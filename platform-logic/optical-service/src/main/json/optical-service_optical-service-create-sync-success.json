[
    {
        "id": "27072996.28603e",
        "type": "dgstart",
        "name": "DGSTART",
        "outputs": 1,
        "x": 184,
        "y": 103,
        "z": "7d0d9c37.54e5a4",
        "wires": [
            [
                "6ffe569c.fa109"
            ]
        ]
    },
    {
        "id": "cc951b5b.220708",
        "type": "method",
        "name": "method",
        "xml": "<method rpc='optical-service-create-sync-success' mode='sync'>\n",
        "comments": "",
        "outputs": 1,
        "x": 378,
        "y": 75,
        "z": "7d0d9c37.54e5a4",
        "wires": [
            [
                "532eb08a.251b5"
            ]
        ]
    },
    {
        "id": "6ffe569c.fa109",
        "type": "service-logic",
        "name": "optical-service ${project.version}",
        "module": "optical-service",
        "version": "${project.version}",
        "comments": "",
        "xml": "<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='optical-service' version='${project.version}'>",
        "outputs": 1,
        "x": 219.5,
        "y": 226,
        "z": "7d0d9c37.54e5a4",
        "wires": [
            [
                "cc951b5b.220708"
            ]
        ]
    },
    {
        "id": "532eb08a.251b5",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic='true'>",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 481,
        "y": 139,
        "z": "7d0d9c37.54e5a4",
        "wires": [
            [
                "59831fea.3da9b8",
                "de3d717d.5418b8",
                "32dae8f5.5da2a",
                "8a15eff0.fb43c8",
                "2407f854.80a4a",
                "4b9498a0.6b56d8",
                "38b45c59.81b3bc",
                "7c78c7d.3f8aeb8",
                "4b5d7c6c.dfedd4"
            ]
        ]
    },
    {
        "id": "32dae8f5.5da2a",
        "type": "save",
        "name": "update rate in aend in DB",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource' \nresource='SQL' \nkey='UPDATE TOPOLOGY_LOGICAL_RELATION_TO_PINTERFACE SET rate = $available-bandwidth-aend WHERE \ninterface_name = $optical-service-create-input.payload.service-aend.port-id'\nforce='true' pfx='save-result'>\n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n\n    \n    \n    \n    \n    \n    \n    \n    \n\n\n\n\n\n\n\n\n\n\n\n",
        "comments": "",
        "outputs": 1,
        "x": 882,
        "y": 183,
        "z": "7d0d9c37.54e5a4",
        "wires": [
            []
        ]
    },
    {
        "id": "2407f854.80a4a",
        "type": "update",
        "name": "update p-interface a-End in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' \nforce='true'\nresource='p-interface'\nkey = 'pnf.pnf-name = $a-end-pnf-name\n      AND p-interface.interface-name = $optical-service-create-input.payload.service-aend.port-id'\n      local-only='false'>\n<parameter name='available-capacity' value='`$available-bandwidth-aend`' />\n\n\n\n\n\n\n\n\n\n    \n    \n    \n    \n    \n    \n    \n    \n   \n    \n    \n    \n\n\n",
        "comments": "",
        "outputs": 1,
        "x": 806,
        "y": 313,
        "z": "7d0d9c37.54e5a4",
        "wires": [
            []
        ]
    },
    {
        "id": "8a15eff0.fb43c8",
        "type": "save",
        "name": "update rate in azend DB",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource' \nresource='SQL' \nkey='UPDATE TOPOLOGY_LOGICAL_RELATION_TO_PINTERFACE SET rate = $available-bandwidth-zend WHERE \ninterface_name = $optical-service-create-input.payload.service-zend.port-id'\nforce='true' pfx='save-result'>\n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n\n    \n    \n    \n    \n    \n    \n    \n    \n\n\n\n\n\n\n\n\n\n\n\n",
        "comments": "",
        "outputs": 1,
        "x": 820,
        "y": 257,
        "z": "7d0d9c37.54e5a4",
        "wires": [
            []
        ]
    },
    {
        "id": "4b9498a0.6b56d8",
        "type": "update",
        "name": "update p-interface z-End in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' \nforce='true'\nresource='p-interface'\nkey = 'pnf.pnf-name = $z-end-pnf-name\n      AND p-interface.interface-name = $optical-service-create-input.payload.service-zend.port-id'\n      local-only='false'>\n<parameter name='available-capacity' value='`$available-bandwidth-zend`' />\n\n\n\n\n\n\n\n\n\n    \n    \n    \n    \n    \n    \n    \n    \n   \n    \n    \n    \n\n\n",
        "comments": "",
        "outputs": 1,
        "x": 802,
        "y": 385,
        "z": "7d0d9c37.54e5a4",
        "wires": [
            []
        ]
    },
    {
        "id": "59831fea.3da9b8",
        "type": "record",
        "name": "record",
        "xml": "<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.FileRecorder\">\n<parameter name=\"file\" value=\"/opt/opendaylight/current/data/log/optical-service-create.log\" />\n<parameter name=\"level\" value=\"info\" />\n<parameter name=\"field1\" value=\"Inside sync success\"/>\n\n",
        "comments": "",
        "outputs": 1,
        "x": 641,
        "y": 86,
        "z": "7d0d9c37.54e5a4",
        "wires": [
            []
        ]
    },
    {
        "id": "de3d717d.5418b8",
        "type": "set",
        "name": "set available rate as 0",
        "xml": "<set>\n<parameter name='available-bandwidth-aend' value='0' />\n<parameter name='available-bandwidth-zend' value='0' />\n\n\n\n\n\n\n\n\n\n",
        "comments": "",
        "x": 753,
        "y": 136,
        "z": "7d0d9c37.54e5a4",
        "wires": []
    },
    {
        "id": "8efcdbce.63cc68",
        "type": "save",
        "name": "save Service Request Details in DB",
        "xml": "<save plugin=\"org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource\" resource=\"SQL\" key=\"INSERT INTO REQUEST_DETAILS (request_id, controller_id, status, service_rate, service_instance_id, service_type, global_customer_id, notification_url) VALUES ( $optical-service-create-input.request-id , $controller-id , 'CREATING' , $optical-service-create-input.payload.service-rate ,  $optical-service-create-input.service-id , $optical-service-create-input.service-type , $optical-service-create-input.global-customer-id , $optical-service-create-input.notification-url );\">\n",
        "comments": "",
        "outputs": 1,
        "x": 1245,
        "y": 339,
        "z": "7d0d9c37.54e5a4",
        "wires": [
            []
        ]
    },
    {
        "id": "efcf557d.c3a5f8",
        "type": "save",
        "name": "save service-instance details in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='service-instance'  \n     key='customer.global-customer-id = $optical-service-create-input.global-customer-id AND\n     service-subscription.service-type = $optical-service-create-input.service-type AND\n     service-instance.service-instance-id = $optical-service-create-input.service-id' >\n<parameter name='service-instance-id' value='`$optical-service-create-input.service-id`' />\n<parameter name='service-instance-name' value='`$optical-service-create-input.payload.service-name`' />\n<parameter name='service-type' value='Domain-Service' />\n<parameter name='orchestration-status' value='CREATING' />\n<parameter name='service-rate' value='`$optical-service-create-input.payload.service-rate`' />\n<parameter name='service-layer' value='`$optical-service-create-input.payload.service-layer`' />\n\n",
        "comments": "",
        "outputs": 1,
        "x": 1255,
        "y": 431,
        "z": "7d0d9c37.54e5a4",
        "wires": [
            []
        ]
    },
    {
        "id": "38b45c59.81b3bc",
        "type": "save",
        "name": "save service-instance relation with p-interface",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='service-instance:relationship-list'  \n     key='customer.global-customer-id = $optical-service-create-input.global-customer-id AND\n     service-subscription.service-type = $optical-service-create-input.service-type AND\n     service-instance.service-instance-id = $optical-service-create-input.service-id' force=\"true\" pfx=\"tmp.AnAI-data\">\n<parameter name=\"relationship-list.relationship[0].related-to\" value=\"p-interface\" />\n<parameter name=\"relationship-list.relationship[0].related-link\" value=\"`'/network/pnfs/pnf/' + $a-end-pnf-name + '/p-interfaces/p-interface/' + $optical-service-create-input.payload.service-aend.port-id `\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"pnf.pnf-name\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$a-end-pnf-name`\" /> \n<parameter name=\"relationship-list.relationship[1].related-to\" value=\"p-interface\" />\n<parameter name=\"relationship-list.relationship[1].related-link\" value=\"`'/network/pnfs/pnf/' + $z-end-pnf-name + '/p-interfaces/p-interface/' + $optical-service-create-input.payload.service-zend.port-id `\" />\n<parameter name=\"relationship-list.relationship[1].relationship-data[0].relationship-key\" value=\"pnf.pnf-name\" />\n<parameter name=\"relationship-list.relationship[1].relationship-data[0].relationship-value\" value=\"`$z-end-pnf-name`\" />\n   \n    ",
        "comments": "",
        "outputs": 1,
        "x": 700,
        "y": 602,
        "z": "7d0d9c37.54e5a4",
        "wires": [
            []
        ]
    },
    {
        "id": "7c78c7d.3f8aeb8",
        "type": "returnSuccess",
        "name": "return success",
        "xml": "<return status='success'>\n<parameter name='error-code' value='200' />\n<parameter name='error-message' value='Service Creation in Progress' />\n<parameter name='ack-final-indicator' value='N' />\n",
        "comments": "",
        "x": 526,
        "y": 670,
        "z": "7d0d9c37.54e5a4",
        "wires": []
    },
    {
        "id": "4b5d7c6c.dfedd4",
        "type": "switchNode",
        "name": "switch domain-type",
        "xml": "<switch test='`$optical-service-create-input.payload.domain-type`'>\n    \n",
        "comments": "",
        "outputs": 1,
        "x": 705,
        "y": 477,
        "z": "7d0d9c37.54e5a4",
        "wires": [
            [
                "d809de29.7d03f8",
                "c1db711f.fdedc"
            ]
        ]
    },
    {
        "id": "d809de29.7d03f8",
        "type": "outcome",
        "name": "MSA",
        "xml": "<outcome value='MSA'>\n",
        "comments": "",
        "outputs": 1,
        "x": 878,
        "y": 442,
        "z": "7d0d9c37.54e5a4",
        "wires": [
            [
                "4f2bcf28.f836e8"
            ]
        ]
    },
    {
        "id": "c1db711f.fdedc",
        "type": "outcome",
        "name": "TAPI",
        "xml": "<outcome value='TAPI'>\n",
        "comments": "",
        "outputs": 1,
        "x": 875,
        "y": 518,
        "z": "7d0d9c37.54e5a4",
        "wires": [
            [
                "1de8f6d7.6e55d9"
            ]
        ]
    },
    {
        "id": "4f2bcf28.f836e8",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 1001,
        "y": 437,
        "z": "7d0d9c37.54e5a4",
        "wires": [
            [
                "8efcdbce.63cc68",
                "efcf557d.c3a5f8"
            ]
        ]
    },
    {
        "id": "1de8f6d7.6e55d9",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 1008,
        "y": 548,
        "z": "7d0d9c37.54e5a4",
        "wires": [
            [
                "35944f6f.0c2038",
                "a30d1744.eb9978"
            ]
        ]
    },
    {
        "id": "35944f6f.0c2038",
        "type": "save",
        "name": "save Service Request Details in DB",
        "xml": "<save plugin=\"org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource\" resource=\"SQL\" key=\"INSERT INTO REQUEST_DETAILS (request_id, controller_id, status, service_rate, service_instance_id, service_type, global_customer_id, notification_url) VALUES ( $optical-service-create-input.request-id , $controller-id , 'CREATED' , $optical-service-create-input.payload.service-rate ,  $optical-service-create-input.service-id , $optical-service-create-input.service-type , $optical-service-create-input.global-customer-id , $optical-service-create-input.notification-url );\">\n",
        "comments": "",
        "outputs": 1,
        "x": 1243,
        "y": 514,
        "z": "7d0d9c37.54e5a4",
        "wires": [
            []
        ]
    },
    {
        "id": "a30d1744.eb9978",
        "type": "save",
        "name": "save service-instance details in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='service-instance'  \n     key='customer.global-customer-id = $optical-service-create-input.global-customer-id AND\n     service-subscription.service-type = $optical-service-create-input.service-type AND\n     service-instance.service-instance-id = $optical-service-create-input.service-id' >\n<parameter name='service-instance-id' value='`$optical-service-create-input.service-id`' />\n<parameter name='service-instance-name' value='`$optical-service-create-input.payload.service-name`' />\n<parameter name='service-type' value='Domain-Service' />\n<parameter name='orchestration-status' value='CREATED' />\n<parameter name='service-rate' value='`$optical-service-create-input.payload.service-rate`' />\n<parameter name='service-layer' value='`$optical-service-create-input.payload.service-layer`' />\n\n",
        "comments": "",
        "outputs": 1,
        "x": 1245,
        "y": 592,
        "z": "7d0d9c37.54e5a4",
        "wires": [
            []
        ]
    }
]