[
    {
        "id": "f869c120.9a5e8",
        "type": "dgstart",
        "name": "DGSTART",
        "outputs": 1,
        "x": 121.5,
        "y": 90,
        "z": "3bd40398.0e17fc",
        "wires": [
            [
                "8af1dc93.0e0da"
            ]
        ]
    },
    {
        "id": "8af1dc93.0e0da",
        "type": "service-logic",
        "name": "optical-service ${project.version}",
        "module": "optical-service",
        "version": "${project.version}",
        "comments": "",
        "xml": "<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='optical-service' version='${project.version}'>",
        "outputs": 1,
        "x": 134.5,
        "y": 150,
        "z": "3bd40398.0e17fc",
        "wires": [
            [
                "b03df385.9b70c"
            ]
        ]
    },
    {
        "id": "b03df385.9b70c",
        "type": "method",
        "name": "method service-delete-tapi",
        "xml": "<method rpc='service-delete-tapi' mode='sync'>\n",
        "comments": "",
        "outputs": 1,
        "x": 154.5,
        "y": 230,
        "z": "3bd40398.0e17fc",
        "wires": [
            [
                "dae9b3c0.70198"
            ]
        ]
    },
    {
        "id": "dae9b3c0.70198",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 402,
        "y": 230,
        "z": "3bd40398.0e17fc",
        "wires": [
            [
                "882993c6.73a42",
                "9a7b4d91.dc0e5",
                "fe5645b4.4896a8",
                "361056c9.62d1aa",
                "fcf7ae69.66bac",
                "658b7b5f.7441e4",
                "ca74a3e.de9376"
            ]
        ]
    },
    {
        "id": "882993c6.73a42",
        "type": "record",
        "name": "record",
        "xml": "<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.FileRecorder\">\n<parameter name=\"file\" value=\"/opt/opendaylight/current/data/log/service-create-tapi.log\" />\n<parameter name=\"level\" value=\"info\" />\n<parameter name=\"field1\" value=\"Inside optical service delete tapi\"/>\n\n\n\n\n\n",
        "comments": "",
        "outputs": 1,
        "x": 498.5,
        "y": 53,
        "z": "3bd40398.0e17fc",
        "wires": [
            []
        ]
    },
    {
        "id": "9a7b4d91.dc0e5",
        "type": "set",
        "name": "set",
        "xml": "<set>\n<parameter name='request-id' value='`$optical-service-delete-input.request-id`' />\n",
        "comments": "",
        "x": 689.5000076293945,
        "y": 37.00000190734863,
        "z": "3bd40398.0e17fc",
        "wires": []
    },
    {
        "id": "ca74a3e.de9376",
        "type": "execute",
        "name": "execute",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"restapiUrl\" value=\"` $controller-ip + $prop.tapi.get.services.url + $service-name`\" />\n<parameter name=\"restapiUser\" value=\"admin\"/>  \n<parameter name=\"restapiPassword\" value=\"admin\"/>  \n<parameter name=\"httpMethod\" value=\"GET\"/>\n<parameter name=\"responsePrefix\" value=\"services-response\"/>\n<parameter name='contentType' value='application/json' />\n<parameter name='format' value='json' />\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.tapi.jks\"/>  \n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>  \n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>  \n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/> ",
        "comments": "",
        "outputs": 1,
        "x": 575.4999465942383,
        "y": 328.3888740539551,
        "z": "3bd40398.0e17fc",
        "wires": [
            [
                "63d373a2.41054c",
                "5229271d.664468"
            ]
        ]
    },
    {
        "id": "bfa60c53.34db1",
        "type": "set",
        "name": "set",
        "xml": "<set>\n<parameter name='aend-nep' value=\"`$services-response.service[0].end-point[0].connection-end-point[0].node-edge-point-uuid`\" />\n<parameter name='zend-nep' value=\"`$services-response.service[0].end-point[1].connection-end-point[0].node-edge-point-uuid`\" />\n<parameter name='aend-cep' value=\"`$services-response.service[0].end-point[0].connection-end-point[0].connection-end-point-uuid`\" />\n<parameter name='zend-cep' value=\"`$services-response.service[0].end-point[1].connection-end-point[0].connection-end-point-uuid`\" />\n",
        "comments": "",
        "x": 1332.7221870422363,
        "y": 97.55551338195801,
        "z": "3bd40398.0e17fc",
        "wires": []
    },
    {
        "id": "63d373a2.41054c",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 793.8332633972168,
        "y": 285.33330154418945,
        "z": "3bd40398.0e17fc",
        "wires": [
            []
        ]
    },
    {
        "id": "5229271d.664468",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 777.9998893737793,
        "y": 377.55554580688477,
        "z": "3bd40398.0e17fc",
        "wires": [
            [
                "aa57e737.b0fed8"
            ]
        ]
    },
    {
        "id": "aa57e737.b0fed8",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic='true'>",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 981.0554733276367,
        "y": 303.6666831970215,
        "z": "3bd40398.0e17fc",
        "wires": [
            [
                "bfa60c53.34db1",
                "863b12fd.05227",
                "b8f3f329.852df",
                "dbf2f1d6.f28c4"
            ]
        ]
    },
    {
        "id": "863b12fd.05227",
        "type": "get-resource",
        "name": "get-resource",
        "xml": "<get-resource plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource' resource='SQL'\nkey='SELECT *\nfrom TOPOLOGY_LOGICAL_RELATION_TO_PINTERFACE\nWHERE interface_name = $aend-nep'\npfx='db-aend'>",
        "comments": "",
        "outputs": 1,
        "x": 1363.5556869506836,
        "y": 152.27777290344238,
        "z": "3bd40398.0e17fc",
        "wires": [
            []
        ]
    },
    {
        "id": "b8f3f329.852df",
        "type": "get-resource",
        "name": "get-resource",
        "xml": "<get-resource plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource' resource='SQL'\nkey='SELECT *\nfrom TOPOLOGY_LOGICAL_RELATION_TO_PINTERFACE\nWHERE interface_name = $zend-nep'\npfx='db-zend'>",
        "comments": "",
        "outputs": 1,
        "x": 1366.055564880371,
        "y": 209.2222318649292,
        "z": "3bd40398.0e17fc",
        "wires": [
            []
        ]
    },
    {
        "id": "a6a0d931.29ae78",
        "type": "set",
        "name": "set",
        "xml": "<set>\n<parameter name='aend-new' value='`$aend-cep`' />\n",
        "comments": "",
        "x": 1776.721923828125,
        "y": 504.22216796875,
        "z": "3bd40398.0e17fc",
        "wires": []
    },
    {
        "id": "96350f11.361f",
        "type": "get-resource",
        "name": "find if aend is uni or nni or enni",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\"\nresource=\"p-interface\"\n key=\"pnf.pnf-name = $db-aend.pnf-name AND\n     p-interface.interface-name = $aend-nep\"\npfx='aend'      local-only='false'>\n\n",
        "comments": "",
        "outputs": 1,
        "x": 1564.6107177734375,
        "y": 419.88885498046875,
        "z": "3bd40398.0e17fc",
        "wires": [
            []
        ]
    },
    {
        "id": "dbf2f1d6.f28c4",
        "type": "execute",
        "name": "execute",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"restapiUrl\" value=\"` $controller-ip + $prop.tapi.delete.service.url + $service-name`\" />\n<parameter name=\"restapiUser\" value=\"admin\"/>  \n<parameter name=\"restapiPassword\" value=\"admin\"/>  \n<parameter name=\"httpMethod\" value=\"DELETE\"/>\n<parameter name=\"responsePrefix\" value=\"tapi-service-response\"/>\n<parameter name='contentType' value='application/json' />\n<parameter name='format' value='json' />\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.tapi.jks\"/>  \n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>  \n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>  \n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/> ",
        "comments": "",
        "outputs": 1,
        "x": 1128.8331146240234,
        "y": 371.44440746307373,
        "z": "3bd40398.0e17fc",
        "wires": [
            [
                "f321d77d.d8fcf8",
                "21838287.92c3fe"
            ]
        ]
    },
    {
        "id": "f321d77d.d8fcf8",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1097.8331146240234,
        "y": 513.4444074630737,
        "z": "3bd40398.0e17fc",
        "wires": [
            [
                "91f84772.c4f2c8"
            ]
        ]
    },
    {
        "id": "91f84772.c4f2c8",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic='true'>",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 1252.0553512573242,
        "y": 467.666627407074,
        "z": "3bd40398.0e17fc",
        "wires": [
            [
                "96350f11.361f",
                "fd9b7231.073dc",
                "438c73c3.1e914c",
                "f0125016.faa34",
                "40bc2de7.03f354",
                "db818283.160ff",
                "f97e22d2.872f8",
                "9544eb2a.40e488",
                "91c2f578.c64f58"
            ]
        ]
    },
    {
        "id": "21838287.92c3fe",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1255.4998016357422,
        "y": 355.88880443573,
        "z": "3bd40398.0e17fc",
        "wires": [
            [
                "77e1cb8f.bccac4"
            ]
        ]
    },
    {
        "id": "77e1cb8f.bccac4",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic='true'>",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 1422.4998016357422,
        "y": 354.88880443573,
        "z": "3bd40398.0e17fc",
        "wires": [
            [
                "92f8a789.a292a8"
            ]
        ]
    },
    {
        "id": "92f8a789.a292a8",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n<parameter name='error-code' value='500' />\n<parameter name='error-message' value='Service Deletion failed' />\n<parameter name='ack-final-indicator' value=\"Y\" />",
        "comments": "",
        "x": 1590.3886985778809,
        "y": 353.66657543182373,
        "z": "3bd40398.0e17fc",
        "wires": []
    },
    {
        "id": "fd9b7231.073dc",
        "type": "switchNode",
        "name": "switch",
        "xml": "<switch test='`$aend.network-interface-type`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1486.6108856201172,
        "y": 522.5554914474487,
        "z": "3bd40398.0e17fc",
        "wires": [
            [
                "1a5628eb.513f87",
                "b8eb04be.936ff8"
            ]
        ]
    },
    {
        "id": "1a5628eb.513f87",
        "type": "outcome",
        "name": "UNI",
        "xml": "<outcome value='UNI'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1651.388671875,
        "y": 504.22216796875,
        "z": "3bd40398.0e17fc",
        "wires": [
            [
                "a6a0d931.29ae78"
            ]
        ]
    },
    {
        "id": "b8eb04be.936ff8",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1653.6108779907227,
        "y": 577.5555419921875,
        "z": "3bd40398.0e17fc",
        "wires": [
            [
                "54b37131.ec50b"
            ]
        ]
    },
    {
        "id": "438c73c3.1e914c",
        "type": "save",
        "name": "update pinterface cep DB Aend",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource' \nresource='SQL' \nkey='UPDATE TOPOLOGY_LOGICAL_RELATION_TO_PINTERFACE SET connection_point = $aend-new WHERE interface_name = $aend-nep'\nforce='true' pfx='save-result'>",
        "comments": "",
        "outputs": 1,
        "x": 1516.6108856201172,
        "y": 620.3332624435425,
        "z": "3bd40398.0e17fc",
        "wires": [
            []
        ]
    },
    {
        "id": "f0125016.faa34",
        "type": "get-resource",
        "name": "find if zend is uni or nni or enni",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\"\nresource=\"p-interface\"\n key=\"pnf.pnf-name = $db-zend.pnf-name AND\n     p-interface.interface-name = $zend-nep\"\npfx='zend'      local-only='false'>\n\n",
        "comments": "",
        "outputs": 1,
        "x": 1493.2772598266602,
        "y": 703.6665992736816,
        "z": "3bd40398.0e17fc",
        "wires": [
            []
        ]
    },
    {
        "id": "40bc2de7.03f354",
        "type": "switchNode",
        "name": "switch",
        "xml": "<switch test='`$zend.network-interface-type`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1395.4998149871826,
        "y": 772.55544090271,
        "z": "3bd40398.0e17fc",
        "wires": [
            [
                "c35140e8.3b796",
                "59a847b5.312e98"
            ]
        ]
    },
    {
        "id": "c35140e8.3b796",
        "type": "outcome",
        "name": "UNI",
        "xml": "<outcome value='UNI'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1585.8330764770508,
        "y": 760.2221584320068,
        "z": "3bd40398.0e17fc",
        "wires": [
            [
                "5f2dae98.203c3"
            ]
        ]
    },
    {
        "id": "59a847b5.312e98",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1588.0553359985352,
        "y": 827.5555419921875,
        "z": "3bd40398.0e17fc",
        "wires": [
            [
                "135bc522.303b8b"
            ]
        ]
    },
    {
        "id": "db818283.160ff",
        "type": "save",
        "name": "update pinterface cep DB Zend",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource' \nresource='SQL' \nkey='UPDATE TOPOLOGY_LOGICAL_RELATION_TO_PINTERFACE SET connection_point = $zend-new WHERE interface_name = $zend-nep'\nforce='true' pfx='save-result'>",
        "comments": "",
        "outputs": 1,
        "x": 1416.6112060546875,
        "y": 866.9999141693115,
        "z": "3bd40398.0e17fc",
        "wires": [
            []
        ]
    },
    {
        "id": "cf13929a.a5198",
        "type": "set",
        "name": "set",
        "xml": "<set>\n<parameter name='zend-new' value=\"`$zend-cep`\" />\n",
        "comments": "",
        "x": 1985.499885559082,
        "y": 829.2221412658691,
        "z": "3bd40398.0e17fc",
        "wires": []
    },
    {
        "id": "5f2dae98.203c3",
        "type": "set",
        "name": "set",
        "xml": "<set>\n<parameter name='zend-new' value='`$zend-cep`' />\n",
        "comments": "",
        "x": 1712.1664352416992,
        "y": 759.2221622467041,
        "z": "3bd40398.0e17fc",
        "wires": []
    },
    {
        "id": "f97e22d2.872f8",
        "type": "delete",
        "name": "delete service instance AAI",
        "xml": "<delete plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\"\nresource=\"service-instance\"\nkey='customer.global-customer-id = $output.global-customer-id AND\nservice-subscription.service-type = $output.service-type AND\nservice-instance.service-instance-id = $output.service-instance-id'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1312.1664199829102,
        "y": 981.4443254470825,
        "z": "3bd40398.0e17fc",
        "wires": [
            []
        ]
    },
    {
        "id": "135bc522.303b8b",
        "type": "switchNode",
        "name": "switch",
        "xml": "<switch test='`$db-zend.connection-point`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1729.9444444444443,
        "y": 830.3333333333333,
        "z": "3bd40398.0e17fc",
        "wires": [
            [
                "dda38169.1a96b",
                "943fd023.cc6d9"
            ]
        ]
    },
    {
        "id": "dda38169.1a96b",
        "type": "outcome",
        "name": "outcome",
        "xml": "<outcome value=''>\n",
        "comments": "",
        "outputs": 1,
        "x": 1857.7222061157227,
        "y": 831.4444217681885,
        "z": "3bd40398.0e17fc",
        "wires": [
            [
                "cf13929a.a5198"
            ]
        ]
    },
    {
        "id": "582c452e.50a00c",
        "type": "set",
        "name": "set",
        "xml": "<set>\n<parameter name='zend-new' value=\"`$db-zend.connection-point + ',' + $zend-cep`\" />\n",
        "comments": "",
        "x": 1987.721981048584,
        "y": 895.8887939453125,
        "z": "3bd40398.0e17fc",
        "wires": []
    },
    {
        "id": "943fd023.cc6d9",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1869.9444444444443,
        "y": 894.7777777777778,
        "z": "3bd40398.0e17fc",
        "wires": [
            [
                "582c452e.50a00c"
            ]
        ]
    },
    {
        "id": "54b37131.ec50b",
        "type": "switchNode",
        "name": "switch",
        "xml": "<switch test='`$db-aend.connection-point`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1781.0554428100586,
        "y": 580.3333148956299,
        "z": "3bd40398.0e17fc",
        "wires": [
            [
                "d7cb5d1f.868ba",
                "b8aa01ad.10807"
            ]
        ]
    },
    {
        "id": "cd72b99.aafe848",
        "type": "set",
        "name": "set",
        "xml": "<set>\n<parameter name='aend-new' value=\"`$aend-cep`\" />\n",
        "comments": "",
        "x": 2055.5,
        "y": 569.22216796875,
        "z": "3bd40398.0e17fc",
        "wires": []
    },
    {
        "id": "d7cb5d1f.868ba",
        "type": "outcome",
        "name": "outcome",
        "xml": "<outcome value=''>\n",
        "comments": "",
        "outputs": 1,
        "x": 1927.7223205566406,
        "y": 571.4444484710693,
        "z": "3bd40398.0e17fc",
        "wires": [
            [
                "cd72b99.aafe848"
            ]
        ]
    },
    {
        "id": "b905fec4.7ac5f",
        "type": "set",
        "name": "set",
        "xml": "<set>\n<parameter name='aend-new' value=\"`$db-aend.connection-point + ',' + $aend-cep`\" />\n",
        "comments": "",
        "x": 2057.722095489502,
        "y": 635.8888206481934,
        "z": "3bd40398.0e17fc",
        "wires": []
    },
    {
        "id": "b8aa01ad.10807",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1939.9445588853623,
        "y": 634.7778044806587,
        "z": "3bd40398.0e17fc",
        "wires": [
            [
                "b905fec4.7ac5f"
            ]
        ]
    },
    {
        "id": "9544eb2a.40e488",
        "type": "delete",
        "name": "delete from db",
        "xml": "<delete plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource'\n    resource=\"SQL\"\n    key=\"DELETE FROM REQUEST_DETAILS WHERE request_id = $request-id\">",
        "comments": "",
        "outputs": 1,
        "x": 1223.2776336669922,
        "y": 1042.5554809570312,
        "z": "3bd40398.0e17fc",
        "wires": [
            []
        ]
    },
    {
        "id": "91c2f578.c64f58",
        "type": "set",
        "name": "set",
        "xml": "<set>\n<parameter name='final-response-code' value=\"200\" />\n",
        "comments": "",
        "x": 1170.5,
        "y": 1114,
        "z": "3bd40398.0e17fc",
        "wires": []
    },
    {
        "id": "fe5645b4.4896a8",
        "type": "get-resource",
        "name": "get-resource",
        "xml": "<get-resource plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource' resource='SQL' \nkey='SELECT * from REQUEST_DETAILS WHERE request_id = $request-id '\npfx='output'>\n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n\n    \n    \n    \n    \n    \n    \n    \n     \n \n",
        "comments": "",
        "outputs": 1,
        "x": 710.0000114440918,
        "y": 107.50000095367432,
        "z": "3bd40398.0e17fc",
        "wires": [
            []
        ]
    },
    {
        "id": "361056c9.62d1aa",
        "type": "set",
        "name": "set",
        "xml": "<set>\n<parameter name='esr-id' value='`$output.controller-id`' />\n",
        "comments": "",
        "x": 727.5,
        "y": 152.5,
        "z": "3bd40398.0e17fc",
        "wires": []
    },
    {
        "id": "fcf7ae69.66bac",
        "type": "execute",
        "name": "execute",
        "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='split' >\n<parameter name=\"original_string\" value='`$esr-id`'/>\n<parameter name=\"regex\" value=\"_\"/>\n<parameter name=\"ctx_memory_result_key\" value=\"new-esr\"/> ",
        "comments": "",
        "outputs": 1,
        "x": 707.5000152587891,
        "y": 207.50000190734863,
        "z": "3bd40398.0e17fc",
        "wires": [
            []
        ]
    },
    {
        "id": "658b7b5f.7441e4",
        "type": "set",
        "name": "set",
        "xml": "<set>\n<parameter name='service-name' value=\"`$optical-service-delete-input.payload.service-name +  $new-esr[2]`\" />\n",
        "comments": "",
        "x": 675.0000114440918,
        "y": 262.50000381469727,
        "z": "3bd40398.0e17fc",
        "wires": []
    }
]