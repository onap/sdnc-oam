[
    {
        "id": "22cb0f8b.7a936",
        "type": "dgstart",
        "name": "DGSTART",
        "outputs": 1,
        "x": 276,
        "y": 233,
        "z": "ecded786.86d6f8",
        "wires": [
            [
                "899fe88f.8b0f18"
            ]
        ]
    },
    {
        "id": "899fe88f.8b0f18",
        "type": "service-logic",
        "name": "optical-service ${project.version}",
        "module": "optical-service",
        "version": "${project.version}",
        "comments": "",
        "xml": "<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='optical-service' version='${project.version}'>",
        "outputs": 1,
        "x": 289,
        "y": 293,
        "z": "ecded786.86d6f8",
        "wires": [
            [
                "8c11d44e.febba8"
            ]
        ]
    },
    {
        "id": "8c11d44e.febba8",
        "type": "method",
        "name": "method service-delete-tapi",
        "xml": "<method rpc='service-delete-tapi' mode='sync'>\n",
        "comments": "",
        "outputs": 1,
        "x": 309,
        "y": 373,
        "z": "ecded786.86d6f8",
        "wires": [
            [
                "4251fc90.7d3354"
            ]
        ]
    },
    {
        "id": "4251fc90.7d3354",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 556.5,
        "y": 373,
        "z": "ecded786.86d6f8",
        "wires": [
            [
                "fa22a868.cbac88",
                "61c8204a.2cec1",
                "613af82c.220508"
            ]
        ]
    },
    {
        "id": "fa22a868.cbac88",
        "type": "record",
        "name": "record",
        "xml": "<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.FileRecorder\">\n<parameter name=\"file\" value=\"/opt/opendaylight/current/data/log/service-create-tapi.log\" />\n<parameter name=\"level\" value=\"info\" />\n<parameter name=\"field1\" value=\"Inside optical service delete tapi\"/>\n\n\n\n\n\n",
        "comments": "",
        "outputs": 1,
        "x": 653,
        "y": 196,
        "z": "ecded786.86d6f8",
        "wires": [
            []
        ]
    },
    {
        "id": "61c8204a.2cec1",
        "type": "set",
        "name": "set",
        "xml": "<set>\n<parameter name='request-id' value='`$optical-service-delete-input.request-id`' />\n",
        "comments": "",
        "x": 729,
        "y": 245,
        "z": "ecded786.86d6f8",
        "wires": []
    },
    {
        "id": "613af82c.220508",
        "type": "execute",
        "name": "execute",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"restapiUrl\" value=\"` $controller-ip + $prop.tapi.get.services.url + $optical-service-delete-input.payload.service-name`\" />\n<parameter name=\"restapiUser\" value=\"admin\"/>  \n<parameter name=\"restapiPassword\" value=\"admin\"/>  \n<parameter name=\"httpMethod\" value=\"GET\"/>\n<parameter name=\"responsePrefix\" value=\"services-response\"/>\n<parameter name='contentType' value='application/json' />\n<parameter name='format' value='json' />\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.tapi.jks\"/>  \n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>  \n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>  \n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/> ",
        "comments": "",
        "outputs": 1,
        "x": 759.9999351501465,
        "y": 378.8888759613037,
        "z": "ecded786.86d6f8",
        "wires": [
            [
                "6682edb5.3e9d24",
                "894f9664.c6abc8"
            ]
        ]
    },
    {
        "id": "ddeadbca.081d98",
        "type": "set",
        "name": "set",
        "xml": "<set>\n<parameter name='aend-nep' value=\"`$services-response.service[0].end-point[0].connection-end-point[0].node-edge-point-uuid`\" />\n<parameter name='zend-nep' value=\"`$services-response.service[0].end-point[1].connection-end-point[0].node-edge-point-uuid`\" />\n<parameter name='aend-cep' value=\"`$services-response.service[0].end-point[0].connection-end-point[0].connection-end-point-uuid`\" />\n<parameter name='zend-cep' value=\"`$services-response.service[0].end-point[1].connection-end-point[0].connection-end-point-uuid`\" />\n",
        "comments": "",
        "x": 1492.2221755981445,
        "y": 305.555513381958,
        "z": "ecded786.86d6f8",
        "wires": []
    },
    {
        "id": "6682edb5.3e9d24",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 963.3332595825195,
        "y": 353.33330249786377,
        "z": "ecded786.86d6f8",
        "wires": [
            []
        ]
    },
    {
        "id": "894f9664.c6abc8",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 939.999885559082,
        "y": 435.55552768707275,
        "z": "ecded786.86d6f8",
        "wires": [
            [
                "dafe166a.8b36d8"
            ]
        ]
    },
    {
        "id": "dafe166a.8b36d8",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic='true'>",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 1135.5554733276367,
        "y": 446.6666831970215,
        "z": "ecded786.86d6f8",
        "wires": [
            [
                "ddeadbca.081d98",
                "2801b4f8.38386c",
                "3cf51d10.896032",
                "a44318ce.afad08"
            ]
        ]
    },
    {
        "id": "2801b4f8.38386c",
        "type": "get-resource",
        "name": "get-resource",
        "xml": "<get-resource plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource' resource='SQL'\nkey='SELECT *\nfrom TOPOLOGY_LOGICAL_RELATION_TO_PINTERFACE\nWHERE interface_name = $aend-nep'\npfx='db-aend'>",
        "comments": "",
        "outputs": 1,
        "x": 1545.5556449890137,
        "y": 367.77777004241943,
        "z": "ecded786.86d6f8",
        "wires": [
            []
        ]
    },
    {
        "id": "3cf51d10.896032",
        "type": "get-resource",
        "name": "get-resource",
        "xml": "<get-resource plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource' resource='SQL'\nkey='SELECT *\nfrom TOPOLOGY_LOGICAL_RELATION_TO_PINTERFACE\nWHERE interface_name = $zend-nep'\npfx='db-zend'>",
        "comments": "",
        "outputs": 1,
        "x": 1545.555549621582,
        "y": 422.2222137451172,
        "z": "ecded786.86d6f8",
        "wires": [
            []
        ]
    },
    {
        "id": "852e3fe3.e39dd",
        "type": "set",
        "name": "set",
        "xml": "<set>\n<parameter name='aend-new' value='`$aend-cep`' />\n",
        "comments": "",
        "x": 1931.221923828125,
        "y": 647.22216796875,
        "z": "ecded786.86d6f8",
        "wires": []
    },
    {
        "id": "4644be9d.89b97",
        "type": "get-resource",
        "name": "find if aend is uni or nni or enni",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\"\nresource=\"p-interface\"\n key=\"pnf.pnf-name = $db-aend.pnf-name AND\n     p-interface.interface-name = $aend-nep\"\npfx='aend'      local-only='false'>\n\n",
        "comments": "",
        "outputs": 1,
        "x": 1719.1107177734375,
        "y": 562.8888549804688,
        "z": "ecded786.86d6f8",
        "wires": [
            []
        ]
    },
    {
        "id": "a44318ce.afad08",
        "type": "execute",
        "name": "execute",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"restapiUrl\" value=\"` $controller-ip + $prop.tapi.delete.service.url + $optical-service-delete-input.payload.service-name`\" />\n<parameter name=\"restapiUser\" value=\"admin\"/>  \n<parameter name=\"restapiPassword\" value=\"admin\"/>  \n<parameter name=\"httpMethod\" value=\"DELETE\"/>\n<parameter name=\"responsePrefix\" value=\"tapi-service-response\"/>\n<parameter name='contentType' value='application/json' />\n<parameter name='format' value='json' />\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.tapi.jks\"/>  \n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>  \n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>  \n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/> ",
        "comments": "",
        "outputs": 1,
        "x": 1283.3331146240234,
        "y": 514.4444074630737,
        "z": "ecded786.86d6f8",
        "wires": [
            [
                "58946d75.cedfa4",
                "e7cecf42.399a6"
            ]
        ]
    },
    {
        "id": "58946d75.cedfa4",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1252.3331146240234,
        "y": 656.4444074630737,
        "z": "ecded786.86d6f8",
        "wires": [
            [
                "1e4a35c6.1c31ca"
            ]
        ]
    },
    {
        "id": "1e4a35c6.1c31ca",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic='true'>",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 1406.5553512573242,
        "y": 610.666627407074,
        "z": "ecded786.86d6f8",
        "wires": [
            [
                "4644be9d.89b97",
                "652250d1.df0d6",
                "29655b58.ca1ca4",
                "aad55652.80ccf8",
                "82da300b.4f57c",
                "2082255.0c982da",
                "9f9c7a46.ce0ff8",
                "70a0ebe0.92bcd4",
                "33fa91ea.5695ce",
                "425e8f1f.07ad6"
            ]
        ]
    },
    {
        "id": "e7cecf42.399a6",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1409.9998016357422,
        "y": 498.88880443573,
        "z": "ecded786.86d6f8",
        "wires": [
            [
                "ea3eca27.8a59e8"
            ]
        ]
    },
    {
        "id": "ea3eca27.8a59e8",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic='true'>",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 1576.9998016357422,
        "y": 497.88880443573,
        "z": "ecded786.86d6f8",
        "wires": [
            [
                "e7be8bd4.b55258"
            ]
        ]
    },
    {
        "id": "e7be8bd4.b55258",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n<parameter name='error-code' value='500' />\n<parameter name='error-message' value='Service Deletion failed' />\n<parameter name='ack-final-indicator' value=\"Y\" />",
        "comments": "",
        "x": 1744.8886985778809,
        "y": 496.66657543182373,
        "z": "ecded786.86d6f8",
        "wires": []
    },
    {
        "id": "652250d1.df0d6",
        "type": "returnSuccess",
        "name": "return success",
        "xml": "<return status='success'>\n<parameter name='error-code' value='200' />\n<parameter name='error-message' value='Service deleted successfully' />\n<parameter name='ack-final-indicator' value=\"Y\" />\n",
        "comments": "",
        "x": 1297.7775955200195,
        "y": 1231.1110696792603,
        "z": "ecded786.86d6f8",
        "wires": []
    },
    {
        "id": "29655b58.ca1ca4",
        "type": "switchNode",
        "name": "switch",
        "xml": "<switch test='`$aend.network-interface-type`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1641.1108856201172,
        "y": 665.5554914474487,
        "z": "ecded786.86d6f8",
        "wires": [
            [
                "aea6fbc6.1505d8",
                "2d663d56.1e55d2"
            ]
        ]
    },
    {
        "id": "aea6fbc6.1505d8",
        "type": "outcome",
        "name": "UNI",
        "xml": "<outcome value='UNI'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1805.888671875,
        "y": 647.22216796875,
        "z": "ecded786.86d6f8",
        "wires": [
            [
                "852e3fe3.e39dd"
            ]
        ]
    },
    {
        "id": "2d663d56.1e55d2",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1808.1108779907227,
        "y": 720.5555419921875,
        "z": "ecded786.86d6f8",
        "wires": [
            [
                "af008805.61eae8"
            ]
        ]
    },
    {
        "id": "aad55652.80ccf8",
        "type": "save",
        "name": "update pinterface cep DB Aend",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource' \nresource='SQL' \nkey='UPDATE TOPOLOGY_LOGICAL_RELATION_TO_PINTERFACE SET connection_point = $aend-new WHERE interface_name = $aend-nep'\nforce='true' pfx='save-result'>",
        "comments": "",
        "outputs": 1,
        "x": 1671.1108856201172,
        "y": 763.3332624435425,
        "z": "ecded786.86d6f8",
        "wires": [
            []
        ]
    },
    {
        "id": "82da300b.4f57c",
        "type": "get-resource",
        "name": "find if zend is uni or nni or enni",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\"\nresource=\"p-interface\"\n key=\"pnf.pnf-name = $db-zend.pnf-name AND\n     p-interface.interface-name = $zend-nep\"\npfx='zend'      local-only='false'>\n\n",
        "comments": "",
        "outputs": 1,
        "x": 1647.7772598266602,
        "y": 846.6665992736816,
        "z": "ecded786.86d6f8",
        "wires": [
            []
        ]
    },
    {
        "id": "2082255.0c982da",
        "type": "switchNode",
        "name": "switch",
        "xml": "<switch test='`$zend.network-interface-type`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1549.9998149871826,
        "y": 915.55544090271,
        "z": "ecded786.86d6f8",
        "wires": [
            [
                "3a6cd376.4295ac",
                "86c6217d.bed2a"
            ]
        ]
    },
    {
        "id": "3a6cd376.4295ac",
        "type": "outcome",
        "name": "UNI",
        "xml": "<outcome value='UNI'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1740.3330764770508,
        "y": 903.2221584320068,
        "z": "ecded786.86d6f8",
        "wires": [
            [
                "b35b94b1.940ff8"
            ]
        ]
    },
    {
        "id": "86c6217d.bed2a",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1742.5553359985352,
        "y": 970.5555419921875,
        "z": "ecded786.86d6f8",
        "wires": [
            [
                "e1b5d596.201438"
            ]
        ]
    },
    {
        "id": "9f9c7a46.ce0ff8",
        "type": "save",
        "name": "update pinterface cep DB Zend",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource' \nresource='SQL' \nkey='UPDATE TOPOLOGY_LOGICAL_RELATION_TO_PINTERFACE SET connection_point = $zend-new WHERE interface_name = $zend-nep'\nforce='true' pfx='save-result'>",
        "comments": "",
        "outputs": 1,
        "x": 1571.1112060546875,
        "y": 1009.9999141693115,
        "z": "ecded786.86d6f8",
        "wires": [
            []
        ]
    },
    {
        "id": "74642edb.088ea",
        "type": "set",
        "name": "set",
        "xml": "<set>\n<parameter name='zend-new' value=\"`$zend-cep`\" />\n",
        "comments": "",
        "x": 2139.999885559082,
        "y": 972.2221412658691,
        "z": "ecded786.86d6f8",
        "wires": []
    },
    {
        "id": "b35b94b1.940ff8",
        "type": "set",
        "name": "set",
        "xml": "<set>\n<parameter name='zend-new' value='`$zend-cep`' />\n",
        "comments": "",
        "x": 1866.6664352416992,
        "y": 902.2221622467041,
        "z": "ecded786.86d6f8",
        "wires": []
    },
    {
        "id": "33fa91ea.5695ce",
        "type": "delete",
        "name": "delete service instance AAI",
        "xml": "<delete plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\"\nresource=\"service-instance\"\nkey='customer.global-customer-id = $output.global-customer-id AND\nservice-subscription.service-type = $output.service-type AND\nservice-instance.service-instance-id = $output.service-instance-id'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1466.6664199829102,
        "y": 1124.4443254470825,
        "z": "ecded786.86d6f8",
        "wires": [
            []
        ]
    },
    {
        "id": "70a0ebe0.92bcd4",
        "type": "get-resource",
        "name": "get service db",
        "xml": "<get-resource plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource' resource='SQL' \nkey='SELECT * from REQUEST_DETAILS WHERE request_id = $request-id '\npfx='output'>\n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n\n    \n    \n    \n    \n    \n    \n    \n     \n \n",
        "comments": "",
        "outputs": 1,
        "x": 1487.7775344848633,
        "y": 1067.7777080535889,
        "z": "ecded786.86d6f8",
        "wires": [
            []
        ]
    },
    {
        "id": "e1b5d596.201438",
        "type": "switchNode",
        "name": "switch",
        "xml": "<switch test='`$db-zend.connection-point`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1884.4444444444443,
        "y": 973.3333333333333,
        "z": "ecded786.86d6f8",
        "wires": [
            [
                "1ff79f49.8fba61",
                "54376f65.aa57"
            ]
        ]
    },
    {
        "id": "1ff79f49.8fba61",
        "type": "outcome",
        "name": "outcome",
        "xml": "<outcome value=''>\n",
        "comments": "",
        "outputs": 1,
        "x": 2012.2222061157227,
        "y": 974.4444217681885,
        "z": "ecded786.86d6f8",
        "wires": [
            [
                "74642edb.088ea"
            ]
        ]
    },
    {
        "id": "f9bfc410.022418",
        "type": "set",
        "name": "set",
        "xml": "<set>\n<parameter name='zend-new' value=\"`$db-zend.connection-point + ',' + $zend-cep`\" />\n",
        "comments": "",
        "x": 2142.221981048584,
        "y": 1038.8887939453125,
        "z": "ecded786.86d6f8",
        "wires": []
    },
    {
        "id": "54376f65.aa57",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2024.4444444444443,
        "y": 1037.7777777777778,
        "z": "ecded786.86d6f8",
        "wires": [
            [
                "f9bfc410.022418"
            ]
        ]
    },
    {
        "id": "af008805.61eae8",
        "type": "switchNode",
        "name": "switch",
        "xml": "<switch test='`$db-aend.connection-point`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1935.5554428100586,
        "y": 723.3333148956299,
        "z": "ecded786.86d6f8",
        "wires": [
            [
                "fdc21e7c.da331",
                "ede7f03e.32c01"
            ]
        ]
    },
    {
        "id": "6ca90d2f.d086e4",
        "type": "set",
        "name": "set",
        "xml": "<set>\n<parameter name='aend-new' value=\"`$aend-cep`\" />\n",
        "comments": "",
        "x": 2210,
        "y": 712.22216796875,
        "z": "ecded786.86d6f8",
        "wires": []
    },
    {
        "id": "fdc21e7c.da331",
        "type": "outcome",
        "name": "outcome",
        "xml": "<outcome value=''>\n",
        "comments": "",
        "outputs": 1,
        "x": 2082.2223205566406,
        "y": 714.4444484710693,
        "z": "ecded786.86d6f8",
        "wires": [
            [
                "6ca90d2f.d086e4"
            ]
        ]
    },
    {
        "id": "f35c33d.adfbfd",
        "type": "set",
        "name": "set",
        "xml": "<set>\n<parameter name='aend-new' value=\"`$db-aend.connection-point + ',' + $aend-cep`\" />\n",
        "comments": "",
        "x": 2212.222095489502,
        "y": 778.8888206481934,
        "z": "ecded786.86d6f8",
        "wires": []
    },
    {
        "id": "ede7f03e.32c01",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2094.4445588853623,
        "y": 777.7778044806587,
        "z": "ecded786.86d6f8",
        "wires": [
            [
                "f35c33d.adfbfd"
            ]
        ]
    },
    {
        "id": "425e8f1f.07ad6",
        "type": "delete",
        "name": "delete from db",
        "xml": "<delete plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource'\n    resource=\"SQL\"\n    key=\"DELETE FROM REQUEST_DETAILS WHERE request_id = $request-id\">",
        "comments": "",
        "outputs": 1,
        "x": 1377.7776336669922,
        "y": 1185.5554809570312,
        "z": "ecded786.86d6f8",
        "wires": [
            []
        ]
    }
]