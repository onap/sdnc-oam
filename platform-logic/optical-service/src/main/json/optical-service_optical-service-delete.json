[
    {
        "id": "7d351c38.c4c6cc",
        "type": "dgstart",
        "name": "DGSTART",
        "outputs": 1,
        "x": 146,
        "y": 70,
        "z": "7b1b071a.92faa",
        "wires": [
            [
                "6c3e5cdb.13fe9c"
            ]
        ]
    },
    {
        "id": "6c3e5cdb.13fe9c",
        "type": "service-logic",
        "name": "optical-service ${project.version}",
        "module": "optical-service",
        "version": "${project.version}",
        "comments": "",
        "xml": "<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='optical-service' version='${project.version}'>",
        "outputs": 1,
        "x": 254.5,
        "y": 148,
        "z": "7b1b071a.92faa",
        "wires": [
            [
                "c9af40a8.771678"
            ]
        ]
    },
    {
        "id": "c9af40a8.771678",
        "type": "method",
        "name": "method",
        "xml": "<method rpc='optical-service-delete' mode='sync'>\n",
        "comments": "",
        "outputs": 1,
        "x": 123,
        "y": 239,
        "z": "7b1b071a.92faa",
        "wires": [
            [
                "487722a8.b389a4"
            ]
        ]
    },
    {
        "id": "487722a8.b389a4",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic='true'>",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 309,
        "y": 235,
        "z": "7b1b071a.92faa",
        "wires": [
            [
                "a1fed560.31e7a8",
                "4b9bbd62.4750fc",
                "eac944ef.f83328",
                "b567b7de.be2de8",
                "c0977e42.e4156"
            ]
        ]
    },
    {
        "id": "bfd79d0e.9f7ee8",
        "type": "execute",
        "name": "Call MSA Controller",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/optical-service-delete-msa.json'`\" />\n<parameter name=\"restapiUrl\" value=\"`$controller-ip + '/cxf/openroadm/openroadm-services/' + $optical-service-delete-input.payload.service-name`\"/>\n<parameter name='restapiUser' value='admin' />\n<parameter name='restapiPassword' value='admin' />\n<parameter name=\"httpMethod\" value=\"DELETE\"/>\n<parameter name=\"responsePrefix\" value=\"service-delete-response\"/>\n<parameter name='contentType' value='application/json' />\n<parameter name='format' value='json' />\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.msa.jks\"/>  \n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/> \n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n\n\n\n\n\n",
        "comments": "",
        "outputs": 1,
        "x": 700,
        "y": 326,
        "z": "7b1b071a.92faa",
        "wires": [
            [
                "582ceeba.7fcce",
                "867ca716.d4515"
            ]
        ]
    },
    {
        "id": "a1fed560.31e7a8",
        "type": "execute",
        "name": "execute",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.prop.PropertiesNode' method='readProperties' >\n<parameter name='fileName' value='/opt/onap/sdnc/data/properties/optical-service-dg.properties' />\n<parameter name='contextPrefix' value='prop' />\n",
        "comments": "",
        "outputs": 1,
        "x": 553,
        "y": 36,
        "z": "7b1b071a.92faa",
        "wires": [
            []
        ]
    },
    {
        "id": "582ceeba.7fcce",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 894,
        "y": 306,
        "z": "7b1b071a.92faa",
        "wires": [
            [
                "c3bd28c6.e626b"
            ]
        ]
    },
    {
        "id": "867ca716.d4515",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 869,
        "y": 410,
        "z": "7b1b071a.92faa",
        "wires": [
            [
                "791a6dc2.40ab1c"
            ]
        ]
    },
    {
        "id": "c3bd28c6.e626b",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic='true'>",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 1053,
        "y": 301,
        "z": "7b1b071a.92faa",
        "wires": [
            [
                "caa7c35f.0456c8"
            ]
        ]
    },
    {
        "id": "caa7c35f.0456c8",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n<parameter name='error-code' value='500' />\n<parameter name='error-message' value='Error deleting the Service' />\n",
        "comments": "",
        "x": 1285,
        "y": 245,
        "z": "7b1b071a.92faa",
        "wires": []
    },
    {
        "id": "2041d7aa.c3ae1",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic='true'>",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 1424,
        "y": 549,
        "z": "7b1b071a.92faa",
        "wires": [
            [
                "27f66eb0.3c9aaa",
                "e6dae4f7.8c52b",
                "276e2c67.21f3ec",
                "126b611e.fd67af",
                "881b58f7.fb4a6"
            ]
        ]
    },
    {
        "id": "27f66eb0.3c9aaa",
        "type": "record",
        "name": "record",
        "xml": "<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.FileRecorder\">\n<parameter name=\"file\" value=\"/opt/opendaylight/current/data/log/optical-service-create.log\" />\n<parameter name=\"level\" value=\"info\" />\n<parameter name=\"field1\" value=\"Inside controller\"/>\n\n",
        "comments": "",
        "outputs": 1,
        "x": 1639,
        "y": 464,
        "z": "7b1b071a.92faa",
        "wires": [
            []
        ]
    },
    {
        "id": "e6dae4f7.8c52b",
        "type": "save",
        "name": "Update status in DB",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource' \nresource='SQL' \nkey='UPDATE REQUEST_DETAILS SET status = \"DELETING\" WHERE request_id = $optical-service-delete-input.request-id' \nforce='true' pfx='save-result'>\n\n\n\n\n\n\n\n\n\n",
        "comments": "",
        "outputs": 1,
        "x": 1641,
        "y": 550,
        "z": "7b1b071a.92faa",
        "wires": [
            []
        ]
    },
    {
        "id": "276e2c67.21f3ec",
        "type": "get-resource",
        "name": "get-resource",
        "xml": "<get-resource plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource' resource='SQL' \nkey='SELECT *\nfrom REQUEST_DETAILS \nWHERE request_id = $optical-service-delete-input.request-id'\npfx='db.request-details'>\n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n\n    \n    \n    \n    \n    \n    \n    \n    \n\n",
        "comments": "",
        "outputs": 1,
        "x": 1637,
        "y": 626,
        "z": "7b1b071a.92faa",
        "wires": [
            [
                "ccbf1f5f.52d948"
            ]
        ]
    },
    {
        "id": "cdc717d5.1094b8",
        "type": "record",
        "name": "record",
        "xml": "<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.FileRecorder\">\n<parameter name=\"file\" value=\"/opt/opendaylight/current/data/log/optical-service-create.log\" />\n<parameter name=\"level\" value=\"info\" />\n<parameter name=\"field1\" value=\"Successfully sent the request\"/>\n\n",
        "comments": "",
        "outputs": 1,
        "x": 1238,
        "y": 332,
        "z": "7b1b071a.92faa",
        "wires": [
            []
        ]
    },
    {
        "id": "791a6dc2.40ab1c",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic='true'>",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 1036,
        "y": 413,
        "z": "7b1b071a.92faa",
        "wires": [
            [
                "cdc717d5.1094b8",
                "d4fa1dc0.5c15a8"
            ]
        ]
    },
    {
        "id": "d4fa1dc0.5c15a8",
        "type": "switchNode",
        "name": "switch",
        "xml": "<switch test='`$service-delete-response.configuration-response-common.response-code`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1221,
        "y": 410,
        "z": "7b1b071a.92faa",
        "wires": [
            [
                "bbeca38a.ba0cc",
                "86f8972f.01b4c8"
            ]
        ]
    },
    {
        "id": "bbeca38a.ba0cc",
        "type": "outcome",
        "name": "200 success",
        "xml": "<outcome value='200'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1409,
        "y": 416,
        "z": "7b1b071a.92faa",
        "wires": [
            [
                "2041d7aa.c3ae1"
            ]
        ]
    },
    {
        "id": "86f8972f.01b4c8",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1395,
        "y": 295,
        "z": "7b1b071a.92faa",
        "wires": [
            [
                "8b978b7.90f6978"
            ]
        ]
    },
    {
        "id": "8b978b7.90f6978",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n<parameter name='error-code' value='`$service-delete-response.configuration-response-common.response-code`' />\n<parameter name='error-message' value='`$service-delete-response.configuration-response-common.response-message`' />\n",
        "comments": "",
        "x": 1582,
        "y": 294,
        "z": "7b1b071a.92faa",
        "wires": []
    },
    {
        "id": "ccbf1f5f.52d948",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1847,
        "y": 621,
        "z": "7b1b071a.92faa",
        "wires": [
            [
                "ae1d75fe.230f18"
            ]
        ]
    },
    {
        "id": "ae1d75fe.230f18",
        "type": "set",
        "name": "set",
        "xml": "<set>\n<parameter name='instance-id' value='`$db.request-details.service-instance-id`' />\n<parameter name='customer-id' value='`$db.request-details.global-customer-id`' />\n<parameter name='service-id' value='`$db.request-details.service-type`' />\n\n\n\n\n\n\n\n\n\n\n\n\n",
        "comments": "",
        "x": 1986,
        "y": 622,
        "z": "7b1b071a.92faa",
        "wires": []
    },
    {
        "id": "126b611e.fd67af",
        "type": "update",
        "name": "update resource status- DELETING in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' \nforce='true' \nresource='service-instance' \nkey = 'customer.global-customer-id = $customer-id AND\n     service-subscription.service-type = $service-id AND\n     service-instance.service-instance-id = $instance-id'\nlocal-only='false'>\n    <parameter name='orchestration-status' value='DELETING' />\n\n    \n    \n    \n\n",
        "comments": "",
        "outputs": 1,
        "x": 1730,
        "y": 714,
        "z": "7b1b071a.92faa",
        "wires": [
            []
        ]
    },
    {
        "id": "881b58f7.fb4a6",
        "type": "returnSuccess",
        "name": "return success",
        "xml": "<return status='success'>\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"Service Deletion in Progress\" />\n<parameter name='ack-final-indicator' value='N' />",
        "comments": "",
        "x": 1619,
        "y": 810,
        "z": "7b1b071a.92faa",
        "wires": []
    },
    {
        "id": "4b9bbd62.4750fc",
        "type": "get-resource",
        "name": "get resources from DB -controller_id",
        "xml": "<get-resource plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource' resource='SQL'\nkey='SELECT controller_id\nfrom REQUEST_DETAILS\nWHERE request_id = $optical-service-delete-input.request-id'\npfx='controllerid'>",
        "comments": "",
        "outputs": 1,
        "x": 665,
        "y": 109,
        "z": "7b1b071a.92faa",
        "wires": [
            [
                "3249f019.f6152"
            ]
        ]
    },
    {
        "id": "eac944ef.f83328",
        "type": "execute",
        "name": "split node-id a-end retrieved from DB",
        "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='split' >\n<parameter name=\"original_string\" value='`$controller-id`'/>\n<parameter name=\"regex\" value=\"_\"/>\n<parameter name=\"ctx_memory_result_key\" value=\"param-prefix\"/>\n",
        "comments": "",
        "outputs": 1,
        "x": 646,
        "y": 168,
        "z": "7b1b071a.92faa",
        "wires": [
            []
        ]
    },
    {
        "id": "3249f019.f6152",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 892,
        "y": 104,
        "z": "7b1b071a.92faa",
        "wires": [
            [
                "cc783b3b.8e16b"
            ]
        ]
    },
    {
        "id": "cc783b3b.8e16b",
        "type": "set",
        "name": "set",
        "xml": "<set>\n<parameter name='controller-id' value='`$controllerid.controller-id`' />\n\n\n\n\n\n\n\n\n\n\n",
        "comments": "",
        "x": 1083,
        "y": 106,
        "z": "7b1b071a.92faa",
        "wires": []
    },
    {
        "id": "b567b7de.be2de8",
        "type": "set",
        "name": "set controller-ip",
        "xml": "<set>\n<parameter name='controller-ip' value='`$param-prefix[1]`' />\n<parameter name='domain-type' value='`$param-prefix[0]`' />\n<parameter name='notification-url' value=\"`$prop.controller.url + '/' + $prop.sdnc.async.url`\" />\n",
        "comments": "",
        "x": 593,
        "y": 223,
        "z": "7b1b071a.92faa",
        "wires": []
    },
    {
        "id": "c0977e42.e4156",
        "type": "switchNode",
        "name": "switch domain-type",
        "xml": "<switch test='`$domain-type`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 188,
        "y": 324,
        "z": "7b1b071a.92faa",
        "wires": [
            [
                "1f20cc0f.cf39ec",
                "fe8682d2.0d3618"
            ]
        ]
    },
    {
        "id": "1f20cc0f.cf39ec",
        "type": "outcome",
        "name": "MSA",
        "xml": "<outcome value='MSA'>\n",
        "comments": "",
        "outputs": 1,
        "x": 363,
        "y": 325,
        "z": "7b1b071a.92faa",
        "wires": [
            [
                "d9880526.733f4"
            ]
        ]
    },
    {
        "id": "fe8682d2.0d3618",
        "type": "outcome",
        "name": "TAPI",
        "xml": "<outcome value='TAPI'>\n",
        "comments": "",
        "outputs": 1,
        "x": 324,
        "y": 428,
        "z": "7b1b071a.92faa",
        "wires": [
            [
                "c4af063b.a8dc38"
            ]
        ]
    },
    {
        "id": "d9880526.733f4",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 507,
        "y": 326,
        "z": "7b1b071a.92faa",
        "wires": [
            [
                "bfd79d0e.9f7ee8"
            ]
        ]
    },
    {
        "id": "c4af063b.a8dc38",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 475,
        "y": 421,
        "z": "7b1b071a.92faa",
        "wires": [
            [
                "5c1ca252.745f4c"
            ]
        ]
    },
    {
        "id": "5c1ca252.745f4c",
        "type": "call",
        "name": "call TAPI DELETE DG",
        "xml": "<call module='optical-service' rpc='service-delete-tapi' mode='sync' >\n",
        "comments": "",
        "outputs": 1,
        "x": 643,
        "y": 524,
        "z": "7b1b071a.92faa",
        "wires": [
            []
        ]
    }
]