

[{"id":"fcf7e196.b57a18","type":"returnSuccess","name":"return success","xml":"<return status='success'>\n\t<parameter name=\"error-code\" value=\"200\" />","comments":"","x":407,"y":762.7500286102295,"z":"56a388d8.4ce54","wires":[]},{"id":"31ea957a.8db692","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":183.99996185302734,"y":123,"z":"56a388d8.4ce54","wires":[["9de92ad.50ab058","fcf7e196.b57a18","bb79241.52c52d8","32164f41.c7fe48","4983281c.426558","a52c709c.8702d","a6b4d2d7.948f98","1672533.d5ee9ad"]]},{"id":"9de92ad.50ab058","type":"set","name":"set: order-status = Deleted","xml":"<set>\n\t<parameter name=\"service-data.oper-status.order-status\" value=\"Deleted\"/>","comments":"","x":448,"y":589.7500286102295,"z":"56a388d8.4ce54","wires":[[]]},{"id":"1ccc10cf.aaa8b7","type":"method","name":"method vnf-topology-delete","xml":"<method rpc='vnf-topology-delete' mode='sync'>\n","comments":"","outputs":1,"x":215.6666488647461,"y":72.16666412353516,"z":"56a388d8.4ce54","wires":[["31ea957a.8db692"]]},{"id":"a68ff260.8bc4","type":"service-logic","name":"VNF-API 2.0.0","module":"VNF-API","version":"${project.version}","comments":"","xml":"<service-logic xmlns='http://www.att.com/sdnctl/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.att.com/sdnctl/svclogic ./svclogic.xsd' module='VNF-API' version='${project.version}'>","outputs":1,"x":285.66661834716797,"y":20.166671752929688,"z":"56a388d8.4ce54","wires":[["1ccc10cf.aaa8b7"]]},{"id":"f5fafe40.045238","type":"dgstart","name":"DGSTART","outputs":1,"x":122.49996185302734,"y":20,"z":"56a388d8.4ce54","wires":[["a68ff260.8bc4"]]},{"id":"3d3232c2.77f4ce","type":"other","name":"false","xml":"<outcome value='false'>","comments":"","outputs":1,"x":1110.9242897033691,"y":204.46213626861572,"z":"56a388d8.4ce54","wires":[["26bca269.f17f9e"]]},{"id":"26bca269.f17f9e","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='error-code' value='400'/>\n\t<parameter name='error-message' value='Invalid order-status'/>","comments":"","x":1263.2574195861816,"y":204.46219730377197,"z":"56a388d8.4ce54","wires":[]},{"id":"4983281c.426558","type":"set","name":"set: last-action ","xml":"<set>\n\t<parameter name=\"service-data.oper-status.last-action\" value=\"`$service-data.request-information.request-action`\"/>","comments":"","x":409.2575988769531,"y":633.2956218719482,"z":"56a388d8.4ce54","wires":[[]]},{"id":"bb79241.52c52d8","type":"switchNode","name":"switch:vnf-id   config == input","xml":"<switch test=\"`$vnf-topology-operation-input.vnf-request-information.vnf-id == $service-data.vnf-id`\">","comments":"","outputs":1,"x":453.14385986328125,"y":122.48754501342773,"z":"56a388d8.4ce54","wires":[["beb921bb.2c9b58"]]},{"id":"beb921bb.2c9b58","type":"outcomeFalse","name":"false","xml":"<outcome value='false'>\n","comments":"","outputs":1,"x":654.5984191894531,"y":122.66937255859375,"z":"56a388d8.4ce54","wires":[["127ae102.70f307"]]},{"id":"127ae102.70f307","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='error-code' value='400'/>\n\t<parameter name='error-message' value='vnf-id not found'/>","comments":"","x":818.189338684082,"y":122.82847309112549,"z":"56a388d8.4ce54","wires":[]},{"id":"32164f41.c7fe48","type":"set","name":"set: last-order-status = order-status","xml":"<set>\n\t<parameter name=\"service-data.oper-status.last-order-status\" value=\"`$service-data.oper-status.order-status`\"/>","comments":"","x":474.3939514160156,"y":548.4875774383545,"z":"56a388d8.4ce54","wires":[[]]},{"id":"a52c709c.8702d","type":"set","name":"Clear vnf topology","xml":"<set>\n\t<parameter name=\"service-data.vnf-topology-information.\" value=\"\" /> \n","comments":"","x":418.3939514160156,"y":673.4875774383545,"z":"56a388d8.4ce54","wires":[[]]},{"id":"1283dc8f.0dbbdb","type":"switchNode","name":"switch: order-status = Active","xml":"<switch test=\"`$service-data.oper-status.order-status == Active`\">","comments":"","outputs":1,"x":909.1071891784668,"y":204.76193714141846,"z":"56a388d8.4ce54","wires":[["3d3232c2.77f4ce"]]},{"id":"1672533.d5ee9ad","type":"set","name":"Set final indicator to Y","xml":"<set>\n<parameter name=\"ack-final\" value=\"Y\"/>","comments":"","x":429.71431732177734,"y":718.690502166748,"z":"56a388d8.4ce54","wires":[[]]},{"id":"a6b4d2d7.948f98","type":"switchNode","name":"switch: INPUT aic-cloud-region","xml":"<switch test=\"`$vnf-topology-operation-input.vnf-request-information.aic-cloud-region`\">","comments":"","outputs":1,"x":462.00001525878906,"y":205.0833387374878,"z":"56a388d8.4ce54","wires":[["3af03fc8.e707b","ddc78af.60992f8"]]},{"id":"3af03fc8.e707b","type":"outcome","name":"NULL","xml":"<outcome value=''>","outputs":1,"x":693.7500114440918,"y":252.72619247436523,"z":"56a388d8.4ce54","wires":[["afd57709.8addb"]]},{"id":"afd57709.8addb","type":"switchNode","name":"switch: INPUT aic-clli","xml":"<switch test=\"`$vnf-topology-operation-input.vnf-request-information.aic-clli`\">","comments":"","outputs":1,"x":890.7500534057617,"y":252.83336067199707,"z":"56a388d8.4ce54","wires":[["dadea9f1.52f198","ac9e3f4c.36446"]]},{"id":"ddc78af.60992f8","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":693.250072479248,"y":204.83335304260254,"z":"56a388d8.4ce54","wires":[["1283dc8f.0dbbdb"]]},{"id":"dadea9f1.52f198","type":"outcome","name":"NULL","xml":"<outcome value=''>","outputs":1,"x":1085.75,"y":253.5833339691162,"z":"56a388d8.4ce54","wires":[["81095c78.688578"]]},{"id":"81095c78.688578","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='error-code' value='400'/>\n\t<parameter name='error-message' value='Either aic-cloud-region or aic-clli must be present'/>","comments":"","x":1258.25,"y":254.0833339691162,"z":"56a388d8.4ce54","wires":[]},{"id":"ac9e3f4c.36446","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":1087,"y":296.0833339691162,"z":"56a388d8.4ce54","wires":[["7a2e8e8a.7bba7"]]},{"id":"680cdb38.59b984","type":"save","name":"delete generic-vnf-l3-network","xml":"<delete plugin=\"org.openecomp.sdnc.sli.resource.sql.SqlResource\" \n\tresource=\"generic-vnf-l3-network\" \n\tkey=\"DELETE FROM GENERIC_VNF_L3_NETWORK WHERE vnf_id = $service-data.vnf-id\" \n\tforce=\"true\" >\n\n","comments":"","outputs":1,"x":1209.5000305175781,"y":418.5833568572998,"z":"56a388d8.4ce54","wires":[["bb5026cb.49ad98"]]},{"id":"e95a580b.ce45f8","type":"save","name":"delete GammaResource: generic-vnf","xml":"<delete plugin=\"org.openecomp.sdnc.sli.resource.sql.SqlResource\" \n\tresource=\"generic-vnf\" \n\tkey=\"DELETE FROM GENERIC_VNF where vnf_id = $service-data.vnf-id\" \n\tlocal-only=\"true\" \n\tforce=\"true\" >\n\n","comments":"","outputs":1,"x":1233.159194946289,"y":504.9546184539795,"z":"56a388d8.4ce54","wires":[["bb5026cb.49ad98"]]},{"id":"e46b8405.65dc18","type":"save","name":"delete generic-vnf-vserver","xml":"<delete plugin=\"org.openecomp.sdnc.sli.resource.sql.SqlResource\" \n\tresource=\"generic-vnf-vserver\" \n\tkey=\"DELETE FROM GENERIC_VNF_VSERVER where vnf_id = $service-data.vnf-id\" \n\tforce=\"true\" >\n\n","comments":"","outputs":1,"x":1200.909194946289,"y":460.0379009246826,"z":"56a388d8.4ce54","wires":[["bb5026cb.49ad98"]]},{"id":"f2b7f8ab.79b31","type":"switchNode","name":"switch: order-status = PendingDelete","xml":"<switch test=\"'$service-data.oper-status.order-status == PendingDelete'\">\n\n<!--\nleaf order-status {\n\ttype enumeration {\n\t\tenum \"Active\";\n\t\tenum \"PendingAssignment\";\n\t\tenum \"PendingCreate\";\n\t\tenum \"PendingUpdate\";\n\t\tenum \"Deleted\";\n\t}\n}\n-->","comments":"","outputs":1,"x":1232.750015258789,"y":376.83334159851074,"z":"56a388d8.4ce54","wires":[["142b3d5d.ab57d3"]]},{"id":"142b3d5d.ab57d3","type":"other","name":"false","xml":"<outcome value='false'>","comments":"","outputs":1,"x":1462.0833892822266,"y":377.166654586792,"z":"56a388d8.4ce54","wires":[["f3ef39a7.92022"]]},{"id":"f3ef39a7.92022","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='error-code' value='400'/>\n\t<parameter name='error-message' value='Invalid order-status'/>","comments":"","x":1614.416519165039,"y":377.16671562194824,"z":"56a388d8.4ce54","wires":[]},{"id":"7a2e8e8a.7bba7","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":979.5,"y":377.0833339691162,"z":"56a388d8.4ce54","wires":[["680cdb38.59b984","e95a580b.ce45f8","e46b8405.65dc18","6a59db9b.2f1714"]]},{"id":"bb5026cb.49ad98","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1495.75,"y":459.5833339691162,"z":"56a388d8.4ce54","wires":[["8239c2d0.1bd9c"]]},{"id":"8239c2d0.1bd9c","type":"set","name":"set: error-message","xml":"<set>\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"error-message\" value=\"An error occurred while deleting generic-vnf, generic-vnf-l3-netweork or generic-vnf-vserver from GammaResource\"/>","comments":"","x":1678.2500228881836,"y":459.58334255218506,"z":"56a388d8.4ce54","wires":[[]]},{"id":"6a59db9b.2f1714","type":"save","name":"delete AnAI: generic-vnf","xml":"<delete plugin=\"com.att.sdnctl.sli.aai.AAIService\" \n\tresource=\"generic-vnf\" \n\tkey=\"generic-vnf.vnf-id = $service-data.vnf-id\" \n\tlocal-only=\"false\" \n\tforce=\"true\" >\n\n","comments":"","outputs":1,"x":1191.5,"y":549.3333339691162,"z":"56a388d8.4ce54","wires":[["6f19a831.9a037"]]},{"id":"6f19a831.9a037","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1384.590805053711,"y":549.4620494842529,"z":"56a388d8.4ce54","wires":[["d613b798.91976"]]},{"id":"d613b798.91976","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='error-code' value='500'/>\n\t<parameter name='error-message' value=\"`'Failed to delete generic-vnf from AnAI with vnf-id = '+ $service-data.vnf-id`\"/>","comments":"","x":1542.7573318481445,"y":549.5454301834106,"z":"56a388d8.4ce54","wires":[]},{"id":"1e6708d8.18e507","type":"comment","name":"NOT checking order-status intentionally","info":"","comments":"","x":1337.000015258789,"y":341.0833396911621,"z":"56a388d8.4ce54","wires":[]}]
