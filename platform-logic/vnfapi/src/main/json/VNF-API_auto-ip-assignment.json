[{"id":"c4c849.47c9e7b8","type":"method","name":"method auto-ip-assignment","xml":"<method rpc='auto-ip-assignment' mode='sync'>\n","comments":"","outputs":1,"x":195.71429443359375,"y":111.42857360839844,"z":"906643da.8385b","wires":[["a51c9819.a60bf8"]]},{"id":"9a9f9db3.5779a","type":"service-logic","name":"VNF-API ${project.version}","module":"VNF-API","version":"${project.version}","comments":"","xml":"<service-logic xmlns='http://www.openecomp.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.openecomp.org/sdnc/svclogic ./svclogic.xsd' module='VNF-API' version='${project.version}'>","outputs":1,"x":314.3928451538086,"y":44.55954360961914,"z":"906643da.8385b","wires":[["c4c849.47c9e7b8"]]},{"id":"a51c9819.a60bf8","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":188.60711669921875,"y":170.10697650909424,"z":"906643da.8385b","wires":[["fc4a44c6.781068","971f54b9.fb4d38","f069bcd9.4f013","79a3b000.6e8ca","d342a830.37aca8","a958a911.a799d8","59e398fa.e1d7a8","34c196c.8967b6a","3082e693.7137ea"]]},{"id":"5620e12.8c8892","type":"dgstart","name":"DGSTART","outputs":1,"x":108.60713195800781,"y":44.821431159973145,"z":"906643da.8385b","wires":[["9a9f9db3.5779a"]]},{"id":"fc4a44c6.781068","type":"get-resource","name":"get-resource VF_MODULE_MODEL","xml":"<get-resource plugin='org.openecomp.sdnc.sli.resource.sql.SqlResource' resource='SQL'\n  key='SELECT * from VF_MODULE_MODEL WHERE customization_uuid = $auto-ip-assignment-input.vf-module.model-customization-uuid'\n  pfx='db.vf-module-model'>\n\n","comments":"","outputs":1,"x":458.6308364868164,"y":385.1310214996338,"z":"906643da.8385b","wires":[["f20f14d0.2760b8","c6ad1e37.8facd"]]},{"id":"971f54b9.fb4d38","type":"get-resource","name":"get-resource VF_MODULE_TO_VFC_MAPPING","xml":"<get-resource plugin='org.openecomp.sdnc.sli.resource.sql.SqlResource' resource='SQL'\n  key='SELECT * from VF_MODULE_TO_VFC_MAPPING WHERE vf_module_customization_uuid = $auto-ip-assignment-input.vf-module.model-customization-uuid'\n  pfx='db.vf-module-to-vfc-mapping[]'>\n\n","comments":"","outputs":1,"x":500.1666488647461,"y":474.7142448425293,"z":"906643da.8385b","wires":[["4adba2e3.55275c","1eeb70cf.99b3df"]]},{"id":"f069bcd9.4f013","type":"for","name":"for each vm-type","xml":"<for index='vm-type-index' start='0' end='`$db.vf-module-to-vfc-mapping_length`' >\n","comments":"","outputs":1,"x":398.13096618652344,"y":605.8455018997192,"z":"906643da.8385b","wires":[["aa296b24.482418"]]},{"id":"f20f14d0.2760b8","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":731.5594100952148,"y":365.5118570327759,"z":"906643da.8385b","wires":[["a1165c5b.d0a2e"]]},{"id":"c6ad1e37.8facd","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":740.1308403015137,"y":409.79757022857666,"z":"906643da.8385b","wires":[["941bd3ff.af5f9"]]},{"id":"4adba2e3.55275c","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":785.5237808227539,"y":456.8093433380127,"z":"906643da.8385b","wires":[["c52748a1.4221d8"]]},{"id":"1eeb70cf.99b3df","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":794.0952110290527,"y":501.0950565338135,"z":"906643da.8385b","wires":[["cbe962d3.6db92"]]},{"id":"fd7d4d0.78ed8b","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":798.0476303100586,"y":795.1906604766846,"z":"906643da.8385b","wires":[["f7d673dc.d1937","cf17705c.4431a","5b25a27f.a329cc","cce22270.1f17c"]]},{"id":"a1165c5b.d0a2e","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error reading VF_MODULE_MODEL table\" />\n","comments":"","x":906.5593414306641,"y":364.6547574996948,"z":"906643da.8385b","wires":[]},{"id":"941bd3ff.af5f9","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"404\" />\n    <parameter name=\"error-message\" value=\"`'No model found for VF module customization UUID ' + $vnf-topology-operation-input.vnf-request-information.model-customization-uuid`\" />\n","comments":"","x":907.2021408081055,"y":409.55949878692627,"z":"906643da.8385b","wires":[]},{"id":"c52748a1.4221d8","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error reading VF_MODULE_TO_VFC_MAPPING table\" />\n","comments":"","x":960.5237121582031,"y":455.95224380493164,"z":"906643da.8385b","wires":[]},{"id":"cbe962d3.6db92","type":"set","name":"set vf-module-to-vfc-mapping length to 0","xml":"<set>\n<parameter name='db.vf-module-to-vfc-mapping_length' value='0' />\n","comments":"","x":1047.3095016479492,"y":500.71371936798096,"z":"906643da.8385b","wires":[]},{"id":"f7d673dc.d1937","type":"for","name":"for each network-role","xml":"<for index='network-role-index' start='0' end='`$db.vfc-to-network-role-mapping_length`' >\n","comments":"","outputs":1,"x":1026.9406509399414,"y":997.4323511123657,"z":"906643da.8385b","wires":[["af64e927.aa86b8"]]},{"id":"af64e927.aa86b8","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":861.4046478271484,"y":1121.4364976882935,"z":"906643da.8385b","wires":[["8ec01dc9.9f782","4614fec1.54cbf","caf2b1e8.8454e"]]},{"id":"8ec01dc9.9f782","type":"switchNode","name":"switch ipv4-ip-version","xml":"<switch test='`$db.vfc-to-network-role-mapping[$network-role-index].ipv4-ip-version`'>\n","comments":"","outputs":1,"x":1106.670539855957,"y":1121.6078214645386,"z":"906643da.8385b","wires":[["671f671.bbe6d98"]]},{"id":"4614fec1.54cbf","type":"switchNode","name":"switch ipv6-ip-version","xml":"<switch test='`$db.vfc-to-network-role-mapping[$network-role-index].ipv6-ip-version`'>\n","comments":"","outputs":1,"x":1099.3372802734375,"y":1629.036325454712,"z":"906643da.8385b","wires":[["8a2b746f.9b3f78"]]},{"id":"671f671.bbe6d98","type":"other","name":"4","xml":"<outcome value='4'>\n","comments":"","outputs":1,"x":1297.6703338623047,"y":1121.7029943466187,"z":"906643da.8385b","wires":[["c67983bc.53cdd"]]},{"id":"8a2b746f.9b3f78","type":"other","name":"6","xml":"<outcome value='6'>\n","comments":"","outputs":1,"x":1286.4325256347656,"y":1629.7024822235107,"z":"906643da.8385b","wires":[["23019c05.931094"]]},{"id":"9b49ea37.aac178","type":"switchNode","name":"switch ipv4-use-dhcp","xml":"<switch test='`$db.vfc-to-network-role-mapping[$network-role-index].ipv4-use-dhcp`'>\n","comments":"","outputs":1,"x":1640.356834411621,"y":1122.2620067596436,"z":"906643da.8385b","wires":[["7c3da937.8a5e38"]]},{"id":"7c3da937.8a5e38","type":"outcome","name":"N","xml":"<outcome value='N'>\n","comments":"","outputs":1,"x":1836.6067161560059,"y":1122.5836000442505,"z":"906643da.8385b","wires":[["b4dffa4e.16be18"]]},{"id":"b4dffa4e.16be18","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1979.1424369812012,"y":1122.6549167633057,"z":"906643da.8385b","wires":[["c1270dd.4ad56f","3a3409df.a8cc66","de34a120.03e1f","17a99401.1f5aec"]]},{"id":"ec1e2ea5.ced2d","type":"set","name":"set tmp.floating-ipv4-count","xml":"<set>\n\t<parameter name='tmp.floating-ipv4-count' value = '1' />\n\n<!--\n   value='`$db.vfc-to-network-role-mapping[$network-role-index].floating-ipv4-count`' />\n-->","comments":"","x":2624.523765563965,"y":1271.5120515823364,"z":"906643da.8385b","wires":[]},{"id":"cb38df4f.51afb","type":"comment","name":"harcode floating ipv4 to 1","info":"","comments":"","x":2758.9757385253906,"y":1218.2501316070557,"z":"906643da.8385b","wires":[]},{"id":"f55e87db.f559f8","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1988.6545600891113,"y":1629.190447807312,"z":"906643da.8385b","wires":[["b51ff026.f26a8","f290f8e3.24e9b8","d7c93974.cc0628","3ec32dc.84e99d2"]]},{"id":"ca3762c4.467bb","type":"set","name":"set tmp.floating-ipv6-count","xml":"<set>\n\t<parameter name='tmp.floating-ipv6-count' value = '1' />\n\n<!--\n   value='`$db.vfc-to-network-role-mapping[$network-role-index].floating-ipv6-count`'\n-->","comments":"","x":2616.1189613342285,"y":1722.3094491958618,"z":"906643da.8385b","wires":[]},{"id":"9bc80f8f.af127","type":"switchNode","name":"switch ipv6-use-dhcp","xml":"<switch test='`$db.vfc-to-network-role-mapping[$network-role-index].ipv6-use-dhcp`'>\n","comments":"","outputs":1,"x":1631.833251953125,"y":1630.1190376281738,"z":"906643da.8385b","wires":[["5a5b2557.20289c"]]},{"id":"5a5b2557.20289c","type":"outcome","name":"N","xml":"<outcome value='N'>\n","comments":"","outputs":1,"x":1833.368724822998,"y":1630.0118246078491,"z":"906643da.8385b","wires":[["f55e87db.f559f8"]]},{"id":"cf17705c.4431a","type":"set","name":"initialize ipv4 ipv6 fixed and floating ip-count","xml":"<set>\n\t<parameter name='tmp.fixed-ipv4-count' value = '0' />\n\t<parameter name='tmp.fixed-ipv6count' value = '0' />\n\t<parameter name='tmp.floating-ipv4-count' value = '0' />\n\t<parameter name='tmp.floating-ipv6count' value = '0' />\n\t<parameter name='total.fixed-ipv4-count' value = '0' />\n\t<parameter name='total.fixed-ipv6-count' value = '0' />\n\t<parameter name='total.floating-ipv4-count' value = '0' />\n\t<parameter name='total.floating-ipv6-count' value = '0' />","comments":"","x":1104.1071090698242,"y":796.3334102630615,"z":"906643da.8385b","wires":[]},{"id":"4ac27b99.4072a4","type":"comment","name":"harcode floating ipv6 to 1","info":"","comments":"","x":2740.405002593994,"y":1671.3335399627686,"z":"906643da.8385b","wires":[]},{"id":"c1270dd.4ad56f","type":"switchNode","name":"switch floating_ipv4_count","xml":"<switch test='`$db.vfc-to-network-role-mapping[$network-role-index].floating_ipv4_count`'>\n","comments":"","outputs":1,"x":2208.9758529663086,"y":1223.9763660430908,"z":"906643da.8385b","wires":[["abd61bfa.882738","64c865d9.e5ec4c","c9897e7f.7f23c"]]},{"id":"b51ff026.f26a8","type":"switchNode","name":"switch floating_ipv6_count","xml":"<switch test='`$db.vfc-to-network-role-mapping[$network-role-index].floating_ipv6_count`'>\n","comments":"","outputs":1,"x":2205.8809089660645,"y":1675.0235958099365,"z":"906643da.8385b","wires":[["67b1ae02.72971","9882c625.d2aa38","fceb6d3c.47adf"]]},{"id":"abd61bfa.882738","type":"outcome","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":2417.5471801757812,"y":1223.5477962493896,"z":"906643da.8385b","wires":[["fe0853f2.d9518"]]},{"id":"fe0853f2.d9518","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":2563.213809967041,"y":1222.8814144134521,"z":"906643da.8385b","wires":[[]]},{"id":"64c865d9.e5ec4c","type":"other","name":"Other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":2417.8330688476562,"y":1272.5477962493896,"z":"906643da.8385b","wires":[["ec1e2ea5.ced2d"]]},{"id":"67b1ae02.72971","type":"outcome","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":2405.8809394836426,"y":1674.1665134429932,"z":"906643da.8385b","wires":[["6e48a49e.d3978c"]]},{"id":"6e48a49e.d3978c","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":2555.5475692749023,"y":1673.5001316070557,"z":"906643da.8385b","wires":[[]]},{"id":"9882c625.d2aa38","type":"other","name":"Other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":2406.1668281555176,"y":1723.1665134429932,"z":"906643da.8385b","wires":[["ca3762c4.467bb"]]},{"id":"825cc879.6becb8","type":"comment","name":"REQUIRED INPUTS","info":"auto-ip-assignment-input.vf-module.model-customization-uuid\n - used to get VF_MODULE_MODEL and related vfc-customization-uuids\nauto-ip-assignment-input.vf-module-id\n - pass to include in eipam-ip-block.plans.[].info\nauto-ip-assignment-input.aic-cloud-region\n - pass to generate FQPN to get clli and complex.region\n - pass to query-aai-l3-network-by network-role as 1st filter\nauto-ip-assignment-input.service-instance-id\n - pass to query-aai-l3-network-by network-role as 2nd filter\n\t","comments":"","x":597.7381439208984,"y":87.26190757751465,"z":"906643da.8385b","wires":[]},{"id":"7a1e44ea.7de3dc","type":"set","name":" set eipam-ip-block","xml":"<set>\n<parameter name='eipam-ip-block.plans[$pidx].plan-name' \n\tvalue='`$db.vfc-to-network-role-mapping[$network-role-index].ipv4-address-plan-name`' />\n<parameter name='eipam-ip-block.plans[$pidx].address-family' \n\tvalue='ipv4' />\n<parameter name='eipam-ip-block.plans[$pidx].requests_length' \n\tvalue='`$total.fixed-ipv4-count`' />\n<parameter name=\"eipam-ip-block.plans_length\" \n\tvalue=\"`$pidx + 1`\"/>\n<parameter name='eipam-ip-block.plans[$pidx].vm-type' \n\tvalue='`$db.vf-module-to-vfc-mapping[$vm-type-index].vm-type`' />\n<parameter name='eipam-ip-block.plans[$pidx].network-role' \n\tvalue='`$db.vfc-to-network-role-mapping[$network-role-index].network-role`' />\n<parameter name='eipam-ip-block.plans[$pidx].vrf-name' \n\tvalue='`$db.vfc-to-network-role-mapping[$network-role-index].ipv4-vrf-name`' />\n","comments":"","x":2753.428382873535,"y":1433.69069480896,"z":"906643da.8385b","wires":[]},{"id":"d05bf1b0.cee3c","type":"set","name":"set eipam-ip-block","xml":"<set>\n<parameter name='eipam-ip-block.plans[$pidx].plan-name' \n\tvalue='`$db.vfc-to-network-role-mapping[$network-role-index].ipv6-address-plan-name`' />\n<parameter name='eipam-ip-block.plans[$pidx].address-family' \n\tvalue='ipv6' />\n<parameter name='eipam-ip-block.plans[$pidx].requests_length' \n\tvalue='`$total.fixed-ipv6-count`' />\n<parameter name=\"eipam-ip-block.plans_length\" \n\tvalue=\"`$pidx + 1`\"/>\n<parameter name='eipam-ip-block.plans[$pidx].vm-type' \n\tvalue='`$db.vf-module-to-vfc-mapping[$vm-type-index].vm-type`' />\n<parameter name='eipam-ip-block.plans[$pidx].network-role' \n\tvalue='`$db.vfc-to-network-role-mapping[$network-role-index].network-role`' />\n<parameter name='eipam-ip-block.plans[$pidx].vrf-name' \n\tvalue='`$db.vfc-to-network-role-mapping[$network-role-index].ipv6-vrf-name`' />\n","comments":"","x":2756.928871154785,"y":1879.6902599334717,"z":"906643da.8385b","wires":[]},{"id":"2250c59f.ed6e5a","type":"comment","name":"Change History","info":"1.2.4.1.test - fix node 28, apppened 'db.' in db.vf-module-to-vfc-mapping\ne2e 1.1.21.test - add chk for vm-module-to-vfc-mapping[].vm-type not null","comments":"","x":814.4642944335938,"y":89.64285278320312,"z":"906643da.8385b","wires":[]},{"id":"d1882508.225b38","type":"call","name":"call: generate-FQPN","xml":"<call module='VNF-API' rpc='generate-FQPN' mode='sync' >","comments":"","outputs":1,"x":624.8452339172363,"y":2251.9167985916138,"z":"906643da.8385b","wires":[["5ba4373b.4676f8"]]},{"id":"51a71618.d4bd18","type":"set","name":"set generate-FQPN inputs","xml":"<set>\n<parameter name='generate-FQPN-input.aic-cloud-region' \n\tvalue='`$auto-ip-assignment-input.aic-cloud-region`' />\n<parameter name='generate-FQPN-input.vf-module-id' \n\tvalue='`$auto-ip-assignment-input.vf-module-id`' />\n<parameter name='generate-FQPN-input.vf-module-name' \n\tvalue='`$auto-ip-assignment-input.vf-module-name`' />\n\n<!--\n<parameter name='generate-FQPN-input.service-instance-id' \n\tvalue='`$auto-ip-assignment-input.service-instance-id`' />\n-->","comments":"","x":643.2619552612305,"y":2203.416919708252,"z":"906643da.8385b","wires":[]},{"id":"79a3b000.6e8ca","type":"switchNode","name":"switch: auto-ip-assignment-input.vf-module.model-customization-uuid","xml":"<switch test='`$auto-ip-assignment-input.vf-module.model-customization-uuid`'>\n","comments":"","outputs":1,"x":565.3929061889648,"y":224.3214282989502,"z":"906643da.8385b","wires":[["bb2b66d1.06fd78"]]},{"id":"bb2b66d1.06fd78","type":"outcome","name":"NULL","xml":"<outcome value=''>","outputs":1,"x":913.3929061889648,"y":224.32142734527588,"z":"906643da.8385b","wires":[["99876d53.9da6b"]]},{"id":"99876d53.9da6b","type":"returnFailure","name":"return failure","xml":"<return status=\"failure\">\n\t<parameter name=\"ack-final\" value=\"Y\" />\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"error-message\" value=\"auto-ip-assignment-input.vf-module.model-customization-uuid is null\" />\n","comments":"","x":1075.3095779418945,"y":224.43252611160278,"z":"906643da.8385b","wires":[]},{"id":"d342a830.37aca8","type":"switchNode","name":"switch: auto-ip-assignment-input.aic-cloud-region","xml":"<switch test='`$auto-ip-assignment-input.aic-cloud-region`'>\n","comments":"","outputs":1,"x":503.39288330078125,"y":170.32142734527588,"z":"906643da.8385b","wires":[["997bf8c0.280fb8"]]},{"id":"997bf8c0.280fb8","type":"outcome","name":"NULL","xml":"<outcome value=''>","outputs":1,"x":766.8928909301758,"y":169.82142734527588,"z":"906643da.8385b","wires":[["b94f7fda.d6a52"]]},{"id":"b94f7fda.d6a52","type":"returnFailure","name":"return failure","xml":"<return status=\"failure\">\n\t<parameter name=\"ack-final\" value=\"Y\" />\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"error-message\" value=\"auto-ip-assignment-input.aic-cloud-region is null\" />\n","comments":"","x":921.3095588684082,"y":169.93252420425415,"z":"906643da.8385b","wires":[]},{"id":"a958a911.a799d8","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":378.51190185546875,"y":2203.0001678466797,"z":"906643da.8385b","wires":[["51a71618.d4bd18","d1882508.225b38"]]},{"id":"34c196c.8967b6a","type":"switchNode","name":"switch: auto-ip-assignment-input.vf-module-id","xml":"<switch test='`$auto-ip-assignment-input.vf-module-id`'>\n","comments":"","outputs":1,"x":491.0714569091797,"y":278.9285726547241,"z":"906643da.8385b","wires":[["c975571e.1a0f38"]]},{"id":"c975571e.1a0f38","type":"outcome","name":"NULL","xml":"<outcome value=''>","outputs":1,"x":785.5714645385742,"y":278.4285726547241,"z":"906643da.8385b","wires":[["d8ce6211.be144"]]},{"id":"d8ce6211.be144","type":"returnFailure","name":"return failure","xml":"<return status=\"failure\">\n\t<parameter name=\"ack-final\" value=\"Y\" />\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"error-message\" value=\"auto-ip-assignment-input.vf-module-id is null\" />\n","comments":"","x":939.9881324768066,"y":278.5396695137024,"z":"906643da.8385b","wires":[]},{"id":"9e50005d.87346","type":"set","name":"set query-aai-l3-network-by-network-role-input","xml":"<set>\n<parameter name='query-aai-l3-network-by-network-role-input.aic-cloud-region' \n\tvalue='`$auto-ip-assignment-input.aic-cloud-region`' />\n<parameter name='query-aai-l3-network-by-network-role-input.service-instance-id' \n\tvalue='`$auto-ip-assignment-input.service-instance-id`' />\n<parameter name='query-aai-l3-network-by-network-role-input.network-role' \n\tvalue='`$db.vfc-to-network-role-mapping[$network-role-index].network-role`' />\n\t\n<!--\nfilter options: service-instance-id, aic-cloud-region\n    - null or Other will filter by aic-cloud-region first, then service-instance-id\n<parameter name='query-aai-l3-network-by-network-role-input.filter' \n\tvalue='service-instance-id' />\n-->","comments":"","x":1951.9998779296875,"y":2007.9404125213623,"z":"906643da.8385b","wires":[]},{"id":"db60b65b.c548c8","type":"call","name":"call: query-aai-l3-network-by-network-role","xml":"<call module='VNF-API' rpc='query-aai-l3-network-by-network-role' mode='sync' >","comments":"","outputs":1,"x":1939.2857513427734,"y":2056.5118713378906,"z":"906643da.8385b","wires":[["418d7218.9d403c"]]},{"id":"ad1e2caa.c32b5","type":"set","name":"set eipam-ip-block.plans[].l3-network","xml":"<set>\n<parameter name='eipam-ip-block.plans[$pidx].l3-network.' \n\tvalue='`$query-aai-l3-network-by-network-role-output.l3-network.`' />","comments":"","x":1924.4998779296875,"y":2105.1904125213623,"z":"906643da.8385b","wires":[]},{"id":"61507326.e8ec3c","type":"execute","name":"call EIPAM assignIPAddress","xml":"<execute plugin=\"com.att.sdnctl.sli.plugin.eipam.EIPAMPlugin\" method=\"assignIPAddress\">","comments":"","outputs":1,"x":1138.7976837158203,"y":2554.2146644592285,"z":"906643da.8385b","wires":[["8660d667.285138"]]},{"id":"8660d667.285138","type":"failure","name":"failure","xml":"<outcome value='failure'>","outputs":1,"x":1352.7976837158203,"y":2554.2146644592285,"z":"906643da.8385b","wires":[["1cc91214.1f215e"]]},{"id":"1cc91214.1f215e","type":"returnFailure","name":"return failure","xml":"<return status=\"failure\">\n\t<parameter name=\"ack-final\" value=\"Y\" />\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"error-message\" value=\"`'An error occured while obtaining ip addresses from EIPAM: ' + $error-message`\" />\n","comments":"","x":1513.7976837158203,"y":2554.2146644592285,"z":"906643da.8385b","wires":[]},{"id":"5b25a27f.a329cc","type":"get-resource","name":"get-resource VFC_TO_NETWORK_ROLE_MAPPING","xml":"<get-resource plugin='org.openecomp.sdnc.sli.resource.sql.SqlResource' resource='SQL'\n  key='SELECT * from VFC_TO_NETWORK_ROLE_MAPPING WHERE vfc_customization_uuid = $db.vf-module-to-vfc-mapping[$vm-type-index].vfc-customization-uuid'\n  pfx='db.vfc-to-network-role-mapping[]'>\n\n","comments":"","outputs":1,"x":1136.1665496826172,"y":854.6905269622803,"z":"906643da.8385b","wires":[["6b773fca.63645","539689a3.742518"]]},{"id":"6b773fca.63645","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":1430.2379455566406,"y":854.6428546905518,"z":"906643da.8385b","wires":[["898a5cb0.6376a"]]},{"id":"898a5cb0.6376a","type":"set","name":"set vfc-to-network-role-mapping length to 0","xml":"<set>\n<parameter name='db.vfc-to-network-role-mapping_length' value='0' />\n","comments":"","x":1693.642765045166,"y":854.6512451171875,"z":"906643da.8385b","wires":[]},{"id":"539689a3.742518","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1423.3570709228516,"y":899.4048080444336,"z":"906643da.8385b","wires":[["8f38e97e.be3d78"]]},{"id":"8f38e97e.be3d78","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error reading VFC_TO_NETWORK_ROLE_MAPPING table\" />\n","comments":"","x":1598.3570022583008,"y":898.5477085113525,"z":"906643da.8385b","wires":[]},{"id":"418d7218.9d403c","type":"failure","name":"failure","xml":"<outcome value='failure'>","outputs":1,"x":2198.4999237060547,"y":2055.976203918457,"z":"906643da.8385b","wires":[["38ba1107.4898be"]]},{"id":"38ba1107.4898be","type":"returnFailure","name":"return failure","xml":"<return status=\"failure\">\n\t<parameter name=\"ack-final\" value=\"Y\" />\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"error-message\" value=\"`'An error occured while querying AAI to retrieve l3-network by network-role: ' + $error-message`\" />\n","comments":"","x":2359.4999237060547,"y":2055.976203918457,"z":"906643da.8385b","wires":[]},{"id":"5ba4373b.4676f8","type":"failure","name":"failure","xml":"<outcome value='failure'>","outputs":1,"x":821.6904754638672,"y":2252.3573246002197,"z":"906643da.8385b","wires":[["7eb92222.b64bfc"]]},{"id":"7eb92222.b64bfc","type":"returnFailure","name":"return failure","xml":"<return status=\"failure\">\n\t<parameter name=\"ack-final\" value=\"Y\" />\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"error-message\" value=\"`'An error occured while generating FQPN: '+ $error-message`\" />\n","comments":"","x":982.6904754638672,"y":2252.3573246002197,"z":"906643da.8385b","wires":[]},{"id":"c0df81c0.646e2","type":"set","name":"set vnf-vms_length","xml":"<set>\n<parameter name='tmp.vnf-topology.vnf-assignments.vnf-vms_length' value='`$db.vf-module-to-vfc-mapping_length`' />","comments":"","x":406.59522247314453,"y":529.8809509277344,"z":"906643da.8385b","wires":[]},{"id":"c67983bc.53cdd","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1431.547592163086,"y":1122.357138633728,"z":"906643da.8385b","wires":[["9b49ea37.aac178"]]},{"id":"23019c05.931094","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1420.9761428833008,"y":1630.737928390503,"z":"906643da.8385b","wires":[["9bc80f8f.af127"]]},{"id":"17a99401.1f5aec","type":"set","name":"set tmp.fixed-ipv4-count","xml":"<set>\n<parameter name='tmp.fixed-ipv4-count'\n\tvalue='`$db.vfc-to-network-role-mapping[$network-role-index].ipv4-count * $db.vf-module-to-vfc-mapping[$vm-type-index].vm-count`' />","comments":"","x":2210.3214797973633,"y":1122.4286575317383,"z":"906643da.8385b","wires":[]},{"id":"3ec32dc.84e99d2","type":"set","name":"set tmp.fixed-ipv6-count","xml":"<set>\n<parameter name='tmp.fixed-ipv6-count'\n\tvalue='`$db.vfc-to-network-role-mapping[$network-role-index].ipv6-count * $db.vf-module-to-vfc-mapping[$vm-type-index].vm-count`' />\n","comments":"","x":2202.7103576660156,"y":1595.5636768341064,"z":"906643da.8385b","wires":[]},{"id":"aa296b24.482418","type":"switchNode","name":"switch: vf-module-to-vfc-mapping[].vm-count","xml":"<switch test='`$db.vf-module-to-vfc-mapping[$vm-type-index].vm-count`'>\n","comments":"","outputs":1,"x":702.8571701049805,"y":606.428632736206,"z":"906643da.8385b","wires":[["4df2f93e.4813c8","ed46ec8a.638d7","6c3747a0.7f66a8"]]},{"id":"4df2f93e.4813c8","type":"outcome","name":"NULL","xml":"<outcome value=''>","outputs":1,"x":971.285758972168,"y":606.0000438690186,"z":"906643da.8385b","wires":[["e4d67d86.40251"]]},{"id":"ed46ec8a.638d7","type":"other","name":"Other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":974.1428146362305,"y":657.428632736206,"z":"906643da.8385b","wires":[["fd7d4d0.78ed8b"]]},{"id":"e4d67d86.40251","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1116.9999923706055,"y":606.0000438690186,"z":"906643da.8385b","wires":[[]]},{"id":"fe1b6ea4.9326a","type":"switchNode","name":"switch: eipam-ip-block.plans_length ","xml":"<switch test='`$eipam-ip-block.plans_length`'>\n","comments":"","outputs":1,"x":628.5714569091797,"y":2452.85724067688,"z":"906643da.8385b","wires":[["d771485d.076148","172f2db5.4703f2","a664e622.12b848"]]},{"id":"d771485d.076148","type":"outcome","name":"NULL","xml":"<outcome value=''>","outputs":1,"x":904.0714874267578,"y":2452.5000953674316,"z":"906643da.8385b","wires":[["443be3d4.2812ec"]]},{"id":"443be3d4.2812ec","type":"set","name":"set eipam-ip-block.plans_length=0","xml":"<set>\n<parameter name='eipam-ip-block.plans_length' value='0' />","comments":"","x":1144.1668014526367,"y":2452.349937438965,"z":"906643da.8385b","wires":[]},{"id":"172f2db5.4703f2","type":"other","name":"Other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":902.6547241210938,"y":2554.0239086151123,"z":"906643da.8385b","wires":[["61507326.e8ec3c"]]},{"id":"a664e622.12b848","type":"other","name":"0","xml":"<outcome value='0'>\n","comments":"","outputs":1,"x":903.3213195800781,"y":2501.3572578430176,"z":"906643da.8385b","wires":[["7f340d9e.02bed4"]]},{"id":"7f340d9e.02bed4","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1056.6547546386719,"y":2501.0239400863647,"z":"906643da.8385b","wires":[[]]},{"id":"59e398fa.e1d7a8","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":371.42859649658203,"y":2453.7146377563477,"z":"906643da.8385b","wires":[["fe1b6ea4.9326a"]]},{"id":"fceb6d3c.47adf","type":"other","name":"0","xml":"<outcome value='0'>\n","comments":"","outputs":1,"x":2405.71435546875,"y":1625.4285888671875,"z":"906643da.8385b","wires":[["6e48a49e.d3978c"]]},{"id":"c9897e7f.7f23c","type":"other","name":"0","xml":"<outcome value='0'>\n","comments":"","outputs":1,"x":2416.142822265625,"y":1174.2857666015625,"z":"906643da.8385b","wires":[["fe0853f2.d9518"]]},{"id":"3a3409df.a8cc66","type":"set","name":"set total.fixed-ipv4-count","xml":"<set>\n\t<parameter name='total.fixed-ipv4-count' value = '`$tmp.fixed-ipv4-count + $tmp.floating-ipv4-count`' />\n\n<!--\n   value='`$db.vfc-to-network-role-mapping[$network-role-index].floating-ipv4-count`' />\n-->","comments":"","x":2205.714210510254,"y":1328.5714235305786,"z":"906643da.8385b","wires":[]},{"id":"de34a120.03e1f","type":"switchNode","name":"switch total.fixed-ipv4-count","xml":"<switch test='`$total.fixed-ipv4-count`'>\n","comments":"","outputs":1,"x":2211.4287109375,"y":1385.71435546875,"z":"906643da.8385b","wires":[["b817324b.8b69f","c1bf895a.180108","f486ad63.cce89"]]},{"id":"b817324b.8b69f","type":"other","name":"0","xml":"<outcome value='0'>\n","comments":"","outputs":1,"x":2417.142822265625,"y":1385.71435546875,"z":"906643da.8385b","wires":[["dd76ec10.2a6b9"]]},{"id":"dd76ec10.2a6b9","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":2569,"y":1384.857177734375,"z":"906643da.8385b","wires":[[]]},{"id":"c1bf895a.180108","type":"other","name":"Other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":2420.28564453125,"y":1434,"z":"906643da.8385b","wires":[["cbf715a1.d0f2a8"]]},{"id":"f290f8e3.24e9b8","type":"set","name":"set total.fixed-ipv6-count","xml":"<set>\n\t<parameter name='total.fixed-ipv6-count' value = '`$tmp.fixed-ipv6-count + $tmp.floating-ipv6-count`' />\n\n<!--\n   value='`$db.vfc-to-network-role-mapping[$network-role-index].floating-ipv6-count`' />\n-->","comments":"","x":2202.8572845458984,"y":1772.857250213623,"z":"906643da.8385b","wires":[]},{"id":"d7c93974.cc0628","type":"switchNode","name":"switch total.fixed-ipv6-count","xml":"<switch test='`$total.fixed-ipv6-count`'>\n","comments":"","outputs":1,"x":2214.28564453125,"y":1831.4285888671875,"z":"906643da.8385b","wires":[["770bf2bb.bf24ac","51475905.b895c8","d934a597.66f038"]]},{"id":"770bf2bb.bf24ac","type":"other","name":"0","xml":"<outcome value='0'>\n","comments":"","outputs":1,"x":2419.999755859375,"y":1831.4285888671875,"z":"906643da.8385b","wires":[["4b876352.0b879c"]]},{"id":"4b876352.0b879c","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":2571.85693359375,"y":1830.5714111328125,"z":"906643da.8385b","wires":[[]]},{"id":"51475905.b895c8","type":"other","name":"Other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":2423.142578125,"y":1878.7142333984375,"z":"906643da.8385b","wires":[["a3eccddb.ba9db"]]},{"id":"caf2b1e8.8454e","type":"switchNode","name":"switch eipam-ip-block.plans[].requests_length","xml":"<switch test='`$eipam-ip-block.plans[$pidx].requests_length`'>\n","comments":"","outputs":1,"x":1171.4286804199219,"y":1833.2857704162598,"z":"906643da.8385b","wires":[["bfbfff1a.ad09d","dfebc58a.9d9348","e884e93a.ec1a38"]]},{"id":"bfbfff1a.ad09d","type":"other","name":"0","xml":"<outcome value='0'>\n","comments":"","outputs":1,"x":1458.4285888671875,"y":1832.857177734375,"z":"906643da.8385b","wires":[["9bfbdca8.d4427"]]},{"id":"9bfbdca8.d4427","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1613.119026184082,"y":1858.0715188980103,"z":"906643da.8385b","wires":[[]]},{"id":"dfebc58a.9d9348","type":"outcome","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":1458.59517288208,"y":1881.5951023101807,"z":"906643da.8385b","wires":[["9bfbdca8.d4427"]]},{"id":"e884e93a.ec1a38","type":"other","name":"Other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":1459.857177734375,"y":1932.857177734375,"z":"906643da.8385b","wires":[["a8a276c7.b8d6b8"]]},{"id":"a8a276c7.b8d6b8","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":1640.0000686645508,"y":2008.5714282989502,"z":"906643da.8385b","wires":[["9e50005d.87346","db60b65b.c548c8","ad1e2caa.c32b5","464ce4bd.76aa7c"]]},{"id":"a3eccddb.ba9db","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":2574.285675048828,"y":1879.4285564422607,"z":"906643da.8385b","wires":[["d05bf1b0.cee3c"]]},{"id":"464ce4bd.76aa7c","type":"set","name":"increment pidx","xml":"<set>\n\t<parameter name='pidx' value = '`$pidx + 1`' />","comments":"","x":1860.0000076293945,"y":2158.5714263916016,"z":"906643da.8385b","wires":[]},{"id":"cbf715a1.d0f2a8","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":2571.4286727905273,"y":1433.8571701049805,"z":"906643da.8385b","wires":[["7a1e44ea.7de3dc"]]},{"id":"cce22270.1f17c","type":"set","name":"set pidx = 0","xml":"<set>\n\t<parameter name='pidx' value = '0' />","comments":"","x":1005.7143173217773,"y":928.5715093612671,"z":"906643da.8385b","wires":[]},{"id":"d934a597.66f038","type":"outcome","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":2415.71435546875,"y":1785.71435546875,"z":"906643da.8385b","wires":[["4b876352.0b879c"]]},{"id":"f486ad63.cce89","type":"outcome","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":2414.28564453125,"y":1340,"z":"906643da.8385b","wires":[["dd76ec10.2a6b9"]]},{"id":"6c3747a0.7f66a8","type":"outcomeFalse","name":"0","xml":"<outcome value='0'>\n","comments":"","outputs":1,"x":974.2857055664062,"y":558.5714111328125,"z":"906643da.8385b","wires":[["e4d67d86.40251"]]},{"id":"3082e693.7137ea","type":"switchNode","name":"switch: auto-ip-assignment-input.vf-module-name","xml":"<switch test='`$auto-ip-assignment-input.vf-module-name`'>\n","comments":"","outputs":1,"x":504.9999694824219,"y":328.33331298828125,"z":"906643da.8385b","wires":[["c5db2c21.8669f"]]},{"id":"c5db2c21.8669f","type":"outcome","name":"NULL","xml":"<outcome value=''>","outputs":1,"x":784.4999771118164,"y":327.83331298828125,"z":"906643da.8385b","wires":[["2d30b0a5.32cb8"]]},{"id":"2d30b0a5.32cb8","type":"returnFailure","name":"return failure","xml":"<return status=\"failure\">\n\t<parameter name=\"ack-final\" value=\"Y\" />\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"error-message\" value=\"auto-ip-assignment-input.vf-module-name is null\" />\n","comments":"","x":938.9166450500488,"y":327.9444098472595,"z":"906643da.8385b","wires":[]}]