


[{"id":"ffac9d92.2aaca","type":"dgstart","name":"DGSTART","outputs":1,"x":192.85714721679688,"y":78.57142639160156,"z":"c61f02a7.f710b","wires":[["cb8ca6c4.e37a28"]]},{"id":"cb8ca6c4.e37a28","type":"service-logic","name":"VNF-API 2.0.0","module":"VNF-API","version":"${project.version}","comments":"","xml":"<service-logic xmlns='http://www.att.com/sdnctl/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.att.com/sdnctl/svclogic ./svclogic.xsd' module='VNF-API' version='${project.version}'>","outputs":1,"x":358.0238037109375,"y":78.73809814453125,"z":"c61f02a7.f710b","wires":[["5e434d1b.a4bf14"]]},{"id":"5e434d1b.a4bf14","type":"method","name":"method vnf-topology-assign","xml":"<method rpc='vnf-topology-assign' mode='sync'>\n","comments":"","outputs":1,"x":266.0238342285156,"y":125.73809051513672,"z":"c61f02a7.f710b","wires":[["d0de5a86.924be8"]]},{"id":"d0de5a86.924be8","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","comments":"","outputs":1,"x":253.3571548461914,"y":181.57142639160156,"z":"c61f02a7.f710b","wires":[["1e8a3f5e.717d91","f514732f.8810c","d85c86c9.1e8a28","3fd98125.b3edde","ea24658e.334798","3868dfb4.d7723","954a9a87.8b91b8","69314bf3.7bab64"]]},{"id":"1e8a3f5e.717d91","type":"set","name":"set: order-status = PendingCreate","xml":"<set>\n\t<parameter name=\"service-data.oper-status.order-status\" value=\"PendingCreate\"/>","comments":"","outputs":1,"x":521.2479934692383,"y":602.7636432647705,"z":"c61f02a7.f710b","wires":[[]]},{"id":"f514732f.8810c","type":"returnSuccess","name":"return success","xml":"<return status='success'>\n\t<parameter name=\"error-code\" value=\"200\" />","comments":"","x":460.39083099365234,"y":688.4682750701904,"z":"c61f02a7.f710b","wires":[]},{"id":"9d55e492.693d48","type":"comment","name":"request-action = VNFActivateRequest","info":"","comments":"","x":700.023811340332,"y":98.68254089355469,"z":"c61f02a7.f710b","wires":[]},{"id":"8ef75230.30a75","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":818.2977523803711,"y":553.7861671447754,"z":"c61f02a7.f710b","wires":[["e8c4e2c.01b712"]]},{"id":"34349fb4.a298a","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='error-code' value='500'/>\n\t<parameter name='error-message' value=\"Encountered error while updating vf-module orchestration-status in AnAI\"/>","comments":"","x":1202.4406814575195,"y":553.7862377166748,"z":"c61f02a7.f710b","wires":[]},{"id":"64dd9984.c41aa8","type":"save","name":"save relationship: l3-network","xml":"<save plugin=\"com.att.sdnctl.sli.aai.AAIService\" \n\tresource=\"vf-module:relationship-list\" \n\t\tkey=\"vf-module.vf-module-id = $vnf-topology-operation-input.vnf-request-information.vnf-id \n\t\t\tand generic-vnf.vnf-id = $vnf-topology-operation-input.vnf-request-information.generic-vnf-id\" \n\tforce=\"true\" \n\tlocal-only=\"false\">\n\t\n\t<parameter name=\"relationship-list.relationship[0].related-to\" value=\"l3-network\" />\n\t<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"l3-network.network-id\" />\n\t<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$service-data.vnf-topology-information.vnf-assignments.vnf-networks[$i].network-id`\" />","comments":"","outputs":1,"x":820.6032409667969,"y":396.6863851547241,"z":"c61f02a7.f710b","wires":[["df85f46a.a2a638"]]},{"id":"df85f46a.a2a638","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1033.2475128173828,"y":396.7333993911743,"z":"c61f02a7.f710b","wires":[["90ef1bbc.fcd5d8"]]},{"id":"d85c86c9.1e8a28","type":"for","name":"for i : SERVICE_DATA vnf-networks","xml":"<for index=\"i\" start=\"0\" end=\"`$service-data.vnf-topology-information.vnf-assignments.vnf-networks_length`\">","comments":"","outputs":1,"x":526.2500457763672,"y":396.6548662185669,"z":"c61f02a7.f710b","wires":[["64dd9984.c41aa8"]]},{"id":"cab52ea5.e9d35","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='error-code' value='500'/>\n\t<parameter name='error-message' value=\"`'Encountered error while saving vf-module l3-network relationship in AnAI with network-id = ' + $service-data.vnf-topology-information.vnf-assignments.vnf-networks[$i].network-id`\"/>","comments":"","x":1202.2975769042969,"y":506.7497262954712,"z":"c61f02a7.f710b","wires":[]},{"id":"90ef1bbc.fcd5d8","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":992.011962890625,"y":459.0355796813965,"z":"c61f02a7.f710b","wires":[["1f3d8f07.94f7b1","cab52ea5.e9d35"]]},{"id":"1f3d8f07.94f7b1","type":"save","name":"delete vf-module: l3-network relationship","xml":"<delete plugin=\"com.att.sdnctl.sli.aai.AAIService\" \n\tresource=\"vf-module:relationship-list\" \n\tkey=\"vf-module.vf-module-id = $vnf-topology-operation-input.vnf-request-information.vnf-id \n\t\tAND generic-vnf.vnf-id = $vnf-topology-operation-input.vnf-request-information.generic-vnf-id \n\t\tAND related-to = l3-network\" \n\tforce=\"true\" \n\tlocal-only=\"false\">","comments":"","outputs":1,"x":1285.440559387207,"y":459.4643259048462,"z":"c61f02a7.f710b","wires":[[]]},{"id":"3fd98125.b3edde","type":"save","name":"update AnAI - vf-module.orchestration-status","xml":"<update plugin=\"com.att.sdnctl.sli.aai.AAIService\" \n\tresource=\"vf-module\" \n\t\tkey=\"vf-module.vf-module-id = $vnf-topology-operation-input.vnf-request-information.vnf-id \n\t\t\tand generic-vnf.vnf-id = $vnf-topology-operation-input.vnf-request-information.generic-vnf-id\" \n\t\tlocal-only=\"false\" >\n\t<parameter name=\"orchestration-status\" value=\"pending-create\" />","comments":"","outputs":1,"x":553.7738952636719,"y":553.797664642334,"z":"c61f02a7.f710b","wires":[["8ef75230.30a75"]]},{"id":"e8c4e2c.01b712","type":"block","name":"block: atomic","xml":"<block atomic=\"true\">\n","atomic":"false","comments":"","outputs":1,"x":976.7263259887695,"y":553.8929262161255,"z":"c61f02a7.f710b","wires":[["34349fb4.a298a","1f3d8f07.94f7b1"]]},{"id":"ea24658e.334798","type":"call","name":"call: vnf-topology-assign-vfmodule","xml":"<call module='VNF-API' rpc='vnf-topology-assign-vfmodule' mode='sync' >","comments":"","outputs":1,"x":520.5238342285156,"y":286.3214416503906,"z":"c61f02a7.f710b","wires":[[]]},{"id":"3868dfb4.d7723","type":"set","name":"Set final indicator to Y","xml":"<set>\n<parameter name=\"ack-final\" value=\"Y\"/>","comments":"","outputs":1,"x":484.4286422729492,"y":647.8928623199463,"z":"c61f02a7.f710b","wires":[[]]},{"id":"954a9a87.8b91b8","type":"switchNode","name":"switch ...SERVICE-DATA vnf-networks[]","xml":"<switch test=\"`$service-data.vnf-topology-information.vnf-assignments.vnf-networks_length`\">","comments":"","outputs":1,"x":538.6071929931641,"y":336.89287185668945,"z":"c61f02a7.f710b","wires":[["49274fc7.115de"]]},{"id":"49274fc7.115de","type":"outcome","name":"NULL","xml":"<outcome value=''>","outputs":1,"x":779.0516662597656,"y":336.42058181762695,"z":"c61f02a7.f710b","wires":[["b1bab9f3.5e4328"]]},{"id":"b1bab9f3.5e4328","type":"set","name":"set SERVICE-DATA vnf-networks[] = 0","xml":"<set>\n<parameter name='service-data.vnf-topology-information.vnf-assignments.vnf-networks_length' value='0' />\n","comments":"","outputs":1,"x":1000.607275221083,"y":336.4206024805703,"z":"c61f02a7.f710b","wires":[[]]},{"id":"69314bf3.7bab64","type":"save","name":"GET AnAI - vf-module","xml":"<get-resource plugin=\"com.att.sdnctl.sli.aai.AAIService\" \n\tresource=\"vf-module\" \n\t\tkey=\"vf-module.vf-module-id = $vnf-topology-operation-input.vnf-request-information.vnf-id \n\t\t\tand generic-vnf.vnf-id = $vnf-topology-operation-input.vnf-request-information.generic-vnf-id\" \n\t\tlocal-only=\"false\" \n\t\tpfx=\"tmp.AnAI.vfmodule\" >","comments":"","outputs":1,"x":484.10716247558594,"y":181.07143688201904,"z":"c61f02a7.f710b","wires":[["7ddae686.7d9d48","4aa52b8f.fa62b4"]]},{"id":"7ddae686.7d9d48","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":678.1071624755859,"y":180.82143688201904,"z":"c61f02a7.f710b","wires":[["72bfa174.1630f"]]},{"id":"4aa52b8f.fa62b4","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":685.607177734375,"y":220.82144737243652,"z":"c61f02a7.f710b","wires":[["a517ff09.80f91"]]},{"id":"72bfa174.1630f","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='error-code' value='500'/>\n\t<parameter name='error-message' value=\"`'Encountered error while querying vf-module from AnAI with vf-module-id = ' + $vnf-topology-operation-input.vnf-request-information.vnf-id + ' and generic-vnf-id = ' + $vnf-topology-operation-input.vnf-request-information.generic-vnf-id`\"/>","comments":"","x":832.3571624755859,"y":180.57143688201904,"z":"c61f02a7.f710b","wires":[]},{"id":"a517ff09.80f91","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='error-code' value='500'/>\n\t<parameter name='error-message' value=\"`'vf-module not found in AnAI with vf-module-id = ' + $vnf-topology-operation-input.vnf-request-information.vnf-id + ' and generic-vnf-id = ' + $vnf-topology-operation-input.vnf-request-information.generic-vnf-id`\"/>","comments":"","x":852.8571624755859,"y":221.07143688201904,"z":"c61f02a7.f710b","wires":[]}]
