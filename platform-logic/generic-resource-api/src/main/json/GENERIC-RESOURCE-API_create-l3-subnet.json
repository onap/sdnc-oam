[{"id":"f2284f71.6463","type":"dgstart","name":"DGSTART","outputs":1,"x":124.28571319580078,"y":60,"z":"5c1ee14f.35ba3","wires":[["a8ce8342.4bd06"]]},{"id":"a8ce8342.4bd06","type":"service-logic","name":"GENERIC-RESOURCE-API ${project.version}","module":"GENERIC-RESOURCE-API","version":"${project.version}","comments":"","xml":"<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>","outputs":1,"x":225.57141876220703,"y":114.23811340332031,"z":"5c1ee14f.35ba3","wires":[["9b3e05cb.d2a0f8"]]},{"id":"9b3e05cb.d2a0f8","type":"method","name":"create-l3-subnet","xml":"<method rpc='create-l3-subnet' mode='sync'>\n","comments":"","outputs":1,"x":240.96434783935547,"y":163.75,"z":"5c1ee14f.35ba3","wires":[["ec2fd40b.a7d928"]]},{"id":"ec2fd40b.a7d928","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":220.7857437133789,"y":296.94350266456604,"z":"5c1ee14f.35ba3","wires":[["1a5998af.a60847","48fddaf1.ceadc4","6e8e044e.88061c","dcfd029c.c25a5"]]},{"id":"1a5998af.a60847","type":"set","name":"set subnet-idx","xml":"<set>\n<parameter name='subnet-idx' value='0' />\n","comments":"","x":415.71427154541016,"y":242.2857151031494,"z":"5c1ee14f.35ba3","wires":[]},{"id":"ee39e288.5fc9c","type":"comment","name":"These should be set from previous eipam call","info":"<parameter name='tmp.l3-network.level2.v4.entity-id' value='' />\n<parameter name='tmp.l3-network.level2.v4.ip-prefix' value='' />\n<parameter name='tmp.l3-network.level2.v4.mask' value='' />\n<parameter name='tmp.l3-network.level2.v4.pool.pre-existing' value='false' />\n<parameter name='tmp.l3-network.level2.v4.subnet.pre-existing' value='false' />\n<parameter name='tmp.l3-network.level2.v6.entity-id' value='' />\n<parameter name='tmp.l3-network.level2.v6.ip-prefix' value='' />\n<parameter name='tmp.l3-network.level2.v6.mask' value='' />\n<parameter name='tmp.l3-network.level2.v6.pool.pre-existing' value='false' />\n<parameter name='tmp.l3-network.level2.v6.subnet.pre-existing' value='false' />","comments":"","x":508.2857131958008,"y":186,"z":"5c1ee14f.35ba3","wires":[]},{"id":"48fddaf1.ceadc4","type":"switchNode","name":"switch entity-id for ipv4","xml":"<switch test='`$tmp.l3-network.level2.v4.entity-id`'>\n","comments":"","outputs":1,"x":434.2857131958008,"y":284.0000305175781,"z":"5c1ee14f.35ba3","wires":[["5d27d606.b49aa8","b7f40f4e.2f916"]]},{"id":"5d27d606.b49aa8","type":"other","name":"outcome null","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":654.2857131958008,"y":282.0000305175781,"z":"5c1ee14f.35ba3","wires":[["4c85d764.9d1558"]]},{"id":"b7f40f4e.2f916","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":642.2857131958008,"y":322.0000305175781,"z":"5c1ee14f.35ba3","wires":[["94cc3a80.3cfaa8"]]},{"id":"94cc3a80.3cfaa8","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":827.6190719604492,"y":324.00003004074097,"z":"5c1ee14f.35ba3","wires":[["957c4a16.6eaa08","f3ad7d1a.f2d3b","e7109a07.926cf8","30da1918.ab7066","c2c83fd0.8f411"]]},{"id":"24324f8a.bb557","type":"set","name":"set dhcp data","xml":"<set>\n<parameter name='tmp.l3-network.subnet[$subnet-idx].dhcp-enabled' value='true' />\n<parameter name='tmp.l3-network.subnet[$subnet-idx].dhcp-start' value='`$tmp.return.generate.dhcp-start-address`' />\n<parameter name='tmp.l3-network.subnet[$subnet-idx].dhcp-end' value='`$tmp.return.generate.dhcp-end-address`' />\n\n\n","comments":"","x":1761.142765045166,"y":394.5714521408081,"z":"5c1ee14f.35ba3","wires":[]},{"id":"957c4a16.6eaa08","type":"execute","name":"execute getSubnetAddresses","xml":"<execute plugin=\"com.att.sdnctl.sli.plugin.ipAddressTools.IpAddressTool\" method=\"getSubnetAddresses\">\n\t<parameter name=\"ipAddress\" value=\"`$tmp.l3-network.level2.v4.ip-prefix`\" />\n\t<parameter name=\"ipVersion\" value=\"4\" />\n\t<parameter name=\"subnet\" value=\"`$tmp.l3-network.level2.v4.mask`\" />\n\t<parameter name=\"ctxGateway\" value=\"tmp.return.generate.gateway-address\" />\n\t<parameter name=\"ctxDhcpStart\" value=\"tmp.return.generate.dhcp-start-address\" />\n\t<parameter name=\"ctxDhcpEnd\" value=\"tmp.return.generate.dhcp-end-address\" />\n\n","comments":"","outputs":1,"x":1113.9999465942383,"y":322.8571548461914,"z":"5c1ee14f.35ba3","wires":[["8e880aaf.ae6268"]]},{"id":"f3ad7d1a.f2d3b","type":"switchNode","name":"switch network-model.ipv4-dhcp-enabled","xml":"<switch test='`$network-model.ipv4-dhcp-enabled`'>\n","comments":"","outputs":1,"x":1145.6509704589844,"y":385.9365463256836,"z":"5c1ee14f.35ba3","wires":[["736b7433.77e98c","20e8766.5fab28a"]]},{"id":"736b7433.77e98c","type":"other","name":"Y","xml":"<outcome value='Y'>\n","comments":"","outputs":1,"x":1401.3649997711182,"y":395.93652153015137,"z":"5c1ee14f.35ba3","wires":[["60241dc3.678824"]]},{"id":"60241dc3.678824","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":1561.841236114502,"y":395.93650817871094,"z":"5c1ee14f.35ba3","wires":[["24324f8a.bb557"]]},{"id":"e7109a07.926cf8","type":"set","name":"set subnet-idx","xml":"<set>\n<parameter name='subnet-idx' value='`$subnet-idx+1`' />\n\n","comments":"","x":1064.2223052978516,"y":420.22220611572266,"z":"5c1ee14f.35ba3","wires":[]},{"id":"6e8e044e.88061c","type":"switchNode","name":"switch entity-id for ipv6","xml":"<switch test='`$tmp.l3-network.level2.v6.entity-id`'>\n","comments":"","outputs":1,"x":444.4867630004883,"y":491.0105953216553,"z":"5c1ee14f.35ba3","wires":[["533c8c33.2653e4","738eb522.e6358c"]]},{"id":"533c8c33.2653e4","type":"other","name":"outcome null","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":664.4867630004883,"y":489.0105953216553,"z":"5c1ee14f.35ba3","wires":[["4ba3ce4b.c74c5"]]},{"id":"738eb522.e6358c","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":651.0581817626953,"y":543.7248754501343,"z":"5c1ee14f.35ba3","wires":[["f63b20.13edc4e"]]},{"id":"49d9043.c579afc","type":"set","name":"set l3network.subnet","xml":"<set>\n<parameter name='tmp.l3-network.subnet[$subnet-idx].orchestration-status' value='PendingCreate' />\n<parameter name='tmp.l3-network.subnet[$subnet-idx].subnet-id' value='`$tmp.l3-network.level2.v6.entity-id`' />\n<parameter name='tmp.l3-network.subnet[$subnet-idx].subnet-name' value=\"`$tmp.l3-network.network-name + '_S' + $subnet-idx`\" />\n<parameter name='tmp.l3-network.subnet[$subnet-idx].gateway-address' value='`$tmp.return.generate.gateway-address`' />\n<parameter name='tmp.l3-network.subnet[$subnet-idx].network-start-address' value='`$tmp.l3-network.level2.v6.ip-prefix`' />\n<parameter name='tmp.l3-network.subnet[$subnet-idx].cidr-mask' value='`$tmp.l3-network.level2.v6.mask`' />\n<parameter name='tmp.l3-network.subnet[$subnet-idx].ip-version' value='`$network-model.ipv6-ip-version`' />\n\n\n","comments":"","x":1096.724983215332,"y":613.2963228225708,"z":"5c1ee14f.35ba3","wires":[]},{"id":"f63b20.13edc4e","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":845.9153594970703,"y":543.296329498291,"z":"5c1ee14f.35ba3","wires":[["47206233.63117c","49d9043.c579afc","e1ea2c66.1252d","43c4c344.b2878c","58924f71.5ba41","5dbaa100.b1ff3"]]},{"id":"9cbc98c0.17c928","type":"set","name":"set dhcp data","xml":"<set>\n<parameter name='tmp.l3-network.subnet[$subnet-idx].dhcp-enabled' value='true' />\n<parameter name='tmp.l3-network.subnet[$subnet-idx].dhcp-start' value='`$tmp.return.generate.dhcp-start-address`' />\n<parameter name='tmp.l3-network.subnet[$subnet-idx].dhcp-end' value='`$tmp.return.generate.dhcp-end-address`' />\n\n\n","comments":"","x":1771.3438987731934,"y":648.7248783111572,"z":"5c1ee14f.35ba3","wires":[]},{"id":"47206233.63117c","type":"execute","name":"execute getSubnetAddresses","xml":"<execute plugin=\"com.att.sdnctl.sli.plugin.ipAddressTools.IpAddressTool\" method=\"getSubnetAddresses\">\n\t<parameter name=\"ipAddress\" value=\"`$tmp.l3-network.level2.v6.ip-prefix`\" />\n\t<parameter name=\"ipVersion\" value=\"6\" />\n\t<parameter name=\"subnet\" value=\"`$tmp.l3-network.level2.v6.mask`\" />\n\t<parameter name=\"ctxGateway\" value=\"tmp.return.generate.gateway-address\" />\n\t<parameter name=\"ctxDhcpStart\" value=\"tmp.return.generate.dhcp-start-address\" />\n\t<parameter name=\"ctxDhcpEnd\" value=\"tmp.return.generate.dhcp-end-address\" />\n\n","comments":"","outputs":1,"x":1124.2010803222656,"y":577.0105810165405,"z":"5c1ee14f.35ba3","wires":[["f3773581.8d2148"]]},{"id":"e1ea2c66.1252d","type":"switchNode","name":"switch network-model.ipv6-dhcp-enabled","xml":"<switch test='`$network-model.ipv6-dhcp-enabled`'>\n","comments":"","outputs":1,"x":1150.137710571289,"y":651.5185317993164,"z":"5c1ee14f.35ba3","wires":[["bdf59629.1a7018","a8abca55.2792c8"]]},{"id":"bdf59629.1a7018","type":"other","name":"Y","xml":"<outcome value='Y'>\n","comments":"","outputs":1,"x":1411.5661334991455,"y":650.0899477005005,"z":"5c1ee14f.35ba3","wires":[["93c67590.4d9238"]]},{"id":"93c67590.4d9238","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":1572.0423698425293,"y":650.0899343490601,"z":"5c1ee14f.35ba3","wires":[["9cbc98c0.17c928"]]},{"id":"8e880aaf.ae6268","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1345.9153366088867,"y":322.629638671875,"z":"5c1ee14f.35ba3","wires":[["c309b0ac.778ac"]]},{"id":"c309b0ac.778ac","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Failed to generate ipv4 addresses using IpAddressTools\" />","comments":"","x":1517.581886291504,"y":322.629638671875,"z":"5c1ee14f.35ba3","wires":[]},{"id":"f3773581.8d2148","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1375.9153747558594,"y":578.1058282852173,"z":"5c1ee14f.35ba3","wires":[["fc59de73.53136"]]},{"id":"fc59de73.53136","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Failed to generate ipv6 addresses using IpAddressTools\" />","comments":"","x":1547.5819244384766,"y":578.1058282852173,"z":"5c1ee14f.35ba3","wires":[]},{"id":"dcfd029c.c25a5","type":"returnSuccess","name":"return success","xml":"<return status='success'>\n<parameter name='' value='' />\n","comments":"","x":392.95237731933594,"y":607.166669845581,"z":"5c1ee14f.35ba3","wires":[]},{"id":"43c4c344.b2878c","type":"record","name":"record","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"GENERIC-RESOURCE-API.create-l3-subnet:REQID\"/>\n<parameter name=\"field3\" value=\"`$network-topology-operation-input.sdnc-request-header.svc-request-id`\"/>\n<parameter name=\"field4\" value=\"tmp.l3-network.level2.v6.entity-id\"/>\n<parameter name=\"field5\" value=\"`$tmp.l3-network.level2.v6.entity-id`\"/>\n\n\n\n","comments":"","outputs":1,"x":1049.9366149902344,"y":543.0793695449829,"z":"5c1ee14f.35ba3","wires":[[]]},{"id":"4ba3ce4b.c74c5","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":842.7936553955078,"y":488.79364109039307,"z":"5c1ee14f.35ba3","wires":[["8ff0f4.8cbfef1"]]},{"id":"8ff0f4.8cbfef1","type":"record","name":"record","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"GENERIC-RESOURCE-API.create-l3-subnet:REQID\"/>\n<parameter name=\"field3\" value=\"`$network-topology-operation-input.sdnc-request-header.svc-request-id`\"/>\n<parameter name=\"field4\" value=\"tmp.l3-network.level2.v6.entity-id\"/>\n<parameter name=\"field5\" value=\"null\"/>\n\n\n\n","comments":"","outputs":1,"x":1048.243558883667,"y":488.1481246948242,"z":"5c1ee14f.35ba3","wires":[[]]},{"id":"30da1918.ab7066","type":"set","name":"set l3network.subnet","xml":"<set>\n<parameter name='tmp.l3-network.subnet[$subnet-idx].orchestration-status' value='PendingCreate' />\n<parameter name='tmp.l3-network.subnet[$subnet-idx].subnet-id' value='`$tmp.l3-network.level2.v4.entity-id`' />\n<parameter name='tmp.l3-network.subnet[$subnet-idx].subnet-name' value=\"`$tmp.l3-network.network-name + '_S' + $subnet-idx`\" />\n<parameter name='tmp.l3-network.subnet[$subnet-idx].gateway-address' value='`$tmp.return.generate.gateway-address`' />\n<parameter name='tmp.l3-network.subnet[$subnet-idx].network-start-address' value='`$tmp.l3-network.level2.v4.ip-prefix`' />\n<parameter name='tmp.l3-network.subnet[$subnet-idx].cidr-mask' value='`$tmp.l3-network.level2.v4.mask`' />\n<parameter name='tmp.l3-network.subnet[$subnet-idx].ip-version' value='`$network-model.ipv4-ip-version`' />\n","comments":"","x":1082.7937698364258,"y":355.9365348815918,"z":"5c1ee14f.35ba3","wires":[]},{"id":"58924f71.5ba41","type":"set","name":"set subnet-idx","xml":"<set>\n<parameter name='subnet-idx' value='`$subnet-idx+1`' />\n","comments":"","x":1068.507942199707,"y":684.5079498291016,"z":"5c1ee14f.35ba3","wires":[]},{"id":"20e8766.5fab28a","type":"other","name":"N","xml":"<outcome value='N'>\n","comments":"","outputs":1,"x":1403.9047927856445,"y":431.6508026123047,"z":"5c1ee14f.35ba3","wires":[["3f11ef0a.6e4de"]]},{"id":"be7775e3.ccf258","type":"set","name":"set dhcp data","xml":"<set>\n<parameter name='tmp.l3-network.subnet[$subnet-idx].dhcp-enabled' value='false' />\n<parameter name='tmp.l3-network.subnet[$subnet-idx].dhcp-start' value='' />\n<parameter name='tmp.l3-network.subnet[$subnet-idx].dhcp-end' value='' />\n\n\n","comments":"","x":1763.9047927856445,"y":430.2222442626953,"z":"5c1ee14f.35ba3","wires":[]},{"id":"3f11ef0a.6e4de","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":1564.6032638549805,"y":431.58730030059814,"z":"5c1ee14f.35ba3","wires":[["be7775e3.ccf258"]]},{"id":"a8abca55.2792c8","type":"other","name":"N","xml":"<outcome value='N'>\n","comments":"","outputs":1,"x":1409.619026184082,"y":683.0793609619141,"z":"5c1ee14f.35ba3","wires":[["c57667ca.b81d28"]]},{"id":"c3350a6a.80eef8","type":"set","name":"set dhcp data","xml":"<set>\n<parameter name='tmp.l3-network.subnet[$subnet-idx].dhcp-enabled' value='false' />\n<parameter name='tmp.l3-network.subnet[$subnet-idx].dhcp-start' value='' />\n<parameter name='tmp.l3-network.subnet[$subnet-idx].dhcp-end' value='' />\n\n\n","comments":"","x":1769.619026184082,"y":681.6508026123047,"z":"5c1ee14f.35ba3","wires":[]},{"id":"c57667ca.b81d28","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":1570.317497253418,"y":683.0158586502075,"z":"5c1ee14f.35ba3","wires":[["c3350a6a.80eef8"]]},{"id":"4c85d764.9d1558","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":827.1428833007812,"y":277.1428527832031,"z":"5c1ee14f.35ba3","wires":[["e636a1c6.25345"]]},{"id":"e636a1c6.25345","type":"record","name":"record","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"GENERIC-RESOURCE-API.create-l3-subnet:REQID\"/>\n<parameter name=\"field3\" value=\"`$network-topology-operation-input.sdnc-request-header.svc-request-id`\"/>\n<parameter name=\"field4\" value=\"tmp.l3-network.level2.v4.entity-id\"/>\n<parameter name=\"field5\" value=\"null\"/>\n\n\n\n","comments":"","outputs":1,"x":998.5713863372803,"y":277.142840385437,"z":"5c1ee14f.35ba3","wires":[[]]},{"id":"c2c83fd0.8f411","type":"set","name":"set subnet_length","xml":"<set>\n<parameter name='tmp.l3-network.subnet_length' value='`$subnet-idx`' />\n","comments":"","x":1067.4286041259766,"y":451.42859268188477,"z":"5c1ee14f.35ba3","wires":[]},{"id":"5dbaa100.b1ff3","type":"set","name":"set subnet-len","xml":"<set>\n<parameter name='tmp.l3-network.subnet_length' value='`$subnet-idx`' />\n","comments":"","x":1068.857177734375,"y":717.1428833007812,"z":"5c1ee14f.35ba3","wires":[]}]
