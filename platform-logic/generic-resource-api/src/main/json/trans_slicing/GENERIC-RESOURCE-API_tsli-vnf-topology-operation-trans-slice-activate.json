[
    {
        "id": "d9508d21.fa5b3",
        "type": "dgstart",
        "name": "DGSTART",
        "outputs": 1,
        "x": 144,
        "y": 116,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "cae32381.bce9d"
            ]
        ]
    },
    {
        "id": "cae32381.bce9d",
        "type": "service-logic",
        "name": "GENERIC-RESOURCE-API ${project.version}",
        "module": "GENERIC-RESOURCE-API",
        "version": "${project.version}",
        "comments": "",
        "xml": "<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>",
        "outputs": 1,
        "x": 275.2856903076172,
        "y": 165.23810863494873,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "82cfa8a0.a91dc"
            ]
        ]
    },
    {
        "id": "82cfa8a0.a91dc",
        "type": "method",
        "name": "method tsli-vnf-topology-operation-trans-slice-activate",
        "xml": "<method rpc='tsli-vnf-topology-operation-trans-slice-activate' mode='sync'>\n",
        "comments": "",
        "outputs": 1,
        "x": 278.4286193847656,
        "y": 250.00003242492676,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "f6fef19d.8fc9f8"
            ]
        ]
    },
    {
        "id": "f6fef19d.8fc9f8",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 428.238037109375,
        "y": 379.6666564941406,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "c70167ce.7f9118",
                "6aca196e.a4377",
                "e86e6571.913898"
            ]
        ]
    },
    {
        "id": "c70167ce.7f9118",
        "type": "returnSuccess",
        "name": "return success",
        "xml": "<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n",
        "comments": "",
        "x": 696.5716552734375,
        "y": 766.59716796875,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "d841551.d686928",
        "type": "comment",
        "name": "new for TransportSlicing",
        "info": "",
        "comments": "",
        "x": 728,
        "y": 441,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "6aca196e.a4377",
        "type": "save",
        "name": "get service-instance from aai",
        "xml": "<!--<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" -->\n<!--\tresource=\"service-instance\"-->\n<!--\tkey='service-instance.service-instance-id = $service-data.vnfs.vnf[$tmp.vidx].vnf-data.service-information.service-instance-id-->\n<!--         AND customer.global-customer-id = $service-data.vnfs.vnf[$tmp.vidx].vnf-data.service-information.global-customer-id -->\n<!--         AND service-subscription.service-type = $service-data.vnfs.vnf[$tmp.vidx].vnf-data.service-information.subscription-service-type'-->\n<!--\tlocal-only=\"false\"-->\n<!--\tforce=\"true\" pfx=\"tmp.aai.service-instance\">-->\n\n<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"service-instance\"\n\tkey='service-instance.service-instance-id = $vnf-topology-operation-input.service-information.service-instance-id\n         AND customer.global-customer-id = $vnf-topology-operation-input.service-information.global-customer-id \n         AND service-subscription.service-type = $vnf-topology-operation-input.service-information.subscription-service-type'\n\tlocal-only=\"false\"\n\tforce=\"true\" pfx=\"tmp.aai.service-instance\">\n\n\n<!--$vnf-topology-operation-input.service-information.service-instance-id-->",
        "comments": "",
        "outputs": 1,
        "x": 748,
        "y": 537,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "8dfdefd.d3d4d9",
                "f6a9e3a5.f26778",
                "6cad2633.e5f528"
            ]
        ]
    },
    {
        "id": "8dfdefd.d3d4d9",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 967,
        "y": 475,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "f2dd8538.5d3378"
            ]
        ]
    },
    {
        "id": "f6a9e3a5.f26778",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 976.490966796875,
        "y": 517.5740356445312,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "59b21b6f.e70b7c"
            ]
        ]
    },
    {
        "id": "6cad2633.e5f528",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 965,
        "y": 564,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "95c7d05e.93c3e"
            ]
        ]
    },
    {
        "id": "59b21b6f.e70b7c",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.l3vpn.pe1_id`\" />\n\n",
        "comments": "",
        "x": 1130.0623779296875,
        "y": 520.8597717285156,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "95c7d05e.93c3e",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
        "comments": "",
        "x": 1134,
        "y": 565,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "f2dd8538.5d3378",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for index='rel-index' start='0' end='`$tmp.aai.service-instance.relationship-list.relationship_length`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 1164,
        "y": 471,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "94e5618.e7d282"
            ]
        ]
    },
    {
        "id": "94e5618.e7d282",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.aai.service-instance.relationship-list.relationship[$rel-index].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1387.33349609375,
        "y": 470.99993896484375,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "32140056.199ae"
            ]
        ]
    },
    {
        "id": "32140056.199ae",
        "type": "outcome",
        "name": "connectivity",
        "xml": "<outcome value='connectivity'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1588.0001335144043,
        "y": 472.00002098083496,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "9174febc.b8b998"
            ]
        ]
    },
    {
        "id": "25e7d332.a761fc",
        "type": "set",
        "name": "set attachment_param for OTN A",
        "xml": "<set>\n<parameter name='src-node-id' value='`$tmp.aai.vpn-bindingA.src-access-node-id`' />\n<parameter name='dst-node-id' value='`$tmp.aai.vpn-bindingA.dst-access-node-id`' />\n<parameter name='dst-tpn-id' value='1' />\n<parameter name='dst-ttp-id' value='`$tmp.aai.vpn-bindingA.dst-access-ltp-id`' />\n<parameter name='slice-instance-id' value='`$tmp.aai.service-instance.service-instance-id`' />\n<parameter name='otn-tunnel-name-src-domain' value='`$tmp.aai.vpn-bindingA.vpn-name`' />\n<parameter name='client-id' value='`$tmp.aai.vpn-bindingA.access-client-id`' />\n<parameter name='provider-id' value='`$tmp.aai.vpn-bindingA.access-provider-id`' />\n<parameter name='topology-id' value='`$tmp.aai.vpn-bindingA.access-topology-id`' />\n",
        "comments": "",
        "x": 3849,
        "y": 191,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "fee47d9.4382e",
        "type": "execute",
        "name": "execute RestApiCallNode Create OTN tunnel with token",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.ts-otn-src-domain-creation.templatefile`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainA.url + '/restconf/data/ietf-te:te'`\" />\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainA.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainA.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"patch\"/>\n<parameter name=\"responsePrefix\" value=\"otn-oof\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n<parameter name='customHttpHeaders' value=\"`'X-ACCESS-TOKEN=' + $prop.sdncRestApi.token_id`\" />",
        "comments": "",
        "outputs": 1,
        "x": 3930,
        "y": 506,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "445402d7.16a9f4",
                "d34714f7.10a51"
            ]
        ]
    },
    {
        "id": "445402d7.16a9f4",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4239.5,
        "y": 475,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "69fb5a0d.27a12c"
            ]
        ]
    },
    {
        "id": "d34714f7.10a51",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4244.5,
        "y": 540,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "f0eccde.2c0533"
            ]
        ]
    },
    {
        "id": "69fb5a0d.27a12c",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create OTN tunnel rest api\" />\n",
        "comments": "",
        "x": 4415.5,
        "y": 475,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "f0eccde.2c0533",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 4411,
        "y": 540,
        "z": "8a9c455f.82beb8",
        "wires": [
            []
        ]
    },
    {
        "id": "a96cdedb.06ef48",
        "type": "set",
        "name": "set sotn_value",
        "xml": "<set>\n<!--<parameter name='eth-service-name' value='`$tmp.aai.connectivityA.connectivity-id`' />-->\n<parameter name='eth-service-name' value='`$tmp.aai.connectivityA.etht-svc-name`' />\n<parameter name='slice-id' value='`$vnf-topology-operation-input.service-information.service-instance-id`' />\n<parameter name='provider-id' value='`$tmp.aai.connectivityA.access-provider-id`' />\n<parameter name='client-id' value='`$tmp.aai.connectivityA.access-client-id`' />\n<parameter name='topology-id' value='`$tmp.aai.connectivityA.access-topology-id`' />\n<parameter name='otn-tunnel-name' value='`$tmp.aai.vpn-bindingA.vpn-name`' />\n<parameter name='ethernet-end-point-name' value='`$tmp.aai.connectivityA.connectivity-id`' />\n<parameter name='index-number' value='0' />\n<parameter name='eth-node-id' value='`$tmp.aai.connectivityA.access-node-id`' />\n<parameter name='eth-node-tp-id' value='`$tmp.aai.connectivityA.access-ltp-id`' />\n<parameter name='CIR' value='`$tmp.aai.vpn-bindingA.route-distinguisher *1000000`' />\n<parameter name='EIR' value='`$tmp.aai.vpn-bindingA.route-distinguisher *1000000`' />\n",
        "comments": "",
        "x": 3796.5,
        "y": 694,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "616c98c7.f82ea8",
        "type": "execute",
        "name": "execute RestApiCallNode Create ethernet Service without token",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.ts-ethernet-service.templatefile`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainA.url + '/restconf/data/ietf-eth-tran-service:etht-svc'`\" />\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.restapi.connection-oof-url`\" />-->\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainA.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainA.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"patch\"/>\n<parameter name='dirPath' value=\"/opt/onap/sdnc/restconfapi/yang\" />\n<parameter name=\"responsePrefix\" value=\"vpn-result\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n",
        "comments": "",
        "outputs": 1,
        "x": 3950.5,
        "y": 742,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "eef8ae3.fdd1a5",
                "8f2e62b6.e98788"
            ]
        ]
    },
    {
        "id": "eef8ae3.fdd1a5",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4296,
        "y": 723,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "f08a069b.6042c8"
            ]
        ]
    },
    {
        "id": "8f2e62b6.e98788",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4300,
        "y": 763,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "b227b2c.229c1d"
            ]
        ]
    },
    {
        "id": "f08a069b.6042c8",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create ethernet service rest api\" />\n",
        "comments": "",
        "x": 4454,
        "y": 723,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "b227b2c.229c1d",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 4457.5,
        "y": 763,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "2af71c81.1e5aec",
                "5fe9896d.3d8e98"
            ]
        ]
    },
    {
        "id": "c5970f4b.9679a8",
        "type": "comment",
        "name": "TODO: FIXME:",
        "info": "put proper values based on connectivity resource retrieved from AAI",
        "comments": "",
        "x": 3794,
        "y": 650,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "2af71c81.1e5aec",
        "type": "save",
        "name": "update vpn-binding A resource (aka. OTN domainA) in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding' \n      key='vpn-binding.vpn-id = $tmp.aai.vpn-bindingA.vpn-id' >\n<parameter name='vpn-id' value='`$tmp.aai.vpn-bindingA.vpn-id`' />\n<parameter name='vpn-name' value='`$tmp.aai.vpn-bindingA.vpn-id`' />\n\n<parameter name='operational-status' value='Activated' />\n",
        "comments": "",
        "outputs": 1,
        "x": 4788,
        "y": 728,
        "z": "8a9c455f.82beb8",
        "wires": [
            []
        ]
    },
    {
        "id": "48dd1ec4.51cb4",
        "type": "comment",
        "name": "TODO: FIXME",
        "info": "use proper vpn-binding id and connectivity id\n\nAlso, does CCSDK support \"update\" operation for vpn-binding and connectivity?",
        "comments": "",
        "x": 4652,
        "y": 687,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "5fe9896d.3d8e98",
        "type": "save",
        "name": "update connectivity resource in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='connectivity' \n      key='connectivity.connectivity-id = $tmp.aai.connectivityA.connectivity-id'>\n<parameter name='connectivity-id' value='`$tmp.aai.connectivityA.connectivity-id`' />\n<parameter name='operational-status' value='Activated' />\n",
        "comments": "",
        "outputs": 1,
        "x": 4715,
        "y": 774,
        "z": "8a9c455f.82beb8",
        "wires": [
            []
        ]
    },
    {
        "id": "75d6c996.11aeb",
        "type": "set",
        "name": "set pnf-name",
        "xml": "<set>\n<parameter name='tmp.src.domainA.pnf-name' value=\"`'networkId-providerId-' +\n                                                   $tmp.aai.vpn-bindingA.access-provider-id + '-clientId-' +\n                                                   $tmp.aai.vpn-bindingA.access-client-id + '-topologyId-' +\n                                                   $tmp.aai.vpn-bindingA.access-topology-id + '-nodeId-' +\n                                                   $tmp.aai.vpn-bindingA.src-access-node-id`\" />\n",
        "comments": "",
        "x": 3787,
        "y": 239,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "c824ab5b.360f6",
        "type": "get-resource",
        "name": "get-resource src pnf",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"pnf\" \n\t\tkey=\"pnf.pnf-name = $tmp.src.domainA.pnf-name\"\n        pfx='tmp.aai.source-pnf' local-only='false' >\n\n        <!--AND depth = '0'\"-->\n",
        "comments": "",
        "outputs": 1,
        "x": 3813,
        "y": 356,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "19cd8085.d8fca7",
                "ff1311fc.28b29",
                "929f1027.4a5828"
            ]
        ]
    },
    {
        "id": "19cd8085.d8fca7",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4008.5001220703125,
        "y": 308,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "a2185ea8.7f403"
            ]
        ]
    },
    {
        "id": "ff1311fc.28b29",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4000.5001220703125,
        "y": 363,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "c3cea897.f88808"
            ]
        ]
    },
    {
        "id": "a2185ea8.7f403",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 4152.8824462890625,
        "y": 307.6556701660156,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "eb7f6fc2.5f3468"
            ]
        ]
    },
    {
        "id": "a0fa7da8.75192",
        "type": "outcome",
        "name": "esr-thirdparty-sdnc",
        "xml": "<outcome value='esr-thirdparty-sdnc'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4735,
        "y": 310,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "809287e6.83f07"
            ]
        ]
    },
    {
        "id": "eb7f6fc2.5f3468",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for silentFailure='true' index='spvidx' start='0' end='`$tmp.aai.source-pnf.relationship-list.relationship_length`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 4337,
        "y": 306,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "21971ee2.f88962"
            ]
        ]
    },
    {
        "id": "21971ee2.f88962",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.aai.source-pnf.relationship-list.relationship[$spvidx].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4532,
        "y": 306,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "a0fa7da8.75192"
            ]
        ]
    },
    {
        "id": "929f1027.4a5828",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4005.5001220703125,
        "y": 420,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "5ece63ab.72534c"
            ]
        ]
    },
    {
        "id": "5ece63ab.72534c",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 4157.5001220703125,
        "y": 421,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "c3cea897.f88808",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 4168.5001220703125,
        "y": 364,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "fd9485b.71b4af8",
        "type": "execute",
        "name": "get esr-thirdparty-sdnc",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"esr-thirdparty-sdnc\" \n\t\tkey=\"esr-thirdparty-sdnc.thirdparty-sdnc-id = $tmp.domainA.esr-thirdparty-id AND \n\t\t     depth = '1'\"\n        pfx='tmp.aai.domainA.esr-thirdparty-sdnc' local-only='false' >",
        "comments": "",
        "outputs": 1,
        "x": 5120,
        "y": 323,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "12fe3fd6.ccef78",
                "5cf62e0d.6aa85",
                "156d902b.c3731"
            ]
        ]
    },
    {
        "id": "809287e6.83f07",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 4914,
        "y": 310,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "a1955015.d4546",
                "fd9485b.71b4af8"
            ]
        ]
    },
    {
        "id": "a1955015.d4546",
        "type": "set",
        "name": "set esr-thirdparty-sdnc domainA id",
        "xml": "<set>\n<parameter name='tmp.domainA.esr-thirdparty-id' value=\"`$tmp.aai.source-pnf.relationship-list.relationship[$spvidx].relationship-data[0].relationship-value`\" />\n",
        "comments": "",
        "x": 5150,
        "y": 271,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "12fe3fd6.ccef78",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5330,
        "y": 314,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "cc3a75a4.21fc7"
            ]
        ]
    },
    {
        "id": "5cf62e0d.6aa85",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5322,
        "y": 369,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "bff3bfa.5f55cc"
            ]
        ]
    },
    {
        "id": "156d902b.c3731",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5327,
        "y": 426,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "be590afe.7cc5a8"
            ]
        ]
    },
    {
        "id": "be590afe.7cc5a8",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 5479,
        "y": 427,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "bff3bfa.5f55cc",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 5490,
        "y": 372,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "cc3a75a4.21fc7",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 5474.38232421875,
        "y": 311.6556701660156,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "665ad654.79ee8"
            ]
        ]
    },
    {
        "id": "665ad654.79ee8",
        "type": "set",
        "name": "set controller domainA data",
        "xml": "<set>\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainA.url' value=\"`$tmp.aai.domainA.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].service-url`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainA.user' value=\"`$tmp.aai.domainA.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].user-name`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainA.password' value=\"`$tmp.aai.domainA.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].password`\" />\n\n\n<!--<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >-->\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/restconf/data/ietf-network:networks'`\" />-->\n<!--<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />-->\n<!--<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />-->\n<!--<parameter name=\"format\" value=\"json\"/>-->\n<!--<parameter name=\"httpMethod\" value=\"get\"/>-->\n<!--<parameter name=\"responsePrefix\" value=\"topology\"/>-->\n<!--<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>-->\n<!--<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>-->\n<!--<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>-->\n<!--<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>-->\n",
        "comments": "",
        "x": 5689,
        "y": 308,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "e86e6571.913898",
        "type": "execute",
        "name": "execute properties",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.prop.PropertiesNode' method='readProperties' >\n    <parameter name='fileName' value='%SDNC_CONFIG_DIR%/generic-resource-api-dg.properties' />\n    <parameter name='contextPrefix' value='prop' />",
        "comments": "",
        "outputs": 1,
        "x": 714,
        "y": 485,
        "z": "8a9c455f.82beb8",
        "wires": [
            []
        ]
    },
    {
        "id": "27bc86e9.1c4e52",
        "type": "set",
        "name": "set attachment_param for OTN B",
        "xml": "<set>\n<parameter name='src-node-id' value='`$tmp.aai.vpn-bindingB.src-access-node-id`' />\n<parameter name='dst-node-id' value='`$tmp.aai.vpn-bindingB.dst-access-node-id`' />\n<parameter name='src-tpn-id' value='1' />\n<parameter name='src-ttp-id' value='`$tmp.aai.vpn-bindingB.src-access-ltp-id`' />\n<parameter name='slice-instance-id' value='`$tmp.aai.service-instance.service-instance-id`' />\n<parameter name='otn-tunnel-name-dst-domain' value='`$tmp.aai.vpn-bindingB.vpn-name`' />\n<parameter name='client-id' value='`$tmp.aai.vpn-bindingB.access-client-id`' />\n<parameter name='provider-id' value='`$tmp.aai.vpn-bindingB.access-provider-id`' />\n<parameter name='topology-id' value='`$tmp.aai.vpn-bindingB.access-topology-id`' />\n",
        "comments": "",
        "x": 3829,
        "y": 995,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "f8350413.ea8398",
        "type": "execute",
        "name": "execute RestApiCallNode Create OTN tunnel with token",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.ts-otn-dst-domain-creation.templatefile`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainB.url + '/restconf/data/ietf-te:te'`\" />\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainB.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainB.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"patch\"/>\n<parameter name=\"responsePrefix\" value=\"otn-oof\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n<parameter name='customHttpHeaders' value=\"`'X-ACCESS-TOKEN=' + $prop.sdncRestApi.token_id`\" />",
        "comments": "",
        "outputs": 1,
        "x": 3892,
        "y": 1324,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "4e841df5.4d2d34",
                "5e6f0ddb.0967b4"
            ]
        ]
    },
    {
        "id": "4e841df5.4d2d34",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4187.5,
        "y": 1291,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "8fb2eae.74bbb98"
            ]
        ]
    },
    {
        "id": "5e6f0ddb.0967b4",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4192.5,
        "y": 1356,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "9fef13b3.660c58"
            ]
        ]
    },
    {
        "id": "8fb2eae.74bbb98",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create OTN tunnel rest api\" />\n",
        "comments": "",
        "x": 4355.5,
        "y": 1291,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "9fef13b3.660c58",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 4366,
        "y": 1356,
        "z": "8a9c455f.82beb8",
        "wires": [
            []
        ]
    },
    {
        "id": "2fd670.86d5219",
        "type": "set",
        "name": "set pnf-name",
        "xml": "<set>\n<parameter name='tmp.dst.domainB.pnf-name' value=\"`'networkId-providerId-' +\n                                                   $tmp.aai.vpn-bindingB.access-provider-id + '-clientId-' +\n                                                   $tmp.aai.vpn-bindingB.access-client-id + '-topologyId-' +\n                                                   $tmp.aai.vpn-bindingB.access-topology-id + '-nodeId-' +\n                                                   $tmp.aai.vpn-bindingB.dst-access-node-id`\" />\n",
        "comments": "",
        "x": 3768,
        "y": 1052,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "8581969f.3e9f8",
        "type": "get-resource",
        "name": "get-resource dst pnf",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"pnf\" \n\t\tkey=\"pnf.pnf-name = $tmp.dst.domainB.pnf-name\"\n        pfx='tmp.aai.destination-pnf' local-only='false' >\n\n        <!--AND depth = '0'\"-->\n",
        "comments": "",
        "outputs": 1,
        "x": 3788,
        "y": 1149,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "3c9a5980.f5df5e",
                "6737c173.340e3",
                "68a240da.0733"
            ]
        ]
    },
    {
        "id": "3c9a5980.f5df5e",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3990.5001220703125,
        "y": 1102,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "ea38c477.b7b2f"
            ]
        ]
    },
    {
        "id": "6737c173.340e3",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3982.5001220703125,
        "y": 1157,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "8bbc992f.718ea"
            ]
        ]
    },
    {
        "id": "ea38c477.b7b2f",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 4134.8824462890625,
        "y": 1099.6556701660156,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "18cecfe3.6de9e"
            ]
        ]
    },
    {
        "id": "18cecfe3.6de9e",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for silentFailure='true' index='dpvidx' start='0' end='`$tmp.aai.destination-pnf.relationship-list.relationship_length`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 4319,
        "y": 1114,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "68f9f038.67b62"
            ]
        ]
    },
    {
        "id": "68a240da.0733",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3987.5001220703125,
        "y": 1214,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "20686ade.8b231e"
            ]
        ]
    },
    {
        "id": "20686ade.8b231e",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 4139.5001220703125,
        "y": 1215,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "8bbc992f.718ea",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 4150.5001220703125,
        "y": 1160,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "597aa62c.50d3c",
        "type": "outcome",
        "name": "esr-thirdparty-sdnc",
        "xml": "<outcome value='esr-thirdparty-sdnc'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4717,
        "y": 1118,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "e04d6fa3.eba9f"
            ]
        ]
    },
    {
        "id": "68f9f038.67b62",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.aai.destination-pnf.relationship-list.relationship[$dpvidx].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4514,
        "y": 1114,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "597aa62c.50d3c"
            ]
        ]
    },
    {
        "id": "2f50548b.6d0f1c",
        "type": "execute",
        "name": "get esr-thirdparty-sdnc",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"esr-thirdparty-sdnc\" \n\t\tkey=\"esr-thirdparty-sdnc.thirdparty-sdnc-id = $tmp.domainB.esr-thirdparty-id AND \n\t\t     depth = '1'\"\n        pfx='tmp.aai.domainB.esr-thirdparty-sdnc' local-only='false' >",
        "comments": "",
        "outputs": 1,
        "x": 5102,
        "y": 1117,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "a769e440.df581",
                "a7207c49.d2bbc",
                "1e0583ed.3bab5c"
            ]
        ]
    },
    {
        "id": "e04d6fa3.eba9f",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 4894,
        "y": 1110,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "eacacb80.08d4c",
                "2f50548b.6d0f1c"
            ]
        ]
    },
    {
        "id": "eacacb80.08d4c",
        "type": "set",
        "name": "set esr-thirdparty-sdnc domainB id",
        "xml": "<set>\n<parameter name='tmp.domainB.esr-thirdparty-id' value=\"`$tmp.aai.destination-pnf.relationship-list.relationship[$dpvidx].relationship-data[0].relationship-value`\" />\n",
        "comments": "",
        "x": 5132,
        "y": 1065,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "61827e75.b97ad8",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 5461,
        "y": 1221,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "b6c7c29b.5ee08",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 5472,
        "y": 1166,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "7c1b7b20.2d7bbc",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 5456.38232421875,
        "y": 1105.6556701660156,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "9190ad56.af3378"
            ]
        ]
    },
    {
        "id": "9190ad56.af3378",
        "type": "set",
        "name": "set controller domainB data",
        "xml": "<set>\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainB.url' value=\"`$tmp.aai.domainB.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].service-url`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainB.user' value=\"`$tmp.aai.domainB.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].user-name`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainB.password' value=\"`$tmp.aai.domainB.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].password`\" />\n\n\n<!--<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >-->\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/restconf/data/ietf-network:networks'`\" />-->\n<!--<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />-->\n<!--<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />-->\n<!--<parameter name=\"format\" value=\"json\"/>-->\n<!--<parameter name=\"httpMethod\" value=\"get\"/>-->\n<!--<parameter name=\"responsePrefix\" value=\"topology\"/>-->\n<!--<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>-->\n<!--<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>-->\n<!--<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>-->\n<!--<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>-->\n",
        "comments": "",
        "x": 5671,
        "y": 1102,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "a769e440.df581",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5312,
        "y": 1108,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "7c1b7b20.2d7bbc"
            ]
        ]
    },
    {
        "id": "a7207c49.d2bbc",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5304,
        "y": 1163,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "b6c7c29b.5ee08"
            ]
        ]
    },
    {
        "id": "1e0583ed.3bab5c",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5309,
        "y": 1220,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "61827e75.b97ad8"
            ]
        ]
    },
    {
        "id": "9174febc.b8b998",
        "type": "save",
        "name": "get connectivity from aai",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"connectivity\"\n\t    key=\"connectivity.connectivity-id = $tmp.aai.service-instance.relationship-list.relationship[$rel-index].relationship-data[0].relationship-value\"\n\t\tlocal-only=\"false\" \n\t\tpfx=\"tmp.aai.connectivity\" >\n",
        "comments": "",
        "outputs": 1,
        "x": 1826,
        "y": 474,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "c96ce0ff.9fbaf8",
                "96dddcba.eaaec8",
                "4ccaabcc.f5bb34"
            ]
        ]
    },
    {
        "id": "c96ce0ff.9fbaf8",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2034,
        "y": 438,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "5281d926.1c9dd"
            ]
        ]
    },
    {
        "id": "96dddcba.eaaec8",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2034.490966796875,
        "y": 483.57403564453125,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "50a19d40.768324"
            ]
        ]
    },
    {
        "id": "4ccaabcc.f5bb34",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2032,
        "y": 527,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "ffedf4ef.62de2"
            ]
        ]
    },
    {
        "id": "50a19d40.768324",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.l3vpn.pe1_id`\" />\n\n",
        "comments": "",
        "x": 2197.0623779296875,
        "y": 483.8597717285156,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "ffedf4ef.62de2",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
        "comments": "",
        "x": 2201,
        "y": 528,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "113dd07d.86f868",
        "type": "save",
        "name": "get vpn-binding from aai",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"vpn-binding\"\n\t    key=\"vpn-binding.vpn-id = $tmp.aai.connectivity.relationship-list.relationship[$cridx].relationship-data[0].relationship-value\"\n\t\tlocal-only=\"false\" \n\t\tpfx=\"tmp.aai.vpn-binding\" >\n",
        "comments": "",
        "outputs": 1,
        "x": 2507,
        "y": 527,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "2b6a4b71.479d3c",
                "34c32e6f.a9d052",
                "c2c66c33.7e24d"
            ]
        ]
    },
    {
        "id": "7a40580d.1d5388",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 2891,
        "y": 527,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "eeee2acf.9c0ba8",
                "57847c7b.2f3dbc"
            ]
        ]
    },
    {
        "id": "2b6a4b71.479d3c",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2718,
        "y": 529,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "7a40580d.1d5388"
            ]
        ]
    },
    {
        "id": "34c32e6f.a9d052",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2718.490966796875,
        "y": 574.5740356445312,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "17c937f3.281d28"
            ]
        ]
    },
    {
        "id": "c2c66c33.7e24d",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2716,
        "y": 618,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "45484d04.351e94"
            ]
        ]
    },
    {
        "id": "45484d04.351e94",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
        "comments": "",
        "x": 2883,
        "y": 617,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "17c937f3.281d28",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.l3vpn.pe1_id`\" />\n\n",
        "comments": "",
        "x": 2881.0623779296875,
        "y": 574.8597717285156,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "5281d926.1c9dd",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for silentFailure='true' index='cridx' start='0' end='`$tmp.aai.connectivity.relationship-list.relationship_length`' >\n\n",
        "comments": "",
        "outputs": 1,
        "x": 2235,
        "y": 433,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "24c8cf8c.d35f5"
            ]
        ]
    },
    {
        "id": "24c8cf8c.d35f5",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.aai.connectivity.relationship-list.relationship[$cridx].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2440,
        "y": 433,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "ffd8562e.6c7ab"
            ]
        ]
    },
    {
        "id": "ffd8562e.6c7ab",
        "type": "outcome",
        "name": "vpn-binding",
        "xml": "<outcome value='vpn-binding'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2606,
        "y": 433,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "1639e360.7db745"
            ]
        ]
    },
    {
        "id": "1639e360.7db745",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 2769,
        "y": 433,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "113dd07d.86f868",
                "b864657f.9c5a"
            ]
        ]
    },
    {
        "id": "eeee2acf.9c0ba8",
        "type": "switchNode",
        "name": "switch vpn-binding has dst-access-ltp",
        "xml": "<switch test='`$tmp.aai.vpn-binding.dst-access-ltp-id`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3145,
        "y": 526,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "888039c0.be2748",
                "40c5843d.11f78c"
            ]
        ]
    },
    {
        "id": "888039c0.be2748",
        "type": "outcome",
        "name": "Null",
        "xml": "<outcome value=''>\n",
        "comments": "",
        "outputs": 1,
        "x": 3398,
        "y": 560,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "d751d093.92a62"
            ]
        ]
    },
    {
        "id": "40c5843d.11f78c",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3398,
        "y": 504,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "ddefc1a3.6644c8"
            ]
        ]
    },
    {
        "id": "d751d093.92a62",
        "type": "switchNode",
        "name": "switch vpn-binding has src-access-ltp",
        "xml": "<switch test='`$tmp.aai.vpn-binding.src-access-ltp-id`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3137,
        "y": 1346,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "b9609f04.c7afe8",
                "28e97c84.2c5ab4"
            ]
        ]
    },
    {
        "id": "b9609f04.c7afe8",
        "type": "outcome",
        "name": "Null",
        "xml": "<outcome value=''>\n",
        "comments": "",
        "outputs": 1,
        "x": 3390,
        "y": 1380,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "ee3de09a.383318"
            ]
        ]
    },
    {
        "id": "28e97c84.2c5ab4",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3390,
        "y": 1324,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "b80c5827.1a79a"
            ]
        ]
    },
    {
        "id": "ee3de09a.383318",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
        "comments": "",
        "x": 3541,
        "y": 1380,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "8527e1fa.cc6b4",
        "type": "set",
        "name": "set vpn-bindingA and connectivityA",
        "xml": "<set>\n<parameter name='tmp.aai.vpn-bindingA.' value=\"`$tmp.aai.vpn-binding.`\" />\n<parameter name='tmp.aai.connectivityA.' value=\"`$tmp.aai.connectivity.`\" />\n",
        "comments": "",
        "x": 3844,
        "y": 131,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "615fdc8e.20c4e4",
        "type": "set",
        "name": "set vpn-bindingB and connectivityB",
        "xml": "<set>\n<parameter name='tmp.aai.vpn-bindingB.' value=\"`$tmp.aai.vpn-binding.`\" />\n<parameter name='tmp.aai.connectivityB.' value=\"`$tmp.aai.connectivity.`\" />\n\n",
        "comments": "",
        "x": 3825,
        "y": 937,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "ddefc1a3.6644c8",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 3566,
        "y": 506,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "8527e1fa.cc6b4",
                "25e7d332.a761fc",
                "75d6c996.11aeb",
                "c824ab5b.360f6",
                "a96cdedb.06ef48",
                "616c98c7.f82ea8",
                "fee47d9.4382e"
            ]
        ]
    },
    {
        "id": "b80c5827.1a79a",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 3541,
        "y": 1323,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "615fdc8e.20c4e4",
                "27bc86e9.1c4e52",
                "2fd670.86d5219",
                "8581969f.3e9f8",
                "f8350413.ea8398",
                "96b5aedc.4196d",
                "e2e659bb.42dea"
            ]
        ]
    },
    {
        "id": "96b5aedc.4196d",
        "type": "set",
        "name": "set sotn_value",
        "xml": "<set>\n<!--<parameter name='eth-service-name' value='`$tmp.aai.connectivityB.connectivity-id`' />-->\n<parameter name='eth-service-name' value='`$tmp.aai.connectivityB.etht-svc-name`' />\n<parameter name='slice-id' value='`$vnf-topology-operation-input.service-information.service-instance-id`' />\n<parameter name='provider-id' value='`$tmp.aai.connectivityB.access-provider-id`' />\n<parameter name='client-id' value='`$tmp.aai.connectivityB.access-client-id`' />\n<parameter name='topology-id' value='`$tmp.aai.connectivityB.access-topology-id`' />\n<parameter name='otn-tunnel-name' value='`$tmp.aai.vpn-bindingB.vpn-name`' />\n<parameter name='ethernet-end-point-name' value='`$tmp.aai.connectivityB.connectivity-id`' />\n<parameter name='index-number' value='0' />\n<parameter name='eth-node-id' value='`$tmp.aai.connectivityB.access-node-id`' />\n<parameter name='eth-node-tp-id' value='`$tmp.aai.connectivityB.access-ltp-id`' />\n<parameter name='CIR' value='`$tmp.aai.vpn-bindingB.route-distinguisher *1000000`' />\n<parameter name='EIR' value='`$tmp.aai.vpn-bindingB.route-distinguisher *1000000`' />\n",
        "comments": "",
        "x": 3770,
        "y": 1466,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "e2e659bb.42dea",
        "type": "execute",
        "name": "execute RestApiCallNode Create ethernet Service without token",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.ts-ethernet-service.templatefile`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainB.url + '/restconf/data/ietf-eth-tran-service:etht-svc'`\" />\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.restapi.connection-oof-url`\" />-->\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainB.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainB.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"patch\"/>\n<parameter name='dirPath' value=\"/opt/onap/sdnc/restconfapi/yang\" />\n<parameter name=\"responsePrefix\" value=\"vpn-result\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n",
        "comments": "",
        "outputs": 1,
        "x": 3924,
        "y": 1514,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "a28581db.fa7cb",
                "a3f78a52.db8928"
            ]
        ]
    },
    {
        "id": "a28581db.fa7cb",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4269.5,
        "y": 1495,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "14523534.ce6de3"
            ]
        ]
    },
    {
        "id": "a3f78a52.db8928",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4273.5,
        "y": 1535,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "2e9384b8.e29014"
            ]
        ]
    },
    {
        "id": "14523534.ce6de3",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create ethernet service rest api\" />\n",
        "comments": "",
        "x": 4427.5,
        "y": 1495,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "2e9384b8.e29014",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 4431,
        "y": 1535,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "b54e7482.e242c8",
                "df1f167a.857918"
            ]
        ]
    },
    {
        "id": "364ac531.cfcb5a",
        "type": "comment",
        "name": "TODO: FIXME:",
        "info": "put proper values based on connectivity resource retrieved from AAI",
        "comments": "",
        "x": 3767.5,
        "y": 1422,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "b54e7482.e242c8",
        "type": "save",
        "name": "update vpn-binding B resource (aka. OTN domainB) in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding' \n      key='vpn-binding.vpn-id = $tmp.aai.vpn-bindingB.vpn-id' >\n<parameter name='vpn-id' value='`$tmp.aai.vpn-bindingB.vpn-id`' />\n<parameter name='vpn-name' value='`$tmp.aai.vpn-bindingB.vpn-id`' />\n\n<parameter name='operational-status' value='Activated' />\n",
        "comments": "",
        "outputs": 1,
        "x": 4771,
        "y": 1534,
        "z": "8a9c455f.82beb8",
        "wires": [
            []
        ]
    },
    {
        "id": "68be1db9.7e03ec",
        "type": "comment",
        "name": "TODO: FIXME",
        "info": "use proper vpn-binding id and connectivity\n\nAlso, does CCSDK support \"update\" operation for vpn-binding and connectivity?",
        "comments": "",
        "x": 4629,
        "y": 1492,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "df1f167a.857918",
        "type": "save",
        "name": "update connectivity resource in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='connectivity' \n      key='connectivity.connectivity-id = $tmp.aai.connectivityB.connectivity-id'>\n<parameter name='connectivity-id' value='`$tmp.aai.connectivityB.connectivity-id`' />\n<parameter name='operational-status' value='Activated' />\n",
        "comments": "",
        "outputs": 1,
        "x": 4700,
        "y": 1583,
        "z": "8a9c455f.82beb8",
        "wires": [
            []
        ]
    },
    {
        "id": "57847c7b.2f3dbc",
        "type": "set",
        "name": "set attachment_param for OTN",
        "xml": "<set>\n<parameter name='gfp-n' value='`$tmp.aai.vpn-binding.route-distinguisher`' />\n",
        "comments": "",
        "x": 3132,
        "y": 432,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "b864657f.9c5a",
        "type": "set",
        "name": "unset tmp.aai.vpn-binding",
        "xml": "<set>\n<parameter name='tmp.aai.vpn-binding.' value='' />\n",
        "comments": "",
        "x": 2953,
        "y": 304,
        "z": "8a9c455f.82beb8",
        "wires": []
    }
]