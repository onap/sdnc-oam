[
    {
        "id": "8976bcf1.70ac48",
        "type": "dgstart",
        "name": "DGSTART",
        "outputs": 1,
        "x": 233.75,
        "y": 126.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "b1b89c9d.983348"
            ]
        ]
    },
    {
        "id": "b1b89c9d.983348",
        "type": "service-logic",
        "name": "GENERIC-RESOURCE-API ${project.version}",
        "module": "GENERIC-RESOURCE-API",
        "version": "${project.version}",
        "comments": "",
        "xml": "<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>",
        "outputs": 1,
        "x": 365.0356903076172,
        "y": 175.98810863494873,
        "z": "21b8a150.843866",
        "wires": [
            [
                "b0c84a88.7eefc"
            ]
        ]
    },
    {
        "id": "b0c84a88.7eefc",
        "type": "method",
        "name": "method tsli-vnf-topology-operation-trans-slice-activate",
        "xml": "<method rpc='tsli-vnf-topology-operation-trans-slice-activate' mode='sync'>\n",
        "comments": "",
        "outputs": 1,
        "x": 368.1786193847656,
        "y": 260.75003242492676,
        "z": "21b8a150.843866",
        "wires": [
            [
                "d31d270a.ac188"
            ]
        ]
    },
    {
        "id": "d31d270a.ac188",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 517.988037109375,
        "y": 390.4166564941406,
        "z": "21b8a150.843866",
        "wires": [
            [
                "67b5a6fb.99f89",
                "31666720.2f23b8",
                "1b5adc13.083b6c"
            ]
        ]
    },
    {
        "id": "67b5a6fb.99f89",
        "type": "returnSuccess",
        "name": "return success",
        "xml": "<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n",
        "comments": "",
        "x": 786.3216552734375,
        "y": 777.34716796875,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "1bac3f01.eca921",
        "type": "comment",
        "name": "new for TransportSlicing",
        "info": "",
        "comments": "",
        "x": 817.75,
        "y": 451.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "31666720.2f23b8",
        "type": "save",
        "name": "get service-instance from aai",
        "xml": "<!--<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" -->\n<!--\tresource=\"service-instance\"-->\n<!--\tkey='service-instance.service-instance-id = $service-data.vnfs.vnf[$tmp.vidx].vnf-data.service-information.service-instance-id-->\n<!--         AND customer.global-customer-id = $service-data.vnfs.vnf[$tmp.vidx].vnf-data.service-information.global-customer-id -->\n<!--         AND service-subscription.service-type = $service-data.vnfs.vnf[$tmp.vidx].vnf-data.service-information.subscription-service-type'-->\n<!--\tlocal-only=\"false\"-->\n<!--\tforce=\"true\" pfx=\"tmp.aai.service-instance\">-->\n\n<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"service-instance\"\n\tkey='service-instance.service-instance-id = $vnf-topology-operation-input.service-information.service-instance-id\n         AND customer.global-customer-id = $vnf-topology-operation-input.service-information.global-customer-id \n         AND service-subscription.service-type = $vnf-topology-operation-input.service-information.subscription-service-type'\n\tlocal-only=\"false\"\n\tforce=\"true\" pfx=\"tmp.aai.service-instance\">\n\n\n<!--$vnf-topology-operation-input.service-information.service-instance-id-->",
        "comments": "",
        "outputs": 1,
        "x": 837.75,
        "y": 547.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "963616f2.8f1aa8",
                "d3eed549.904728",
                "b7b5ac0a.4b96c"
            ]
        ]
    },
    {
        "id": "963616f2.8f1aa8",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1056.75,
        "y": 485.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "85a98f1d.b180e"
            ]
        ]
    },
    {
        "id": "d3eed549.904728",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1066.240966796875,
        "y": 528.3240356445312,
        "z": "21b8a150.843866",
        "wires": [
            [
                "bfe60f89.4e364"
            ]
        ]
    },
    {
        "id": "b7b5ac0a.4b96c",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1054.75,
        "y": 574.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "2df6c7e.346a038"
            ]
        ]
    },
    {
        "id": "bfe60f89.4e364",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.l3vpn.pe1_id`\" />\n\n",
        "comments": "",
        "x": 1219.8123779296875,
        "y": 531.6097717285156,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "2df6c7e.346a038",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
        "comments": "",
        "x": 1223.75,
        "y": 575.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "85a98f1d.b180e",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for index='rel-index' start='0' end='`$tmp.aai.service-instance.relationship-list.relationship_length`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 1253.75,
        "y": 481.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "58591981.123b78"
            ]
        ]
    },
    {
        "id": "58591981.123b78",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.aai.service-instance.relationship-list.relationship[$rel-index].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1477.08349609375,
        "y": 481.74993896484375,
        "z": "21b8a150.843866",
        "wires": [
            [
                "56e0d242.b4b17c"
            ]
        ]
    },
    {
        "id": "56e0d242.b4b17c",
        "type": "outcome",
        "name": "connectivity",
        "xml": "<outcome value='connectivity'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1677.7501335144043,
        "y": 482.75002098083496,
        "z": "21b8a150.843866",
        "wires": [
            [
                "463ca820.11cf78"
            ]
        ]
    },
    {
        "id": "bda858bd.a9d128",
        "type": "set",
        "name": "set attachment_param for OTN A",
        "xml": "<set>\n<parameter name='src-node-id' value='`$tmp.aai.vpn-bindingA.src-access-node-id`' />\n<parameter name='dst-node-id' value='`$tmp.aai.vpn-bindingA.dst-access-node-id`' />\n<!--<parameter name='dst-tpn-id' value='1' />-->\n<parameter name='dst-tpn-id' value='`$tmp.aai.vpn-bindingA.customer-vpn-id`' />\n<parameter name='dst-ttp-id' value='`$tmp.aai.vpn-bindingA.dst-access-ltp-id`' />\n<parameter name='slice-instance-id' value='`$tmp.aai.service-instance.service-instance-id`' />\n<parameter name='otn-tunnel-name-src-domain' value='`$tmp.aai.vpn-bindingA.vpn-name`' />\n<parameter name='client-id' value='`$tmp.aai.vpn-bindingA.access-client-id`' />\n<parameter name='provider-id' value='`$tmp.aai.vpn-bindingA.access-provider-id`' />\n<parameter name='topology-id' value='`$tmp.aai.vpn-bindingA.access-topology-id`' />\n",
        "comments": "",
        "x": 4496.75,
        "y": 198.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "be3c5cce.b55c98",
        "type": "execute",
        "name": "execute RestApiCallNode Create OTN tunnel with token",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.ts-otn-src-domain-creation.templatefile`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainA.url + '/restconf/data/ietf-te:te'`\" />\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainA.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainA.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"patch\"/>\n<parameter name=\"responsePrefix\" value=\"otn-oof\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n<parameter name='customHttpHeaders' value=\"`'X-ACCESS-TOKEN=' + $prop.sdncRestApi.token_id`\" />",
        "comments": "",
        "outputs": 1,
        "x": 4577.75,
        "y": 513.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "a29e7e17.b5f91",
                "3da90d10.f4de92"
            ]
        ]
    },
    {
        "id": "a29e7e17.b5f91",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4887.25,
        "y": 482.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "878c441e.87326"
            ]
        ]
    },
    {
        "id": "3da90d10.f4de92",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4892.25,
        "y": 547.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "d4311e2b.569f08"
            ]
        ]
    },
    {
        "id": "878c441e.87326",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create OTN tunnel rest api\" />\n",
        "comments": "",
        "x": 5063.25,
        "y": 482.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "d4311e2b.569f08",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 5058.75,
        "y": 547.75,
        "z": "21b8a150.843866",
        "wires": [
            []
        ]
    },
    {
        "id": "3e803655.1b101a",
        "type": "set",
        "name": "set sotn_value",
        "xml": "<set>\n<!--<parameter name='eth-service-name' value='`$tmp.aai.connectivityA.connectivity-id`' />-->\n<parameter name='eth-service-name' value='`$tmp.aai.connectivityA.etht-svc-name`' />\n<parameter name='slice-id' value='`$vnf-topology-operation-input.service-information.service-instance-id`' />\n<parameter name='provider-id' value='`$tmp.aai.connectivityA.access-provider-id`' />\n<parameter name='client-id' value='`$tmp.aai.connectivityA.access-client-id`' />\n<parameter name='topology-id' value='`$tmp.aai.connectivityA.access-topology-id`' />\n<parameter name='otn-tunnel-name' value='`$tmp.aai.vpn-bindingA.vpn-name`' />\n<parameter name='ethernet-end-point-name' value='`$tmp.aai.connectivityA.connectivity-id`' />\n<parameter name='index-number' value='0' />\n<parameter name='eth-node-id' value='`$tmp.aai.connectivityA.access-node-id`' />\n<parameter name='eth-node-tp-id' value='`$tmp.aai.connectivityA.access-ltp-id`' />\n<parameter name='CIR' value='`$tmp.aai.vpn-bindingA.route-distinguisher *1000000`' />\n<parameter name='EIR' value='`$tmp.aai.vpn-bindingA.route-distinguisher *1000000`' />\n<parameter name='cvlan' value='`$tmp.aai.connectivityA.cvlan`' />\n",
        "comments": "",
        "x": 4444.25,
        "y": 701.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "4c6ccd14.a8a574",
        "type": "execute",
        "name": "execute RestApiCallNode Create ethernet Service without token",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.ts-ethernet-service.templatefile`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainA.url + '/restconf/data/ietf-eth-tran-service:etht-svc'`\" />\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.restapi.connection-oof-url`\" />-->\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainA.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainA.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"patch\"/>\n<parameter name='dirPath' value=\"/opt/onap/sdnc/restconfapi/yang\" />\n<parameter name=\"responsePrefix\" value=\"vpn-result\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n",
        "comments": "",
        "outputs": 1,
        "x": 4598.25,
        "y": 749.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "276414cf.b4df2c",
                "64503714.72c7f8"
            ]
        ]
    },
    {
        "id": "276414cf.b4df2c",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4943.75,
        "y": 730.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "102e191c.056cc7"
            ]
        ]
    },
    {
        "id": "64503714.72c7f8",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4947.75,
        "y": 770.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "24862939.f8dc8e"
            ]
        ]
    },
    {
        "id": "102e191c.056cc7",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create ethernet service rest api\" />\n",
        "comments": "",
        "x": 5101.75,
        "y": 730.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "24862939.f8dc8e",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 5105.25,
        "y": 770.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "21b9b574.b5d392",
                "9fb31567.2a4df8",
                "88154427.646e5"
            ]
        ]
    },
    {
        "id": "a1a69def.dde488",
        "type": "comment",
        "name": "TODO: FIXME:",
        "info": "put proper values based on connectivity resource retrieved from AAI",
        "comments": "",
        "x": 4441.75,
        "y": 657.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "21b9b574.b5d392",
        "type": "save",
        "name": "update vpn-binding A resource (aka. OTN domainA) in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding' \n      key='vpn-binding.vpn-id = $tmp.aai.vpn-bindingA.vpn-id' >\n<parameter name='vpn-id' value='`$tmp.aai.vpn-bindingA.vpn-id`' />\n<parameter name='vpn-name' value='`$tmp.aai.vpn-bindingA.vpn-name`' />\n\n<parameter name='operational-status' value='Activated' />\n",
        "comments": "",
        "outputs": 1,
        "x": 5435.75,
        "y": 735.75,
        "z": "21b8a150.843866",
        "wires": [
            []
        ]
    },
    {
        "id": "88c6cc39.d0a418",
        "type": "comment",
        "name": "TODO: FIXME",
        "info": "use proper vpn-binding id and connectivity id\n\nAlso, does CCSDK support \"update\" operation for vpn-binding and connectivity?",
        "comments": "",
        "x": 5299.75,
        "y": 694.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "9fb31567.2a4df8",
        "type": "save",
        "name": "update connectivity resource in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='connectivity' \n      key='connectivity.connectivity-id = $tmp.aai.connectivityA.connectivity-id'>\n<parameter name='connectivity-id' value='`$tmp.aai.connectivityA.connectivity-id`' />\n<parameter name='operational-status' value='Activated' />\n",
        "comments": "",
        "outputs": 1,
        "x": 5362.75,
        "y": 781.75,
        "z": "21b8a150.843866",
        "wires": [
            []
        ]
    },
    {
        "id": "3c21bf12.e3cf58",
        "type": "set",
        "name": "set pnf-name",
        "xml": "<set>\n<parameter name='tmp.src.domainA.pnf-name' value=\"`'networkId-providerId-' +\n                                                   $tmp.aai.vpn-bindingA.access-provider-id + '-clientId-' +\n                                                   $tmp.aai.vpn-bindingA.access-client-id + '-topologyId-' +\n                                                   $tmp.aai.vpn-bindingA.access-topology-id + '-nodeId-' +\n                                                   $tmp.aai.vpn-bindingA.src-access-node-id`\" />\n",
        "comments": "",
        "x": 4434.75,
        "y": 246.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "70ce80db.d98e2",
        "type": "get-resource",
        "name": "get-resource src pnf",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"pnf\" \n\t\tkey=\"pnf.pnf-name = $tmp.src.domainA.pnf-name\"\n        pfx='tmp.aai.source-pnf' local-only='false' >\n\n        <!--AND depth = '0'\"-->\n",
        "comments": "",
        "outputs": 1,
        "x": 4460.75,
        "y": 363.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "cd855b12.4c7648",
                "e908220c.f2eba8",
                "9142c53.c51d0b8"
            ]
        ]
    },
    {
        "id": "cd855b12.4c7648",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4656.2501220703125,
        "y": 315.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "a4edf485.1b87b"
            ]
        ]
    },
    {
        "id": "e908220c.f2eba8",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4648.2501220703125,
        "y": 370.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "9b453a42.4c355"
            ]
        ]
    },
    {
        "id": "a4edf485.1b87b",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 4800.6324462890625,
        "y": 315.4056701660156,
        "z": "21b8a150.843866",
        "wires": [
            [
                "5c080425.067b9c"
            ]
        ]
    },
    {
        "id": "c0826996.0b6fb8",
        "type": "outcome",
        "name": "esr-thirdparty-sdnc",
        "xml": "<outcome value='esr-thirdparty-sdnc'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5382.75,
        "y": 317.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "2f8dc255.fe7e1e"
            ]
        ]
    },
    {
        "id": "5c080425.067b9c",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for silentFailure='true' index='spvidx' start='0' end='`$tmp.aai.source-pnf.relationship-list.relationship_length`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 4984.75,
        "y": 313.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "495e68aa.ac002"
            ]
        ]
    },
    {
        "id": "495e68aa.ac002",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.aai.source-pnf.relationship-list.relationship[$spvidx].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5179.75,
        "y": 313.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "c0826996.0b6fb8"
            ]
        ]
    },
    {
        "id": "9142c53.c51d0b8",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4653.2501220703125,
        "y": 427.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "9ce4b617.939088"
            ]
        ]
    },
    {
        "id": "9ce4b617.939088",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 4805.2501220703125,
        "y": 428.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "9b453a42.4c355",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 4816.2501220703125,
        "y": 371.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "e93c75e1.80ec18",
        "type": "execute",
        "name": "get esr-thirdparty-sdnc",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"esr-thirdparty-sdnc\" \n\t\tkey=\"esr-thirdparty-sdnc.thirdparty-sdnc-id = $tmp.domainA.esr-thirdparty-id AND \n\t\t     depth = '1'\"\n        pfx='tmp.aai.domainA.esr-thirdparty-sdnc' local-only='false' >",
        "comments": "",
        "outputs": 1,
        "x": 5767.75,
        "y": 330.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "31d08ad5.ae1df6",
                "38f9754c.f69992",
                "31e3f0ee.1be648"
            ]
        ]
    },
    {
        "id": "2f8dc255.fe7e1e",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 5561.75,
        "y": 317.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "35fe1089.09d838",
                "e93c75e1.80ec18"
            ]
        ]
    },
    {
        "id": "35fe1089.09d838",
        "type": "set",
        "name": "set esr-thirdparty-sdnc domainA id",
        "xml": "<set>\n<parameter name='tmp.domainA.esr-thirdparty-id' value=\"`$tmp.aai.source-pnf.relationship-list.relationship[$spvidx].relationship-data[0].relationship-value`\" />\n",
        "comments": "",
        "x": 5797.75,
        "y": 278.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "31d08ad5.ae1df6",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5977.75,
        "y": 321.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "dcbf70b.fe9e51"
            ]
        ]
    },
    {
        "id": "38f9754c.f69992",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5969.75,
        "y": 376.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "b70d6ea.910679"
            ]
        ]
    },
    {
        "id": "31e3f0ee.1be648",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5974.75,
        "y": 433.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "96cd1d2a.b041a"
            ]
        ]
    },
    {
        "id": "96cd1d2a.b041a",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 6126.75,
        "y": 434.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "b70d6ea.910679",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 6137.75,
        "y": 379.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "dcbf70b.fe9e51",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 6122.13232421875,
        "y": 319.4056701660156,
        "z": "21b8a150.843866",
        "wires": [
            [
                "b0be4e8c.83ee08"
            ]
        ]
    },
    {
        "id": "b0be4e8c.83ee08",
        "type": "set",
        "name": "set controller domainA data",
        "xml": "<set>\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainA.url' value=\"`$tmp.aai.domainA.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].service-url`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainA.user' value=\"`$tmp.aai.domainA.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].user-name`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainA.password' value=\"`$tmp.aai.domainA.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].password`\" />\n\n\n<!--<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >-->\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/restconf/data/ietf-network:networks'`\" />-->\n<!--<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />-->\n<!--<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />-->\n<!--<parameter name=\"format\" value=\"json\"/>-->\n<!--<parameter name=\"httpMethod\" value=\"get\"/>-->\n<!--<parameter name=\"responsePrefix\" value=\"topology\"/>-->\n<!--<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>-->\n<!--<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>-->\n<!--<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>-->\n<!--<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>-->\n",
        "comments": "",
        "x": 6336.75,
        "y": 315.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "1b5adc13.083b6c",
        "type": "execute",
        "name": "execute properties",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.prop.PropertiesNode' method='readProperties' >\n    <parameter name='fileName' value='%SDNC_CONFIG_DIR%/generic-resource-api-dg.properties' />\n    <parameter name='contextPrefix' value='prop' />",
        "comments": "",
        "outputs": 1,
        "x": 803.75,
        "y": 495.75,
        "z": "21b8a150.843866",
        "wires": [
            []
        ]
    },
    {
        "id": "321a405b.7459b8",
        "type": "set",
        "name": "set attachment_param for OTN B",
        "xml": "<set>\n<parameter name='src-node-id' value='`$tmp.aai.vpn-bindingB.src-access-node-id`' />\n<parameter name='dst-node-id' value='`$tmp.aai.vpn-bindingB.dst-access-node-id`' />\n<!--<parameter name='src-tpn-id' value='1' />-->\n<parameter name='src-tpn-id' value='`$tmp.aai.vpn-bindingB.customer-vpn-id`' />\n<parameter name='src-ttp-id' value='`$tmp.aai.vpn-bindingB.src-access-ltp-id`' />\n<parameter name='slice-instance-id' value='`$tmp.aai.service-instance.service-instance-id`' />\n<parameter name='otn-tunnel-name-dst-domain' value='`$tmp.aai.vpn-bindingB.vpn-name`' />\n<parameter name='client-id' value='`$tmp.aai.vpn-bindingB.access-client-id`' />\n<parameter name='provider-id' value='`$tmp.aai.vpn-bindingB.access-provider-id`' />\n<parameter name='topology-id' value='`$tmp.aai.vpn-bindingB.access-topology-id`' />\n",
        "comments": "",
        "x": 3903.75,
        "y": 1655.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "13cb6aa6.78d01d",
        "type": "execute",
        "name": "execute RestApiCallNode Create OTN tunnel with token",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.ts-otn-dst-domain-creation.templatefile`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainB.url + '/restconf/data/ietf-te:te'`\" />\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainB.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainB.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"patch\"/>\n<parameter name=\"responsePrefix\" value=\"otn-oof\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n<parameter name='customHttpHeaders' value=\"`'X-ACCESS-TOKEN=' + $prop.sdncRestApi.token_id`\" />",
        "comments": "",
        "outputs": 1,
        "x": 3966.75,
        "y": 1984.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "10d81799.8466e",
                "67bbae69.f0649"
            ]
        ]
    },
    {
        "id": "10d81799.8466e",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4262.25,
        "y": 1951.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "892eb025.ee91a8"
            ]
        ]
    },
    {
        "id": "67bbae69.f0649",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4267.25,
        "y": 2016.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "f603d29b.ff0438"
            ]
        ]
    },
    {
        "id": "892eb025.ee91a8",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create OTN tunnel rest api\" />\n",
        "comments": "",
        "x": 4430.25,
        "y": 1951.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "f603d29b.ff0438",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 4440.75,
        "y": 2016.75,
        "z": "21b8a150.843866",
        "wires": [
            []
        ]
    },
    {
        "id": "88f53e94.6d0a1",
        "type": "set",
        "name": "set pnf-name",
        "xml": "<set>\n<parameter name='tmp.dst.domainB.pnf-name' value=\"`'networkId-providerId-' +\n                                                   $tmp.aai.vpn-bindingB.access-provider-id + '-clientId-' +\n                                                   $tmp.aai.vpn-bindingB.access-client-id + '-topologyId-' +\n                                                   $tmp.aai.vpn-bindingB.access-topology-id + '-nodeId-' +\n                                                   $tmp.aai.vpn-bindingB.dst-access-node-id`\" />\n",
        "comments": "",
        "x": 3842.75,
        "y": 1712.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "3fa49f7e.accef8",
        "type": "get-resource",
        "name": "get-resource dst pnf",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"pnf\" \n\t\tkey=\"pnf.pnf-name = $tmp.dst.domainB.pnf-name\"\n        pfx='tmp.aai.destination-pnf' local-only='false' >\n\n        <!--AND depth = '0'\"-->\n",
        "comments": "",
        "outputs": 1,
        "x": 3862.75,
        "y": 1809.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "ebf12595.10e938",
                "efabfdfe.5ba96",
                "205446da.fa0a6a"
            ]
        ]
    },
    {
        "id": "ebf12595.10e938",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4065.2501220703125,
        "y": 1762.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "3bb96014.a51678"
            ]
        ]
    },
    {
        "id": "efabfdfe.5ba96",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4057.2501220703125,
        "y": 1817.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "6194e30c.a75eac"
            ]
        ]
    },
    {
        "id": "3bb96014.a51678",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 4209.6324462890625,
        "y": 1760.4056701660156,
        "z": "21b8a150.843866",
        "wires": [
            [
                "60e39d5f.e73f74"
            ]
        ]
    },
    {
        "id": "60e39d5f.e73f74",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for silentFailure='true' index='dpvidx' start='0' end='`$tmp.aai.destination-pnf.relationship-list.relationship_length`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 4393.75,
        "y": 1774.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "f8535a31.25ce18"
            ]
        ]
    },
    {
        "id": "205446da.fa0a6a",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4062.2501220703125,
        "y": 1874.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "126fd357.b0d735"
            ]
        ]
    },
    {
        "id": "126fd357.b0d735",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 4214.2501220703125,
        "y": 1875.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "6194e30c.a75eac",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 4225.2501220703125,
        "y": 1820.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "a4686eb2.3a15b8",
        "type": "outcome",
        "name": "esr-thirdparty-sdnc",
        "xml": "<outcome value='esr-thirdparty-sdnc'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4791.75,
        "y": 1778.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "dd82991b.5dd978"
            ]
        ]
    },
    {
        "id": "f8535a31.25ce18",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.aai.destination-pnf.relationship-list.relationship[$dpvidx].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4588.75,
        "y": 1774.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "a4686eb2.3a15b8"
            ]
        ]
    },
    {
        "id": "ad6998e4.c7769",
        "type": "execute",
        "name": "get esr-thirdparty-sdnc",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"esr-thirdparty-sdnc\" \n\t\tkey=\"esr-thirdparty-sdnc.thirdparty-sdnc-id = $tmp.domainB.esr-thirdparty-id AND \n\t\t     depth = '1'\"\n        pfx='tmp.aai.domainB.esr-thirdparty-sdnc' local-only='false' >",
        "comments": "",
        "outputs": 1,
        "x": 5176.75,
        "y": 1777.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "f50cc222.33dcd",
                "8488316b.70cb5",
                "804e8e55.127ce"
            ]
        ]
    },
    {
        "id": "dd82991b.5dd978",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 4968.75,
        "y": 1770.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "c219345a.333ee8",
                "ad6998e4.c7769"
            ]
        ]
    },
    {
        "id": "c219345a.333ee8",
        "type": "set",
        "name": "set esr-thirdparty-sdnc domainB id",
        "xml": "<set>\n<parameter name='tmp.domainB.esr-thirdparty-id' value=\"`$tmp.aai.destination-pnf.relationship-list.relationship[$dpvidx].relationship-data[0].relationship-value`\" />\n",
        "comments": "",
        "x": 5206.75,
        "y": 1725.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "5afc9335.91bec4",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 5535.75,
        "y": 1881.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "bba1d37e.3ac768",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 5546.75,
        "y": 1826.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "4872e24d.b18cd4",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 5531.13232421875,
        "y": 1766.4056701660156,
        "z": "21b8a150.843866",
        "wires": [
            [
                "4b7568ba.14d37"
            ]
        ]
    },
    {
        "id": "4b7568ba.14d37",
        "type": "set",
        "name": "set controller domainB data",
        "xml": "<set>\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainB.url' value=\"`$tmp.aai.domainB.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].service-url`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainB.user' value=\"`$tmp.aai.domainB.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].user-name`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainB.password' value=\"`$tmp.aai.domainB.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].password`\" />\n\n\n<!--<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >-->\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/restconf/data/ietf-network:networks'`\" />-->\n<!--<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />-->\n<!--<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />-->\n<!--<parameter name=\"format\" value=\"json\"/>-->\n<!--<parameter name=\"httpMethod\" value=\"get\"/>-->\n<!--<parameter name=\"responsePrefix\" value=\"topology\"/>-->\n<!--<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>-->\n<!--<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>-->\n<!--<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>-->\n<!--<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>-->\n",
        "comments": "",
        "x": 5745.75,
        "y": 1762.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "f50cc222.33dcd",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5386.75,
        "y": 1768.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "4872e24d.b18cd4"
            ]
        ]
    },
    {
        "id": "8488316b.70cb5",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5378.75,
        "y": 1823.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "bba1d37e.3ac768"
            ]
        ]
    },
    {
        "id": "804e8e55.127ce",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5383.75,
        "y": 1880.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "5afc9335.91bec4"
            ]
        ]
    },
    {
        "id": "463ca820.11cf78",
        "type": "save",
        "name": "get connectivity from aai",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"connectivity\"\n\t    key=\"connectivity.connectivity-id = $tmp.aai.service-instance.relationship-list.relationship[$rel-index].relationship-data[0].relationship-value\"\n\t\tlocal-only=\"false\" \n\t\tpfx=\"tmp.aai.connectivity\" >\n",
        "comments": "",
        "outputs": 1,
        "x": 1915.75,
        "y": 484.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "2eb4dc08.7f1c34",
                "fa210005.600e9",
                "cf2c914d.6b904"
            ]
        ]
    },
    {
        "id": "2eb4dc08.7f1c34",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2123.75,
        "y": 448.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "fdf5ae6d.1a01"
            ]
        ]
    },
    {
        "id": "fa210005.600e9",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2124.240966796875,
        "y": 494.32403564453125,
        "z": "21b8a150.843866",
        "wires": [
            [
                "f1f7e3b1.bd8ea8"
            ]
        ]
    },
    {
        "id": "cf2c914d.6b904",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2121.75,
        "y": 537.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "da54cf61.ae1b78"
            ]
        ]
    },
    {
        "id": "f1f7e3b1.bd8ea8",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.l3vpn.pe1_id`\" />\n\n",
        "comments": "",
        "x": 2286.8123779296875,
        "y": 494.6097717285156,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "da54cf61.ae1b78",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
        "comments": "",
        "x": 2290.75,
        "y": 538.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "7cc4f06d.7fdaa",
        "type": "save",
        "name": "get vpn-binding from aai",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"vpn-binding\"\n\t    key=\"vpn-binding.vpn-id = $tmp.aai.connectivity.relationship-list.relationship[$cridx].relationship-data[0].relationship-value\"\n\t\tlocal-only=\"false\" \n\t\tpfx=\"tmp.aai.vpn-binding\" >\n",
        "comments": "",
        "outputs": 1,
        "x": 2596.75,
        "y": 537.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "48c45912.635ab8",
                "a55b1245.6d5a98",
                "5114317.7fef9d"
            ]
        ]
    },
    {
        "id": "f222a91f.adc5a8",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 2976.75,
        "y": 625.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "941633f0.a03e2"
            ]
        ]
    },
    {
        "id": "48c45912.635ab8",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2807.75,
        "y": 626.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "f222a91f.adc5a8"
            ]
        ]
    },
    {
        "id": "a55b1245.6d5a98",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2810.240966796875,
        "y": 522.3240356445312,
        "z": "21b8a150.843866",
        "wires": [
            [
                "c2aa70b6.4baf8"
            ]
        ]
    },
    {
        "id": "5114317.7fef9d",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2805.75,
        "y": 566.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "3cb9370e.446c48"
            ]
        ]
    },
    {
        "id": "3cb9370e.446c48",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
        "comments": "",
        "x": 2973.75,
        "y": 566.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "c2aa70b6.4baf8",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.l3vpn.pe1_id`\" />\n\n",
        "comments": "",
        "x": 2972.8125,
        "y": 521.6097412109375,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "fdf5ae6d.1a01",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for silentFailure='true' index='cridx' start='0' end='`$tmp.aai.connectivity.relationship-list.relationship_length`' >\n\n",
        "comments": "",
        "outputs": 1,
        "x": 2324.75,
        "y": 443.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "de0f0110.005fa8"
            ]
        ]
    },
    {
        "id": "de0f0110.005fa8",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.aai.connectivity.relationship-list.relationship[$cridx].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2529.75,
        "y": 443.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "a755493f.53e5c"
            ]
        ]
    },
    {
        "id": "a755493f.53e5c",
        "type": "outcome",
        "name": "vpn-binding",
        "xml": "<outcome value='vpn-binding'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2695.75,
        "y": 443.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "30deb2e6.ddbdde"
            ]
        ]
    },
    {
        "id": "30deb2e6.ddbdde",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 2858.75,
        "y": 443.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "7cc4f06d.7fdaa",
                "5a3b76e5.927ca8"
            ]
        ]
    },
    {
        "id": "e892b304.06846",
        "type": "switchNode",
        "name": "switch vpn-binding has dst-access-ltp",
        "xml": "<switch test='`$tmp.aai.vpn-binding.dst-access-ltp-id`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3417.75,
        "y": 726.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "21602510.29ed62",
                "bcc4ade6.f232"
            ]
        ]
    },
    {
        "id": "21602510.29ed62",
        "type": "outcome",
        "name": "Null",
        "xml": "<outcome value=''>\n",
        "comments": "",
        "outputs": 1,
        "x": 3631.75,
        "y": 763.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "134315e7.fd7042"
            ]
        ]
    },
    {
        "id": "bcc4ade6.f232",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3633.75,
        "y": 701.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "3ace6707.d27cb8"
            ]
        ]
    },
    {
        "id": "134315e7.fd7042",
        "type": "switchNode",
        "name": "switch vpn-binding has src-access-ltp",
        "xml": "<switch test='`$tmp.aai.vpn-binding.src-access-ltp-id`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3211.75,
        "y": 2006.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "36f11901.c669fe",
                "3d3a4221.98f866"
            ]
        ]
    },
    {
        "id": "36f11901.c669fe",
        "type": "outcome",
        "name": "Null",
        "xml": "<outcome value=''>\n",
        "comments": "",
        "outputs": 1,
        "x": 3464.75,
        "y": 2040.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "861f9ff3.a542f8"
            ]
        ]
    },
    {
        "id": "3d3a4221.98f866",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3464.75,
        "y": 1984.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "cd34c51c.32ff6"
            ]
        ]
    },
    {
        "id": "861f9ff3.a542f8",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
        "comments": "",
        "x": 3615.75,
        "y": 2040.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "37ab634e.8eb82c",
        "type": "set",
        "name": "set vpn-bindingA and connectivityA",
        "xml": "<set>\n<parameter name='tmp.aai.vpn-bindingA.' value=\"`$tmp.aai.vpn-binding.`\" />\n<parameter name='tmp.aai.connectivityA.' value=\"`$tmp.aai.connectivity.`\" />\n",
        "comments": "",
        "x": 4491.75,
        "y": 138.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "e9288827.8d4e48",
        "type": "set",
        "name": "set vpn-bindingB and connectivityB",
        "xml": "<set>\n<parameter name='tmp.aai.vpn-bindingB.' value=\"`$tmp.aai.vpn-binding.`\" />\n<parameter name='tmp.aai.connectivityB.' value=\"`$tmp.aai.connectivity.`\" />\n\n",
        "comments": "",
        "x": 3899.75,
        "y": 1597.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "5833352c.36b4cc",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 4182.75,
        "y": 395.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "37ab634e.8eb82c",
                "bda858bd.a9d128",
                "3c21bf12.e3cf58",
                "70ce80db.d98e2",
                "3e803655.1b101a",
                "4c6ccd14.a8a574",
                "be3c5cce.b55c98"
            ]
        ]
    },
    {
        "id": "cd34c51c.32ff6",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 3615.75,
        "y": 1983.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "e9288827.8d4e48",
                "321a405b.7459b8",
                "88f53e94.6d0a1",
                "3fa49f7e.accef8",
                "13cb6aa6.78d01d",
                "6887177c.ca96",
                "4e3c7c24.641514"
            ]
        ]
    },
    {
        "id": "6887177c.ca96",
        "type": "set",
        "name": "set sotn_value",
        "xml": "<set>\n<!--<parameter name='eth-service-name' value='`$tmp.aai.connectivityB.connectivity-id`' />-->\n<parameter name='eth-service-name' value='`$tmp.aai.connectivityB.etht-svc-name`' />\n<parameter name='slice-id' value='`$vnf-topology-operation-input.service-information.service-instance-id`' />\n<parameter name='provider-id' value='`$tmp.aai.connectivityB.access-provider-id`' />\n<parameter name='client-id' value='`$tmp.aai.connectivityB.access-client-id`' />\n<parameter name='topology-id' value='`$tmp.aai.connectivityB.access-topology-id`' />\n<parameter name='otn-tunnel-name' value='`$tmp.aai.vpn-bindingB.vpn-name`' />\n<parameter name='ethernet-end-point-name' value='`$tmp.aai.connectivityB.connectivity-id`' />\n<parameter name='index-number' value='0' />\n<parameter name='eth-node-id' value='`$tmp.aai.connectivityB.access-node-id`' />\n<parameter name='eth-node-tp-id' value='`$tmp.aai.connectivityB.access-ltp-id`' />\n<parameter name='CIR' value='`$tmp.aai.vpn-bindingB.route-distinguisher *1000000`' />\n<parameter name='EIR' value='`$tmp.aai.vpn-bindingB.route-distinguisher *1000000`' />\n<parameter name='cvlan' value='`$tmp.aai.connectivityB.cvlan`' />\n\n",
        "comments": "",
        "x": 3844.75,
        "y": 2126.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "4e3c7c24.641514",
        "type": "execute",
        "name": "execute RestApiCallNode Create ethernet Service without token",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.ts-ethernet-service.templatefile`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainB.url + '/restconf/data/ietf-eth-tran-service:etht-svc'`\" />\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.restapi.connection-oof-url`\" />-->\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainB.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainB.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"patch\"/>\n<parameter name='dirPath' value=\"/opt/onap/sdnc/restconfapi/yang\" />\n<parameter name=\"responsePrefix\" value=\"vpn-result\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n",
        "comments": "",
        "outputs": 1,
        "x": 3998.75,
        "y": 2174.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "a995cca0.79095",
                "691eaa5b.460a8c"
            ]
        ]
    },
    {
        "id": "a995cca0.79095",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4344.25,
        "y": 2155.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "8dda8416.3500c"
            ]
        ]
    },
    {
        "id": "691eaa5b.460a8c",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4348.25,
        "y": 2195.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "12034c01.7a6e24"
            ]
        ]
    },
    {
        "id": "8dda8416.3500c",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create ethernet service rest api\" />\n",
        "comments": "",
        "x": 4502.25,
        "y": 2155.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "12034c01.7a6e24",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 4505.75,
        "y": 2195.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "7af02db5.1d648c",
                "7e35a72c.c5049",
                "ed48bc59.3a7d1"
            ]
        ]
    },
    {
        "id": "8f84b99e.0eac8",
        "type": "comment",
        "name": "TODO: FIXME:",
        "info": "put proper values based on connectivity resource retrieved from AAI",
        "comments": "",
        "x": 3842.25,
        "y": 2082.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "7af02db5.1d648c",
        "type": "save",
        "name": "update vpn-binding B resource (aka. OTN domainB) in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding' \n      key='vpn-binding.vpn-id = $tmp.aai.vpn-bindingB.vpn-id' >\n<parameter name='vpn-id' value='`$tmp.aai.vpn-bindingB.vpn-id`' />\n<parameter name='vpn-name' value='`$tmp.aai.vpn-bindingB.vpn-name`' />\n\n<parameter name='operational-status' value='Activated' />\n",
        "comments": "",
        "outputs": 1,
        "x": 4845.75,
        "y": 2194.75,
        "z": "21b8a150.843866",
        "wires": [
            []
        ]
    },
    {
        "id": "1abb03b6.c2733c",
        "type": "comment",
        "name": "TODO: FIXME",
        "info": "use proper vpn-binding id and connectivity\n\nAlso, does CCSDK support \"update\" operation for vpn-binding and connectivity?",
        "comments": "",
        "x": 4703.75,
        "y": 2152.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "7e35a72c.c5049",
        "type": "save",
        "name": "update connectivity resource in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='connectivity' \n      key='connectivity.connectivity-id = $tmp.aai.connectivityB.connectivity-id'>\n<parameter name='connectivity-id' value='`$tmp.aai.connectivityB.connectivity-id`' />\n<parameter name='operational-status' value='Activated' />\n",
        "comments": "",
        "outputs": 1,
        "x": 4774.75,
        "y": 2243.75,
        "z": "21b8a150.843866",
        "wires": [
            []
        ]
    },
    {
        "id": "7f9728ff.5a56d",
        "type": "set",
        "name": "set attachment_param (gfp-n) for OTN",
        "xml": "<set>\n<parameter name='gfp-n' value='`$tmp.aai.vpn-binding.route-distinguisher`' />\n",
        "comments": "",
        "x": 3408.75,
        "y": 666.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "5a3b76e5.927ca8",
        "type": "set",
        "name": "unset tmp.aai.vpn-binding",
        "xml": "<set>\n<parameter name='tmp.aai.vpn-binding.' value='' />\n",
        "comments": "",
        "x": 3042.75,
        "y": 314.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "5dc7fe07.3de0e",
        "type": "comment",
        "name": "only dst ttp exists. No src",
        "info": "",
        "comments": "",
        "x": 4003.75,
        "y": 352.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "95f7053c.6e7e8",
        "type": "comment",
        "name": "only src ttp exists. No dst",
        "info": "",
        "comments": "",
        "x": 3560.75,
        "y": 1930.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "3ace6707.d27cb8",
        "type": "switchNode",
        "name": "switch vpn-binding has src-access-ltp",
        "xml": "<switch test='`$tmp.aai.vpn-binding.src-access-ltp-id`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3739.75,
        "y": 514.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "784800ed.f5bf68",
                "38254c71.c979d4"
            ]
        ]
    },
    {
        "id": "38254c71.c979d4",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3981.75,
        "y": 1103.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "8cda2b7.f98f558"
            ]
        ]
    },
    {
        "id": "784800ed.f5bf68",
        "type": "outcome",
        "name": "Null",
        "xml": "<outcome value=''>\n",
        "comments": "",
        "outputs": 1,
        "x": 3975.75,
        "y": 394.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "5833352c.36b4cc"
            ]
        ]
    },
    {
        "id": "8cda2b7.f98f558",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 4139.75,
        "y": 1102.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "b7c2373e.9cd388",
                "147ed25c.bf0c96",
                "9a1eac1c.da1de8",
                "2922d6af.6c9642",
                "6061bd4e.a66dac"
            ]
        ]
    },
    {
        "id": "147ed25c.bf0c96",
        "type": "set",
        "name": "set attachment_param for OTN G",
        "xml": "<set>\n<parameter name='src-node-id' value='`$tmp.aai.vpn-bindingG.src-access-node-id`' />\n<parameter name='dst-node-id' value='`$tmp.aai.vpn-bindingG.dst-access-node-id`' />\n<!--<parameter name='dst-tpn-id' value='1' />-->\n<parameter name='src-tpn-id' value='`$tmp.aai.vpn-bindingG.customer-vpn-id`' />\n<parameter name='dst-tpn-id' value='`$tmp.aai.vpn-bindingG.customer-vpn-id`' />\n<parameter name='src-ttp-id' value='`$tmp.aai.vpn-bindingG.src-access-ltp-id`' />\n<parameter name='dst-ttp-id' value='`$tmp.aai.vpn-bindingG.dst-access-ltp-id`' />\n<parameter name='slice-instance-id' value='`$tmp.aai.service-instance.service-instance-id`' />\n<parameter name='otn-tunnel-name-domainG' value='`$tmp.aai.vpn-bindingG.vpn-name`' />\n<parameter name='client-id' value='`$tmp.aai.vpn-bindingG.access-client-id`' />\n<parameter name='provider-id' value='`$tmp.aai.vpn-bindingG.access-provider-id`' />\n<parameter name='topology-id' value='`$tmp.aai.vpn-bindingG.access-topology-id`' />\n",
        "comments": "",
        "x": 4403.75,
        "y": 985.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "6061bd4e.a66dac",
        "type": "execute",
        "name": "execute RestApiCallNode Create OTN tunnel with token",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.ts-otn-domainG-creation.templatefile`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainG.url + '/restconf/data/ietf-te:te'`\" />\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainG.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainG.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"patch\"/>\n<parameter name=\"responsePrefix\" value=\"otn-oof\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n<parameter name='customHttpHeaders' value=\"`'X-ACCESS-TOKEN=' + $prop.sdncRestApi.token_id`\" />",
        "comments": "",
        "outputs": 1,
        "x": 4484.75,
        "y": 1300.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "de634d2d.e7705",
                "961ea997.f45bc"
            ]
        ]
    },
    {
        "id": "de634d2d.e7705",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4794.25,
        "y": 1269.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "4e3f5895.525ca8"
            ]
        ]
    },
    {
        "id": "961ea997.f45bc",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4799.25,
        "y": 1334.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "8c3ef243.d5f688"
            ]
        ]
    },
    {
        "id": "4e3f5895.525ca8",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create OTN tunnel rest api\" />\n",
        "comments": "",
        "x": 4970.25,
        "y": 1269.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "8c3ef243.d5f688",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 4965.75,
        "y": 1334.75,
        "z": "21b8a150.843866",
        "wires": [
            []
        ]
    },
    {
        "id": "9a1eac1c.da1de8",
        "type": "set",
        "name": "set pnf-name",
        "xml": "<set>\n<parameter name='tmp.domainG.pnf-name' value=\"`'networkId-providerId-' +\n                                                   $tmp.aai.vpn-bindingG.access-provider-id + '-clientId-' +\n                                                   $tmp.aai.vpn-bindingG.access-client-id + '-topologyId-' +\n                                                   $tmp.aai.vpn-bindingG.access-topology-id + '-nodeId-' +\n                                                   $tmp.aai.vpn-bindingG.src-access-node-id`\" />\n",
        "comments": "",
        "x": 4341.75,
        "y": 1033.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "2922d6af.6c9642",
        "type": "get-resource",
        "name": "get-resource src pnf",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"pnf\" \n\t\tkey=\"pnf.pnf-name = $tmp.domainG.pnf-name\"\n        pfx='tmp.aai.domainG-pnf' local-only='false' >\n\n        <!--AND depth = '0'\"-->\n",
        "comments": "",
        "outputs": 1,
        "x": 4367.75,
        "y": 1150.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "7da6d8ec.042ad",
                "feb3e7e4.820368",
                "c44e5f71.e84558"
            ]
        ]
    },
    {
        "id": "7da6d8ec.042ad",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4563.2501220703125,
        "y": 1102.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "e38aeca.3dbc21"
            ]
        ]
    },
    {
        "id": "feb3e7e4.820368",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4555.2501220703125,
        "y": 1157.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "7637358b.a7e4fc"
            ]
        ]
    },
    {
        "id": "e38aeca.3dbc21",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 4707.6324462890625,
        "y": 1102.4056701660156,
        "z": "21b8a150.843866",
        "wires": [
            [
                "fc132576.25bf4"
            ]
        ]
    },
    {
        "id": "fc132576.25bf4",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for silentFailure='true' index='spvidx' start='0' end='`$tmp.aai.domainG-pnf.relationship-list.relationship_length`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 4891.75,
        "y": 1100.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "823913cb.fbad5"
            ]
        ]
    },
    {
        "id": "823913cb.fbad5",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.aai.domainG-pnf.relationship-list.relationship[$spvidx].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5086.75,
        "y": 1100.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "ac47c77.0d50538"
            ]
        ]
    },
    {
        "id": "c44e5f71.e84558",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4560.2501220703125,
        "y": 1214.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "e748e54c.7c4d78"
            ]
        ]
    },
    {
        "id": "e748e54c.7c4d78",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 4712.2501220703125,
        "y": 1215.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "7637358b.a7e4fc",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 4723.2501220703125,
        "y": 1158.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "b7c2373e.9cd388",
        "type": "set",
        "name": "set vpn-bindingG and connectivityG",
        "xml": "<set>\n<parameter name='tmp.aai.vpn-bindingG.' value=\"`$tmp.aai.vpn-binding.`\" />\n<parameter name='tmp.aai.connectivityG.' value=\"`$tmp.aai.connectivity.`\" />\n",
        "comments": "",
        "x": 4398.75,
        "y": 925.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "ac47c77.0d50538",
        "type": "outcome",
        "name": "esr-thirdparty-sdnc",
        "xml": "<outcome value='esr-thirdparty-sdnc'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5289.75,
        "y": 1104.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "ee4f92a0.59618"
            ]
        ]
    },
    {
        "id": "afac86b6.9de7f8",
        "type": "execute",
        "name": "get esr-thirdparty-sdnc",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"esr-thirdparty-sdnc\" \n\t\tkey=\"esr-thirdparty-sdnc.thirdparty-sdnc-id = $tmp.domainG.esr-thirdparty-id AND \n\t\t     depth = '1'\"\n        pfx='tmp.aai.domainG.esr-thirdparty-sdnc' local-only='false' >",
        "comments": "",
        "outputs": 1,
        "x": 5674.75,
        "y": 1117.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "25aa1b1d.6db59c",
                "a1092777.856c6",
                "2b2036c0.eb7f62"
            ]
        ]
    },
    {
        "id": "ee4f92a0.59618",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 5468.75,
        "y": 1104.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "e370a3c1.84639",
                "afac86b6.9de7f8"
            ]
        ]
    },
    {
        "id": "e370a3c1.84639",
        "type": "set",
        "name": "set esr-thirdparty-sdnc domainG id",
        "xml": "<set>\n<parameter name='tmp.domainG.esr-thirdparty-id' value=\"`$tmp.aai.domainG-pnf.relationship-list.relationship[$spvidx].relationship-data[0].relationship-value`\" />\n",
        "comments": "",
        "x": 5704.75,
        "y": 1065.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "25aa1b1d.6db59c",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5884.75,
        "y": 1108.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "345ab0d6.763128"
            ]
        ]
    },
    {
        "id": "a1092777.856c6",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5876.75,
        "y": 1163.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "42378f39.6fe7f"
            ]
        ]
    },
    {
        "id": "2b2036c0.eb7f62",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5881.75,
        "y": 1220.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "cd65837d.e470e"
            ]
        ]
    },
    {
        "id": "cd65837d.e470e",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 6033.75,
        "y": 1221.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "42378f39.6fe7f",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 6044.75,
        "y": 1166.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "345ab0d6.763128",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 6029.13232421875,
        "y": 1106.4056701660156,
        "z": "21b8a150.843866",
        "wires": [
            [
                "50b0a43e.7ed78c"
            ]
        ]
    },
    {
        "id": "50b0a43e.7ed78c",
        "type": "set",
        "name": "set controller domainG data",
        "xml": "<set>\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainG.url' value=\"`$tmp.aai.domainG.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].service-url`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainG.user' value=\"`$tmp.aai.domainG.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].user-name`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainG.password' value=\"`$tmp.aai.domainG.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].password`\" />\n\n\n<!--<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >-->\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/restconf/data/ietf-network:networks'`\" />-->\n<!--<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />-->\n<!--<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />-->\n<!--<parameter name=\"format\" value=\"json\"/>-->\n<!--<parameter name=\"httpMethod\" value=\"get\"/>-->\n<!--<parameter name=\"responsePrefix\" value=\"topology\"/>-->\n<!--<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>-->\n<!--<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>-->\n<!--<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>-->\n<!--<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>-->\n",
        "comments": "",
        "x": 6243.75,
        "y": 1102.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "73d673d.bf12a0c",
        "type": "comment",
        "name": "both src and dst exist",
        "info": "",
        "comments": "",
        "x": 4017.75,
        "y": 1043.75,
        "z": "21b8a150.843866",
        "wires": []
    },
    {
        "id": "941633f0.a03e2",
        "type": "switchNode",
        "name": "switch vpn-binding is not already Activated (i.e. is either Created or Modified)",
        "xml": "<switch test=\"`$tmp.aai.vpn-binding.operational-status != 'Activated' `\">\n",
        "comments": "",
        "outputs": 1,
        "x": 2579.75,
        "y": 770.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "cee45ed9.f16768",
                "eb58c452.cd625"
            ]
        ]
    },
    {
        "id": "eb58c452.cd625",
        "type": "outcomeFalse",
        "name": "false",
        "xml": "<outcome value='false'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2986.75,
        "y": 788.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "736cb25.e089b4c"
            ]
        ]
    },
    {
        "id": "cee45ed9.f16768",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2986.75,
        "y": 733.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "ba60006d.870c1"
            ]
        ]
    },
    {
        "id": "ba60006d.870c1",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 3142.75,
        "y": 731.75,
        "z": "21b8a150.843866",
        "wires": [
            [
                "7f9728ff.5a56d",
                "e892b304.06846"
            ]
        ]
    },
    {
        "id": "736cb25.e089b4c",
        "type": "block",
        "name": "block",
        "xml": "<block>",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 3119.75,
        "y": 789.75,
        "z": "21b8a150.843866",
        "wires": [
            []
        ]
    },
    {
        "id": "88154427.646e5",
        "type": "save",
        "name": "update service-instance resource in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='service-instance' \n      key='service-instance.service-instance-id = $vnf-topology-operation-input.service-information.service-instance-id\n         AND customer.global-customer-id = $vnf-topology-operation-input.service-information.global-customer-id \n         AND service-subscription.service-type = $vnf-topology-operation-input.service-information.subscription-service-type'>\n<parameter name='service-instance-id' value='`$tmp.aai.service-instance.service-instance-id`' />\n<parameter name='orchestration-status' value='Activated' />\n",
        "comments": "",
        "outputs": 1,
        "x": 5382.5,
        "y": 842.25,
        "z": "21b8a150.843866",
        "wires": [
            []
        ]
    },
    {
        "id": "ed48bc59.3a7d1",
        "type": "save",
        "name": "update service-instance resource in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='service-instance' \n      key='service-instance.service-instance-id = $vnf-topology-operation-input.service-information.service-instance-id\n         AND customer.global-customer-id = $vnf-topology-operation-input.service-information.global-customer-id \n         AND service-subscription.service-type = $vnf-topology-operation-input.service-information.subscription-service-type'>\n<parameter name='service-instance-id' value='`$tmp.aai.service-instance.service-instance-id`' />\n<parameter name='orchestration-status' value='Activated' />\n",
        "comments": "",
        "outputs": 1,
        "x": 4794.25,
        "y": 2310,
        "z": "21b8a150.843866",
        "wires": [
            []
        ]
    }
]