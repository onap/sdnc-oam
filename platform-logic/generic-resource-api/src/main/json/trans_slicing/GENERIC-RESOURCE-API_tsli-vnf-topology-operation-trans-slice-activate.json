[
    {
        "id": "d5615e24.a00ab8",
        "type": "dgstart",
        "name": "DGSTART",
        "outputs": 1,
        "x": 156,
        "y": 95,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "90741178.637a68"
            ]
        ]
    },
    {
        "id": "90741178.637a68",
        "type": "service-logic",
        "name": "GENERIC-RESOURCE-API ${project.version}",
        "module": "GENERIC-RESOURCE-API",
        "version": "${project.version}",
        "comments": "",
        "xml": "<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>",
        "outputs": 1,
        "x": 287.2856903076172,
        "y": 144.23810863494873,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "e9aee376.235818"
            ]
        ]
    },
    {
        "id": "e9aee376.235818",
        "type": "method",
        "name": "method tsli-vnf-topology-operation-trans-slice-activate",
        "xml": "<method rpc='tsli-vnf-topology-operation-trans-slice-activate' mode='sync'>\n",
        "comments": "",
        "outputs": 1,
        "x": 290.4286193847656,
        "y": 229.00003242492676,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "9c8b5d20.5b6ef8"
            ]
        ]
    },
    {
        "id": "9c8b5d20.5b6ef8",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 440.238037109375,
        "y": 358.6666564941406,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "f1c1dc9b.59851",
                "40fee6aa.417918",
                "a3f28ac6.d30ed8"
            ]
        ]
    },
    {
        "id": "f1c1dc9b.59851",
        "type": "returnSuccess",
        "name": "return success",
        "xml": "<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n",
        "comments": "",
        "x": 708.5716552734375,
        "y": 745.59716796875,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "e4fd4d94.2b8ec8",
        "type": "comment",
        "name": "new for TransportSlicing",
        "info": "",
        "comments": "",
        "x": 740,
        "y": 420,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "40fee6aa.417918",
        "type": "save",
        "name": "get service-instance from aai",
        "xml": "<!--<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" -->\n<!--\tresource=\"service-instance\"-->\n<!--\tkey='service-instance.service-instance-id = $service-data.vnfs.vnf[$tmp.vidx].vnf-data.service-information.service-instance-id-->\n<!--         AND customer.global-customer-id = $service-data.vnfs.vnf[$tmp.vidx].vnf-data.service-information.global-customer-id -->\n<!--         AND service-subscription.service-type = $service-data.vnfs.vnf[$tmp.vidx].vnf-data.service-information.subscription-service-type'-->\n<!--\tlocal-only=\"false\"-->\n<!--\tforce=\"true\" pfx=\"tmp.aai.service-instance\">-->\n\n<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"service-instance\"\n\tkey='service-instance.service-instance-id = $vnf-topology-operation-input.service-information.service-instance-id\n         AND customer.global-customer-id = $vnf-topology-operation-input.service-information.global-customer-id \n         AND service-subscription.service-type = $vnf-topology-operation-input.service-information.subscription-service-type'\n\tlocal-only=\"false\"\n\tforce=\"true\" pfx=\"tmp.aai.service-instance\">\n\n\n<!--$vnf-topology-operation-input.service-information.service-instance-id-->",
        "comments": "",
        "outputs": 1,
        "x": 760,
        "y": 516,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "15f2cda7.88709a",
                "187b249d.3c85cb",
                "c12e657e.e2c7f8"
            ]
        ]
    },
    {
        "id": "15f2cda7.88709a",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 979,
        "y": 454,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "56c6117d.ed7bc"
            ]
        ]
    },
    {
        "id": "187b249d.3c85cb",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 988.490966796875,
        "y": 496.57403564453125,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "dd3e3cac.482ca8"
            ]
        ]
    },
    {
        "id": "c12e657e.e2c7f8",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 977,
        "y": 543,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "d7bbbdd4.b85c7"
            ]
        ]
    },
    {
        "id": "dd3e3cac.482ca8",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.l3vpn.pe1_id`\" />\n\n",
        "comments": "",
        "x": 1142.0623779296875,
        "y": 499.8597717285156,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "d7bbbdd4.b85c7",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
        "comments": "",
        "x": 1146,
        "y": 544,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "56c6117d.ed7bc",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for index='rel-index' start='0' end='`$tmp.aai.service-instance.relationship-list.relationship_length`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 1176,
        "y": 450,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "68f0da0a.13a494"
            ]
        ]
    },
    {
        "id": "68f0da0a.13a494",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.aai.service-instance.relationship-list.relationship[$rel-index].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1399.33349609375,
        "y": 449.99993896484375,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "a37a9810.801788"
            ]
        ]
    },
    {
        "id": "a37a9810.801788",
        "type": "outcome",
        "name": "connectivity",
        "xml": "<outcome value='connectivity'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1600.0001335144043,
        "y": 451.00002098083496,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "2d3714db.b7aad4"
            ]
        ]
    },
    {
        "id": "3d56fd4f.8da4ea",
        "type": "set",
        "name": "set attachment_param for OTN A",
        "xml": "<set>\n<parameter name='src-node-id' value='`$tmp.aai.vpn-bindingA.src-access-node-id`' />\n<parameter name='dst-node-id' value='`$tmp.aai.vpn-bindingA.dst-access-node-id`' />\n<parameter name='dst-tpn-id' value='1' />\n<parameter name='dst-ttp-id' value='`$tmp.aai.vpn-bindingA.dst-access-ltp-id`' />\n<parameter name='slice-instance-id' value='`$tmp.aai.service-instance.service-instance-id`' />\n<parameter name='otn-tunnel-name-src-domain' value='`$tmp.aai.vpn-bindingA.vpn-name`' />\n<parameter name='client-id' value='`$tmp.aai.vpn-bindingA.access-client-id`' />\n<parameter name='provider-id' value='`$tmp.aai.vpn-bindingA.access-provider-id`' />\n<parameter name='topology-id' value='`$tmp.aai.vpn-bindingA.access-topology-id`' />\n",
        "comments": "",
        "x": 3861,
        "y": 170,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "119d7057.187e9",
        "type": "execute",
        "name": "execute RestApiCallNode Create OTN tunnel with token",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.ts-otn-src-domain-creation.templatefile`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainA.url + '/restconf/data/ietf-te:te'`\" />\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainA.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainA.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"patch\"/>\n<parameter name=\"responsePrefix\" value=\"otn-oof\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n<parameter name='customHttpHeaders' value=\"`'X-ACCESS-TOKEN=' + $prop.sdncRestApi.token_id`\" />",
        "comments": "",
        "outputs": 1,
        "x": 3942,
        "y": 485,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "a078109.a1f9bf",
                "c205f5c4.0bdb88"
            ]
        ]
    },
    {
        "id": "a078109.a1f9bf",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4251.5,
        "y": 454,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "3b38ca16.a7fb4e"
            ]
        ]
    },
    {
        "id": "c205f5c4.0bdb88",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4256.5,
        "y": 519,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "176e9242.258856"
            ]
        ]
    },
    {
        "id": "3b38ca16.a7fb4e",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create OTN tunnel rest api\" />\n",
        "comments": "",
        "x": 4427.5,
        "y": 454,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "176e9242.258856",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 4423,
        "y": 519,
        "z": "8a9c455f.82beb8",
        "wires": [
            []
        ]
    },
    {
        "id": "ab834e.f483fcb",
        "type": "set",
        "name": "set sotn_value",
        "xml": "<set>\n<parameter name='eth-service-name' value='`$tmp.aai.connectivityA.connectivity-id`' />\n<parameter name='provider-id' value='`$tmp.aai.connectivityA.access-provider-id`' />\n<parameter name='client-id' value='`$tmp.aai.connectivityA.access-client-id`' />\n<parameter name='topology-id' value='`$tmp.aai.connectivityA.access-topology-id`' />\n<parameter name='otn-tunnel-name' value='`$tmp.aai.vpn-bindingA.vpn-name`' />\n<parameter name='ethernet-end-point-name' value='`$tmp.aai.connectivityA.connectivity-id`' />\n<parameter name='index-number' value='0' />\n<parameter name='eth-node-id' value='`$tmp.aai.connectivityA.access-node-id`' />\n<parameter name='eth-node-tp-id' value='`$tmp.aai.connectivityA.access-ltp-id`' />\n",
        "comments": "",
        "x": 3808.5,
        "y": 673,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "c9d60073.e2df48",
        "type": "execute",
        "name": "execute RestApiCallNode Create ethernet Service without token",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.ts-ethernet-service.templatefile`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainA.url + '/restconf/data/ietf-eth-tran-service:etht-svc'`\" />\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.restapi.connection-oof-url`\" />-->\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainA.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainA.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"patch\"/>\n<parameter name='dirPath' value=\"/opt/onap/sdnc/restconfapi/yang\" />\n<parameter name=\"responsePrefix\" value=\"vpn-result\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n",
        "comments": "",
        "outputs": 1,
        "x": 3962.5,
        "y": 721,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "1e624148.f51b17",
                "9b38443d.36a338"
            ]
        ]
    },
    {
        "id": "1e624148.f51b17",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4308,
        "y": 702,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "20712318.8d32fc"
            ]
        ]
    },
    {
        "id": "9b38443d.36a338",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4312,
        "y": 742,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "a4fdbce9.b1c4"
            ]
        ]
    },
    {
        "id": "20712318.8d32fc",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create ethernet service rest api\" />\n",
        "comments": "",
        "x": 4466,
        "y": 702,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "a4fdbce9.b1c4",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 4469.5,
        "y": 742,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "f9579fb7.928158",
                "b5483433.ff3288"
            ]
        ]
    },
    {
        "id": "320ccbea.c02274",
        "type": "comment",
        "name": "TODO: FIXME:",
        "info": "put proper values based on connectivity resource retrieved from AAI",
        "comments": "",
        "x": 3806,
        "y": 629,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "f9579fb7.928158",
        "type": "save",
        "name": "update vpn-binding A resource (aka. OTN domainA) in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding' \n      key='vpn-binding.vpn-id = $tmp.aai.vpn-bindingA.vpn-id' >\n<parameter name='vpn-id' value='`$tmp.aai.vpn-bindingA.vpn-id`' />\n<parameter name='vpn-name' value='`$tmp.aai.vpn-bindingA.vpn-id`' />\n\n<parameter name='operational-status' value='Activated' />\n",
        "comments": "",
        "outputs": 1,
        "x": 4800,
        "y": 707,
        "z": "8a9c455f.82beb8",
        "wires": [
            []
        ]
    },
    {
        "id": "d3281524.0d8478",
        "type": "comment",
        "name": "TODO: FIXME",
        "info": "use proper vpn-binding id and connectivity id\n\nAlso, does CCSDK support \"update\" operation for vpn-binding and connectivity?",
        "comments": "",
        "x": 4664,
        "y": 666,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "b5483433.ff3288",
        "type": "save",
        "name": "update connectivity resource in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='connectivity' \n      key='connectivity.connectivity-id = $tmp.aai.connectivityA.connectivity-id'>\n<parameter name='connectivity-id' value='`$tmp.aai.connectivityA.connectivity-id`' />\n<parameter name='operational-status' value='Activated' />\n",
        "comments": "",
        "outputs": 1,
        "x": 4727,
        "y": 753,
        "z": "8a9c455f.82beb8",
        "wires": [
            []
        ]
    },
    {
        "id": "5074df67.2ba988",
        "type": "set",
        "name": "set pnf-name",
        "xml": "<set>\n<parameter name='tmp.src.domainA.pnf-name' value=\"`'networkId-providerId-' +\n                                                   $tmp.aai.vpn-bindingA.access-provider-id + '-clientId-' +\n                                                   $tmp.aai.vpn-bindingA.access-client-id + '-topologyId-' +\n                                                   $tmp.aai.vpn-bindingA.access-topology-id + '-nodeId-' +\n                                                   $tmp.aai.vpn-bindingA.src-access-node-id`\" />\n",
        "comments": "",
        "x": 3799,
        "y": 218,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "9fd13730.014208",
        "type": "get-resource",
        "name": "get-resource src pnf",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"pnf\" \n\t\tkey=\"pnf.pnf-name = $tmp.src.domainA.pnf-name\"\n        pfx='tmp.aai.source-pnf' local-only='false' >\n\n        <!--AND depth = '0'\"-->\n",
        "comments": "",
        "outputs": 1,
        "x": 3825,
        "y": 335,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "e11a5ea7.685f28",
                "6cb0b7a8.80c24",
                "a90c44f8.bdb148"
            ]
        ]
    },
    {
        "id": "e11a5ea7.685f28",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4020.5001220703125,
        "y": 287,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "dfb8903c.c1b1d8"
            ]
        ]
    },
    {
        "id": "6cb0b7a8.80c24",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4012.5001220703125,
        "y": 342,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "509847ff.264c58"
            ]
        ]
    },
    {
        "id": "dfb8903c.c1b1d8",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 4164.8824462890625,
        "y": 286.6556701660156,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "22c6d630.71326a"
            ]
        ]
    },
    {
        "id": "5e775dc4.42bfbc",
        "type": "outcome",
        "name": "esr-thirdparty-sdnc",
        "xml": "<outcome value='esr-thirdparty-sdnc'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4747,
        "y": 289,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "f76a815f.36c178"
            ]
        ]
    },
    {
        "id": "22c6d630.71326a",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for silentFailure='true' index='spvidx' start='0' end='`$tmp.aai.source-pnf.relationship-list.relationship_length`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 4349,
        "y": 285,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "a3e1c0eb.9f5f88"
            ]
        ]
    },
    {
        "id": "a3e1c0eb.9f5f88",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.aai.source-pnf.relationship-list.relationship[$spvidx].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4544,
        "y": 285,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "5e775dc4.42bfbc"
            ]
        ]
    },
    {
        "id": "a90c44f8.bdb148",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4017.5001220703125,
        "y": 399,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "7a5f3123.aad6e8"
            ]
        ]
    },
    {
        "id": "7a5f3123.aad6e8",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 4169.5001220703125,
        "y": 400,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "509847ff.264c58",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 4180.5001220703125,
        "y": 343,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "4ab5c9a1.06e3f",
        "type": "execute",
        "name": "get esr-thirdparty-sdnc",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"esr-thirdparty-sdnc\" \n\t\tkey=\"esr-thirdparty-sdnc.thirdparty-sdnc-id = $tmp.domainA.esr-thirdparty-id AND \n\t\t     depth = '1'\"\n        pfx='tmp.aai.domainA.esr-thirdparty-sdnc' local-only='false' >",
        "comments": "",
        "outputs": 1,
        "x": 5132,
        "y": 302,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "73f9ea02.2fb1e4",
                "f8008145.65a48",
                "81ec8b7a.5856d8"
            ]
        ]
    },
    {
        "id": "f76a815f.36c178",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 4926,
        "y": 289,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "ba856b81.43ed78",
                "4ab5c9a1.06e3f"
            ]
        ]
    },
    {
        "id": "ba856b81.43ed78",
        "type": "set",
        "name": "set esr-thirdparty-sdnc domainA id",
        "xml": "<set>\n<parameter name='tmp.domainA.esr-thirdparty-id' value=\"`$tmp.aai.source-pnf.relationship-list.relationship[$spvidx].relationship-data[0].relationship-value`\" />\n",
        "comments": "",
        "x": 5162,
        "y": 250,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "73f9ea02.2fb1e4",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5342,
        "y": 293,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "5955dc9c.10f754"
            ]
        ]
    },
    {
        "id": "f8008145.65a48",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5334,
        "y": 348,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "e3286b6.68c7618"
            ]
        ]
    },
    {
        "id": "81ec8b7a.5856d8",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5339,
        "y": 405,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "ecd34f94.c447e"
            ]
        ]
    },
    {
        "id": "ecd34f94.c447e",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 5491,
        "y": 406,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "e3286b6.68c7618",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 5502,
        "y": 351,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "5955dc9c.10f754",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 5486.38232421875,
        "y": 290.6556701660156,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "adf5d068.f7cc"
            ]
        ]
    },
    {
        "id": "adf5d068.f7cc",
        "type": "set",
        "name": "set controller domainA data",
        "xml": "<set>\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainA.url' value=\"`$tmp.aai.domainA.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].service-url`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainA.user' value=\"`$tmp.aai.domainA.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].user-name`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainA.password' value=\"`$tmp.aai.domainA.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].password`\" />\n\n\n<!--<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >-->\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/restconf/data/ietf-network:networks'`\" />-->\n<!--<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />-->\n<!--<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />-->\n<!--<parameter name=\"format\" value=\"json\"/>-->\n<!--<parameter name=\"httpMethod\" value=\"get\"/>-->\n<!--<parameter name=\"responsePrefix\" value=\"topology\"/>-->\n<!--<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>-->\n<!--<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>-->\n<!--<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>-->\n<!--<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>-->\n",
        "comments": "",
        "x": 5701,
        "y": 287,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "a3f28ac6.d30ed8",
        "type": "execute",
        "name": "execute properties",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.prop.PropertiesNode' method='readProperties' >\n    <parameter name='fileName' value='%SDNC_CONFIG_DIR%/generic-resource-api-dg.properties' />\n    <parameter name='contextPrefix' value='prop' />",
        "comments": "",
        "outputs": 1,
        "x": 726,
        "y": 464,
        "z": "8a9c455f.82beb8",
        "wires": [
            []
        ]
    },
    {
        "id": "b8f0eb5.a171218",
        "type": "set",
        "name": "set attachment_param for OTN B",
        "xml": "<set>\n<parameter name='src-node-id' value='`$tmp.aai.vpn-bindingB.src-access-node-id`' />\n<parameter name='dst-node-id' value='`$tmp.aai.vpn-bindingB.dst-access-node-id`' />\n<parameter name='src-tpn-id' value='1' />\n<parameter name='src-ttp-id' value='`$tmp.aai.vpn-bindingB.src-access-ltp-id`' />\n<parameter name='slice-instance-id' value='`$tmp.aai.service-instance.service-instance-id`' />\n<parameter name='otn-tunnel-name-dst-domain' value='`$tmp.aai.vpn-bindingB.vpn-name`' />\n<parameter name='client-id' value='`$tmp.aai.vpn-bindingB.access-client-id`' />\n<parameter name='provider-id' value='`$tmp.aai.vpn-bindingB.access-provider-id`' />\n<parameter name='topology-id' value='`$tmp.aai.vpn-bindingB.access-topology-id`' />\n",
        "comments": "",
        "x": 3841,
        "y": 974,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "d94b849.7fdac78",
        "type": "execute",
        "name": "execute RestApiCallNode Create OTN tunnel with token",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.ts-otn-dst-domain-creation.templatefile`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainB.url + '/restconf/data/ietf-te:te'`\" />\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainB.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainB.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"patch\"/>\n<parameter name=\"responsePrefix\" value=\"otn-oof\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n<parameter name='customHttpHeaders' value=\"`'X-ACCESS-TOKEN=' + $prop.sdncRestApi.token_id`\" />",
        "comments": "",
        "outputs": 1,
        "x": 3904,
        "y": 1303,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "bfb79ead.715e28",
                "d50b4560.d85de8"
            ]
        ]
    },
    {
        "id": "bfb79ead.715e28",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4199.5,
        "y": 1270,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "3d3c3af3.12a3b6"
            ]
        ]
    },
    {
        "id": "d50b4560.d85de8",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4204.5,
        "y": 1335,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "347f5539.8f6cd2"
            ]
        ]
    },
    {
        "id": "3d3c3af3.12a3b6",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create OTN tunnel rest api\" />\n",
        "comments": "",
        "x": 4367.5,
        "y": 1270,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "347f5539.8f6cd2",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 4378,
        "y": 1335,
        "z": "8a9c455f.82beb8",
        "wires": [
            []
        ]
    },
    {
        "id": "7af2004a.23f66",
        "type": "set",
        "name": "set pnf-name",
        "xml": "<set>\n<parameter name='tmp.dst.domainB.pnf-name' value=\"`'networkId-providerId-' +\n                                                   $tmp.aai.vpn-bindingB.access-provider-id + '-clientId-' +\n                                                   $tmp.aai.vpn-bindingB.access-client-id + '-topologyId-' +\n                                                   $tmp.aai.vpn-bindingB.access-topology-id + '-nodeId-' +\n                                                   $tmp.aai.vpn-bindingB.dst-access-node-id`\" />\n",
        "comments": "",
        "x": 3780,
        "y": 1031,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "9e8fb92f.dc9c38",
        "type": "get-resource",
        "name": "get-resource dst pnf",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"pnf\" \n\t\tkey=\"pnf.pnf-name = $tmp.dst.domainB.pnf-name\"\n        pfx='tmp.aai.destination-pnf' local-only='false' >\n\n        <!--AND depth = '0'\"-->\n",
        "comments": "",
        "outputs": 1,
        "x": 3800,
        "y": 1128,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "3defc723.7feba8",
                "92e9e56.6323798",
                "92430372.354f08"
            ]
        ]
    },
    {
        "id": "3defc723.7feba8",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4002.5001220703125,
        "y": 1081,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "38216362.304eb4"
            ]
        ]
    },
    {
        "id": "92e9e56.6323798",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3994.5001220703125,
        "y": 1136,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "48eafe9b.93564"
            ]
        ]
    },
    {
        "id": "38216362.304eb4",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 4146.8824462890625,
        "y": 1078.6556701660156,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "5738b986.eff058"
            ]
        ]
    },
    {
        "id": "5738b986.eff058",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for silentFailure='true' index='dpvidx' start='0' end='`$tmp.aai.destination-pnf.relationship-list.relationship_length`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 4331,
        "y": 1093,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "424cd2de.fa894c"
            ]
        ]
    },
    {
        "id": "92430372.354f08",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3999.5001220703125,
        "y": 1193,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "93dd1d01.b545d"
            ]
        ]
    },
    {
        "id": "93dd1d01.b545d",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 4151.5001220703125,
        "y": 1194,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "48eafe9b.93564",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 4162.5001220703125,
        "y": 1139,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "38af15c1.7d84ba",
        "type": "outcome",
        "name": "esr-thirdparty-sdnc",
        "xml": "<outcome value='esr-thirdparty-sdnc'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4729,
        "y": 1097,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "d8eb3cd4.227208"
            ]
        ]
    },
    {
        "id": "424cd2de.fa894c",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.aai.destination-pnf.relationship-list.relationship[$dpvidx].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4526,
        "y": 1093,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "38af15c1.7d84ba"
            ]
        ]
    },
    {
        "id": "a9c07a83.518f98",
        "type": "execute",
        "name": "get esr-thirdparty-sdnc",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"esr-thirdparty-sdnc\" \n\t\tkey=\"esr-thirdparty-sdnc.thirdparty-sdnc-id = $tmp.domainB.esr-thirdparty-id AND \n\t\t     depth = '1'\"\n        pfx='tmp.aai.domainB.esr-thirdparty-sdnc' local-only='false' >",
        "comments": "",
        "outputs": 1,
        "x": 5114,
        "y": 1096,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "ef0c3c57.987338",
                "56343453.6f0ce4",
                "3b68871e.15bfe"
            ]
        ]
    },
    {
        "id": "d8eb3cd4.227208",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 4906,
        "y": 1089,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "f04e0884.6fcbb8",
                "a9c07a83.518f98"
            ]
        ]
    },
    {
        "id": "f04e0884.6fcbb8",
        "type": "set",
        "name": "set esr-thirdparty-sdnc domainB id",
        "xml": "<set>\n<parameter name='tmp.domainB.esr-thirdparty-id' value=\"`$tmp.aai.destination-pnf.relationship-list.relationship[$dpvidx].relationship-data[0].relationship-value`\" />\n",
        "comments": "",
        "x": 5144,
        "y": 1044,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "b02d57da.181518",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 5473,
        "y": 1200,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "fed20348.5bb418",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 5484,
        "y": 1145,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "63aaed6a.7bdac4",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 5468.38232421875,
        "y": 1084.6556701660156,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "75824df.2d8fab4"
            ]
        ]
    },
    {
        "id": "75824df.2d8fab4",
        "type": "set",
        "name": "set controller domainB data",
        "xml": "<set>\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainB.url' value=\"`$tmp.aai.domainB.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].service-url`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainB.user' value=\"`$tmp.aai.domainB.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].user-name`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainB.password' value=\"`$tmp.aai.domainB.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].password`\" />\n\n\n<!--<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >-->\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/restconf/data/ietf-network:networks'`\" />-->\n<!--<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />-->\n<!--<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />-->\n<!--<parameter name=\"format\" value=\"json\"/>-->\n<!--<parameter name=\"httpMethod\" value=\"get\"/>-->\n<!--<parameter name=\"responsePrefix\" value=\"topology\"/>-->\n<!--<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>-->\n<!--<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>-->\n<!--<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>-->\n<!--<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>-->\n",
        "comments": "",
        "x": 5683,
        "y": 1081,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "ef0c3c57.987338",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5324,
        "y": 1087,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "63aaed6a.7bdac4"
            ]
        ]
    },
    {
        "id": "56343453.6f0ce4",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5316,
        "y": 1142,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "fed20348.5bb418"
            ]
        ]
    },
    {
        "id": "3b68871e.15bfe",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5321,
        "y": 1199,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "b02d57da.181518"
            ]
        ]
    },
    {
        "id": "2d3714db.b7aad4",
        "type": "save",
        "name": "get connectivity from aai",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"connectivity\"\n\t    key=\"connectivity.connectivity-id = $tmp.aai.service-instance.relationship-list.relationship[$rel-index].relationship-data[0].relationship-value\"\n\t\tlocal-only=\"false\" \n\t\tpfx=\"tmp.aai.connectivity\" >\n",
        "comments": "",
        "outputs": 1,
        "x": 1838,
        "y": 453,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "ff6cd3bd.d426f",
                "64ede831.c277d",
                "c3e64c55.d790f8"
            ]
        ]
    },
    {
        "id": "ff6cd3bd.d426f",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2046,
        "y": 417,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "ab398477.a58648"
            ]
        ]
    },
    {
        "id": "64ede831.c277d",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2046.490966796875,
        "y": 462.57403564453125,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "575d4e0a.5d761"
            ]
        ]
    },
    {
        "id": "c3e64c55.d790f8",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2044,
        "y": 506,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "b99b7bb3.94d958"
            ]
        ]
    },
    {
        "id": "575d4e0a.5d761",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.l3vpn.pe1_id`\" />\n\n",
        "comments": "",
        "x": 2209.0623779296875,
        "y": 462.8597717285156,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "b99b7bb3.94d958",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
        "comments": "",
        "x": 2213,
        "y": 507,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "684f9a1f.f6246c",
        "type": "save",
        "name": "get vpn-binding from aai",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"vpn-binding\"\n\t    key=\"vpn-binding.vpn-id = $tmp.aai.connectivity.relationship-list.relationship[$cridx].relationship-data[0].relationship-value\"\n\t\tlocal-only=\"false\" \n\t\tpfx=\"tmp.aai.vpn-binding\" >\n",
        "comments": "",
        "outputs": 1,
        "x": 2519,
        "y": 506,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "7a997c1a.ca4d0c",
                "5d76d89f.d221e",
                "d47edd7.a73b9a"
            ]
        ]
    },
    {
        "id": "11f43428.ee3774",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 2903,
        "y": 506,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "9d8c4947.e731c",
                "a3bb6162.8aa1a8"
            ]
        ]
    },
    {
        "id": "7a997c1a.ca4d0c",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2730,
        "y": 508,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "11f43428.ee3774"
            ]
        ]
    },
    {
        "id": "5d76d89f.d221e",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2730.490966796875,
        "y": 553.5740356445312,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "38cca479.139cac"
            ]
        ]
    },
    {
        "id": "d47edd7.a73b9a",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2728,
        "y": 597,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "3c7730a0.80743"
            ]
        ]
    },
    {
        "id": "3c7730a0.80743",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
        "comments": "",
        "x": 2895,
        "y": 596,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "38cca479.139cac",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.l3vpn.pe1_id`\" />\n\n",
        "comments": "",
        "x": 2893.0623779296875,
        "y": 553.8597717285156,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "ab398477.a58648",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for silentFailure='true' index='cridx' start='0' end='`$tmp.aai.connectivity.relationship-list.relationship_length`' >\n\n",
        "comments": "",
        "outputs": 1,
        "x": 2247,
        "y": 412,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "32748804.ce58a"
            ]
        ]
    },
    {
        "id": "32748804.ce58a",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.aai.connectivity.relationship-list.relationship[$cridx].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2452,
        "y": 412,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "41c73b96.f41a84"
            ]
        ]
    },
    {
        "id": "41c73b96.f41a84",
        "type": "outcome",
        "name": "vpn-binding",
        "xml": "<outcome value='vpn-binding'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2618,
        "y": 412,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "cfeba90.49ffe58"
            ]
        ]
    },
    {
        "id": "cfeba90.49ffe58",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 2781,
        "y": 412,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "684f9a1f.f6246c",
                "b9f32cf4.c94178"
            ]
        ]
    },
    {
        "id": "9d8c4947.e731c",
        "type": "switchNode",
        "name": "switch vpn-binding has dst-access-ltp",
        "xml": "<switch test='`$tmp.aai.vpn-binding.dst-access-ltp-id`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3157,
        "y": 505,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "c705e3fd.e27bf",
                "74e33b9a.6a3ba4"
            ]
        ]
    },
    {
        "id": "c705e3fd.e27bf",
        "type": "outcome",
        "name": "Null",
        "xml": "<outcome value=''>\n",
        "comments": "",
        "outputs": 1,
        "x": 3410,
        "y": 539,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "ab5b6203.69a998"
            ]
        ]
    },
    {
        "id": "74e33b9a.6a3ba4",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3410,
        "y": 483,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "7b04fd35.ba570c"
            ]
        ]
    },
    {
        "id": "ab5b6203.69a998",
        "type": "switchNode",
        "name": "switch vpn-binding has src-access-ltp",
        "xml": "<switch test='`$tmp.aai.vpn-binding.src-access-ltp-id`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3149,
        "y": 1325,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "15797e4.5eae102",
                "55009f8b.9fdc5"
            ]
        ]
    },
    {
        "id": "15797e4.5eae102",
        "type": "outcome",
        "name": "Null",
        "xml": "<outcome value=''>\n",
        "comments": "",
        "outputs": 1,
        "x": 3402,
        "y": 1359,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "4151c132.8e3c28"
            ]
        ]
    },
    {
        "id": "55009f8b.9fdc5",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3402,
        "y": 1303,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "db74d7f2.74d0f8"
            ]
        ]
    },
    {
        "id": "4151c132.8e3c28",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
        "comments": "",
        "x": 3553,
        "y": 1359,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "ad6a538e.8b5998",
        "type": "set",
        "name": "set vpn-bindingA and connectivityA",
        "xml": "<set>\n<parameter name='tmp.aai.vpn-bindingA.' value=\"`$tmp.aai.vpn-binding.`\" />\n<parameter name='tmp.aai.connectivityA.' value=\"`$tmp.aai.connectivity.`\" />\n",
        "comments": "",
        "x": 3856,
        "y": 110,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "51807068.f4c68",
        "type": "set",
        "name": "set vpn-bindingB and connectivityB",
        "xml": "<set>\n<parameter name='tmp.aai.vpn-bindingB.' value=\"`$tmp.aai.vpn-binding.`\" />\n<parameter name='tmp.aai.connectivityB.' value=\"`$tmp.aai.connectivity.`\" />\n\n",
        "comments": "",
        "x": 3837,
        "y": 916,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "7b04fd35.ba570c",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 3578,
        "y": 485,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "ad6a538e.8b5998",
                "3d56fd4f.8da4ea",
                "5074df67.2ba988",
                "9fd13730.014208",
                "ab834e.f483fcb",
                "c9d60073.e2df48",
                "119d7057.187e9"
            ]
        ]
    },
    {
        "id": "db74d7f2.74d0f8",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 3553,
        "y": 1302,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "51807068.f4c68",
                "b8f0eb5.a171218",
                "7af2004a.23f66",
                "9e8fb92f.dc9c38",
                "d94b849.7fdac78",
                "f91c20c6.244a28",
                "158d95b4.dbf02a"
            ]
        ]
    },
    {
        "id": "f91c20c6.244a28",
        "type": "set",
        "name": "set sotn_value",
        "xml": "<set>\n<parameter name='eth-service-name' value='`$tmp.aai.connectivityB.connectivity-id`' />\n<parameter name='provider-id' value='`$tmp.aai.connectivityB.access-provider-id`' />\n<parameter name='client-id' value='`$tmp.aai.connectivityB.access-client-id`' />\n<parameter name='topology-id' value='`$tmp.aai.connectivityB.access-topology-id`' />\n<parameter name='otn-tunnel-name' value='`$tmp.aai.vpn-bindingB.vpn-name`' />\n<parameter name='ethernet-end-point-name' value='`$tmp.aai.connectivityB.connectivity-id`' />\n<parameter name='index-number' value='0' />\n<parameter name='eth-node-id' value='`$tmp.aai.connectivityB.access-node-id`' />\n<parameter name='eth-node-tp-id' value='`$tmp.aai.connectivityB.access-ltp-id`' />\n",
        "comments": "",
        "x": 3782,
        "y": 1445,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "158d95b4.dbf02a",
        "type": "execute",
        "name": "execute RestApiCallNode Create ethernet Service without token",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.ts-ethernet-service.templatefile`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainB.url + '/restconf/data/ietf-eth-tran-service:etht-svc'`\" />\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.restapi.connection-oof-url`\" />-->\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainB.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainB.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"patch\"/>\n<parameter name='dirPath' value=\"/opt/onap/sdnc/restconfapi/yang\" />\n<parameter name=\"responsePrefix\" value=\"vpn-result\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n",
        "comments": "",
        "outputs": 1,
        "x": 3936,
        "y": 1493,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "7e8ddb70.effbcc",
                "8eaa1ef7.3644e"
            ]
        ]
    },
    {
        "id": "7e8ddb70.effbcc",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4281.5,
        "y": 1474,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "596967d4.0f4de8"
            ]
        ]
    },
    {
        "id": "8eaa1ef7.3644e",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4285.5,
        "y": 1514,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "4f294e9d.697c08"
            ]
        ]
    },
    {
        "id": "596967d4.0f4de8",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create ethernet service rest api\" />\n",
        "comments": "",
        "x": 4439.5,
        "y": 1474,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "4f294e9d.697c08",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 4443,
        "y": 1514,
        "z": "8a9c455f.82beb8",
        "wires": [
            [
                "637a80dd.df05",
                "d2c33ee2.7a3708"
            ]
        ]
    },
    {
        "id": "78a845.7bb187bc",
        "type": "comment",
        "name": "TODO: FIXME:",
        "info": "put proper values based on connectivity resource retrieved from AAI",
        "comments": "",
        "x": 3779.5,
        "y": 1401,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "637a80dd.df05",
        "type": "save",
        "name": "update vpn-binding B resource (aka. OTN domainB) in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding' \n      key='vpn-binding.vpn-id = $tmp.aai.vpn-bindingB.vpn-id' >\n<parameter name='vpn-id' value='`$tmp.aai.vpn-bindingB.vpn-id`' />\n<parameter name='vpn-name' value='`$tmp.aai.vpn-bindingB.vpn-id`' />\n\n<parameter name='operational-status' value='Activated' />\n",
        "comments": "",
        "outputs": 1,
        "x": 4783,
        "y": 1513,
        "z": "8a9c455f.82beb8",
        "wires": [
            []
        ]
    },
    {
        "id": "88ec2f6d.8d5da",
        "type": "comment",
        "name": "TODO: FIXME",
        "info": "use proper vpn-binding id and connectivity\n\nAlso, does CCSDK support \"update\" operation for vpn-binding and connectivity?",
        "comments": "",
        "x": 4641,
        "y": 1471,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "d2c33ee2.7a3708",
        "type": "save",
        "name": "update connectivity resource in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='connectivity' \n      key='connectivity.connectivity-id = $tmp.aai.connectivityB.connectivity-id'>\n<parameter name='connectivity-id' value='`$tmp.aai.connectivityB.connectivity-id`' />\n<parameter name='operational-status' value='Activated' />\n",
        "comments": "",
        "outputs": 1,
        "x": 4712,
        "y": 1562,
        "z": "8a9c455f.82beb8",
        "wires": [
            []
        ]
    },
    {
        "id": "a3bb6162.8aa1a8",
        "type": "set",
        "name": "set attachment_param for OTN",
        "xml": "<set>\n<parameter name='gfp-n' value='`$tmp.aai.vpn-binding.route-distinguisher`' />\n",
        "comments": "",
        "x": 3144,
        "y": 411,
        "z": "8a9c455f.82beb8",
        "wires": []
    },
    {
        "id": "b9f32cf4.c94178",
        "type": "set",
        "name": "unset tmp.aai.vpn-binding",
        "xml": "<set>\n<parameter name='tmp.aai.vpn-binding.' value='' />\n",
        "comments": "",
        "x": 2965,
        "y": 283,
        "z": "8a9c455f.82beb8",
        "wires": []
    }
]