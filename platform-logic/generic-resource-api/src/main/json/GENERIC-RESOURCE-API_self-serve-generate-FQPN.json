[{"id":"6b55c686.e98f58","type":"dgstart","name":"DGSTART","outputs":1,"x":95,"y":30,"z":"58ac4a51.14cfa4","wires":[["13afa36f.3e613d"]]},{"id":"118353f8.b3b67c","type":"method","name":"method self-serve-generate-FQPN","xml":"<method rpc='self-serve-generate-FQPN' mode='sync'>\n","comments":"","outputs":1,"x":197.0357208251953,"y":78.37698745727539,"z":"58ac4a51.14cfa4","wires":[["e5d7247c.e78aa8"]]},{"id":"e5d7247c.e78aa8","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","comments":"","outputs":1,"x":171.26589965820312,"y":154.1230583190918,"z":"58ac4a51.14cfa4","wires":[["faf52f6a.0694f","fb8a9cf8.8fbb2","7ad4d33c.188b7c","bcc69e94.ad89d","dcc749b9.569fe8","dab61149.8cd06"]]},{"id":"dab61149.8cd06","type":"execute","name":"call EIPAM getPlanTopology","xml":"<execute plugin=\"com.att.sdnctl.sli.plugin.eipam.EIPAMPlugin\" method=\"getPlanTopology\">","comments":"","outputs":1,"x":456.9287567138672,"y":326.93658924102783,"z":"58ac4a51.14cfa4","wires":[["7742e4f5.24469c"]]},{"id":"7742e4f5.24469c","type":"failure","name":"failure","xml":"<outcome value='failure'>","outputs":1,"x":673.309814453125,"y":326.66322231292725,"z":"58ac4a51.14cfa4","wires":[["1000bf31.b1f1f1"]]},{"id":"1000bf31.b1f1f1","type":"returnFailure","name":"return failure","xml":"<return status=\"failure\">\n\t<parameter name=\"ack-final\" value=\"Y\" />\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"error-message\" value=\"`'An error occured while getting Keyname and Keyvalue for address plan, '+ $eipam-ip-block.planName + ', from EIPAM'`\" />\n","comments":"","x":829.2025604248047,"y":326.77045154571533,"z":"58ac4a51.14cfa4","wires":[]},{"id":"fb8a9cf8.8fbb2","type":"switchNode","name":"switch: TopologyDetails_length","xml":"<switch test='`$eipam-ip-block.getPlanTopologyResponse.TopologyDetails_length`'>\n","comments":"","outputs":1,"x":459.14695739746094,"y":394.82542276382446,"z":"58ac4a51.14cfa4","wires":[["7a5942e6.6691dc"]]},{"id":"7a5942e6.6691dc","type":"outcome","name":"NULL","xml":"<outcome value=''>","outputs":1,"x":679.4643402099609,"y":394.8254346847534,"z":"58ac4a51.14cfa4","wires":[["a12111ef.55246"]]},{"id":"a12111ef.55246","type":"returnFailure","name":"return failure","xml":"<return status=\"failure\">\n\t<parameter name=\"ack-final\" value=\"Y\" />\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"error-message\" value=\"eipam-ip-block.getPlanTopologyResponse.TopologyDetails is null\" />\n","comments":"","x":839.3810119628906,"y":394.9365334510803,"z":"58ac4a51.14cfa4","wires":[]},{"id":"5c649a99.441c74","type":"set","name":"set pool-index","xml":"<set>\n<parameter name='pool-index'\n   value='`$eipam-ip-block.getPlanTopologyResponse.TopologyDetails[$resp-index].Level - 1`' />\n","comments":"","x":737.7975540161133,"y":496.81360149383545,"z":"58ac4a51.14cfa4","wires":[]},{"id":"faf52f6a.0694f","type":"set","name":"set eipam-ip-block.plan-name = tmp.ss.plan-name","xml":"<set>\n<parameter name='eipam-ip-block.plan-name' value='`$tmp.ss.plan-name`' />\n","comments":"","x":527.6468505859375,"y":209.23416805267334,"z":"58ac4a51.14cfa4","wires":[]},{"id":"affb505f.7eaa3","type":"switchNode","name":"switch: Response.planName vs eipam-ip-block..plan-name","xml":"<switch test='`$eipam-ip-block.plan-name == $eipam-ip-block.getPlanTopologyResponse.PlanName`'>\n","comments":"","outputs":1,"x":875.4127349853516,"y":448.74602794647217,"z":"58ac4a51.14cfa4","wires":[["519f260d.88c578"]]},{"id":"519f260d.88c578","type":"outcomeFalse","name":"false","xml":"<outcome value='false'>\n","comments":"","outputs":1,"x":1190.1429557800293,"y":448.95237159729004,"z":"58ac4a51.14cfa4","wires":[["baab19da.004908"]]},{"id":"baab19da.004908","type":"returnFailure","name":"return failure","xml":"<return status=\"failure\">\n\t<parameter name=\"ack-final\" value=\"Y\" />\n\t<parameter name=\"error-code\" value=\"500\"/>\n\t<parameter name=\"error-message\" value=\"`'eipam response plan-name ['+ $eipam-ip-block.getPlanTopologyResponse.PlanName + ' is not the same as input '+$eipam-ip-block.planName`\" />\n","comments":"","x":1355.5715103149414,"y":448.9523649215698,"z":"58ac4a51.14cfa4","wires":[]},{"id":"30eb4248.61be8e","type":"set","name":"set self-serve-generate-FQPN-output.pools[]","xml":"<set>\n<parameter name='self-serve-generate-FQPN-output.pools[$pool-index].key-name'\n   value='`$tmp.getPlanTopologyResponse.key-name`' />\n<parameter name='self-serve-generate-FQPN-output.pools[$pool-index].key-value'\n\tvalue='`$tmp.ss.final.key-value`' />","comments":"","x":818.6666412353516,"y":1116.5592398643494,"z":"58ac4a51.14cfa4","wires":[]},{"id":"ea1157ef.5c36d8","type":"comment","name":"Change History","info":"iTrack 8790\n- add validation for network-role in input for null\n- change query of ROUTING_CHARATERISTIC table with network-role from input.\n- Return generate-FQPN-output.pools[]\n- set pools_length to .getPlanTopologyResponse.TopologyDetails_length separately at the end of the call.\niTrack 10846\n- node 35, fixed error-message, generate-FQPN-input.network-role\niTrack 11310\n- changed ADDRESS_PLAN_POLICIES  cloud_region_id from using vnfapi nodestring for cloud-region-id\n- added AddressPlanPolicyDG-Network_Role and AddressPlanPolicyDG-Network_Id to ADDRESS_PLAN_POLICIES  query and resolution\n- updated vrf-name resolution to use tosca data if not found in ADDRESS_PLAN_POLICIES\n- support compound key-name\niTrack 11945\n- added network-collection and zone \n- remove validation of all input except plan-name\n","comments":"","x":93.75003051757812,"y":455.8928623199463,"z":"58ac4a51.14cfa4","wires":[]},{"id":"bcc69e94.ad89d","type":"for","name":"for resp-index: TopologyDetails[]","xml":"<for index=\"resp-index\" start=\"0\" end=\"`$eipam-ip-block.getPlanTopologyResponse.TopologyDetails_length`\">","comments":"","outputs":1,"x":463.52381896972656,"y":448.80959367752075,"z":"58ac4a51.14cfa4","wires":[["affb505f.7eaa3","5c649a99.441c74","12042b26.6ec7e5","30eb4248.61be8e","bf20cb6a.689cc8","5543f869.2b4cb8","b0808369.33c33","60f9abd6.9b1864"]]},{"id":"7ad4d33c.188b7c","type":"set","name":"empty self-serve-generate-FQPN-output.","xml":"<set>\n<parameter name='self-serve-generate-FQPN-output.' value='' />\n","comments":"","x":498.5357666015625,"y":271.57149744033813,"z":"58ac4a51.14cfa4","wires":[]},{"id":"c32b1831.2dfd38","type":"comment","name":"OUTPUT","info":"generate-FQPN-output.pools[]\ngenerate-FQPN-output.pools_length","comments":"","x":117.67855072021484,"y":360.5357151031494,"z":"58ac4a51.14cfa4","wires":[]},{"id":"dcc749b9.569fe8","type":"set","name":"set self-serve-generate-FQPN-output.pools_length","xml":"<set>\n<parameter name='self-serve-generate-FQPN-output.pools_length' \n\tvalue='`$eipam-ip-block.getPlanTopologyResponse.TopologyDetails_length`' />\n","comments":"","x":526.1072235107422,"y":1193.0357995033264,"z":"58ac4a51.14cfa4","wires":[]},{"id":"13afa36f.3e613d","type":"service-logic","name":"GENERIC-RESOURCE-API ${project.version}","module":"GENERIC-RESOURCE-API","version":"${project.version}","comments":"","xml":"<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>","outputs":1,"x":367.8571472167969,"y":29.428566932678223,"z":"58ac4a51.14cfa4","wires":[["118353f8.b3b67c"]]},{"id":"12042b26.6ec7e5","type":"set","name":"set tmp.getPlanTopologyResponse.key-name","xml":"<set>\n<parameter name='tmp.getPlanTopologyResponse.key-name' \n\tvalue='`$eipam-ip-block.getPlanTopologyResponse.TopologyDetails[$resp-index].KeyName`' />\n","comments":"","x":835.4643020629883,"y":547.1429715156555,"z":"58ac4a51.14cfa4","wires":[]},{"id":"5543f869.2b4cb8","type":"execute","name":"split tmp.getPlanTopologyResponse.key-value-format","xml":"<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='split' >\n\t<parameter name=\"original_string\" value=\"`$tmp.getPlanTopologyResponse.key-value-format`\" />\n\t<parameter name=\"regex\" value=\":\" />\n\t<parameter name=\"ctx_memory_result_key\" value=\"tmp.split.key-value-format\" />\n","comments":"","outputs":1,"x":864.6071395874023,"y":646.9643845558167,"z":"58ac4a51.14cfa4","wires":[[]]},{"id":"b0808369.33c33","type":"for","name":"for split-index: tmp.split.key-value-format","xml":"<for index=\"split-index\" start=\"0\" end=\"`$tmp.split.key-value-format_length`\">","comments":"","outputs":1,"x":821.7858352661133,"y":747.6786179542542,"z":"58ac4a51.14cfa4","wires":[["ee7b415f.68d5","98cc0ef6.2af94","d4d77014.0c4b3","ce214f8a.35d6c","2d190b10.073a64"]]},{"id":"85e1b3d.faf545","type":"set","name":"set tmp.ss.param.capability-name","xml":"<set>\n<parameter name='tmp.ss.param.capability-name' \n\tvalue='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-parameters.param[$pidx].resource-resolution-data.capability-name`' />\n","comments":"","x":1453.4524307250977,"y":891.1786241531372,"z":"58ac4a51.14cfa4","wires":[]},{"id":"246bb255.6cc33e","type":"set","name":"set tmp.ss.final.key-value","xml":"<set>\n<parameter name='tmp.ss.final.key-value' value=\"`$tmp.ss.partial.key-value`\" />\n","comments":"","x":1538.130729675293,"y":1022.166757106781,"z":"58ac4a51.14cfa4","wires":[]},{"id":"d4d77014.0c4b3","type":"switchNode","name":"switch: split-index == 0","xml":"<switch test='`$split-index == 0`'>\n","comments":"","outputs":1,"x":1135.1308288574219,"y":1022.5953135490417,"z":"58ac4a51.14cfa4","wires":[["1630c64f.a0ee7a","dab38bb.6e09578"]]},{"id":"1630c64f.a0ee7a","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":1331.8451538085938,"y":1022.5952353477478,"z":"58ac4a51.14cfa4","wires":[["246bb255.6cc33e"]]},{"id":"dab38bb.6e09578","type":"outcomeFalse","name":"false","xml":"<outcome value='false'>\n","comments":"","outputs":1,"x":1333.7022094726562,"y":1074.0238242149353,"z":"58ac4a51.14cfa4","wires":[["521825ba.41010c"]]},{"id":"521825ba.41010c","type":"set","name":"set tmp.final.key-value with :","xml":"<set>\n<parameter name='tmp.ss.final.key-value' \n\tvalue=\"`$tmp.ss.final.key-value + ':' + $tmp.ss.partial.key-value`\" />\n","comments":"","x":1546.9880065917969,"y":1074.2144198417664,"z":"58ac4a51.14cfa4","wires":[]},{"id":"60f9abd6.9b1864","type":"set","name":"set tmp.final.key-value NULL","xml":"<set>\n<parameter name='tmp.final.key-value' value=\"\" />\n","comments":"","x":788.285774230957,"y":695.3572058677673,"z":"58ac4a51.14cfa4","wires":[]},{"id":"bf20cb6a.689cc8","type":"set","name":"set tmp.getPlanTopologyResponse.key-value-format","xml":"<set>\n<parameter name='tmp.getPlanTopologyResponse.key-value-format' \n\tvalue='`$eipam-ip-block.getPlanTopologyResponse.TopologyDetails[$resp-index].KeyValueFormat`' />\n","comments":"","x":858.9999923706055,"y":598.7500195503235,"z":"58ac4a51.14cfa4","wires":[]},{"id":"ee7b415f.68d5","type":"execute","name":"replace ${ with \"\"","xml":"<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"`$tmp.split.key-value-format[$split-index]`\" />\n\t<parameter name=\"target\" value=\"${\"/>\n\t<parameter name=\"replacement\" value=\"\"/>\n\t<parameter name=\"outputPath\" value=\"tmp.split-value\"/>\n","comments":"","outputs":1,"x":1118.0000076293945,"y":747.5000290870667,"z":"58ac4a51.14cfa4","wires":[[]]},{"id":"98cc0ef6.2af94","type":"execute","name":"replace } with \"\"","xml":"<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"`$tmp.split-value`\" />\n\t<parameter name=\"target\" value=\"}\"/>\n\t<parameter name=\"replacement\" value=\"\"/>\n\t<parameter name=\"outputPath\" value=\"tmp.ss.split-value\"/>\n","comments":"","outputs":1,"x":1115.500015258789,"y":791.2500309944153,"z":"58ac4a51.14cfa4","wires":[[]]},{"id":"2d190b10.073a64","type":"for","name":"for pidx in param_length","xml":"<for index=\"pidx\" start=\"0\" end=\"`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-parameters.param_length`\">","comments":"","outputs":1,"x":1143.6666564941406,"y":891.2500944137573,"z":"58ac4a51.14cfa4","wires":[["6595219f.ab227","85e1b3d.faf545"]]},{"id":"6595219f.ab227","type":"switchNode","name":"switch: capability-name - ss vs param","xml":"<switch test='`$tmp.ss.param.capability-name == $ss.capability-name`'>\n","comments":"","outputs":1,"x":1465.4166564941406,"y":934.7500982284546,"z":"58ac4a51.14cfa4","wires":[["5a38343a.825c9c"]]},{"id":"5a38343a.825c9c","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":1704.1666641235352,"y":934.5000982284546,"z":"58ac4a51.14cfa4","wires":[["83308cd8.3dce"]]},{"id":"59c5ed43.c15bb4","type":"set","name":"set tmp.ss.partial.key-value","xml":"<set>\n<parameter name='tmp.ss.partial.key-value' \n\tvalue='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-parameters.param[$pidx].resource-resolution-data.resource-key[$kidx].value`' />\n","comments":"","x":2700.750030517578,"y":979.8333764076233,"z":"58ac4a51.14cfa4","wires":[]},{"id":"83308cd8.3dce","type":"for","name":"for kidx in resource-key_length","xml":"<for index=\"kidx\" start=\"0\" end=\"`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-parameters.param[$ss.param-index].resource-resolution-data.resource-key_length`\">","comments":"","outputs":1,"x":1921.9166564941406,"y":933.7500371932983,"z":"58ac4a51.14cfa4","wires":[["56ff67f7.37df58","fcb1624d.05791"]]},{"id":"56ff67f7.37df58","type":"set","name":"set tmp.ss.resource-key.name","xml":"<set>\n<parameter name='tmp.ss.resource-key.name' \n\tvalue='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-parameters.param[$pidx].resource-resolution-data.resource-key[$kidx].name`' />\n","comments":"","x":2213.416778564453,"y":933.7500643730164,"z":"58ac4a51.14cfa4","wires":[]},{"id":"fcb1624d.05791","type":"switchNode","name":"switch: split-value == resource-key.name","xml":"<switch test='`$tmp.ss.split-value == $tmp.ss.resource-key.name`'>\n","comments":"","outputs":1,"x":2244.6666564941406,"y":980.5000371932983,"z":"58ac4a51.14cfa4","wires":[["a79fe216.cb8bd"]]},{"id":"a79fe216.cb8bd","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":2495,"y":980.0833649635315,"z":"58ac4a51.14cfa4","wires":[["59c5ed43.c15bb4"]]},{"id":"98155a12.d97fc8","type":"execute","name":"printContext","xml":"<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='printContext' >\n<parameter name='filename' value='/var/tmp/ss.eipam.log' />\n","comments":"","outputs":1,"x":403.19444274902344,"y":1307.6388483047485,"z":"58ac4a51.14cfa4","wires":[[]]},{"id":"ce214f8a.35d6c","type":"record","name":"record","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"`'SS: tmp.ss.split-value: ' + $tmp.ss.split-value`\"/>\n","comments":"","outputs":1,"x":1090.4166564941406,"y":838.3333268165588,"z":"58ac4a51.14cfa4","wires":[[]]}]