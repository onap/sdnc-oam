[{"id":"f07e5af5.2a81a8","type":"dgstart","name":"DGSTART","outputs":1,"x":100,"y":80.74699592590332,"z":"4e44f4dc.d3fbac","wires":[["7dfb89c0.30c288"]]},{"id":"7dfb89c0.30c288","type":"service-logic","name":"GENERIC-RESOURCE-API ${project.version}","module":"GENERIC-RESOURCE-API","version":"${project.version}","comments":"","xml":"<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>","outputs":1,"x":215.28570556640625,"y":122.65177536010742,"z":"4e44f4dc.d3fbac","wires":[["1bd914ea.94267b"]]},{"id":"1bd914ea.94267b","type":"method","name":"method vnf-topology-operation-assign","xml":"<method rpc='vnf-topology-operation-assign' mode='sync'>\n","comments":"","outputs":1,"x":188.09530639648438,"y":165.41365909576416,"z":"4e44f4dc.d3fbac","wires":[["11bf25d2.bdb8da"]]},{"id":"2e619ce7.bf2e34","type":"comment","name":"vnf-topology-operation-assign","info":"","comments":"","x":476.0115280151367,"y":30,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"b32ac93e.aaa508","type":"switchNode","name":"switch request-action","xml":"<switch test='`$vnf-topology-operation-input.request-information.request-action`'>\n","comments":"","outputs":1,"x":486.3809509277344,"y":313.8898277282715,"z":"4e44f4dc.d3fbac","wires":[["95fe5c1b.234a3","1c086997.eb74d6"]]},{"id":"95fe5c1b.234a3","type":"outcome","name":"CreateVnfInstance","xml":"<outcome value='CreateVnfInstance'>\n","comments":"","outputs":1,"x":740.0952453613281,"y":291.0327091217041,"z":"4e44f4dc.d3fbac","wires":[["b3d6c559.f5a1f8"]]},{"id":"1c086997.eb74d6","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":702.0952110290527,"y":336.7470369338989,"z":"4e44f4dc.d3fbac","wires":[["3d3a9ebb.853872"]]},{"id":"b3d6c559.f5a1f8","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":924.9523735046387,"y":291.0327386856079,"z":"4e44f4dc.d3fbac","wires":[[]]},{"id":"3d3a9ebb.853872","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"If svc-action is 'assign' then request-action must be 'CreateVnfInstance'\" />\n","comments":"","x":942.0952186584473,"y":336.746994972229,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"ae713fba.3df7f","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":186.07147216796875,"y":1577.7707920074463,"z":"4e44f4dc.d3fbac","wires":[["78a8ab8d.e4a224","766c94ea.b9611c","434cb265.75e27c","a6c6204f.95895","b69f4291.61fa5","f416891b.c49b38","b1c5abc7.29b208","c969fd25.a5dbc","5551cb18.77a4d4","27e79a76.199b26","68282397.14338c","4cef2e4e.2eeb7","b4645e2b.83793","19423cf4.442143","59cc3158.776f9","2eaa370.dfe9cca","ab5ed0d2.dee8c","2dd176ed.0041ba","acbd5170.3e4c4","60684400.780c7c","31bebad4.8a5896","438000d4.31b1e","6f6caf00.d957c","277ce9ee.277656","56e0bd4b.bd3f64","58f81e72.df87b","719fd6d4.9a4d78","1fd770ea.bfd8af","183d18f7.8083e7","537d84c0.249e5c","4cc45d68.737674","ed7dcd3d.7a64c","d4e45ae3.95e8e8","569d159b.7974ac"]]},{"id":"3e444c8d.9a16f4","type":"get-resource","name":"get-resource VF_MODEL","xml":"<get-resource plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource' resource='SQL'\n  key='SELECT * from VF_MODEL WHERE customization_uuid = $vnf-topology-operation-input.vnf-information.onap-model-information.model-customization-uuid'\n  pfx='db.vf-model'>\n\n","comments":"","outputs":1,"x":498.7142562866211,"y":405.0326976776123,"z":"4e44f4dc.d3fbac","wires":[["474b191f.eb1888","e8e33d1a.e987"]]},{"id":"f4e1f5bf.f95318","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'No model found for VNF customization UUID ' + $vnf-topology-operation-input.vnf-information.onap-model-information.model-customization-uuid`\" />\n","comments":"","x":940.1427345275879,"y":428.46118354797363,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"474b191f.eb1888","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":699.4999542236328,"y":385.413535118103,"z":"4e44f4dc.d3fbac","wires":[["bd82a433.1ab928"]]},{"id":"e8e33d1a.e987","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":708.0713844299316,"y":429.6992483139038,"z":"4e44f4dc.d3fbac","wires":[["f4e1f5bf.f95318"]]},{"id":"bd82a433.1ab928","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error reading VF_MODEL table\" />\n","comments":"","x":939.4999351501465,"y":383.5564422607422,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"78a8ab8d.e4a224","type":"switchNode","name":"switch service-data.vnfs.vnf_length","xml":"<switch test='`$service-data.vnfs.vnf_length`'>\n","comments":"","outputs":1,"x":532.3809204101562,"y":1155.9851322174072,"z":"4e44f4dc.d3fbac","wires":[["120eef5e.ea3881","a22c3ff8.e2fb3"]]},{"id":"120eef5e.ea3881","type":"other","name":"NULL","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":758.0952491760254,"y":1123.1279201507568,"z":"4e44f4dc.d3fbac","wires":[["b7dbc5c1.1c67c8"]]},{"id":"b7dbc5c1.1c67c8","type":"set","name":"set vnf-index=0","xml":"<set>\n<parameter name='vnf-index' value='0' />\n","comments":"","x":922.3809700012207,"y":1122.1279983520508,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"a22c3ff8.e2fb3","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":759.523811340332,"y":1187.4137382507324,"z":"4e44f4dc.d3fbac","wires":[["41b7f789.ac4538"]]},{"id":"93cbad48.90b08","type":"set","name":"set vnf-index = vnf_length","xml":"<set>\n<parameter name='vnf-index' value='`$service-data.vnfs.vnf_length`' />\n","comments":"","x":1098.3809661865234,"y":1165.699426651001,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"a06ff958.ca8818","type":"for","name":"for each existing VNF","xml":"<for index='idx' start='0' end='`$service-data.vnfs.vnf_length`' >\n","comments":"","outputs":1,"x":1083.8094787597656,"y":1211.6993656158447,"z":"4e44f4dc.d3fbac","wires":[["8b898020.e1666"]]},{"id":"41b7f789.ac4538","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":895.2380714416504,"y":1187.413703918457,"z":"4e44f4dc.d3fbac","wires":[["93cbad48.90b08","a06ff958.ca8818"]]},{"id":"8b898020.e1666","type":"switchNode","name":"switch vnf-information.vnf-id == service-data.vnfs.vnf[].vnf-id","xml":"<switch test='`$vnf-topology-operation-input.vnf-information.vnf-id == $service-data.vnfs.vnf[$idx].vnf-id`'>\n","comments":"","outputs":1,"x":1438.0952453613281,"y":1211.270845413208,"z":"4e44f4dc.d3fbac","wires":[["b372ccf2.90f5f"]]},{"id":"b372ccf2.90f5f","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":1732.3810005187988,"y":1210.8423299789429,"z":"4e44f4dc.d3fbac","wires":[["2889470.ea41bba"]]},{"id":"2889470.ea41bba","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'VNF id ' + $service-data.vnfs.vnf[$idx].vnf-id\n      + ' already exists'`\" />\n","comments":"","x":1880.9523620605469,"y":1210.8422775268555,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"11adb872.3cc0d8","type":"comment","name":"make sure this VNF doesn't exist already","info":"","comments":"","x":1425.2379760742188,"y":1168.8422756195068,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"766c94ea.b9611c","type":"set","name":"set vnf-topology data","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-topology-identifier-structure.vnf-id'\n value='`$vnf-topology-operation-input.vnf-information.vnf-id`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-topology-identifier-structure.vnf-type'\n value='`$vnf-topology-operation-input.vnf-information.vnf-type`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-topology-identifier-structure.nf-type'\n value='`$db.vf-model.nf-type`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-topology-identifier-structure.nf-role'\n value='`$db.vf-model.nf-role`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-topology-identifier-structure.nf-function'\n value='`$db.vf-model.nf-function`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-topology-identifier-structure.nf-code'\n value='`$db.vf-model.nf-code`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.tenant'\n value='`$vnf-topology-operation-input.vnf-request-input.tenant`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.aic-cloud-region'\n value='`$vnf-topology-operation-input.vnf-request-input.aic-cloud-region`' />\n \n","comments":"","x":498.0952033996582,"y":1687.6518993377686,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"434cb265.75e27c","type":"switchNode","name":"switch input vnf-name","xml":"<switch test='`$vnf-topology-operation-input.vnf-request-input.vnf-name`'>\n","comments":"","outputs":1,"x":510.59522247314453,"y":2049.770956993103,"z":"4e44f4dc.d3fbac","wires":[["e8e240a8.b6802","9b1fc0be.8fa7"]]},{"id":"a6c6204f.95895","type":"get-resource","name":"get-resource cloud region","xml":"<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"cloud-region\" \n\t\tkey=\"cloud-region.cloud-owner = $prop.cloud-region.cloud-owner AND \n\t\t     cloud-region.cloud-region-id = $vnf-topology-operation-input.vnf-request-input.aic-cloud-region AND\n\t\t     depth='all'\"\n        pfx='aai.cloud-region' local-only='false' >\n\n","comments":"","outputs":1,"x":542.738166809082,"y":2945.7706928253174,"z":"4e44f4dc.d3fbac","wires":[["8e720469.5e8cb8","7b05d3d.76e1b2c"]]},{"id":"7b05d3d.76e1b2c","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":767.9843597412109,"y":2963.921548843384,"z":"4e44f4dc.d3fbac","wires":[["a42ab710.cce278"]]},{"id":"4676d832.85c178","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error retrieving cloud region from AAI\" />\n","comments":"","x":1069.6510314941406,"y":2963.9215660095215,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"8e720469.5e8cb8","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":776.912956237793,"y":2922.207282066345,"z":"4e44f4dc.d3fbac","wires":[["e0c152ab.e7e04"]]},{"id":"f16260c8.4591b","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Cloud region not found in AAI\" />\n","comments":"","x":1069.9289321899414,"y":2921.512840270996,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"b69f4291.61fa5","type":"get-resource","name":"get-resource VF_TO_NETWORK_ROLE_MAPPING","xml":"<get-resource plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource' resource='SQL'\n  key='SELECT * from VF_TO_NETWORK_ROLE_MAPPING WHERE vf_customization_uuid = $vnf-topology-operation-input.vnf-information.onap-model-information.model-customization-uuid'\n  pfx='db.vf-network-role-mapping[]'>\n\n","comments":"","outputs":1,"x":607.9762496948242,"y":3256.8182125091553,"z":"4e44f4dc.d3fbac","wires":[["60a87727.b01328","35785ae2.8b74a6"]]},{"id":"60a87727.b01328","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":903.7619209289551,"y":3235.532377243042,"z":"4e44f4dc.d3fbac","wires":[["7f628377.de20fc"]]},{"id":"35785ae2.8b74a6","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":912.3333511352539,"y":3279.818090438843,"z":"4e44f4dc.d3fbac","wires":[["cb783055.50a9a"]]},{"id":"7fcd46cd.478d88","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error reading VF_TO_NETWORK_ROLE_MAPPING table\" />\n","comments":"","x":1220.428544998169,"y":3235.342109680176,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"7b16dda0.235334","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":1039.5716705322266,"y":3728.1274967193604,"z":"4e44f4dc.d3fbac","wires":[["9c162cfb.04057","32d1bfdb.27738","7cbe8d03.77d1c4","9ecaa4ff.23c328","4bcf8a69.ae8c44","8025807.9d68d8","ccd49d85.073d1","cdefc051.a04bf"]]},{"id":"7cbe8d03.77d1c4","type":"get-resource","name":"get-resource l3-network","xml":"<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"l3-networks\" \n\t\tkey=\"l3-network.network-role = $db.vf-network-role-mapping[$role-index].network-role\"\n        pfx='aai.l3-network' local-only='false'\n>\n","comments":"","outputs":1,"x":1272.4287300109863,"y":3409.080026626587,"z":"4e44f4dc.d3fbac","wires":[["9891f515.8ee1c8","94d72e9b.4db64"]]},{"id":"94d72e9b.4db64","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1476.4764442443848,"y":3431.2228660583496,"z":"4e44f4dc.d3fbac","wires":[["22276dbf.92cb12"]]},{"id":"91d086d5.905598","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error retrieving l3-network from AAI\" />\n","comments":"","x":1791.476474761963,"y":3431.556209564209,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"9891f515.8ee1c8","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":1485.4050407409668,"y":3389.508599281311,"z":"4e44f4dc.d3fbac","wires":[["85a5708b.39733"]]},{"id":"b5a9325f.8e06e","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'No active l3-network found in AAI with cloud_region_id '\n          + $vnf-topology-operation-input.vnf-request-input.aic-cloud-region + ' and network_role '\n          + $db.vf-network-role-mapping[$network-index].network-role`\" />\n","comments":"","x":1790.087670326233,"y":3390.4807357788086,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"9c162cfb.04057","type":"set","name":"set vnf-network data","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network[$network-index].network-role'\n    value='`$db.vf-network-role-mapping[$role-index].network-role`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network[$network-index].network-name'\n    value='`$aai.l3-network.l3-network[$db-network-index].network-name`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network[$network-index].neutron-id'\n    value='`$aai.l3-network.l3-network[$db-network-index].neutron-network-id`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network[$network-index].network-id'\n    value='`$aai.l3-network.l3-network[$db-network-index].network-id`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network[$network-index].contrail-network-fqdn'\n    value='`$aai.l3-network.l3-network[$db-network-index].contrail-network-fqdn`' />\n","comments":"","x":1261.6193199157715,"y":3896.0802698135376,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"5551cb18.77a4d4","type":"for","name":"for each cloud-region availability zone","xml":"<for index='idx' start='0' end='`$aai.cloud-region.availability-zones.availability-zone_length`' >\n","comments":"","outputs":1,"x":535.0003356933594,"y":4313.199224472046,"z":"4e44f4dc.d3fbac","wires":[["858bb9df.ef0b98"]]},{"id":"420bf10a.3f71f","type":"set","name":"set availability-zone","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.availability-zones.availability-zone[$idx]'\n  value='`$aai.cloud-region.availability-zones.availability-zone[$idx].availability-zone-name`' />\n","comments":"","x":996.6670188903809,"y":4282.532638549805,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"27e79a76.199b26","type":"set","name":"set vnf-parameters-data","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-parameters-data.'\n  value='vnf-topology-operation-input.vnf-request-input.vnf-input-parameters.' />\n","comments":"","x":494.6192626953125,"y":4163.151584625244,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"cbb1f011.821ee","type":"save","name":"save generic-vnf l3-network relationships","xml":"<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\"\n   resource=\"generic-vnf:relationship-list\"\n   key=\"generic-vnf.vnf-id = $service-data.vnfs.vnf[$vnf-index].vnf-id\"\n   force=\"true\" pfx=\"tmp.AnAI-data\">\n    <parameter name=\"relationship-list.relationship[0].related-to\" value=\"l3-network\" />\n    <parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"l3-network.network-id\" />\n    <parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network[$vnf-nw-index].network-id`\" />\n","comments":"","outputs":1,"x":961.1907958984375,"y":4456.961437225342,"z":"4e44f4dc.d3fbac","wires":[["32a6aa28.4d7b46","22485f0b.22ad6"]]},{"id":"b4645e2b.83793","type":"returnSuccess","name":"return success","xml":"<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n","comments":"","x":454.4288101196289,"y":4922.579827308655,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"4cef2e4e.2eeb7","type":"set","name":"set vnf-level-oper-status to PendingCreate","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-level-oper-status.order-status' value='PendingCreate' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-level-oper-status.last-rpc-action' value='`$vnf-topology-operation-input.sdnc-request-header.svc-action`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-level-oper-status.last-action' value='`$vnf-topology-operation-input.request-information.request-action`' />\n","comments":"","x":544.2422561645508,"y":4824.917307853699,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"b1c5abc7.29b208","type":"for","name":"for each network-role","xml":"<for index='role-index' start='0' end='`$db.vf-network-role-mapping_length`'>","comments":"","outputs":1,"x":499.57160568237305,"y":3701.4611654281616,"z":"4e44f4dc.d3fbac","wires":[["ed4c9615.d61838"]]},{"id":"f416891b.c49b38","type":"set","name":"set network-index = 0","xml":"<set>\n<parameter name='network-index' value='0' />\n","comments":"","x":510.40474700927734,"y":3310.8660068511963,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"32d1bfdb.27738","type":"set","name":"increment network-index","xml":"<set>\n<parameter name='network-index' value='`$network-index + 1`' />\n","comments":"","x":1271.95267868042,"y":4050.842246055603,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"c969fd25.a5dbc","type":"set","name":"set vnf-network_length","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network_length'\n  value='`$network-index`' />\n","comments":"","x":493.4763488769531,"y":4113.151628494263,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"68282397.14338c","type":"set","name":"copy input data","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.sdnc-request-header.' value='$vnf-topology-operation-input.sdnc-request-header.' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.request-information.' value='$vnf-topology-operation-input.request-information.' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.service-information.' value='$vnf-topology-operation-input.service-information.' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-information.' value='$vnf-topology-operation-input.vnf-information.' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-request-input.' value='$vnf-topology-operation-input.vnf-request-input.' />\n\n","comments":"","x":459.7620849609375,"y":4772.580139160156,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"19423cf4.442143","type":"for","name":"for each vnf-network","xml":"<for index='vnf-nw-index' start='0' end='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network_length`' >\n","comments":"","outputs":1,"x":484.1907043457031,"y":4455.961353302002,"z":"4e44f4dc.d3fbac","wires":[["5f481128.d6fd6"]]},{"id":"5f481128.d6fd6","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":687.8573455810547,"y":4455.961314201355,"z":"4e44f4dc.d3fbac","wires":[["cbb1f011.821ee"]]},{"id":"59cc3158.776f9","type":"set","name":"set new vnf_length","xml":"<set>\n<parameter name='service-data.vnfs.vnf_length' value='`$vnf-index + 1`' />\n","comments":"","x":481.02384185791016,"y":1208.0090227127075,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"2eaa370.dfe9cca","type":"for","name":"for each cloud-region relationship","xml":"<for index='idx' start='0' end='`$aai.cloud-region.relationship-list.relationship_length`' >\n","comments":"","outputs":1,"x":555.5952911376953,"y":3033.008864402771,"z":"4e44f4dc.d3fbac","wires":[["e5925a76.815c58"]]},{"id":"e5925a76.815c58","type":"switchNode","name":"switch related-to","xml":"<switch test='`$aai.cloud-region.relationship-list.relationship[$idx].related-to`'>\n","comments":"","outputs":1,"x":803.2738342285156,"y":3032.7587938308716,"z":"4e44f4dc.d3fbac","wires":[["3699dec9.348a82"]]},{"id":"3699dec9.348a82","type":"outcome","name":"complex","xml":"<outcome value='complex'>\n","comments":"","outputs":1,"x":972.7381553649902,"y":3032.1516160964966,"z":"4e44f4dc.d3fbac","wires":[["ed1ad94c.99ecb8"]]},{"id":"98e2f8af.a2f578","type":"set","name":"set aic-clli","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.aic-clli'\n  value='`$aai-uid-split[$aai-uid-split_length - 1]`' />\n","comments":"","x":1293.4524536132812,"y":3031.8182735443115,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"ab5ed0d2.dee8c","type":"switchNode","name":"switch aic-clli","xml":"<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.aic-clli`'>\n","comments":"","outputs":1,"x":488.64291763305664,"y":3146.1039962768555,"z":"4e44f4dc.d3fbac","wires":[["cd42ad7f.c7287"]]},{"id":"cd42ad7f.c7287","type":"outcome","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":636.7857513427734,"y":3146.103979110718,"z":"4e44f4dc.d3fbac","wires":[["b6ad7e13.cbdb8"]]},{"id":"f7a16dbf.78dcf","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unable to find aic-clli in AAI for aic-cloud-region ' + $vnf-topology-operation-input.vnf-request-input.aic-cloud-region`\" />\n","comments":"","x":927.2619438171387,"y":3147.3420248031616,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"817e056c.b110d8","type":"set","name":"set from DB","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.onap-model-information.model-invariant-uuid'\n  value='`$db.vf-model.invariant-uuid`' />\n","comments":"","x":915.0954627990723,"y":2504.9612531661987,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"4527349c.9a52ec","type":"for","name":"for each l3-network","xml":"<for index='db-network-index' start='0' end='`$aai.l3-network.l3-network_length`' >\n","comments":"","outputs":1,"x":1381.8812980651855,"y":3720.6516485214233,"z":"4e44f4dc.d3fbac","wires":[["45b722b6.db776c"]]},{"id":"2b805935.a35cb6","type":"switchNode","name":"switch orchestration-status","xml":"<switch test='`$aai.l3-network.l3-network[$db-network-index].orchestration-status`'>\n","comments":"","outputs":1,"x":1800.4524688720703,"y":3655.2231130599976,"z":"4e44f4dc.d3fbac","wires":[["b291cd89.5e04","688efdb4.26b7f4","1dbdf0e3.6d4c4f","3bfc9f47.c3df5","8f5abb8c.6c74f8"]]},{"id":"b291cd89.5e04","type":"outcome","name":"Pending Delete","xml":"<outcome value='Pending Delete'>\n","comments":"","outputs":1,"x":2041.1193389892578,"y":3696.8896169662476,"z":"4e44f4dc.d3fbac","wires":[["757bdd4d.6abe74"]]},{"id":"688efdb4.26b7f4","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":2013.9764785766602,"y":3747.8895978927612,"z":"4e44f4dc.d3fbac","wires":[["47f9fe3b.cd325"]]},{"id":"9833efbf.69304","type":"switchNode","name":"switch related-to","xml":"<switch test='`$aai.l3-network.l3-network[$db-network-index].relationship-list.relationship[$db-rel-index].related-to`'>\n","comments":"","outputs":1,"x":2549.6909255981445,"y":3716.460892677307,"z":"4e44f4dc.d3fbac","wires":[["440449fc.68ede8"]]},{"id":"47f9fe3b.cd325","type":"for","name":"for each relationship","xml":"<for silentFailure='true' index='db-rel-index' start='0' end='`$aai.l3-network.l3-network[$db-network-index].relationship-list.relationship_length`' >\n","comments":"","outputs":1,"x":2183.976390838623,"y":3747.4609746932983,"z":"4e44f4dc.d3fbac","wires":[["46c88819.e15b38"]]},{"id":"440449fc.68ede8","type":"outcome","name":"cloud-region","xml":"<outcome value='cloud-region'>\n","comments":"","outputs":1,"x":2723.9765663146973,"y":3716.0323390960693,"z":"4e44f4dc.d3fbac","wires":[["3d11cc80.c4e0c4"]]},{"id":"3d11cc80.c4e0c4","type":"for","name":"for each relationship data","xml":"<for silentFailure='true' index='db-data-index' start='0' end='`$aai.l3-network.l3-network[$db-network-index].relationship-list.relationship[$db-rel-index].relationship-data_length`' >\n","comments":"","outputs":1,"x":2921.1192665100098,"y":3716.4608068466187,"z":"4e44f4dc.d3fbac","wires":[["ced7a748.131728"]]},{"id":"ced7a748.131728","type":"switchNode","name":"switch relationship-key","xml":"<switch test='`$aai.l3-network.l3-network[$db-network-index].relationship-list.relationship[$db-rel-index].relationship-data[$db-data-index].relationship-key`'>\n","comments":"","outputs":1,"x":3152.547866821289,"y":3716.032181739807,"z":"4e44f4dc.d3fbac","wires":[["92fbe3e9.e193d"]]},{"id":"92fbe3e9.e193d","type":"outcome","name":"cloud-region.cloud-region-id","xml":"<outcome value='cloud-region.cloud-region-id'>\n","comments":"","outputs":1,"x":3393.976432800293,"y":3716.032278060913,"z":"4e44f4dc.d3fbac","wires":[["3d76bce7.883fc4"]]},{"id":"3d76bce7.883fc4","type":"switchNode","name":"switch relationship-value == cloud-region-id","xml":"<switch test='`$aai.l3-network.l3-network[$db-network-index].relationship-list.relationship[$db-rel-index].relationship-data[$db-data-index].relationship-value == $vnf-topology-operation-input.vnf-request-input.aic-cloud-region`'>\n","comments":"","outputs":1,"x":3698.262351989746,"y":3715.8893337249756,"z":"4e44f4dc.d3fbac","wires":[["5f95e58e.702e5c"]]},{"id":"5f95e58e.702e5c","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":3403.2624893188477,"y":3833.5322875976562,"z":"4e44f4dc.d3fbac","wires":[["a7f11203.5d359"]]},{"id":"9ecaa4ff.23c328","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1218.0954704284668,"y":3651.9372930526733,"z":"4e44f4dc.d3fbac","wires":[["4527349c.9a52ec","be0cee42.5ab7e"]]},{"id":"4bcf8a69.ae8c44","type":"set","name":"set l3-network-id = -1","xml":"<set>\n<parameter name='l3-network-id' value='-1' />\n","comments":"","x":1262.4288291931152,"y":3523.8419466018677,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"a7f11203.5d359","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":3549.0954666137695,"y":3833.0083961486816,"z":"4e44f4dc.d3fbac","wires":[["afc40b2f.c29e28","6f9b0a93.f694a4","2a1ad752.bfcd38"]]},{"id":"afc40b2f.c29e28","type":"set","name":"set l3-network-id = this l3-network","xml":"<set>\n<parameter name='l3-network-id' value='`$aai.l3-network.l3-network[$db-network-index].network-id`' />\n","comments":"","x":3784.333469390869,"y":3795.1513652801514,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"8025807.9d68d8","type":"switchNode","name":"switch l3-network-id","xml":"<switch test='`$l3-network-id`'>\n","comments":"","outputs":1,"x":1259.42875289917,"y":3847.508988380432,"z":"4e44f4dc.d3fbac","wires":[["aa114731.395c08"]]},{"id":"aa114731.395c08","type":"outcome","name":"-1","xml":"<outcome value='-1'>\n","comments":"","outputs":1,"x":1429.4287033081055,"y":3847.508744239807,"z":"4e44f4dc.d3fbac","wires":[["2fba815e.79c32e"]]},{"id":"6395a483.342b9c","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unable to find l3-network in AAI for network role ' + $db.vf-network-role-mapping[$role-index].network-role`\" />\n","comments":"","x":1712.7620658874512,"y":3847.5089931488037,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"2dd176ed.0041ba","type":"switchNode","name":"switch input model-invariant-uuid","xml":"<switch test='`$vnf-topology-operation-input.vnf-information.onap-model-information.model-invariant-uuid`'>\n","comments":"","outputs":1,"x":558.9525375366211,"y":2527.7856969833374,"z":"4e44f4dc.d3fbac","wires":[["d5c66a20.2113f8","4eb518d2.0c93e8"]]},{"id":"d5c66a20.2113f8","type":"outcome","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":764.6192092895508,"y":2504.9286603927612,"z":"4e44f4dc.d3fbac","wires":[["817e056c.b110d8"]]},{"id":"4eb518d2.0c93e8","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":766.0478057861328,"y":2549.2142515182495,"z":"4e44f4dc.d3fbac","wires":[["7ce719fb.9a6228"]]},{"id":"7ce719fb.9a6228","type":"set","name":"set from input","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.onap-model-information.model-invariant-uuid'\n  value='`$vnf-topology-operation-input.vnf-information.onap-model-information.model-invariant-uuid`' />\n","comments":"","x":920.3335418701172,"y":2548.6428236961365,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"ef5faa7d.94cb58","type":"set","name":"set from DB","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.onap-model-information.model-uuid'\n  value='`$db.vf-model.uuid`' />\n","comments":"","x":916.0477333068848,"y":2593.4999294281006,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"acbd5170.3e4c4","type":"switchNode","name":"switch input model-uuid","xml":"<switch test='`$vnf-topology-operation-input.vnf-information.onap-model-information.model-uuid`'>\n","comments":"","outputs":1,"x":531.5715560913086,"y":2616.3244342803955,"z":"4e44f4dc.d3fbac","wires":[["ce65d89f.20afc8","34fc501b.a39a8"]]},{"id":"ce65d89f.20afc8","type":"outcome","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":765.5715293884277,"y":2593.467366218567,"z":"4e44f4dc.d3fbac","wires":[["ef5faa7d.94cb58"]]},{"id":"34fc501b.a39a8","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":767.0001258850098,"y":2637.752957344055,"z":"4e44f4dc.d3fbac","wires":[["f5981394.788ef"]]},{"id":"f5981394.788ef","type":"set","name":"set from input","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.onap-model-information.model-uuid'\n  value='`$vnf-topology-operation-input.vnf-information.onap-model-information.model-uuid`' />\n","comments":"","x":921.2858619689941,"y":2637.181529521942,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"538946a2.181668","type":"set","name":"set from DB","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.onap-model-information.model-version'\n  value='`$db.vf-model.version`' />\n","comments":"","x":913.1906661987305,"y":2682.3571367263794,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"60684400.780c7c","type":"switchNode","name":"switch input model-version","xml":"<switch test='`$vnf-topology-operation-input.vnf-information.onap-model-information.model-version`'>\n","comments":"","outputs":1,"x":539.714427947998,"y":2705.1815814971924,"z":"4e44f4dc.d3fbac","wires":[["e137a9dc.787888","5fc591ca.bc88b"]]},{"id":"e137a9dc.787888","type":"outcome","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":762.714412689209,"y":2682.324543952942,"z":"4e44f4dc.d3fbac","wires":[["538946a2.181668"]]},{"id":"5fc591ca.bc88b","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":764.143009185791,"y":2726.61013507843,"z":"4e44f4dc.d3fbac","wires":[["b9a36199.dc978"]]},{"id":"b9a36199.dc978","type":"set","name":"set from input","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.onap-model-information.model-version'\n  value='`$vnf-topology-operation-input.vnf-information.onap-model-information.model-version`' />\n","comments":"","x":918.4287452697754,"y":2726.038707256317,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"855b2ca8.132f9","type":"set","name":"set from DB","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.onap-model-information.model-name'\n  value='`$db.vf-model.name`' />\n","comments":"","x":913.1906661987305,"y":2769.4999589920044,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"31bebad4.8a5896","type":"switchNode","name":"switch input model-name","xml":"<switch test='`$vnf-topology-operation-input.vnf-information.onap-model-information.model-name`'>\n","comments":"","outputs":1,"x":534.714427947998,"y":2792.3244037628174,"z":"4e44f4dc.d3fbac","wires":[["7a7f7561.1b9f2c","af9f8b2b.cd7db8"]]},{"id":"7a7f7561.1b9f2c","type":"outcome","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":762.714412689209,"y":2769.467366218567,"z":"4e44f4dc.d3fbac","wires":[["855b2ca8.132f9"]]},{"id":"af9f8b2b.cd7db8","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":764.143009185791,"y":2813.752957344055,"z":"4e44f4dc.d3fbac","wires":[["f010777f.4fc4a8"]]},{"id":"f010777f.4fc4a8","type":"set","name":"set from input","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.onap-model-information.model-name'\n  value='`$vnf-topology-operation-input.vnf-information.onap-model-information.model-name`' />\n","comments":"","x":918.4287452697754,"y":2813.181529521942,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"757bdd4d.6abe74","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":2194.3334312438965,"y":3697.666494369507,"z":"4e44f4dc.d3fbac","wires":[[]]},{"id":"8f5abb8c.6c74f8","type":"outcome","name":"PendingDelete","xml":"<outcome value='PendingDelete'>\n","comments":"","outputs":1,"x":2039.000072479248,"y":3652.6664085388184,"z":"4e44f4dc.d3fbac","wires":[["689950a3.df60a"]]},{"id":"689950a3.df60a","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":2194.2141647338867,"y":3653.4432859420776,"z":"4e44f4dc.d3fbac","wires":[[]]},{"id":"3bfc9f47.c3df5","type":"outcome","name":"Pending Create","xml":"<outcome value='Pending Create'>\n","comments":"","outputs":1,"x":2041.000072479248,"y":3609.3329124450684,"z":"4e44f4dc.d3fbac","wires":[["ea88d2ba.493d6"]]},{"id":"ea88d2ba.493d6","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":2194.2141647338867,"y":3610.1097898483276,"z":"4e44f4dc.d3fbac","wires":[[]]},{"id":"1dbdf0e3.6d4c4f","type":"outcome","name":"PendingCreate","xml":"<outcome value='PendingCreate'>\n","comments":"","outputs":1,"x":2041.000072479248,"y":3565.9996604919434,"z":"4e44f4dc.d3fbac","wires":[["8104066e.259008"]]},{"id":"8104066e.259008","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":2194.2141647338867,"y":3566.7765378952026,"z":"4e44f4dc.d3fbac","wires":[[]]},{"id":"fe91b2bf.8c099","type":"for","name":"for each A&AI subnet","xml":"<for index='subnet-index' start='0' end='`$aai.l3-network.l3-network[0].subnets.subnet_length`' >\n","comments":"","outputs":1,"x":1727.3810997009277,"y":3986.7138295173645,"z":"4e44f4dc.d3fbac","wires":[["b10f2375.b9afa"]]},{"id":"53c17453.f0880c","type":"set","name":"set subnet_length","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network[$network-index].subnets-data.subnet-data_length'\n   value='`$aai.l3-network.l3-network[0].subnets.subnet_length`' />\n","comments":"","x":1716.047664642334,"y":4031.7139115333557,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"438000d4.31b1e","type":"set","name":"set availability-zones.max-count and length","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.availability-zones.max-count'\n   value='`$db.vf-model.avail-zone-max-count`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.availability-zones.availability-zone_length'\n   value='`$aai.cloud-region.availability-zones.availability-zone_length`' />\n","comments":"","x":554.6668395996094,"y":4401.214692115784,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"6f6caf00.d957c","type":"set","name":"set vnf-name","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-topology-identifier-structure.vnf-name'\n   value='`$tmp.vnf-name`' />\n","comments":"","x":495.8333511352539,"y":2461.8334608078003,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"277ce9ee.277656","type":"save","name":"update generic-vnf","xml":"<update plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\"\n   resource=\"generic-vnf\"\n   key=\"generic-vnf.vnf-id = $service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-topology-identifier-structure.vnf-id\"\n   force=\"true\" pfx=\"tmp.AnAI-data\">\n<parameter name=\"vnf-name\" value=\"`$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-topology-identifier-structure.vnf-name`\" />\n<parameter name=\"prov-status\" value=\"PREPROV\" />\n<!-- <parameter name=\"operational-status\" value=\"out-of-service-path\" /> -->\n<parameter name=\"equipment-role\" value=\"`$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-topology-identifier-structure.nf-role`\" />\n<parameter name=\"model-invariant-id\" value=\"`$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.onap-model-information.model-invariant-uuid`\" />\n<parameter name=\"model-version-id\" value=\"`$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.onap-model-information.model-uuid`\" />\n<parameter name=\"model-customization-id\" value=\"`$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.onap-model-information.model-customization-uuid`\" />\n<parameter name=\"selflink\" value=\"`$vnf-object-path`\" />\n","comments":"","outputs":1,"x":475.00010681152344,"y":4610.88045501709,"z":"4e44f4dc.d3fbac","wires":[["7a3c612.03fada","d92cf5a6.33b858"]]},{"id":"56e0bd4b.bd3f64","type":"set","name":"set vnf-object-path","xml":"<set>\n<parameter name='vnf-object-path'\n value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $vnf-topology-operation-input.service-information.service-instance-id\n + '/service-data/vnfs/vnf/'\n + $service-data.vnfs.vnf[$vnf-index].vnf-id\n + '/vnf-data/vnf-topology'`\"/>\n\n","comments":"","x":475.0001449584961,"y":4540.880937576294,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"58f81e72.df87b","type":"set","name":"set vnf-id","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-id'\n   value='`$vnf-topology-operation-input.vnf-information.vnf-id`' />\n","comments":"","x":484.1666946411133,"y":2413.5000038146973,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"719fd6d4.9a4d78","type":"execute","name":"printContext","xml":"<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='printContext' >\n<parameter name='filename' value='/var/tmp/bgb-viprend.log' />\n","comments":"","outputs":1,"x":449.3335380554199,"y":4871.3570766448975,"z":"4e44f4dc.d3fbac","wires":[[]]},{"id":"9263c515.503118","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'No generic-vnf found in AAI for vnf ID ' + $service-data.vnfs.vnf[$vnf-index].vnf-id`\" />\n","comments":"","x":1511.66695022583,"y":4477.547351837158,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"32a6aa28.4d7b46","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1211.0241508483887,"y":4434.500012397766,"z":"4e44f4dc.d3fbac","wires":[["672f3870.869518"]]},{"id":"22485f0b.22ad6","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":1219.5955810546875,"y":4478.785725593567,"z":"4e44f4dc.d3fbac","wires":[["6e62ccc6.dc7f34"]]},{"id":"32930b6a.86e284","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating generic-vnf in AAI\" />\n","comments":"","x":1514.3575439453125,"y":4434.30955696106,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"3c4d390f.0ff276","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'No generic-vnf found in AAI for vnf ID ' + $service-data.vnfs.vnf[$vnf-index].vnf-id`\" />\n","comments":"","x":946.6668853759766,"y":4630.8808879852295,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"7a3c612.03fada","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":649.3574371337891,"y":4589.500050544739,"z":"4e44f4dc.d3fbac","wires":[["db6c1834.e91948"]]},{"id":"d92cf5a6.33b858","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":657.9288673400879,"y":4633.78576374054,"z":"4e44f4dc.d3fbac","wires":[["ec9973e.c6a799"]]},{"id":"7baf675.e9c2498","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating selflink in generic-vnf in AAI\" />\n","comments":"","x":949.357479095459,"y":4587.643093109131,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"1fd770ea.bfd8af","type":"set","name":"set model-customization-uuid","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.onap-model-information.model-customization-uuid'\n  value='`$vnf-topology-operation-input.vnf-information.onap-model-information.model-customization-uuid`' />\n","comments":"","x":547.5000152587891,"y":2865.1666078567505,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"703de5d6.b6b11c","type":"execute","name":"split related-link","xml":"<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='split'>\n   <parameter name='ctx_memory_result_key' value='aai-uid-split' />\n   <parameter name='original_string' value='`$aai.cloud-region.relationship-list.relationship[$idx].related-link`' />\n   <parameter name='regex' value='/' />\n","comments":"","outputs":1,"x":1312.8333129882812,"y":2986.5801916122437,"z":"4e44f4dc.d3fbac","wires":[[]]},{"id":"ed1ad94c.99ecb8","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":1132.500015258789,"y":3033.24697971344,"z":"4e44f4dc.d3fbac","wires":[["703de5d6.b6b11c","98e2f8af.a2f578","62cd4dc6.bccf24"]]},{"id":"62cd4dc6.bccf24","type":"break","name":"break","xml":"<break>\n","comments":"","x":1282.4999771118164,"y":3076.580276489258,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"858bb9df.ef0b98","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":786.6667785644531,"y":4312.294808387756,"z":"4e44f4dc.d3fbac","wires":[["420bf10a.3f71f","e9021688.b099b8"]]},{"id":"e9021688.b099b8","type":"save","name":"save generic-vnf availability-zone relationship","xml":"<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\"\n   resource=\"generic-vnf:relationship-list\"\n   key=\"generic-vnf.vnf-id = $service-data.vnfs.vnf[$vnf-index].vnf-id\"\n   force=\"true\" pfx=\"tmp.AnAI-data\">\n    <parameter name=\"relationship-list.relationship[0].related-to\" value=\"availability-zone\" />\n    <parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"cloud-region.cloud-owner\" />\n    <parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$prop.cloud-region.cloud-owner`\" />\n    <parameter name=\"relationship-list.relationship[0].relationship-data[1].relationship-key\" value=\"cloud-region.cloud-region-id\" />\n    <parameter name=\"relationship-list.relationship[0].relationship-data[1].relationship-value\" value=\"`$vnf-topology-operation-input.vnf-request-input.aic-cloud-region`\" />\n    <parameter name=\"relationship-list.relationship[0].relationship-data[2].relationship-key\" value=\"availability-zone.availability-zone-name\" />\n    <parameter name=\"relationship-list.relationship[0].relationship-data[2].relationship-value\" value=\"`$aai.cloud-region.availability-zones.availability-zone[$idx].availability-zone-name`\" />\n","comments":"","outputs":1,"x":1080.0001678466797,"y":4335.628262519836,"z":"4e44f4dc.d3fbac","wires":[["3a86920a.c74fce","85b44524.f59068"]]},{"id":"2639188b.f42278","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'No generic-vnf found in AAI for vnf ID ' + $service-data.vnfs.vnf[$vnf-index].vnf-id`\" />\n","comments":"","x":1637.1428298950195,"y":4359.547591209412,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"3a86920a.c74fce","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1344.8334197998047,"y":4316.500084877014,"z":"4e44f4dc.d3fbac","wires":[["c2464793.9ffc08"]]},{"id":"85b44524.f59068","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":1353.4048500061035,"y":4360.785798072815,"z":"4e44f4dc.d3fbac","wires":[["9d10abef.aa9d68"]]},{"id":"2754abb3.b85874","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating generic-vnf in AAI\" />\n","comments":"","x":1639.833423614502,"y":4316.309796333313,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"cb783055.50a9a","type":"set","name":"set mapping rows to 0","xml":"<set>\n<parameter name='db.vf-network-role-mapping_length' value='0' />\n","comments":"","x":1106.3094863891602,"y":3279.437578201294,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"183d18f7.8083e7","type":"switchNode","name":"switch AAI availability-zone_length","xml":"<switch test='`$aai.cloud-region.availability-zones.availability-zone_length`'>\n","comments":"","outputs":1,"x":527.3810653686523,"y":4216.10439491272,"z":"4e44f4dc.d3fbac","wires":[["bd16fb24.0fe038"]]},{"id":"bd16fb24.0fe038","type":"outcome","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":745.9524841308594,"y":4215.675804138184,"z":"4e44f4dc.d3fbac","wires":[["44f8e0c6.bf172"]]},{"id":"a4deaa00.e82908","type":"set","name":"set availability-zone_length to 0","xml":"<set>\n<parameter name='aai.cloud-region.availability-zones.availability-zone_length' value='0' />\n","comments":"","x":1347.3811264038086,"y":4234.2470417022705,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"44f8e0c6.bf172","type":"switchNode","name":"switch AZ max count > 0","xml":"<switch test='`$db.vf-model.avail-zone-max-count &gt; 0`'>\n","comments":"","outputs":1,"x":934.5239562988281,"y":4216.104115962982,"z":"4e44f4dc.d3fbac","wires":[["d06ce29c.e7c56","91254f4.8fe1bb"]]},{"id":"d06ce29c.e7c56","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":1137.3810634613037,"y":4190.389865875244,"z":"4e44f4dc.d3fbac","wires":[["2bf16ac7.c29516"]]},{"id":"91254f4.8fe1bb","type":"outcomeFalse","name":"false","xml":"<outcome value='false'>\n","comments":"","outputs":1,"x":1138.809684753418,"y":4234.67561340332,"z":"4e44f4dc.d3fbac","wires":[["a4deaa00.e82908"]]},{"id":"66145063.39707","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'No availability zones found in AAI for cloud region '\n       + $vnf-topology-operation-input.vnf-request-input.aic-cloud-region`\" />\n","comments":"","x":1428.8095703125,"y":4188.437558174133,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"a0fc8588.9798e8","type":"execute","name":"execute PropertiesNode","xml":"<execute plugin='org.onap.ccsdk.sli.plugins.prop.PropertiesNode' method='readProperties' >\n    <parameter name='fileName' value='%SDNC_CONFIG_DIR%/generic-resource-api-dg.properties' />\n    <parameter name='contextPrefix' value='prop' />\n","comments":"","outputs":1,"x":495.95240020751953,"y":233.84224128723145,"z":"4e44f4dc.d3fbac","wires":[[]]},{"id":"e8e240a8.b6802","type":"outcome","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":712.6190414428711,"y":1863.2470073699951,"z":"4e44f4dc.d3fbac","wires":[["fda0d94d.246058"]]},{"id":"6ba58c99.3d6c54","type":"switchNode","name":"switch ecomp-naming","xml":"<switch test='`$db.vf-model.ecomp-generated-naming`'>\n","comments":"","outputs":1,"x":1090.2384300231934,"y":1763.961443901062,"z":"4e44f4dc.d3fbac","wires":[["6bc3ca08.30d814","1bd7e0e4.afcd3f","59311d10.015684"]]},{"id":"fda0d94d.246058","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":858.3335418701172,"y":1863.247124671936,"z":"4e44f4dc.d3fbac","wires":[["6ba58c99.3d6c54","68402099.cbb6e"]]},{"id":"1bd7e0e4.afcd3f","type":"outcome","name":"N","xml":"<outcome value='N'>","comments":"","outputs":1,"x":1276.6668167114258,"y":1764.4375705718994,"z":"4e44f4dc.d3fbac","wires":[["8abd4d2f.9ce9"]]},{"id":"8abd4d2f.9ce9","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"No vnf-name was received but ecomp-generated-naming is not Y\" />\n","comments":"","x":1430.9526023864746,"y":1783.009015083313,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"6bc3ca08.30d814","type":"outcome","name":"Y","xml":"<outcome value='Y'>","comments":"","outputs":1,"x":1276.6668090820312,"y":1723.0090246200562,"z":"4e44f4dc.d3fbac","wires":[["d6abe0cd.f17a7"]]},{"id":"59311d10.015684","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":1276.6667556762695,"y":1807.2947025299072,"z":"4e44f4dc.d3fbac","wires":[["8abd4d2f.9ce9"]]},{"id":"d6abe0cd.f17a7","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1413.809726715088,"y":1723.151891708374,"z":"4e44f4dc.d3fbac","wires":[[]]},{"id":"9b1fc0be.8fa7","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":697.8097686767578,"y":2217.866183280945,"z":"4e44f4dc.d3fbac","wires":[["68621ac1.29c734"]]},{"id":"68621ac1.29c734","type":"set","name":"set tmp.vnf-name","xml":"<set>\n<parameter name='tmp.vnf-name' value=\"`$vnf-topology-operation-input.vnf-request-input.vnf-name`\" />\n","comments":"","x":863.5717315673828,"y":2216.7234535217285,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"e954ebf6.540d38","type":"call","name":"call GENERIC-RESOURCE-API:generate-unique-name","xml":"<call module='GENERIC-RESOURCE-API' rpc='generate-unique-name' mode='sync' >\n","comments":"","outputs":1,"x":1748.643009185791,"y":1913.0089440345764,"z":"4e44f4dc.d3fbac","wires":[["e58cf0cd.381b5","7d1e3ef3.b14f9"]]},{"id":"e58cf0cd.381b5","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":2025.7858123779297,"y":1886.5804772377014,"z":"4e44f4dc.d3fbac","wires":[["f78aa92e.072f88"]]},{"id":"7d1e3ef3.b14f9","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":2030.5475578308105,"y":1931.9613881111145,"z":"4e44f4dc.d3fbac","wires":[["67192240.ef86fc"]]},{"id":"8e80323.5aec3d","type":"set","name":"set variables for generating unique name","xml":"<set>\n<parameter name='generate-unique-name-input.action' value='ASSIGN' />\n<parameter name='generate-unique-name-input.context-id' value='`$vnf-topology-operation-input.vnf-information.vnf-id`' />\n<parameter name='generate-unique-name-input.index-table-name' value='VNF_NAME_INDEX' />\n<parameter name='generate-unique-name-input.index-table-prefix-column' value='vnf_name_prefix' />\n<parameter name='generate-unique-name-input.name-table-type' value='VNF_INSTANCE' />\n<parameter name='generate-unique-name-input.prefix' value=\"`'z' + $vnf-topology-operation-input.vnf-request-input.aic-cloud-region + $db.vf-model.nf-code`\" />\n","comments":"","x":1703.6432609558105,"y":1864.1042637825012,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"67192240.ef86fc","type":"set","name":"set tmp.vnf-name to generated name","xml":"<set>\n<parameter name='tmp.vnf-name' value='`$generate-unique-name-output.generated-name`' />\n","comments":"","x":2253.4519538879395,"y":1931.4374632835388,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"f78aa92e.072f88","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`$generate-unique-name-output.error-message`\" />\n","comments":"","x":2179.3572731018066,"y":1886.0089869499207,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"68402099.cbb6e","type":"switchNode","name":"switch naming-policy","xml":"<switch test='`$db.vf-model.naming-policy`'>\n","comments":"","outputs":1,"x":1088.024013519287,"y":1972.2470607757568,"z":"4e44f4dc.d3fbac","wires":[["a1c920b0.57e32","54eaf052.a1d45"]]},{"id":"a1c920b0.57e32","type":"outcome","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":1278.0239448547363,"y":1893.675615310669,"z":"4e44f4dc.d3fbac","wires":[["bccad88.6a02328"]]},{"id":"54eaf052.a1d45","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":1278.2621841430664,"y":2021.056559562683,"z":"4e44f4dc.d3fbac","wires":[["334f9686.9dd50a"]]},{"id":"bccad88.6a02328","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":1430.8812141418457,"y":1892.2470817565918,"z":"4e44f4dc.d3fbac","wires":[["8e80323.5aec3d","e954ebf6.540d38"]]},{"id":"f9872f82.e6538","type":"call","name":"call GENERIC-RESOURCE-API:naming-policy-generate-name","xml":"<call module='GENERIC-RESOURCE-API' rpc='naming-policy-generate-name' mode='sync' >\n","comments":"","outputs":1,"x":1769.9291381835938,"y":2036.7709412574768,"z":"4e44f4dc.d3fbac","wires":[["63e66d57.ad35d4","47bb6c9e.5da7d4"]]},{"id":"334f9686.9dd50a","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":1432.786033630371,"y":2021.056559562683,"z":"4e44f4dc.d3fbac","wires":[["7ca84586.ce108c","f9872f82.e6538"]]},{"id":"7ca84586.ce108c","type":"set","name":"set variables for generating name","xml":"<set>\n<parameter name='naming-policy-generate-name-input.policy-instance-name' value='`$db.vf-model.naming-policy`' />\n<parameter name='naming-policy-generate-name-input.naming-type' value='VNF' />\n<parameter name='naming-policy-generate-name-input.context-id' value='`$vnf-topology-operation-input.vnf-information.vnf-id`' />\n<parameter name='naming-policy-generate-name-input.action' value='ASSIGN' />\n<parameter name='naming-policy-generate-name-input.query-parameter' value='`$vnf-topology-operation-input.vnf-information.onap-model-information.model-customization-uuid`' />","comments":"","x":1679.929054260254,"y":1991.05659532547,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"1c84fc68.b37734","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Unable to generate VNF name\" />\n","comments":"","x":2212.786087036133,"y":2010.6278791427612,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"7fa1a5bb.63414c","type":"set","name":"set tmp.vnf-name to generated name","xml":"<set>\n<parameter name='tmp.vnf-name' value='`$naming-policy-generate-name-output.vnf-name`' />\n","comments":"","x":2291.214656829834,"y":2055.3421812057495,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"159fe4a1.e3dfcb","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":1802.6188735961914,"y":2735.746706008911,"z":"4e44f4dc.d3fbac","wires":[["10cd1a1d.c198e6","1a70e102.4df24f"]]},{"id":"1a70e102.4df24f","type":"call","name":"call GENERIC-RESOURCE-API:naming-policy-generate-name","xml":"<call module='GENERIC-RESOURCE-API' rpc='naming-policy-generate-name' mode='sync' >\n","comments":"","outputs":1,"x":2126.9045791625977,"y":2762.3182373046875,"z":"4e44f4dc.d3fbac","wires":[[]]},{"id":"10cd1a1d.c198e6","type":"set","name":"set variables for deleting name","xml":"<set>\n<parameter name='naming-policy-generate-name-input.naming-type' value='VNF' />\n<parameter name='naming-policy-generate-name-input.context-id' value='`$vnf-topology-operation-input.vnf-information.vnf-id`' />\n<parameter name='naming-policy-generate-name-input.action' value='DELETE' />\n","comments":"","x":2028.3331985473633,"y":2715.175308227539,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"b587067c.c12fd8","type":"comment","name":"Unassign the VNF name","info":"","comments":"","x":1894.2855224609375,"y":2655.746808052063,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"e0c152ab.e7e04","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":914.2857818603516,"y":2922.4135060310364,"z":"4e44f4dc.d3fbac","wires":[["f16260c8.4591b","159fe4a1.e3dfcb"]]},{"id":"a42ab710.cce278","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":912.6190643310547,"y":2964.080258369446,"z":"4e44f4dc.d3fbac","wires":[["4676d832.85c178","159fe4a1.e3dfcb"]]},{"id":"b6ad7e13.cbdb8","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":769.2857360839844,"y":3145.7468881607056,"z":"4e44f4dc.d3fbac","wires":[["f7a16dbf.78dcf","159fe4a1.e3dfcb"]]},{"id":"7f628377.de20fc","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1060.9524230957031,"y":3235.7468881607056,"z":"4e44f4dc.d3fbac","wires":[["7fcd46cd.478d88","159fe4a1.e3dfcb"]]},{"id":"85a5708b.39733","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1620.9524421691895,"y":3389.7467555999756,"z":"4e44f4dc.d3fbac","wires":[["b5a9325f.8e06e","159fe4a1.e3dfcb"]]},{"id":"22276dbf.92cb12","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1619.2857246398926,"y":3431.413507938385,"z":"4e44f4dc.d3fbac","wires":[["91d086d5.905598","159fe4a1.e3dfcb"]]},{"id":"2fba815e.79c32e","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1562.619068145752,"y":3847.4135036468506,"z":"4e44f4dc.d3fbac","wires":[["6395a483.342b9c","159fe4a1.e3dfcb"]]},{"id":"2bf16ac7.c29516","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1272.6190872192383,"y":4189.080174446106,"z":"4e44f4dc.d3fbac","wires":[["66145063.39707","159fe4a1.e3dfcb"]]},{"id":"c2464793.9ffc08","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1492.6190872192383,"y":4317.080174446106,"z":"4e44f4dc.d3fbac","wires":[["2754abb3.b85874","159fe4a1.e3dfcb"]]},{"id":"9d10abef.aa9d68","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1490.9523696899414,"y":4360.746926784515,"z":"4e44f4dc.d3fbac","wires":[["2639188b.f42278","159fe4a1.e3dfcb"]]},{"id":"672f3870.869518","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1355.9524612426758,"y":4434.080174446106,"z":"4e44f4dc.d3fbac","wires":[["32930b6a.86e284","159fe4a1.e3dfcb"]]},{"id":"6e62ccc6.dc7f34","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1354.285743713379,"y":4477.746926784515,"z":"4e44f4dc.d3fbac","wires":[["9263c515.503118","159fe4a1.e3dfcb"]]},{"id":"db6c1834.e91948","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":802.6191215515137,"y":4589.080289840698,"z":"4e44f4dc.d3fbac","wires":[["7baf675.e9c2498","159fe4a1.e3dfcb"]]},{"id":"ec9973e.c6a799","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":800.9524040222168,"y":4632.747042179108,"z":"4e44f4dc.d3fbac","wires":[["3c4d390f.0ff276","159fe4a1.e3dfcb"]]},{"id":"63e66d57.ad35d4","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":2068.095184326172,"y":2011.6994485855103,"z":"4e44f4dc.d3fbac","wires":[["1c84fc68.b37734"]]},{"id":"47bb6c9e.5da7d4","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":2072.8569297790527,"y":2057.0803594589233,"z":"4e44f4dc.d3fbac","wires":[["7fa1a5bb.63414c"]]},{"id":"3e07f67c.a7124a","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":723.3332824707031,"y":1366.666666984558,"z":"4e44f4dc.d3fbac","wires":[["baf35ab4.de3628","1a10c87.b7e5338"]]},{"id":"537d84c0.249e5c","type":"for","name":"for each instance group id","xml":"<for silentFailure='true' index='inst-group-index' start='0' end='`$vnf-topology-operation-input.vnf-request-input.vnf-network-instance-group-ids_length`' >\n","comments":"","outputs":1,"x":506.66662979125977,"y":1367.333312034607,"z":"4e44f4dc.d3fbac","wires":[["3e07f67c.a7124a"]]},{"id":"baf35ab4.de3628","type":"get-resource","name":"get-resource instance-group","xml":"<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"instance-group\" \n\t\tkey=\"instance-group.id = $vnf-topology-operation-input.vnf-request-input.vnf-network-instance-group-ids[$inst-group-index].vnf-network-instance-group-id\"\n        pfx='aai.instance-group' local-only='false' >\n\n","comments":"","outputs":1,"x":954.6666412353516,"y":1290.0000486373901,"z":"4e44f4dc.d3fbac","wires":[["5a73dff4.a3a92","1cc3de9c.f21291"]]},{"id":"1cc3de9c.f21291","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1168.9128494262695,"y":1308.150897026062,"z":"4e44f4dc.d3fbac","wires":[["8ab060f.9d1f2a"]]},{"id":"5a73dff4.a3a92","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":1177.8414459228516,"y":1266.4366302490234,"z":"4e44f4dc.d3fbac","wires":[["6cb384a2.611ddc"]]},{"id":"6cb384a2.611ddc","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Cannot find instance group id ' +\n      $vnf-topology-operation-input.vnf-request-input.vnf-network-instance-group-ids[$inst-group-index].vnf-network-instance-group-id\n      + ' in AAI'`\" />\n","comments":"","x":1350.6666564941406,"y":1264.0000410079956,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"8ab060f.9d1f2a","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error retrieving instance-group from AAI\" />\n","comments":"","x":1350.6666564941406,"y":1308.0000410079956,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"4cc45d68.737674","type":"execute","name":"printContext","xml":"<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='printContext' >\n<parameter name='filename' value='/var/tmp/bgb-vnf.log' />\n","comments":"","outputs":1,"x":485.8095016479492,"y":2334.2858095169067,"z":"4e44f4dc.d3fbac","wires":[[]]},{"id":"1a10c87.b7e5338","type":"for","name":"for each relationship","xml":"<for index='rel-index' start='0' end='`$aai.instance-group.relationship-list.relationship_length`' >\n","comments":"","outputs":1,"x":928.3332977294922,"y":1438.3333644866943,"z":"4e44f4dc.d3fbac","wires":[["334e1afb.9c1a56"]]},{"id":"334e1afb.9c1a56","type":"switchNode","name":"switch related-to","xml":"<switch test='`$aai.instance-group.relationship-list.relationship[$rel-index].related-to`'>\n","comments":"","outputs":1,"x":1141.6667404174805,"y":1438.333303451538,"z":"4e44f4dc.d3fbac","wires":[["9ec622df.a4f79"]]},{"id":"9ec622df.a4f79","type":"outcome","name":"collection","xml":"<outcome value='collection'>\n","comments":"","outputs":1,"x":1313.3333778381348,"y":1438.3333854675293,"z":"4e44f4dc.d3fbac","wires":[["f0af7cfb.630f1"]]},{"id":"f0af7cfb.630f1","type":"get-resource","name":"get-resource collection","xml":"<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"collection\" \n\t\tkey=\"collection.collection-id = $aai.instance-group.relationship-list.relationship[$rel-index].relationship-data[0].relationship-value\"\n        pfx='aai.collection' local-only='false' >\n\n","comments":"","outputs":1,"x":1533.3332824707031,"y":1436.6666469573975,"z":"4e44f4dc.d3fbac","wires":[["5a9a2b.446c05d4","ed35d4f2.f5a3d8","86f300a3.7cafb"]]},{"id":"ed35d4f2.f5a3d8","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1747.579475402832,"y":1388.1508359909058,"z":"4e44f4dc.d3fbac","wires":[["58b0fdde.ff35b4"]]},{"id":"5a9a2b.446c05d4","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":1756.508071899414,"y":1346.4365692138672,"z":"4e44f4dc.d3fbac","wires":[["a61328d2.f754c8"]]},{"id":"a61328d2.f754c8","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Cannot find collection ' +\n      $aai.instance-group.relationship-list.relationship[$rel-index].relationship-data[0].relationship-value\n      + ' in AAI'`\" />\n","comments":"","x":1913.3332824707031,"y":1345.0000410079956,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"58b0fdde.ff35b4","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"System error retrieving collection from AAI\" />\n","comments":"","x":1913.3332824707031,"y":1389.0000410079956,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"86f300a3.7cafb","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":1746.6666831970215,"y":1525.000012397766,"z":"4e44f4dc.d3fbac","wires":[["81df8930.31e0f8"]]},{"id":"81df8930.31e0f8","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":1899.9998245239258,"y":1524.3333082199097,"z":"4e44f4dc.d3fbac","wires":[["8a522d26.71257","a4f68cb7.668a2","8d0504d7.cdc028","cc147160.20bfe","3198ae9f.e95542"]]},{"id":"8a522d26.71257","type":"for","name":"for each network-instance-group","xml":"<for silentFailure='true' index='nig-index' start='0' end='`$service-data.network-instance-groups.network-instance-group_length`' >\n","comments":"","outputs":1,"x":2138.333168029785,"y":1475.0000562667847,"z":"4e44f4dc.d3fbac","wires":[["9063a8ee.f7faa8"]]},{"id":"a4f68cb7.668a2","type":"set","name":"set found-network-instance-group to false","xml":"<set>\n<parameter name='found-network-instance-group' value='false' />\n","comments":"","x":2168.3331298828125,"y":1428.3334283828735,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"9063a8ee.f7faa8","type":"switchNode","name":"network-instance-group-id matches?","xml":"<switch test='`$vnf-topology-operation-input.vnf-request-input.vnf-network-instance-group-ids[$inst-group-index].vnf-network-instance-group-id\n  == $service-data.network-instance-groups.network-instance-group[$nig-index].network-instance-group-id`'>\n","comments":"","outputs":1,"x":2454.9996795654297,"y":1475.0000553131104,"z":"4e44f4dc.d3fbac","wires":[["98d54f6d.c932"]]},{"id":"98d54f6d.c932","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":2676.666458129883,"y":1475.0000200271606,"z":"4e44f4dc.d3fbac","wires":[["a9385545.8b31c8"]]},{"id":"a9385545.8b31c8","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":2806.666488647461,"y":1475.000096321106,"z":"4e44f4dc.d3fbac","wires":[["85ee6cee.1bd2a","a14aee8f.5893a"]]},{"id":"85ee6cee.1bd2a","type":"set","name":"set found-network-instance-group to true","xml":"<set>\n<parameter name='found-network-instance-group' value='true' />\n","comments":"","x":3039.9996643066406,"y":1446.6667213439941,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"a14aee8f.5893a","type":"break","name":"break","xml":"<break>\n","comments":"","x":2933.333278656006,"y":1495.0000915527344,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"8d0504d7.cdc028","type":"switchNode","name":"switch found-network-instance-group","xml":"<switch test='`$found-network-instance-group`'>\n","comments":"","outputs":1,"x":2149.999786376953,"y":1525.0000371932983,"z":"4e44f4dc.d3fbac","wires":[["9189bba.faf6f48"]]},{"id":"9189bba.faf6f48","type":"outcomeFalse","name":"false","xml":"<outcome value='false'>\n","comments":"","outputs":1,"x":2371.666633605957,"y":1525.0000596046448,"z":"4e44f4dc.d3fbac","wires":[["520b2234.8e265c"]]},{"id":"520b2234.8e265c","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Could not find network instance group ' +\n      $vnf-topology-operation-input.vnf-request-input.vnf-network-instance-group-ids[$inst-group-index].vnf-network-instance-group-id\n      + ' in MD-SAL'`\" />\n","comments":"","x":2518.333206176758,"y":1523.3333940505981,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"ed7dcd3d.7a64c","type":"set","name":"set tmp.vnf-network-collection_length to 0","xml":"<set>\n<parameter name='tmp.vnf-network-collection_length' value='0' />\n","comments":"","x":554.9999694824219,"y":1318.3334436416626,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"cc147160.20bfe","type":"set","name":"set vnf-network-collection data","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-network-collections.vnf-network-collection[$tmp.vnf-network-collection_length].network-instance-group-function'\n  value='`$aai.instance-group.instance-group-function`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-network-collections.vnf-network-collection[$tmp.vnf-network-collection_length].network-instance-group-id'\n  value='`$aai.instance-group.id`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-network-collections.vnf-network-collection[$tmp.vnf-network-collection_length].network-collection-service-instance-id'\n  value='`$service-data.network-instance-groups.network-instance-group[$nig-index].service-instance-id`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-network-collections.vnf-network-collection[$tmp.vnf-network-collection_length].network-collection-customization-uuid'\n  value='`$aai.collection.collection-customization-id`' />\n","comments":"","x":2130.0001106262207,"y":1573.3333730697632,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"3198ae9f.e95542","type":"set","name":"increment tmp.vnf-network-collection_length","xml":"<set>\n<parameter name='tmp.vnf-network-collection_length' value='`$tmp.vnf-network-collection_length + 1`' />\n","comments":"","x":2171.666816711426,"y":1620.0000410079956,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"d4e45ae3.95e8e8","type":"set","name":"set vnf-network-collection_length","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-network-collections.vnf-network-collection_length'\n  value='`$tmp.vnf-network-collection_length`' />\n","comments":"","x":534.1666641235352,"y":1575.8333930969238,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"5602ea58.f558a4","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":711.6667289733887,"y":4705.476315498352,"z":"4e44f4dc.d3fbac","wires":[["f145731.7dc939"]]},{"id":"569d159b.7974ac","type":"for","name":"for each instance group id","xml":"<for silentFailure='true' index='inst-group-index' start='0' end='`$vnf-topology-operation-input.vnf-request-input.vnf-network-instance-group-ids_length`' >\n","comments":"","outputs":1,"x":495.0000762939453,"y":4706.142960548401,"z":"4e44f4dc.d3fbac","wires":[["5602ea58.f558a4"]]},{"id":"f145731.7dc939","type":"save","name":"save generic-vnf relationship to instance-group","xml":"<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\"\n   resource=\"generic-vnf:relationship-list\"\n   key=\"generic-vnf.vnf-id = $vnf-topology-operation-input.vnf-information.vnf-id\"\n   force=\"true\" pfx=\"tmp.AnAI-data\">\n    <parameter name=\"relationship-list.relationship[0].related-to\" value=\"instance-group\" />\n    <parameter name=\"relationship-list.relationship[0].related-link\"\n      value=\"`'/aai/v$/network/instance-groups/instance-group/'\n        + $vnf-topology-operation-input.vnf-request-input.vnf-network-instance-group-ids[$inst-group-index].vnf-network-instance-group-id`\" />\n","comments":"","outputs":1,"x":995.000057220459,"y":4704.999996185303,"z":"4e44f4dc.d3fbac","wires":[["aa364f8f.633a1","d50f251f.b38a38"]]},{"id":"2c0352e1.886b8e","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'No generic-vnf found in AAI for vnf ID ' + $service-data.vnfs.vnf[$vnf-index].vnf-id`\" />\n","comments":"","x":1551.6667289733887,"y":4723.333249092102,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"aa364f8f.633a1","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1254.3572807312012,"y":4681.952411651611,"z":"4e44f4dc.d3fbac","wires":[["b6ef2322.ecde1"]]},{"id":"d50f251f.b38a38","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":1262.9287109375,"y":4726.238124847412,"z":"4e44f4dc.d3fbac","wires":[["c25bd07f.ba3dc"]]},{"id":"39611e1d.841192","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating relationship in generic-vnf in AAI\" />\n","comments":"","x":1554.3573303222656,"y":4680.095512390137,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"b6ef2322.ecde1","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1407.6189651489258,"y":4681.532650947571,"z":"4e44f4dc.d3fbac","wires":[["39611e1d.841192","159fe4a1.e3dfcb"]]},{"id":"c25bd07f.ba3dc","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1405.952247619629,"y":4725.19940328598,"z":"4e44f4dc.d3fbac","wires":[["2c0352e1.886b8e","159fe4a1.e3dfcb"]]},{"id":"ccd49d85.073d1","type":"switchNode","name":"switch subnet_length","xml":"<switch test='`$aai.l3-network.l3-network[0].subnets.subnet_length`'>\n","comments":"","outputs":1,"x":1263.5714988708496,"y":3968.095386505127,"z":"4e44f4dc.d3fbac","wires":[["13f8461f.02754a","4f0f1832.9d6238","4a7eee29.bdad1"]]},{"id":"13f8461f.02754a","type":"outcome","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":1436.4286613464355,"y":3930.9524459838867,"z":"4e44f4dc.d3fbac","wires":[["d7fec3a.cf03e4"]]},{"id":"4f0f1832.9d6238","type":"outcome","name":"0","xml":"<outcome value='0'>\n","comments":"","outputs":1,"x":1437.8572311401367,"y":3969.523609161377,"z":"4e44f4dc.d3fbac","wires":[["d7fec3a.cf03e4"]]},{"id":"4a7eee29.bdad1","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":1436.428695678711,"y":4008.095001220703,"z":"4e44f4dc.d3fbac","wires":[["7e5c1302.e8982c"]]},{"id":"7e5c1302.e8982c","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1557.857250213623,"y":4008.0952682495117,"z":"4e44f4dc.d3fbac","wires":[["fe91b2bf.8c099","53c17453.f0880c"]]},{"id":"d7fec3a.cf03e4","type":"set","name":"set subnet_length to 0","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network[$network-index].subnets-data.subnet-data_length'\n   value='0' />\n","comments":"","x":1629.2858543395996,"y":3939.523609161377,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"6d2f55b8.a2759c","type":"switchNode","name":"switch: sdnc-model-name && sdnc-artifact-name != null","xml":"<switch test=\"`$db.vf-model.sdnc-model-name != '' and $db.vf-model.sdnc-artifact-name != ''`\">","comments":"","outputs":1,"x":1539.8175621032715,"y":949.9999332427979,"z":"4e44f4dc.d3fbac","wires":[["6dd97b97.b67924","7c6a046e.7cc64c"]]},{"id":"6dd97b97.b67924","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":1842.8889503479004,"y":922.6785984039307,"z":"4e44f4dc.d3fbac","wires":[["5b2ce020.a36b2"]]},{"id":"86ca6d15.0e146","type":"switchNode","name":"switch: param[].name","xml":"<switch test=\"`$vnf-topology-operation-input.vnf-request-input.vnf-input-parameters.param[$p].name`\">\n","comments":"","outputs":1,"x":1053.9484024047852,"y":598.2024068832397,"z":"4e44f4dc.d3fbac","wires":[["af0da8d9.d8ece8","6b384f33.32a78"]]},{"id":"63f83908.751498","type":"for","name":"for p in vnf-input-parameters,param[]","xml":"<for silentFailure='true' index='p' start='0' end='`$vnf-topology-operation-input.vnf-request-input.vnf-input-parameters.param_length`' >\n","comments":"","outputs":1,"x":760.055549621582,"y":598.7024393081665,"z":"4e44f4dc.d3fbac","wires":[["86ca6d15.0e146"]]},{"id":"e3aa680f.7c2008","type":"outcomeFalse","name":"false","xml":"<outcome value='false'>\n","comments":"","outputs":1,"x":1250.2581176757812,"y":949.9521970748901,"z":"4e44f4dc.d3fbac","wires":[["6d2f55b8.a2759c"]]},{"id":"542091af.e959d","type":"call","name":"call self-serve-vnf-assign","xml":"<call module='GENERIC-RESOURCE-API' rpc='self-serve-vnf-assign' mode='sync' >\n","comments":"","outputs":1,"x":2132.257625579834,"y":717.845365524292,"z":"4e44f4dc.d3fbac","wires":[["a34d6a59.d39c18"]]},{"id":"ecba7f02.a0e2c","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Failed to create self-serve assignment for vnf with vnf-id=' + $vnf-topology-operation-input.vnf-information.vnf-id`\" />\n","comments":"","x":2516.329002380371,"y":717.8453159332275,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"7c6a046e.7cc64c","type":"outcomeFalse","name":"false","xml":"<outcome value='false'>\n","comments":"","outputs":1,"x":1845.78169631958,"y":979.2856025695801,"z":"4e44f4dc.d3fbac","wires":[["ae713fba.3df7f"]]},{"id":"84263c0c.96c43","type":"set","name":"set tmp.exist.sdnc-artifact-name = true","xml":"<set>\n<parameter name='tmp.exist.sdnc-artifact-name' value='true' />","comments":"","x":1595.8413314819336,"y":648.0595769882202,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"ae12ffc.41b2a","type":"set","name":"set tmp.exist.sdnc-model-name = true","xml":"<set>\n<parameter name='tmp.exist.sdnc-model-name' value='true' />\n","comments":"","x":1592.5554389953613,"y":598.0595922470093,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"3f17b073.bbbcb","type":"switchNode","name":"switch: tmp.exist.sdnc-model-name && tmp.exist.sdnc-artifact-name == true","xml":"<switch test=\"`$tmp.exist.sdnc-model-name == 'true' and $tmp.exist.sdnc-artifact-name == 'true'`\">\n","comments":"","outputs":1,"x":877.9960327148438,"y":767.0237197875977,"z":"4e44f4dc.d3fbac","wires":[["d1f392c4.1dab8","e3aa680f.7c2008"]]},{"id":"d1f392c4.1dab8","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":1246.5079917907715,"y":719.1427278518677,"z":"4e44f4dc.d3fbac","wires":[["5b2ce020.a36b2"]]},{"id":"cd40e494.6d16b8","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":453.65077209472656,"y":500.8691177368164,"z":"4e44f4dc.d3fbac","wires":[["63f83908.751498","3f17b073.bbbcb","e38b7cc3.75e77","806e0f23.0111b"]]},{"id":"d5dac1e.b0d824","type":"comment","name":"SELF-SERVE FORK","info":"","comments":"","x":442.2221984863281,"y":624.6786069869995,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"af0da8d9.d8ece8","type":"outcome","name":"sdnc_model_name","xml":"<outcome value='sdnc_model_name'>\n","comments":"","outputs":1,"x":1310.1269781930105,"y":598.1072013037544,"z":"4e44f4dc.d3fbac","wires":[["ae12ffc.41b2a"]]},{"id":"6b384f33.32a78","type":"outcome","name":"sdnc_artifact_name","xml":"<outcome value='sdnc_artifact_name'>\n","comments":"","outputs":1,"x":1312.9841003417969,"y":647.5357732772827,"z":"4e44f4dc.d3fbac","wires":[["84263c0c.96c43"]]},{"id":"a34d6a59.d39c18","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":2337.555206298828,"y":717.3333969116211,"z":"4e44f4dc.d3fbac","wires":[["ecba7f02.a0e2c"]]},{"id":"11bf25d2.bdb8da","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":233.4126968383789,"y":234.2857322692871,"z":"4e44f4dc.d3fbac","wires":[["a0fc8588.9798e8","b32ac93e.aaa508","3e444c8d.9a16f4","cd40e494.6d16b8"]]},{"id":"b10f2375.b9afa","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1899.047706604004,"y":3986.6994638442993,"z":"4e44f4dc.d3fbac","wires":[["5bcbda97.98c4e4","3b85bc8c.02f794","e6ea74fb.9af718","f638c11c.6fd0e"]]},{"id":"cdefc051.a04bf","type":"set","name":"clear aai.l3-network","xml":"<set>\n<parameter name='aai.l3-network.' value='' />\n","comments":"","x":1257.6191520690918,"y":3359.5565824508667,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"6f9b0a93.f694a4","type":"break","name":"break","xml":"<break>\n","comments":"","x":3699.3330879211426,"y":3886.699146270752,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"be0cee42.5ab7e","type":"set","name":"set found-network to false","xml":"<set>\n<parameter name='found-network' value='false' />\n","comments":"","x":1399.047679901123,"y":3592.413550376892,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"46c88819.e15b38","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":2370.7619857788086,"y":3746.6993465423584,"z":"4e44f4dc.d3fbac","wires":[["9833efbf.69304","5f2e36ac.da9228"]]},{"id":"5f2e36ac.da9228","type":"switchNode","name":"switch found-network","xml":"<switch test='`$found-network`'>\n","comments":"","outputs":1,"x":2562.190532684326,"y":3776.6994009017944,"z":"4e44f4dc.d3fbac","wires":[["66e2cd5f.2e0f04"]]},{"id":"2a1ad752.bfcd38","type":"set","name":"set found-network to true","xml":"<set>\n<parameter name='found-network' value='true' />\n","comments":"","x":3755.047966003418,"y":3840.984827041626,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"66e2cd5f.2e0f04","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":2730.7620239257812,"y":3776.699330329895,"z":"4e44f4dc.d3fbac","wires":[["10d190b5.dcecdf"]]},{"id":"10d190b5.dcecdf","type":"break","name":"break","xml":"<break>\n","comments":"","x":2860.762092590332,"y":3775.27072429657,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"45b722b6.db776c","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":1571.0477027893066,"y":3720.4136247634888,"z":"4e44f4dc.d3fbac","wires":[["2b805935.a35cb6","c7e830d3.e9283"]]},{"id":"c7e830d3.e9283","type":"switchNode","name":"switch found-network","xml":"<switch test='`$found-network`'>\n","comments":"","outputs":1,"x":1781.0476570129395,"y":3792.413508415222,"z":"4e44f4dc.d3fbac","wires":[["24156eb7.6d1de2"]]},{"id":"24156eb7.6d1de2","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":1949.6191482543945,"y":3792.4134378433228,"z":"4e44f4dc.d3fbac","wires":[["25a3a86e.400be8"]]},{"id":"25a3a86e.400be8","type":"break","name":"break","xml":"<break>\n","comments":"","x":2079.6192169189453,"y":3790.9848318099976,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"e38b7cc3.75e77","type":"set","name":"initialize tmp.exist.sdnc-model-name && tmp.exist.sdnc-artifact-name = false","xml":"<set>\n<parameter name='tmp.exist.sdnc-model-name' value='false' />\n<parameter name='tmp.exist.sdnc-artifact-name' value='false' />","comments":"","x":880.1429061889648,"y":501.33330821990967,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"fb1b0696.2b0118","type":"returnSuccess","name":"return success","xml":"<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n","comments":"","x":2098.666561126709,"y":879.9999332427979,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"893e0d25.a86ef","type":"set","name":"set vnf-level-oper-status to PendingCreate","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-level-oper-status.order-status' value='PendingCreate' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-level-oper-status.last-rpc-action' value='`$vnf-topology-operation-input.sdnc-request-header.svc-action`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-level-oper-status.last-action' value='`$vnf-topology-operation-input.request-information.request-action`' />\n","comments":"","x":2188.480007171631,"y":782.3374137878418,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"f4cb36d0.800108","type":"execute","name":"printContext","xml":"<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='printContext' >\n<parameter name='filename' value='/var/tmp/ss-vnfend.log' />\n","comments":"","outputs":1,"x":2093.5712890625,"y":828.7771825790405,"z":"4e44f4dc.d3fbac","wires":[[]]},{"id":"5b2ce020.a36b2","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":1899.6664695739746,"y":718.3333206176758,"z":"4e44f4dc.d3fbac","wires":[["542091af.e959d","893e0d25.a86ef","f4cb36d0.800108","fb1b0696.2b0118"]]},{"id":"e6ea74fb.9af718","type":"set","name":"set subnet data","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network[$network-index].subnets-data.subnet-data[$subnet-index].ip-version'\n   value='`$tmp.ip-version`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network[$network-index].subnets-data.subnet-data[$subnet-index].subnet-id'\n   value='`$aai.l3-network.l3-network[$db-network-index].subnets.subnet[$subnet-index].neutron-subnet-id`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network[$network-index].subnets-data.subnet-data[$subnet-index].sdnc-subnet-id'\n   value='`$aai.l3-network.l3-network[$db-network-index].subnets.subnet[$subnet-index].subnet-id`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network[$network-index].subnets-data.subnet-data[$subnet-index].subnet-role'\n   value='`$aai.l3-network.l3-network[$db-network-index].subnets.subnet[$subnet-index].subnet-role`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network[$network-index].subnets-data.subnet-data[$subnet-index].subnet-name'\n   value='`$aai.l3-network.l3-network[$db-network-index].subnets.subnet[$subnet-index].subnet-name`' />\n","comments":"","x":2053.3334732055664,"y":4017.3812103271484,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"f638c11c.6fd0e","type":"switchNode","name":"switch dhcp-enabled","xml":"<switch test='`$aai.l3-network.l3-network[$db-network-index].subnets.subnet[$subnet-index].dhcp-enabled`'>\n","comments":"","outputs":1,"x":2067.8572540283203,"y":4070.2241640090942,"z":"4e44f4dc.d3fbac","wires":[["1616a214.4d52fe","6cb55598.b5519c"]]},{"id":"1616a214.4d52fe","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":2230.714418683733,"y":4048.795521736145,"z":"4e44f4dc.d3fbac","wires":[["9228e480.6386e8"]]},{"id":"6cb55598.b5519c","type":"outcomeFalse","name":"false","xml":"<outcome value='false'>\n","comments":"","outputs":1,"x":2229.2857513427734,"y":4094.5099477767944,"z":"4e44f4dc.d3fbac","wires":[["10fd862a.7096da"]]},{"id":"9228e480.6386e8","type":"set","name":"set dhcp-enabled to Y","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network[$network-index].subnets-data.subnet-data[$subnet-index].dhcp-enabled'\n   value='Y' />\n","comments":"","x":2403.571617126465,"y":4047.3669176101685,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"10fd862a.7096da","type":"set","name":"set dhcp-enabled to N","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network[$network-index].subnets-data.subnet-data[$subnet-index].dhcp-enabled'\n   value='N' />\n","comments":"","x":2400.714385986328,"y":4094.5099477767944,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"5bcbda97.98c4e4","type":"switchNode","name":"switch subnet-role","xml":"<switch test='`$aai.l3-network.l3-network[$db-network-index].subnets.subnet[$subnet-index].subnet-role`'>\n","comments":"","outputs":1,"x":2068.333423614502,"y":3899.2718362808228,"z":"4e44f4dc.d3fbac","wires":[["2f3e4a5d.7c3b36"]]},{"id":"2f3e4a5d.7c3b36","type":"outcome","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":2235.000026702881,"y":3899.2714881896973,"z":"4e44f4dc.d3fbac","wires":[["24afcaa5.1defa6"]]},{"id":"24afcaa5.1defa6","type":"set","name":"set subnet-role to NONE","xml":"<set>\n<parameter name='aai.l3-network.l3-network[$db-network-index].subnets.subnet[$subnet-index].subnet-role' value='NONE' />\n","comments":"","x":2416.6668128967285,"y":3898.605140686035,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"3b85bc8c.02f794","type":"switchNode","name":"switch ip-version","xml":"<switch test='`$aai.l3-network.l3-network[$db-network-index].subnets.subnet[$subnet-index].ip-version`'>\n","comments":"","outputs":1,"x":2063.5717582702637,"y":3963.762942314148,"z":"4e44f4dc.d3fbac","wires":[["1c2233e9.20214c","e680d1ed.d7f9c"]]},{"id":"1c2233e9.20214c","type":"outcome","name":"4","xml":"<outcome value='4'>\n","comments":"","outputs":1,"x":2229.285900115967,"y":3945.191339492798,"z":"4e44f4dc.d3fbac","wires":[["f01b1452.dd9f88"]]},{"id":"e680d1ed.d7f9c","type":"outcome","name":"6","xml":"<outcome value='6'>\n","comments":"","outputs":1,"x":2229.285861968994,"y":3986.6200828552246,"z":"4e44f4dc.d3fbac","wires":[["319040e.ea0d5c"]]},{"id":"f01b1452.dd9f88","type":"set","name":"set tmp.ip-version to ipv4","xml":"<set>\n<parameter name='tmp.ip-version' value='ipv4' />\n","comments":"","x":2416.428665161133,"y":3944.3342666625977,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"319040e.ea0d5c","type":"set","name":"set tmp.ip-version to ipv6","xml":"<set>\n<parameter name='tmp.ip-version' value='ipv6' />\n","comments":"","x":2415.000217437744,"y":3986.6200847625732,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"806e0f23.0111b","type":"switchNode","name":"switch: vnf-input-parameters.param_length","xml":"<switch test=\"`$vnf-topology-operation-input.vnf-request-input.vnf-input-parameters.param_length`\">\n","comments":"","outputs":1,"x":778.5714645385742,"y":547.1428127288818,"z":"4e44f4dc.d3fbac","wires":[["f780fd19.5435b"]]},{"id":"f780fd19.5435b","type":"other","name":"NULL","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":1042.1428833007812,"y":547.4285526275635,"z":"4e44f4dc.d3fbac","wires":[["7fdf9810.65be18"]]},{"id":"7fdf9810.65be18","type":"set","name":"set vnf-input-parameters.param_length = 0","xml":"<set>\n<parameter name='vnf-topology-operation-input.vnf-request-input.vnf-input-parameters.param_length' value='0' />\n","comments":"","x":1315.8571243286133,"y":547.2857141494751,"z":"4e44f4dc.d3fbac","wires":[]},{"id":"ed4c9615.d61838","type":"switchNode","name":"switch network-role","xml":"<switch test='`$db.vf-network-role-mapping[$role-index].network-role`'>\n","comments":"","outputs":1,"x":719.9999656677246,"y":3700.0000677108765,"z":"4e44f4dc.d3fbac","wires":[["43bb48c2.19f5b8","be93f82a.71aa68"]]},{"id":"43bb48c2.19f5b8","type":"outcome","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":886.666561126709,"y":3668.333317756653,"z":"4e44f4dc.d3fbac","wires":[["1443f6c4.ddb499"]]},{"id":"be93f82a.71aa68","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":886.6666069030762,"y":3726.666666984558,"z":"4e44f4dc.d3fbac","wires":[["7b16dda0.235334"]]},{"id":"1443f6c4.ddb499","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1018.3333129882812,"y":3666.66650390625,"z":"4e44f4dc.d3fbac","wires":[[]]}]