[
  {
    "id": "28277ffa.638ba",
    "type": "dgstart",
    "name": "DGSTART",
    "outputs": 1,
    "x": 139.57137298583984,
    "y": 52.00390625,
    "z": "3dfa2ee1.d9eb62",
    "wires": [
      [
        "4a59deb7.c7457"
      ]
    ]
  },
  {
    "id": "4a59deb7.c7457",
    "type": "service-logic",
    "name": "GENERIC-RESOURCE-API ${project.version}",
    "module": "GENERIC-RESOURCE-API",
    "version": "${project.version}",
    "comments": "",
    "xml": "<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>",
    "outputs": 1,
    "x": 214.8570785522461,
    "y": 92.24201774597168,
    "z": "3dfa2ee1.d9eb62",
    "wires": [
      [
        "4241d8c0.16daf8"
      ]
    ]
  },
  {
    "id": "4241d8c0.16daf8",
    "type": "method",
    "name": "method sdwan-vnf-topology-operation-device-deactivate",
    "xml": "<method rpc='sdwan-vnf-topology-operation-device-deactivate' mode='sync'>\n",
    "comments": "",
    "outputs": 1,
    "x": 208,
    "y": 132.0039005279541,
    "z": "3dfa2ee1.d9eb62",
    "wires": [
      [
        "e1131c3b.26e86"
      ]
    ]
  },
  {
    "id": "e1131c3b.26e86",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 232.73810195922852,
    "y": 322.69744873046875,
    "z": "3dfa2ee1.d9eb62",
    "wires": [
      [
        "f0fdfb5e.5f4f98",
        "f90e57ef.2882a8",
        "7e2abc70.e22d84",
        "c34a88b2.04b7e8",
        "270267d5.5e26e8",
        "58a16fad.ea89b",
        "90a0a7b1.52f328",
        "f53c993f.c19e48",
        "30405ea5.d01402",
        "6f2e8f06.6beb6",
        "8a59eab6.8ca808",
        "fd82888d.de41f8"
      ]
    ]
  },
  {
    "id": "f0fdfb5e.5f4f98",
    "type": "set",
    "name": "set vnf in service-data",
    "xml": "<set>\n<parameter name='service-data.vnfs.vnf[$tmp.vidx].vnf-id' value='`$vnf-topology-operation-input.vnf-information.vnf-id`' />\n<parameter name='service-data.vnfs.vnf[$tmp.vidx].vnf-data.sdnc-request-header.' value='`$vnf-topology-operation-input.sdnc-request-header.`' />\n<parameter name='service-data.vnfs.vnf[$tmp.vidx].vnf-data.request-information.' value='`$vnf-topology-operation-input.request-information.`' />\n<parameter name='service-data.vnfs.vnf[$tmp.vidx].vnf-data.service-information.' value='`$vnf-topology-operation-input.service-information.`' />\n<parameter name='service-data.vnfs.vnf[$tmp.vidx].vnf-data.vnf-information.' value='`$vnf-topology-operation-input.vnf-information.`' />",
    "comments": "",
    "x": 488.57144927978516,
    "y": 745.0041379928589,
    "z": "3dfa2ee1.d9eb62",
    "wires": []
  },
  {
    "id": "f90e57ef.2882a8",
    "type": "set",
    "name": "set vnfId and vnf-object-path",
    "xml": "<set>\n<parameter name='vnfId' value='`$vnf-topology-operation-input.vnf-information.vnf-id`' />\n<parameter name=\"vnf-object-path\" value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'  + $vnf-topology-operation-input.service-information.service-instance-id  + '/service-data/vnfs/vnf/'  + $vnf-topology-operation-input.vnf-information.vnf-id  + '/vnf-data/'` \" />",
    "comments": "",
    "x": 510.12699127197266,
    "y": 787.2263488769531,
    "z": "3dfa2ee1.d9eb62",
    "wires": []
  },
  {
    "id": "c34a88b2.04b7e8",
    "type": "returnSuccess",
    "name": "return success",
    "xml": "<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n",
    "comments": "",
    "x": 468.90482330322266,
    "y": 949.7816972732544,
    "z": "3dfa2ee1.d9eb62",
    "wires": []
  },
  {
    "id": "86982181.80824",
    "type": "update",
    "name": "update SDWAN DeviceInstance status to AAI",
    "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='device' \n      key='device.id = $vnf-topology-operation-input.vnf-information.vnf-id' >\n<parameter name='id' value='`$vnf-topology-operation-input.vnf-information.vnf-id`' />\n<parameter name='operational-status' value='PendingDelete' />",
    "comments": "",
    "outputs": 1,
    "x": 559.2344131469727,
    "y": 890.1517286300659,
    "z": "3dfa2ee1.d9eb62",
    "wires": [
      []
    ]
  },
  {
    "id": "7e2abc70.e22d84",
    "type": "set",
    "name": "set vnf-level-oper-status to PendingDelete",
    "xml": "<set>\n<parameter name='service-data.vnfs.vnf[$tmp.vidx].vnf-data.vnf-level-oper-status.order-status' value='PendingDelete' />\n<parameter name='service-data.vnfs.vnf[$tmp.vidx].vnf-data.vnf-level-oper-status.last-rpc-action' value='`$vnf-topology-operation-input.sdnc-request-header.svc-action`' />\n<parameter name='service-data.vnfs.vnf[$tmp.vidx].vnf-data.vnf-level-oper-status.last-action' value='`$vnf-topology-operation-input.request-information.request-action`' />\n",
    "comments": "",
    "x": 548.5714797973633,
    "y": 844.0041055679321,
    "z": "3dfa2ee1.d9eb62",
    "wires": []
  },
  {
    "id": "6f2e8f06.6beb6",
    "type": "get-resource",
    "name": "get-resource esr-thirdparty-sdnc",
    "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"esr-thirdparty-sdnc\" \n\t\tkey=\"esr-thirdparty-sdnc.thirdparty-sdnc-id = SDWANController AND \n\t\t     depth = '1'\"\n        pfx='tmp.aai.esr-thirdparty-sdnc' local-only='false' >\n\n",
    "comments": "",
    "outputs": 1,
    "x": 515.1269454956055,
    "y": 372.00386905670166,
    "z": "3dfa2ee1.d9eb62",
    "wires": [
      [
        "f6a1b10b.feba7",
        "3f65fa89.adee86",
        "78d7b0ce.bc9f4"
      ]
    ]
  },
  {
    "id": "f6a1b10b.feba7",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 742.126953125,
    "y": 300.00386810302734,
    "z": "3dfa2ee1.d9eb62",
    "wires": [
      [
        "7f8f918f.20ef"
      ]
    ]
  },
  {
    "id": "7f8f918f.20ef",
    "type": "set",
    "name": "set controller data",
    "xml": "<set>\n<parameter name='prop.sdncRestApi.thirdpartySdnc.url' value=\"`$tmp.aai.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].service-url`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.user' value=\"`$tmp.aai.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].user-name`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.password' value=\"`$tmp.aai.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].password`\" />\n",
    "comments": "",
    "x": 940.627067565918,
    "y": 291.003867149353,
    "z": "3dfa2ee1.d9eb62",
    "wires": []
  },
  {
    "id": "3f65fa89.adee86",
    "type": "not-found",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 744.6178817749023,
    "y": 332.577880859375,
    "z": "3dfa2ee1.d9eb62",
    "wires": [
      [
        "d39e70d3.4d393"
      ]
    ]
  },
  {
    "id": "d39e70d3.4d393",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying esr-thirdparty-sdnc from AnAI with thirdparty-sdnc-id = ' + $tmp.thirdparty-sdnc-id`\" />\n\n",
    "comments": "",
    "x": 921.1893501281738,
    "y": 329.86363315582275,
    "z": "3dfa2ee1.d9eb62",
    "wires": []
  },
  {
    "id": "78d7b0ce.bc9f4",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 736.9508895874023,
    "y": 373.91119384765625,
    "z": "3dfa2ee1.d9eb62",
    "wires": [
      [
        "9d02040e.b8d128"
      ]
    ]
  },
  {
    "id": "9d02040e.b8d128",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying esr-thirdparty-sdnc from AnAI with thirdparty-sdnc-id = ' + $tmp.thirdparty-sdnc-id`\" />\n\n",
    "comments": "",
    "x": 924.723445892334,
    "y": 369.35038661956787,
    "z": "3dfa2ee1.d9eb62",
    "wires": []
  },
  {
    "id": "8a59eab6.8ca808",
    "type": "execute",
    "name": "execute RestApiCallNode Get token",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/sdwan-device.json'`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/controller/v2/tokens'`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"post\"/>\n<parameter name=\"responsePrefix\" value=\"token-result\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.openecomp.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>",
    "comments": "",
    "outputs": 1,
    "x": 538.0155982971191,
    "y": 438.1150779724121,
    "z": "3dfa2ee1.d9eb62",
    "wires": [
      [
        "26f9897c.dede86",
        "de10be74.3d175"
      ]
    ]
  },
  {
    "id": "26f9897c.dede86",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 773.0155982971191,
    "y": 416.1150779724121,
    "z": "3dfa2ee1.d9eb62",
    "wires": [
      [
        "2cf72494.6f564c"
      ]
    ]
  },
  {
    "id": "de10be74.3d175",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 765.2655982971191,
    "y": 469.75796127319336,
    "z": "3dfa2ee1.d9eb62",
    "wires": [
      [
        "af0aa9cf.0f24c8"
      ]
    ]
  },
  {
    "id": "2cf72494.6f564c",
    "type": "set",
    "name": "set token-id",
    "xml": "<set>\n<parameter name='prop.sdncRestApi.token_id' value='`$token-result.data.token_id`' />\n",
    "comments": "",
    "x": 927.0155982971191,
    "y": 417.1150779724121,
    "z": "3dfa2ee1.d9eb62",
    "wires": []
  },
  {
    "id": "d3b082c5.69f01",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 874.1268157958984,
    "y": 653.1151113510132,
    "z": "3dfa2ee1.d9eb62",
    "wires": [
      [
        "99768bda.9cb4d8"
      ]
    ]
  },
  {
    "id": "99768bda.9cb4d8",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "comments": "",
    "outputs": 1,
    "x": 1045.2378311157227,
    "y": 651.8929319381714,
    "z": "3dfa2ee1.d9eb62",
    "wires": [
      []
    ]
  },
  {
    "id": "af0aa9cf.0f24c8",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 913.1266403198242,
    "y": 466.00391006469727,
    "z": "3dfa2ee1.d9eb62",
    "wires": [
      []
    ]
  },
  {
    "id": "2e0a17d4.eed478",
    "type": "comment",
    "name": "Do Nothing",
    "info": "",
    "comments": "",
    "x": 1048.6822141011553,
    "y": 464.89278581407336,
    "z": "3dfa2ee1.d9eb62",
    "wires": []
  },
  {
    "id": "333f615c.44144e",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 870.6823692321777,
    "y": 706.4483976364136,
    "z": "3dfa2ee1.d9eb62",
    "wires": [
      [
        "d0bb3a12.db6658"
      ]
    ]
  },
  {
    "id": "d0bb3a12.db6658",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create vpn rest api\" />\n",
    "comments": "",
    "x": 1015.6823692321777,
    "y": 709.4483976364136,
    "z": "3dfa2ee1.d9eb62",
    "wires": []
  },
  {
    "id": "d3422f84.faf5e",
    "type": "comment",
    "name": "deviceId need to provide here?",
    "info": "",
    "comments": "",
    "x": 509.9047050476074,
    "y": 504.00390625,
    "z": "3dfa2ee1.d9eb62",
    "wires": []
  },
  {
    "id": "f9274c25.d5eea",
    "type": "comment",
    "name": "tmp.thirdparty-sdnc-id to be hardcoded here?",
    "info": "",
    "comments": "",
    "x": 563.9047393798828,
    "y": 291.0039653778076,
    "z": "3dfa2ee1.d9eb62",
    "wires": []
  },
  {
    "id": "4a930baa.676754",
    "type": "returnSuccess",
    "name": "return success",
    "xml": "<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n",
    "comments": "",
    "x": 803.904655456543,
    "y": 1694.3372421264648,
    "z": "3dfa2ee1.d9eb62",
    "wires": []
  },
  {
    "id": "270267d5.5e26e8",
    "type": "for",
    "name": "for vidx..service-data.vnfs.vnf_length[]",
    "xml": "<for index='vidx' start='0' end='`$service-data.vnfs.vnf_length`' >\n",
    "comments": "",
    "outputs": 1,
    "x": 547.6026229858398,
    "y": 220.03515625,
    "z": "3dfa2ee1.d9eb62",
    "wires": [
      [
        "728ab8ba.7e8bd8"
      ]
    ]
  },
  {
    "id": "728ab8ba.7e8bd8",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 795.9522171020508,
    "y": 220.5752239227295,
    "z": "3dfa2ee1.d9eb62",
    "wires": [
      [
        "905ea52f.02efa8"
      ]
    ]
  },
  {
    "id": "905ea52f.02efa8",
    "type": "switchNode",
    "name": "switch vnfid found",
    "xml": "<switch test=\"`$service-data.vnfs.vnf[$vidx].vnf-id == $vnf-topology-operation-input.vnf-information.vnf-id`\">\n\n",
    "comments": "",
    "outputs": 1,
    "x": 950.0318145751953,
    "y": 220.28530597686768,
    "z": "3dfa2ee1.d9eb62",
    "wires": [
      [
        "7e04ad09.ef3004"
      ]
    ]
  },
  {
    "id": "873538e6.7c6cb8",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 1243.6293258666992,
    "y": 221.58561897277832,
    "z": "3dfa2ee1.d9eb62",
    "wires": [
      [
        "3c1b116b.de0f4e",
        "2734bda2.1de7a2",
        "79d2ab5b.7f7124"
      ]
    ]
  },
  {
    "id": "7e04ad09.ef3004",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1104.9838066101074,
    "y": 221.17798519134521,
    "z": "3dfa2ee1.d9eb62",
    "wires": [
      [
        "873538e6.7c6cb8"
      ]
    ]
  },
  {
    "id": "2734bda2.1de7a2",
    "type": "set",
    "name": "set vnf-request-input.",
    "xml": "<set>\n<parameter name='vnf-request-input.' value='`$ctx.vnf-data.vnf-data.vnf-request-input.`' />\n\n",
    "comments": "",
    "x": 1484.9621810913086,
    "y": 177.58567905426025,
    "z": "3dfa2ee1.d9eb62",
    "wires": []
  },
  {
    "id": "3c1b116b.de0f4e",
    "type": "set",
    "name": "set tmp.vidx and ctx.vnf-data",
    "xml": "<set>\n<parameter name='tmp.vidx' value='`$vidx`' />\n<parameter name='ctx.vnf-data.' value='`$service-data.vnfs.vnf[$vidx].`' />\n",
    "comments": "",
    "x": 1512.5158920288086,
    "y": 130.92804336547852,
    "z": "3dfa2ee1.d9eb62",
    "wires": []
  },
  {
    "id": "79d2ab5b.7f7124",
    "type": "call",
    "name": "call sdwan-get-device-param",
    "xml": "<call module='GENERIC-RESOURCE-API' rpc='sdwan-get-device-param' mode='sync' >\n",
    "comments": "",
    "outputs": 1,
    "x": 1489.6026306152344,
    "y": 240.03514957427979,
    "z": "3dfa2ee1.d9eb62",
    "wires": [
      []
    ]
  },
  {
    "id": "58a16fad.ea89b",
    "type": "switchNode",
    "name": "switch tmp.vidx ",
    "xml": "<switch test=\"`$tmp.vidx`\">\n\n",
    "comments": "",
    "outputs": 1,
    "x": 464.60262298583984,
    "y": 262.03515625,
    "z": "3dfa2ee1.d9eb62",
    "wires": [
      [
        "dde49dff.66ec"
      ]
    ]
  },
  {
    "id": "dde49dff.66ec",
    "type": "outcome",
    "name": "NULL",
    "xml": "<outcome value=''>\n",
    "comments": "",
    "outputs": 1,
    "x": 612.0312652587891,
    "y": 261.6065664291382,
    "z": "3dfa2ee1.d9eb62",
    "wires": [
      [
        "94b39f5e.140ba"
      ]
    ]
  },
  {
    "id": "94b39f5e.140ba",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"vnf-topology-operation-input.vnf-request-input.vnf-id not found in service-data\" />\n",
    "comments": "",
    "x": 761.4599914550781,
    "y": 262.7494840621948,
    "z": "3dfa2ee1.d9eb62",
    "wires": []
  },
  {
    "id": "fd82888d.de41f8",
    "type": "execute",
    "name": "execute RestApiCallNode delete Devcie Instance",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/sdwan-device-del.json'`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/controller/campus/v3/devices'`\" />\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"delete\"/>\n<parameter name=\"responsePrefix\" value=\"deviceResp\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.openecomp.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n<parameter name='customHttpHeaders' value=\"`'X-ACCESS-TOKEN=' + $prop.sdncRestApi.token_id`\" />",
    "comments": "",
    "outputs": 1,
    "x": 580.6026992797852,
    "y": 676.0352630615234,
    "z": "3dfa2ee1.d9eb62",
    "wires": [
      [
        "d3b082c5.69f01",
        "333f615c.44144e"
      ]
    ]
  },
  {
    "id": "90a0a7b1.52f328",
    "type": "execute",
    "name": "execute Properties",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.prop.PropertiesNode' method='readProperties' >\n    <parameter name='fileName' value='%SDNC_CONFIG_DIR%/generic-resource-api-dg.properties' />\n    <parameter name='contextPrefix' value='prop' />\n",
    "comments": "",
    "outputs": 1,
    "x": 488.60262298583984,
    "y": 326.03515625,
    "z": "3dfa2ee1.d9eb62",
    "wires": [
      []
    ]
  },
  {
    "id": "f53c993f.c19e48",
    "type": "set",
    "name": "set device Id length and deviceId",
    "xml": "<set>\n<parameter name='prop.devices[0]' value='`$prop.device.deviceId`' />\n\n\n",
    "comments": "",
    "x": 530.6026382446289,
    "y": 621.0351729393005,
    "z": "3dfa2ee1.d9eb62",
    "wires": []
  },
  {
    "id": "30405ea5.d01402",
    "type": "set",
    "name": "set device Id length and deviceId",
    "xml": "<set>\n<parameter name='prop.devices_length' value='1' />\n\n\n",
    "comments": "",
    "x": 524.6026229858398,
    "y": 571.03515625,
    "z": "3dfa2ee1.d9eb62",
    "wires": []
  }
]
