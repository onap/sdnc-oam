[
    {
        "id": "ed294889.e18cd8",
        "type": "dgstart",
        "name": "DGSTART",
        "outputs": 1,
        "x": 117,
        "y": 57,
        "z": "a8db409e.810378",
        "wires": [
            [
                "d573cd56.a0362"
            ]
        ]
    },
    {
        "id": "d573cd56.a0362",
        "type": "service-logic",
        "name": "GENERIC-RESOURCE-API ${project.version}",
        "module": "GENERIC-RESOURCE-API",
        "version": "${project.version}",
        "comments": "",
        "xml": "<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>",
        "outputs": 1,
        "x": 248.2856903076172,
        "y": 106.23810863494873,
        "z": "a8db409e.810378",
        "wires": [
            [
                "ab294e07.a9e7f"
            ]
        ]
    },
    {
        "id": "ab294e07.a9e7f",
        "type": "method",
        "name": "method sotn-vf-operation-l2vpn-create",
        "xml": "<method rpc='sotn-vf-operation-l2vpn-create' mode='sync'>\n",
        "comments": "",
        "outputs": 1,
        "x": 251.42861938476562,
        "y": 191.00003242492676,
        "z": "a8db409e.810378",
        "wires": [
            [
                "3b2ee2be.0d5776"
            ]
        ]
    },
    {
        "id": "3b2ee2be.0d5776",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 664.2380447387695,
        "y": 394.6666717529297,
        "z": "a8db409e.810378",
        "wires": [
            [
                "7075470e.ead518",
                "a887fb8.23d1908",
                "c96cd735.589ad8",
                "6d0e8b42.1f8964",
                "49bfb25c.1c60ac",
                "3b8acefc.66b31a",
                "6eb961ad.5ae338",
                "adbadf0e.275b3",
                "c0c21f0e.1b5958",
                "f1922be.86c2058",
                "d0ca9568.fe847",
                "5bbdffcc.b3f3b8"
            ]
        ]
    },
    {
        "id": "a887fb8.23d1908",
        "type": "set",
        "name": "set vnf-level-oper-status to Created",
        "xml": "<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-level-oper-status.order-status' value='Created' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-level-oper-status.last-rpc-action' value='`$vnf-topology-operation-input.sdnc-request-header.svc-action`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-level-oper-status.last-action' value='`$vnf-topology-operation-input.request-information.request-action`' />\n",
        "comments": "",
        "x": 1086.3848571777344,
        "y": 758.6706044944003,
        "z": "a8db409e.810378",
        "wires": []
    },
    {
        "id": "7075470e.ead518",
        "type": "set",
        "name": "copy input data to service data",
        "xml": "<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-id' value='`$prop.vnf-id`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.sdnc-request-header.' value='$vnf-topology-operation-input.sdnc-request-header.' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.request-information.' value='$vnf-topology-operation-input.request-information.' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.service-information.' value='$vnf-topology-operation-input.service-information.' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-information.' value='$vnf-topology-operation-input.vnf-information.' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-request-input.' value='$vnf-topology-operation-input.vnf-request-input.' />\n\n",
        "comments": "",
        "x": 1078.2380447387695,
        "y": 653.6668565543368,
        "z": "a8db409e.810378",
        "wires": []
    },
    {
        "id": "49bfb25c.1c60ac",
        "type": "execute",
        "name": "execute generate-vnf-index",
        "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='generateUUID' >\n<parameter name=\"ctx-destination\" value=\"prop.connectivity-id\"/>\n",
        "comments": "",
        "outputs": 1,
        "x": 1066.571548461914,
        "y": 603.3334405692294,
        "z": "a8db409e.810378",
        "wires": [
            []
        ]
    },
    {
        "id": "c0c21f0e.1b5958",
        "type": "set",
        "name": "set vnf-index to service data",
        "xml": "<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-information.vnf-id' value='`$prop.vnf-id`' />\n",
        "comments": "",
        "x": 1077.5716247558594,
        "y": 710.3334443839267,
        "z": "a8db409e.810378",
        "wires": []
    },
    {
        "id": "c96cd735.589ad8",
        "type": "switchNode",
        "name": "switch service-data.vnfs.vnf_length",
        "xml": "<switch test='`$service-data.vnfs.vnf_length`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1093.5713653564453,
        "y": 273.3333633216098,
        "z": "a8db409e.810378",
        "wires": [
            [
                "9138e1fa.f1d37",
                "bf45ff7d.c852e"
            ]
        ]
    },
    {
        "id": "9138e1fa.f1d37",
        "type": "other",
        "name": "NULL",
        "xml": "<outcome value=''>\n",
        "comments": "",
        "outputs": 1,
        "x": 1328.2857513427734,
        "y": 268.47618367988616,
        "z": "a8db409e.810378",
        "wires": [
            [
                "4dbced61.ca9034"
            ]
        ]
    },
    {
        "id": "4dbced61.ca9034",
        "type": "set",
        "name": "set vnf-index=0",
        "xml": "<set>\n<parameter name='vnf-index' value='0' />\n",
        "comments": "",
        "x": 1488.5714569091797,
        "y": 268.47627523262054,
        "z": "a8db409e.810378",
        "wires": []
    },
    {
        "id": "bf45ff7d.c852e",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1324.7142906188965,
        "y": 301.7620151313022,
        "z": "a8db409e.810378",
        "wires": [
            [
                "dbddb28c.bce1e8"
            ]
        ]
    },
    {
        "id": "33a0ff35.932e78",
        "type": "set",
        "name": "set vnf-index = vnf_length",
        "xml": "<set>\n<parameter name='vnf-index' value='`$service-data.vnfs.vnf_length`' />\n",
        "comments": "",
        "x": 1717.571533203125,
        "y": 280.0477407248691,
        "z": "a8db409e.810378",
        "wires": []
    },
    {
        "id": "36e21bba.2e2ef4",
        "type": "for",
        "name": "for each existing VNF",
        "xml": "<for index='idx' start='0' end='`$service-data.vnfs.vnf_length`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 1706.0001525878906,
        "y": 315.04771259147674,
        "z": "a8db409e.810378",
        "wires": [
            [
                "7dde789c.f76928"
            ]
        ]
    },
    {
        "id": "dbddb28c.bce1e8",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 1459.4285736083984,
        "y": 303.76198461372405,
        "z": "a8db409e.810378",
        "wires": [
            [
                "33a0ff35.932e78",
                "36e21bba.2e2ef4"
            ]
        ]
    },
    {
        "id": "7dde789c.f76928",
        "type": "switchNode",
        "name": "switch vnf-information.vnf-id == service-data.vnfs.vnf[].vnf-id",
        "xml": "<switch test='`$vnf-topology-operation-input.vnf-information.vnf-id == $service-data.vnfs.vnf[$idx].vnf-id`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2099.285888671875,
        "y": 315.61919668037444,
        "z": "a8db409e.810378",
        "wires": [
            [
                "5924827c.34c2fc"
            ]
        ]
    },
    {
        "id": "5924827c.34c2fc",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2380.571590423584,
        "y": 314.19060209114105,
        "z": "a8db409e.810378",
        "wires": [
            [
                "46ba128f.50acd4"
            ]
        ]
    },
    {
        "id": "88b8e912.2900e8",
        "type": "comment",
        "name": "make sure this vnf-id doesn't exist already",
        "info": "",
        "comments": "",
        "x": 2068.4285049438477,
        "y": 279.1905887397006,
        "z": "a8db409e.810378",
        "wires": []
    },
    {
        "id": "6d0e8b42.1f8964",
        "type": "set",
        "name": "set new vnf_length",
        "xml": "<set>\n<parameter name='service-data.vnfs.vnf_length' value='`$vnf-index + 1`' />\n",
        "comments": "",
        "x": 1038.571548461914,
        "y": 551.3334372313693,
        "z": "a8db409e.810378",
        "wires": []
    },
    {
        "id": "3b8acefc.66b31a",
        "type": "returnSuccess",
        "name": "return success",
        "xml": "<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n",
        "comments": "",
        "x": 1025.5715103149414,
        "y": 1021.5969560416415,
        "z": "a8db409e.810378",
        "wires": []
    },
    {
        "id": "6eb961ad.5ae338",
        "type": "set",
        "name": "set vnf-index and vnf-object-path",
        "xml": "<set>\n<parameter name='vnfId' value='`$prop.vnf-id`' />\n<parameter name=\"vnf-object-path\" value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'  + $vnf-topology-operation-input.service-information.service-instance-id  + '/service-data/vnfs/vnf/'  + $prop.vnf-id  + '/vnf-data/'` \" />",
        "comments": "",
        "x": 1079.5715408325195,
        "y": 799.5968749793246,
        "z": "a8db409e.810378",
        "wires": []
    },
    {
        "id": "46ba128f.50acd4",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'VNF id ' + $service-data.vnfs.vnf[$idx].vnf-id\n      + ' already exists, and has order status ' + $service-data.vnfs.vnf[$idx].vnf-data.vnf-level-oper-status.order-status`\" />\n",
        "comments": "",
        "x": 2509.1429595947266,
        "y": 365.1906163962558,
        "z": "a8db409e.810378",
        "wires": []
    },
    {
        "id": "adbadf0e.275b3",
        "type": "save",
        "name": "save AnAI - l2vpn.operational-status",
        "xml": "<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"connectivity\"   \n\t\tkey='connectivity.connectivity-id = $prop.connectivity-id' >\n<parameter name=\"operational-status\" value=\"Created\" />\n",
        "comments": "",
        "outputs": 1,
        "x": 1134.5458450317383,
        "y": 909.247092035599,
        "z": "a8db409e.810378",
        "wires": [
            []
        ]
    },
    {
        "id": "204db5a4.c326da",
        "type": "comment",
        "name": "TODO: change AAI models",
        "info": "",
        "comments": "",
        "x": 1068.1821060180664,
        "y": 868.9743078025058,
        "z": "a8db409e.810378",
        "wires": []
    },
    {
        "id": "e76c21c2.4a838",
        "type": "execute",
        "name": "execute split parameterName",
        "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='split' >\n<parameter name=\"original_string\" value='`$vnf-topology-operation-input.vnf-request-input.vnf-input-parameters.param[$idx].name`'/>\n<parameter name=\"regex\" value=\"_\"/>\n<parameter name=\"ctx_memory_result_key\" value=\"param-prefix\"/>\n",
        "comments": "",
        "outputs": 1,
        "x": 1494.7395935058594,
        "y": 362.7500076564029,
        "z": "a8db409e.810378",
        "wires": [
            []
        ]
    },
    {
        "id": "11945653.6c33ba",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 1298.4833908081055,
        "y": 367.0018806727603,
        "z": "a8db409e.810378",
        "wires": [
            [
                "e76c21c2.4a838",
                "e0fb04c6.a15c88"
            ]
        ]
    },
    {
        "id": "f1922be.86c2058",
        "type": "for",
        "name": "for loop idx - VNF input parameters",
        "xml": "<for index=\"idx\" start=\"0\" end=\"`$vnf-topology-operation-input.vnf-request-input.vnf-input-parameters.param_length`\">\n",
        "comments": "",
        "outputs": 1,
        "x": 1083.7050476074219,
        "y": 369.4462967189029,
        "z": "a8db409e.810378",
        "wires": [
            [
                "11945653.6c33ba"
            ]
        ]
    },
    {
        "id": "d0ca9568.fe847",
        "type": "set",
        "name": "set vnf-request-input.",
        "xml": "<set>\n<parameter name='vnf-request-input.' value='`$vnf-topology-operation-input.vnf-request-input.`' />\n",
        "comments": "",
        "x": 1040.7046813964844,
        "y": 439.7710037501529,
        "z": "a8db409e.810378",
        "wires": []
    },
    {
        "id": "e0fb04c6.a15c88",
        "type": "set",
        "name": "set parameterName",
        "xml": "<set>\n<parameter name=\"`vnf-topology-operation-input.vnf-request-input.vnf-input-parameters.param[$idx].name`\" value='`$param-prefix[$param-prefix_length -1]`'/>\n",
        "comments": "",
        "x": 1471.7395935058594,
        "y": 408.7500076564029,
        "z": "a8db409e.810378",
        "wires": []
    },
    {
        "id": "5bbdffcc.b3f3b8",
        "type": "for",
        "name": "for each sdwan-get-request-input-param",
        "xml": "<for index=\"idx\" start=\"0\" end=\"`$vnf-topology-operation-input.vnf-request-input.vnf-input-parameters.param_length`\">\n",
        "comments": "",
        "outputs": 1,
        "x": 1096.7395935058594,
        "y": 491.7500076564029,
        "z": "a8db409e.810378",
        "wires": [
            [
                "e0f56e7c.d34a1"
            ]
        ]
    },
    {
        "id": "e0f56e7c.d34a1",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 1322.9722595214844,
        "y": 490.0937576564029,
        "z": "a8db409e.810378",
        "wires": [
            [
                "5be518f3.e26978"
            ]
        ]
    },
    {
        "id": "5be518f3.e26978",
        "type": "switchNode",
        "name": "switch vnf name",
        "xml": "<switch test=\"`$vnf-topology-operation-input.vnf-request-input.vnf-input-parameters.param[$idx].name == 'name'`\">\n",
        "comments": "",
        "outputs": 1,
        "x": 1479.4722595214844,
        "y": 488.09381869155914,
        "z": "a8db409e.810378",
        "wires": [
            [
                "3bfa8dc2.ee3a5a"
            ]
        ]
    },
    {
        "id": "3bfa8dc2.ee3a5a",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1640.4726257324219,
        "y": 488.0938797267154,
        "z": "a8db409e.810378",
        "wires": [
            [
                "5f201fd1.6acc3"
            ]
        ]
    },
    {
        "id": "5f201fd1.6acc3",
        "type": "set",
        "name": "set vnf name",
        "xml": "<set>\n<parameter name='prop.vnfName' value='`$vnf-topology-operation-input.vnf-request-input.vnf-input-parameters.param[$idx].value`' />\n",
        "comments": "",
        "x": 1798.4727478027344,
        "y": 486.69391634780914,
        "z": "a8db409e.810378",
        "wires": []
    }
]