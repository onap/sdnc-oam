[
  {
    "id": "4ddcb062.8ecdb",
    "type": "dgstart",
    "name": "DGSTART",
    "outputs": 1,
    "x": 88.03125,
    "y": 50.03125,
    "z": "28e3f0b9.24cf2",
    "wires": [
      [
        "596e35be.20cc4c"
      ]
    ]
  },
  {
    "id": "596e35be.20cc4c",
    "type": "service-logic",
    "name": "GENERIC-RESOURCE-API ${project.version}",
    "module": "GENERIC-RESOURCE-API",
    "version": "${project.version}",
    "comments": "",
    "xml": "<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>",
    "outputs": 1,
    "x": 274.03125381469727,
    "y": 122.0312671661377,
    "z": "28e3f0b9.24cf2",
    "wires": [
      [
        "c01d9d60.83407"
      ]
    ]
  },
  {
    "id": "c01d9d60.83407",
    "type": "method",
    "name": "method sdwan-network-topology-operation-activate",
    "xml": "<method rpc='sdwan-network-topology-operation-activate' mode='sync'>\n",
    "comments": "",
    "outputs": 1,
    "x": 262.0313720703125,
    "y": 210.03125,
    "z": "28e3f0b9.24cf2",
    "wires": [
      [
        "18ab359f.ed0fba"
      ]
    ]
  },
  {
    "id": "18ab359f.ed0fba",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 436.03126525878906,
    "y": 318.0313091278076,
    "z": "28e3f0b9.24cf2",
    "wires": [
      [
        "c561faa1.7d7778",
        "6dc01778.009fd8",
        "da487e61.56608",
        "c6b01240.db33",
        "3f3b0e5f.2cbb02",
        "98c44abf.148e28",
        "21c2ad92.7e1fb2",
        "2511a75a.f0a8b8",
        "1ae62a5a.18e726",
        "fc4fc9d4.5f3178",
        "3bff9e87.90adb2",
        "3355eb7a.3cf5b4",
        "fce8b550.d12f88",
        "cc83cf92.13ac4",
        "5ff87b45.2a9d04"
      ]
    ]
  },
  {
    "id": "c561faa1.7d7778",
    "type": "call",
    "name": "call GENERIC-RESOURCE-API:validate-sdwan-network-input-parameters",
    "xml": "<call module='GENERIC-RESOURCE-API' rpc='validate-sdwan-network-input-parameters' mode='sync' >\n",
    "comments": "",
    "outputs": 1,
    "x": 894.4201507568359,
    "y": 67.03125,
    "z": "28e3f0b9.24cf2",
    "wires": [
      []
    ]
  },
  {
    "id": "6dc01778.009fd8",
    "type": "record",
    "name": "record",
    "xml": "<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.FileRecorder\">\n<parameter name=\"file\" value=\"/opt/opendaylight/current/data/log/svclogic.log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"sdwan-network-topology-operation-activate\"/>\n<parameter name=\"field3\" value=\"SDWAN-Activate\"/>\n",
    "comments": "",
    "outputs": 1,
    "x": 694.5868492126465,
    "y": 120.80910301208496,
    "z": "28e3f0b9.24cf2",
    "wires": [
      []
    ]
  },
  {
    "id": "da487e61.56608",
    "type": "set",
    "name": "set networkId and network-object-path",
    "xml": "<set>\n<parameter name='networkId' value='`$network-topology-operation-input.network-information.network-id`' />\n<parameter name=\"network-object-path\" value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'  + $network-topology-operation-input.service-information.service-instance-id  + '/service-data/networks/network/'  + $network-topology-operation-input.network-information.network-id  + '/network-data/'` \" />",
    "comments": "",
    "x": 781.5871276855469,
    "y": 1043.344719171524,
    "z": "28e3f0b9.24cf2",
    "wires": []
  },
  {
    "id": "c6b01240.db33",
    "type": "returnSuccess",
    "name": "return success",
    "xml": "<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n",
    "comments": "",
    "x": 703.3649291992188,
    "y": 1232.900139093399,
    "z": "28e3f0b9.24cf2",
    "wires": []
  },
  {
    "id": "3f3b0e5f.2cbb02",
    "type": "set",
    "name": "set network-level-oper-status",
    "xml": "<set>\n<parameter name='service-data.networks.network[$tmp.nidx].network-data.network-level-oper-status.order-status' value='Active' />\n<parameter name='service-data.networks.network[$tmp.nidx].network-data.network-level-oper-status.last-rpc-action' value='`$network-topology-operation-input.sdnc-request-header.svc-action`' />\n<parameter name='service-data.networks.network[$tmp.nidx].network-data.network-level-oper-status.last-action' value='`$network-topology-operation-input.request-information.request-action`' />",
    "comments": "",
    "x": 748.4760437011719,
    "y": 1104.5668938159943,
    "z": "28e3f0b9.24cf2",
    "wires": []
  },
  {
    "id": "98c44abf.148e28",
    "type": "execute",
    "name": "execute Properties",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.prop.PropertiesNode' method='readProperties' >\n    <parameter name='fileName' value='%SDNC_CONFIG_DIR%/generic-resource-api-dg.properties' />\n    <parameter name='contextPrefix' value='prop' />\n",
    "comments": "",
    "outputs": 1,
    "x": 726.8889541625977,
    "y": 173.80913925170898,
    "z": "28e3f0b9.24cf2",
    "wires": [
      []
    ]
  },
  {
    "id": "21c2ad92.7e1fb2",
    "type": "update",
    "name": "update SDWAN VPN status to AAI",
    "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='sdwan-vpn' \n      key='sdwan-vpn.id = $network-topology-operation-input.network-information.network-id' >\n<parameter name='id' value='`$network-topology-operation-input.network-information.network-id`' />\n<parameter name='operational-status' value='Active' />\n<parameter name='tenanatId' value='`$prop.tenant-id`' />\n<parameter name='vpn-id' value='`$prop.vpn-id`' />",
    "comments": "",
    "outputs": 1,
    "x": 765.6947593688965,
    "y": 1167.2701053619385,
    "z": "28e3f0b9.24cf2",
    "wires": [
      []
    ]
  },
  {
    "id": "2511a75a.f0a8b8",
    "type": "set",
    "name": "set network in service-data",
    "xml": "<set>\n<parameter name='service-data.networks.network[$tmp.nidx].network-data.sdnc-request-header.' value='`$network-topology-operation-input.sdnc-request-header.`' />\n<parameter name='service-data.networks.network[$tmp.nidx].network-data.request-information.' value='`$network-topology-operation-input.request-information.`' />\n<parameter name='service-data.networks.network[$tmp.nidx].network-data.service-information.' value='`$network-topology-operation-input.service-information.`' />\n<parameter name='service-data.networks.network[$tmp.nidx].network-data.network-information.' value='`$network-topology-operation-input.network-information.`' />",
    "comments": "",
    "x": 742.0316581726074,
    "y": 990.1225531101227,
    "z": "28e3f0b9.24cf2",
    "wires": []
  },
  {
    "id": "1ae62a5a.18e726",
    "type": "for",
    "name": "for each network-input-parameters",
    "xml": "<for index='idx' start='0' end='`$ctx.network-data.network-request-input.network-input-parameters.param_length`' >\n",
    "comments": "",
    "outputs": 1,
    "x": 779.03125,
    "y": 244.03515753149986,
    "z": "28e3f0b9.24cf2",
    "wires": [
      [
        "b794657d.4da128"
      ]
    ]
  },
  {
    "id": "b794657d.4da128",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1035.8646812438965,
    "y": 178.36850866675377,
    "z": "28e3f0b9.24cf2",
    "wires": [
      [
        "53501d6c.c520f4",
        "e1341c8f.56768"
      ]
    ]
  },
  {
    "id": "53501d6c.c520f4",
    "type": "switchNode",
    "name": "switch name",
    "xml": "<switch test=\"`$ctx.network-data.network-request-input.network-input-parameters.param[$idx].name == 'name'`\">\n",
    "comments": "",
    "outputs": 1,
    "x": 1226.8647422790527,
    "y": 174.36854109168053,
    "z": "28e3f0b9.24cf2",
    "wires": [
      [
        "2cafaedf.cedf32"
      ]
    ]
  },
  {
    "id": "2cafaedf.cedf32",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1400.8648681640625,
    "y": 174.3685449063778,
    "z": "28e3f0b9.24cf2",
    "wires": [
      [
        "529c0b0c.8d2074"
      ]
    ]
  },
  {
    "id": "529c0b0c.8d2074",
    "type": "set",
    "name": "set name",
    "xml": "<set>\n<parameter name='prop.name' value='`$ctx.network-data.network-request-input.network-input-parameters.param[$idx].value`' />\n",
    "comments": "",
    "x": 1563.8647537231445,
    "y": 173.96853956580162,
    "z": "28e3f0b9.24cf2",
    "wires": []
  },
  {
    "id": "fce8b550.d12f88",
    "type": "get-resource",
    "name": "get-resource esr-thirdparty-sdnc",
    "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"esr-thirdparty-sdnc\" \n\t\tkey=\"esr-thirdparty-sdnc.thirdparty-sdnc-id = 'SDWAN-Controller' AND \n\t\t     depth = '1'\"\n        pfx='tmp.aai.esr-thirdparty-sdnc' local-only='false' >\n\n",
    "comments": "",
    "outputs": 1,
    "x": 773.03125,
    "y": 353.03515753149986,
    "z": "28e3f0b9.24cf2",
    "wires": [
      [
        "9b25121d.283a4",
        "385f822e.d7b4ae",
        "f3914c31.422ce"
      ]
    ]
  },
  {
    "id": "9b25121d.283a4",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1018.03125,
    "y": 299.03515753149986,
    "z": "28e3f0b9.24cf2",
    "wires": [
      [
        "f386956a.705be8"
      ]
    ]
  },
  {
    "id": "385f822e.d7b4ae",
    "type": "not-found",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1021.522216796875,
    "y": 346.6091931760311,
    "z": "28e3f0b9.24cf2",
    "wires": [
      [
        "e34bc405.635f88"
      ]
    ]
  },
  {
    "id": "f3914c31.422ce",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1016.855224609375,
    "y": 387.94250616431236,
    "z": "28e3f0b9.24cf2",
    "wires": [
      [
        "799bf116.3f716"
      ]
    ]
  },
  {
    "id": "f386956a.705be8",
    "type": "set",
    "name": "set controller data",
    "xml": "<set>\n<parameter name='prop.sdncRestApi.thirdpartySdnc.url' value=\"`$tmp.aai.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].service-url`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.user' value=\"`$tmp.aai.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].user-name`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.password' value=\"`$tmp.aai.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].password`\" />\n",
    "comments": "",
    "x": 1215.5313110351562,
    "y": 287.03515753149986,
    "z": "28e3f0b9.24cf2",
    "wires": []
  },
  {
    "id": "e34bc405.635f88",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying esr-thirdparty-sdnc from AnAI with thirdparty-sdnc-id = ' + $tmp.thirdparty-sdnc-id`\" />\n\n",
    "comments": "",
    "x": 1198.0936279296875,
    "y": 334.8949292600155,
    "z": "28e3f0b9.24cf2",
    "wires": []
  },
  {
    "id": "799bf116.3f716",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying esr-thirdparty-sdnc from AnAI with thirdparty-sdnc-id = ' + $tmp.thirdparty-sdnc-id`\" />\n\n",
    "comments": "",
    "x": 1204.6277809143066,
    "y": 383.381698936224,
    "z": "28e3f0b9.24cf2",
    "wires": []
  },
  {
    "id": "cc83cf92.13ac4",
    "type": "execute",
    "name": "execute RestApiCallNode Get token",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/actokentemplate.json'`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/controller/v2/tokens'`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"post\"/>\n<parameter name=\"responsePrefix\" value=\"token-result\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.openecomp.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>",
    "comments": "",
    "outputs": 1,
    "x": 781.03125,
    "y": 464.03515753149986,
    "z": "28e3f0b9.24cf2",
    "wires": [
      [
        "de360ea0.df86c",
        "8ab64288.ec606"
      ]
    ]
  },
  {
    "id": "de360ea0.df86c",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1020.031322479248,
    "y": 442.03518772125244,
    "z": "28e3f0b9.24cf2",
    "wires": [
      [
        "d8a5f197.3daff"
      ]
    ]
  },
  {
    "id": "8ab64288.ec606",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1012.281322479248,
    "y": 495.6780710220337,
    "z": "28e3f0b9.24cf2",
    "wires": [
      [
        "761741d1.08b81"
      ]
    ]
  },
  {
    "id": "d8a5f197.3daff",
    "type": "set",
    "name": "set token-id",
    "xml": "<set>\n<parameter name='prop.sdncRestApi.token_id' value='`$token-result.data.token_id`' />\n",
    "comments": "",
    "x": 1170.03125,
    "y": 443.03515753149986,
    "z": "28e3f0b9.24cf2",
    "wires": []
  },
  {
    "id": "761741d1.08b81",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing get token rest api\" />\n",
    "comments": "",
    "x": 1165.031322479248,
    "y": 495.42813205718994,
    "z": "28e3f0b9.24cf2",
    "wires": []
  },
  {
    "id": "e1341c8f.56768",
    "type": "switchNode",
    "name": "switch topology",
    "xml": "<switch test=\"`$ctx.network-data.network-request-input.network-input-parameters.param[$idx].name == 'topology'`\">\n",
    "comments": "",
    "outputs": 1,
    "x": 1225.28125,
    "y": 227.03515753149986,
    "z": "28e3f0b9.24cf2",
    "wires": [
      [
        "abb60c8f.8ac5f"
      ]
    ]
  },
  {
    "id": "abb60c8f.8ac5f",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1399.2813758850098,
    "y": 227.03516134619713,
    "z": "28e3f0b9.24cf2",
    "wires": [
      [
        "36b54251.f429ce"
      ]
    ]
  },
  {
    "id": "36b54251.f429ce",
    "type": "set",
    "name": "set topology",
    "xml": "<set>\n<parameter name='prop.topology' value='`$ctx.network-data.network-request-input.network-input-parameters.param[$idx].value`' />\n",
    "comments": "",
    "x": 1562.2812614440918,
    "y": 226.63515600562096,
    "z": "28e3f0b9.24cf2",
    "wires": []
  },
  {
    "id": "5ff87b45.2a9d04",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 702.7812957763672,
    "y": 710.0352792739868,
    "z": "28e3f0b9.24cf2",
    "wires": [
      [
        "34512469.61377c"
      ]
    ]
  },
  {
    "id": "34512469.61377c",
    "type": "execute",
    "name": "execute RestApiCallNode Create network orchestration",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/sdwan-network-orchestration.json'`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/controller/campus/v1/sdwan/net/network-orchestration-resources'`\" />\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"put\"/>\n<parameter name=\"responsePrefix\" value=\"orchestration-result\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.openecomp.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n<parameter name='customHttpHeaders' value=\"`'X-ACCESS-TOKEN=' + $prop.sdncRestApi.token_id`\" />",
    "comments": "",
    "outputs": 1,
    "x": 1023.2814025878906,
    "y": 699.0353622436523,
    "z": "28e3f0b9.24cf2",
    "wires": [
      []
    ]
  },
  {
    "id": "fc4fc9d4.5f3178",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 705.2812652587891,
    "y": 772.0352075994015,
    "z": "28e3f0b9.24cf2",
    "wires": [
      [
        "dcf83ef9.92d4e",
        "6fd086ba.35f488",
        "ccbce6bf.529778"
      ]
    ]
  },
  {
    "id": "6fd086ba.35f488",
    "type": "execute",
    "name": "execute RestApiCallNode Create vpn",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/sdwan-vpn.json'`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/controller/campus/v1/sdwan/overlay-network/vpn'`\" />\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"post\"/>\n<parameter name=\"responsePrefix\" value=\"vpn-result\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.openecomp.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n<parameter name='customHttpHeaders' value=\"`'X-ACCESS-TOKEN=' + $prop.sdncRestApi.token_id`\" />",
    "comments": "",
    "outputs": 1,
    "x": 976.7813110351562,
    "y": 762.0353315770626,
    "z": "28e3f0b9.24cf2",
    "wires": [
      []
    ]
  },
  {
    "id": "dcf83ef9.92d4e",
    "type": "set",
    "name": "set prop.vpn-id and prop.vpn1Id",
    "xml": "<set>\n<!--parameter name='prop.vpn-id' value='`$vpn-result.id`' />\n<parameter name='prop.vpn1Id' value='`$vpn-result.id`' /-->\n\n<parameter name='prop.vpn-id' value='10' />\n<parameter name='prop.vpn1Id' value='10' />\n",
    "comments": "",
    "x": 972.7814674377441,
    "y": 814.0354309082031,
    "z": "28e3f0b9.24cf2",
    "wires": []
  },
  {
    "id": "ccbce6bf.529778",
    "type": "execute",
    "name": "execute RestApiCallNode Create vpn topology",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/sdwan-vpn-topology.json'`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/controller/campus/v1/sdwan/overlay-network/' + $prop.vpn-id + '/topology'`\" />\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"post\"/>\n<parameter name=\"responsePrefix\" value=\"vpn-result\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.openecomp.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n<parameter name='customHttpHeaders' value=\"`'X-ACCESS-TOKEN=' + $prop.sdncRestApi.token_id`\" />",
    "comments": "",
    "outputs": 1,
    "x": 1004.2813148498535,
    "y": 866.0352058410645,
    "z": "28e3f0b9.24cf2",
    "wires": [
      []
    ]
  },
  {
    "id": "3bff9e87.90adb2",
    "type": "set",
    "name": "set tenant-id and vpn-id to service-data",
    "xml": "<set>\n<parameter name='service-data.networks.network[$tmp.nidx].network-data.network-request-input.network-input-parameters.param[$network-topology-operation-input.network-request-input.network-input-parameters.param_length].name' value='tenant-id' />\n<parameter name='service-data.networks.network[$tmp.nidx].network-data.network-request-input.network-input-parameters.param[$network-topology-operation-input.network-request-input.network-input-parameters.param_length].value' value='`$prop.tenant-id`' />\n<parameter name='service-data.networks.network[$tmp.nidx].network-data.network-request-input.network-input-parameters.param[$network-topology-operation-input.network-request-input.network-input-parameters.param_length + 1].name' value='vpn-id' />\n<parameter name='service-data.networks.network[$tmp.nidx].network-data.network-request-input.network-input-parameters.param[$network-topology-operation-input.network-request-input.network-input-parameters.param_length + 1].value' value='`$prop.vpn-id`' />\n<parameter name='service-data.networks.network[$tmp.nidx].network-data.network-request-input.network-input-parameters.param_length' value='`$network-topology-operation-input.network-request-input.network-input-parameters.param_length + 2`' />",
    "comments": "",
    "x": 784.2812538146973,
    "y": 935.7852268218994,
    "z": "28e3f0b9.24cf2",
    "wires": []
  },
  {
    "id": "3355eb7a.3cf5b4",
    "type": "get-resource",
    "name": "get-resource service-subscription",
    "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"service-subscription\" \n        key= 'service-subscription.service-type = $service-data.networks.network[$tmp.nidx].network-data.service-information.subscription-service-type \n        AND customer.global-customer-id = $service-data.networks.network[$tmp.nidx].network-data.service-information.global-customer-id'\n      force=\"true\" pfx=\"tmp.AnAI-data\">\n      \n",
    "comments": "",
    "outputs": 1,
    "x": 758.5313873291016,
    "y": 613.2851915359497,
    "z": "28e3f0b9.24cf2",
    "wires": [
      [
        "edc9287a.cc5518",
        "5b0f29d9.42a638"
      ]
    ]
  },
  {
    "id": "a1fba96c.417d58",
    "type": "switchNode",
    "name": "switch temp-ub-sub-account-id",
    "xml": "<switch test='`$tmp.AnAI-data.temp-ub-sub-account-id`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1170.531478881836,
    "y": 578.0352725982666,
    "z": "28e3f0b9.24cf2",
    "wires": [
      [
        "e5d2c50b.cba8f8",
        "21c5a234.6190ae"
      ]
    ]
  },
  {
    "id": "e5d2c50b.cba8f8",
    "type": "outcome",
    "name": "NULL",
    "xml": "<outcome value=''>",
    "comments": "",
    "outputs": 1,
    "x": 1363.2459297180176,
    "y": 552.0353136062622,
    "z": "28e3f0b9.24cf2",
    "wires": [
      [
        "f0651115.93559"
      ]
    ]
  },
  {
    "id": "21c5a234.6190ae",
    "type": "other",
    "name": "Other",
    "xml": "<outcome value='Other'>",
    "comments": "",
    "outputs": 1,
    "x": 1363.531494140625,
    "y": 607.0352764129639,
    "z": "28e3f0b9.24cf2",
    "wires": [
      [
        "867c2305.719d4"
      ]
    ]
  },
  {
    "id": "867c2305.719d4",
    "type": "set",
    "name": "set prop.tenant-id",
    "xml": "<set>\n<parameter name='prop.tenant-id' value='`$tmp.AnAI-data.temp-ub-sub-account-id`' />\n",
    "comments": "",
    "x": 1519.5316696166992,
    "y": 665.0351943969727,
    "z": "28e3f0b9.24cf2",
    "wires": []
  },
  {
    "id": "f0651115.93559",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1501.2812385559082,
    "y": 553.7851538658142,
    "z": "28e3f0b9.24cf2",
    "wires": [
      [
        "369b1850.33da28",
        "6de36f9a.0a191",
        "1299a0cc.66391f",
        "8cc3c364.b95fb",
        "c1785bc5.472658"
      ]
    ]
  },
  {
    "id": "8cc3c364.b95fb",
    "type": "set",
    "name": "set prop.customer-id",
    "xml": "<set>\n<parameter name='prop.customer-id' value='`$ctx.network-data.service-information.global-customer-id`' />\n",
    "comments": "",
    "x": 1716.7815170288086,
    "y": 490.78530991077423,
    "z": "28e3f0b9.24cf2",
    "wires": []
  },
  {
    "id": "369b1850.33da28",
    "type": "execute",
    "name": "execute RestApiCallNode Create tenant",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/sdwan-tenant.json'`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/controller/campus/v1/baseservice/tenanats'`\" />\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"put\"/>\n<parameter name=\"responsePrefix\" value=\"tenant-result\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.openecomp.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n<parameter name='customHttpHeaders' value=\"`'X-ACCESS-TOKEN=' + $prop.sdncRestApi.token_id`\" />",
    "comments": "",
    "outputs": 1,
    "x": 1774.78125,
    "y": 567.785163551569,
    "z": "28e3f0b9.24cf2",
    "wires": [
      []
    ]
  },
  {
    "id": "6de36f9a.0a191",
    "type": "set",
    "name": "set prop.tenant-id",
    "xml": "<set>\n<parameter name='prop.tenant-id' value='`$tenant-result.data.tenantId`' />\n",
    "comments": "",
    "x": 1724.7814826965332,
    "y": 619.785234451294,
    "z": "28e3f0b9.24cf2",
    "wires": []
  },
  {
    "id": "1299a0cc.66391f",
    "type": "execute",
    "name": "execute RestApiCallNode Create tenant auth",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/controller/campus/v1/baseservice/tenanats/authorization/' + $prop.tenant-id`\" />\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"put\"/>\n<parameter name=\"responsePrefix\" value=\"tenant-result\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.openecomp.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n<parameter name='customHttpHeaders' value=\"`'X-ACCESS-TOKEN=' + $prop.sdncRestApi.token_id`\" />",
    "comments": "",
    "outputs": 1,
    "x": 1792.281478881836,
    "y": 655.535234451294,
    "z": "28e3f0b9.24cf2",
    "wires": [
      []
    ]
  },
  {
    "id": "c1785bc5.472658",
    "type": "get-resource",
    "name": "save-resource customer-id in service-subscription",
    "xml": "<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"service-subscription\" \n        key= 'service-subscription.service-type = $service-data.networks.network[$tmp.nidx].network-data.service-information.subscription-service-type \n        AND customer.global-customer-id = $service-data.networks.network[$tmp.nidx].network-data.service-information.global-customer-id'>\n<parameter name='temp-ub-sub-account-id' value='`$prop.customer-id`' />\n\n",
    "comments": "",
    "outputs": 1,
    "x": 1794.7813568115234,
    "y": 528.7853126525879,
    "z": "28e3f0b9.24cf2",
    "wires": [
      []
    ]
  },
  {
    "id": "edc9287a.cc5518",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 969.03125,
    "y": 586.03125,
    "z": "28e3f0b9.24cf2",
    "wires": [
      [
        "a1fba96c.417d58"
      ]
    ]
  },
  {
    "id": "5b0f29d9.42a638",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 961.28125,
    "y": 639.6741333007812,
    "z": "28e3f0b9.24cf2",
    "wires": [
      [
        "406169f1.4046c8"
      ]
    ]
  },
  {
    "id": "406169f1.4046c8",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing get token rest api\" />\n",
    "comments": "",
    "x": 1114.03125,
    "y": 639.4241943359375,
    "z": "28e3f0b9.24cf2",
    "wires": []
  }
]
