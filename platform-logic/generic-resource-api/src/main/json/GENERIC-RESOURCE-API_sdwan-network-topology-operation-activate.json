[
  {
    "id": "b728dcab.e2e08",
    "type": "dgstart",
    "name": "DGSTART",
    "outputs": 1,
    "x": 93,
    "y": 47,
    "z": "4c287bc.f107e84",
    "wires": [
      [
        "f1013e83.11195"
      ]
    ]
  },
  {
    "id": "f1013e83.11195",
    "type": "service-logic",
    "name": "GENERIC-RESOURCE-API ${project.version}",
    "module": "GENERIC-RESOURCE-API",
    "version": "${project.version}",
    "comments": "",
    "xml": "<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>",
    "outputs": 1,
    "x": 279.00000381469727,
    "y": 119.0000171661377,
    "z": "4c287bc.f107e84",
    "wires": [
      [
        "4636719f.41274"
      ]
    ]
  },
  {
    "id": "4636719f.41274",
    "type": "method",
    "name": "method sdwan-network-topology-operation-activate",
    "xml": "<method rpc='sdwan-network-topology-operation-activate' mode='sync'>\n",
    "comments": "",
    "outputs": 1,
    "x": 267.0001220703125,
    "y": 207,
    "z": "4c287bc.f107e84",
    "wires": [
      [
        "c7a7aadf.8ed488"
      ]
    ]
  },
  {
    "id": "c7a7aadf.8ed488",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 441.00001525878906,
    "y": 315.0000591278076,
    "z": "4c287bc.f107e84",
    "wires": [
      [
        "98d3b92f.70fc48",
        "189da6d2.5a6819",
        "e988ff0f.b5aae",
        "e4aad21c.e7ff7",
        "39e02c84.3177e4",
        "b96459be.6fd7a8",
        "747d96dd.f43d58",
        "39860903.53b456",
        "69af4cc7.202f04",
        "bc16f27b.ec50b",
        "29cb6e2b.ecafd2",
        "f71b9190.340d8",
        "3eb35468.4702ac",
        "d3877bd.f214188",
        "73dbb3c3.f1d1fc",
        "9bf6657f.dd37a8"
      ]
    ]
  },
  {
    "id": "98d3b92f.70fc48",
    "type": "call",
    "name": "call GENERIC-RESOURCE-API:validate-sdwan-network-input-parameters",
    "xml": "<call module='GENERIC-RESOURCE-API' rpc='validate-sdwan-network-input-parameters' mode='sync' >\n",
    "comments": "",
    "outputs": 1,
    "x": 899.3889007568359,
    "y": 64,
    "z": "4c287bc.f107e84",
    "wires": [
      []
    ]
  },
  {
    "id": "189da6d2.5a6819",
    "type": "record",
    "name": "record",
    "xml": "<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.FileRecorder\">\n<parameter name=\"file\" value=\"/opt/opendaylight/current/data/log/svclogic.log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"sdwan-network-topology-operation-activate\"/>\n<parameter name=\"field3\" value=\"SDWAN-Activate\"/>\n",
    "comments": "",
    "outputs": 1,
    "x": 699.5555992126465,
    "y": 117.77785301208496,
    "z": "4c287bc.f107e84",
    "wires": [
      []
    ]
  },
  {
    "id": "e988ff0f.b5aae",
    "type": "set",
    "name": "set networkId and network-object-path",
    "xml": "<set>\n<parameter name='networkId' value='`$network-topology-operation-input.network-information.network-id`' />\n<parameter name=\"network-object-path\" value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'  + $network-topology-operation-input.service-information.service-instance-id  + '/service-data/networks/network/'  + $network-topology-operation-input.network-information.network-id  + '/network-data/'` \" />",
    "comments": "",
    "x": 786.5558776855469,
    "y": 1040.313469171524,
    "z": "4c287bc.f107e84",
    "wires": []
  },
  {
    "id": "e4aad21c.e7ff7",
    "type": "returnSuccess",
    "name": "return success",
    "xml": "<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n",
    "comments": "",
    "x": 708.3336791992188,
    "y": 1229.868889093399,
    "z": "4c287bc.f107e84",
    "wires": []
  },
  {
    "id": "39e02c84.3177e4",
    "type": "set",
    "name": "set network-level-oper-status",
    "xml": "<set>\n<parameter name='service-data.networks.network[$tmp.nidx].network-data.network-level-oper-status.order-status' value='Active' />\n<parameter name='service-data.networks.network[$tmp.nidx].network-data.network-level-oper-status.last-rpc-action' value='`$network-topology-operation-input.sdnc-request-header.svc-action`' />\n<parameter name='service-data.networks.network[$tmp.nidx].network-data.network-level-oper-status.last-action' value='`$network-topology-operation-input.request-information.request-action`' />",
    "comments": "",
    "x": 753.4447937011719,
    "y": 1101.5356438159943,
    "z": "4c287bc.f107e84",
    "wires": []
  },
  {
    "id": "b96459be.6fd7a8",
    "type": "execute",
    "name": "execute Properties",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.prop.PropertiesNode' method='readProperties' >\n    <parameter name='fileName' value='%SDNC_CONFIG_DIR%/generic-resource-api-dg.properties' />\n    <parameter name='contextPrefix' value='prop' />\n",
    "comments": "",
    "outputs": 1,
    "x": 731.8577041625977,
    "y": 170.77788925170898,
    "z": "4c287bc.f107e84",
    "wires": [
      []
    ]
  },
  {
    "id": "747d96dd.f43d58",
    "type": "update",
    "name": "update SDWAN VPN status to AAI",
    "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='sdwan-vpn' \n      key='sdwan-vpn.sdwan-vpn-id = $network-topology-operation-input.network-information.network-id' >\n<parameter name='sdwan-vpn-id' value='`$network-topology-operation-input.network-information.network-id`' />\n<parameter name='operational-status' value='Active' />\n<parameter name='tenanat-id' value='`$prop.tenant-id`' />\n<parameter name='vpn-id' value='`$prop.vpn-id`' />",
    "comments": "",
    "outputs": 1,
    "x": 770.6635093688965,
    "y": 1164.2388553619385,
    "z": "4c287bc.f107e84",
    "wires": [
      []
    ]
  },
  {
    "id": "39860903.53b456",
    "type": "set",
    "name": "set network in service-data",
    "xml": "<set>\n<parameter name='service-data.networks.network[$tmp.nidx].network-data.sdnc-request-header.' value='`$network-topology-operation-input.sdnc-request-header.`' />\n<parameter name='service-data.networks.network[$tmp.nidx].network-data.request-information.' value='`$network-topology-operation-input.request-information.`' />\n<parameter name='service-data.networks.network[$tmp.nidx].network-data.service-information.' value='`$network-topology-operation-input.service-information.`' />\n<parameter name='service-data.networks.network[$tmp.nidx].network-data.network-information.' value='`$network-topology-operation-input.network-information.`' />",
    "comments": "",
    "x": 747.0004081726074,
    "y": 987.0913031101227,
    "z": "4c287bc.f107e84",
    "wires": []
  },
  {
    "id": "69af4cc7.202f04",
    "type": "for",
    "name": "for each network-input-parameters",
    "xml": "<for index='idx' start='0' end='`$ctx.network-data.network-request-input.network-input-parameters.param_length`' >\n",
    "comments": "",
    "outputs": 1,
    "x": 784,
    "y": 241.00390753149986,
    "z": "4c287bc.f107e84",
    "wires": [
      [
        "e4f0bee4.ba4a3"
      ]
    ]
  },
  {
    "id": "e4f0bee4.ba4a3",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1040.8334312438965,
    "y": 175.33725866675377,
    "z": "4c287bc.f107e84",
    "wires": [
      [
        "9e11c248.9eb9d",
        "9793f672.805878"
      ]
    ]
  },
  {
    "id": "9e11c248.9eb9d",
    "type": "switchNode",
    "name": "switch name",
    "xml": "<switch test=\"`$ctx.network-data.network-request-input.network-input-parameters.param[$idx].name == 'name'`\">\n",
    "comments": "",
    "outputs": 1,
    "x": 1231.8334922790527,
    "y": 171.33729109168053,
    "z": "4c287bc.f107e84",
    "wires": [
      [
        "8c9ad24.52d233"
      ]
    ]
  },
  {
    "id": "8c9ad24.52d233",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1405.8336181640625,
    "y": 171.3372949063778,
    "z": "4c287bc.f107e84",
    "wires": [
      [
        "360dce92.bcd8b2"
      ]
    ]
  },
  {
    "id": "360dce92.bcd8b2",
    "type": "set",
    "name": "set name",
    "xml": "<set>\n<parameter name='prop.name' value='`$ctx.network-data.network-request-input.network-input-parameters.param[$idx].value`' />\n",
    "comments": "",
    "x": 1568.8335037231445,
    "y": 170.93728956580162,
    "z": "4c287bc.f107e84",
    "wires": []
  },
  {
    "id": "f71b9190.340d8",
    "type": "get-resource",
    "name": "get-resource esr-thirdparty-sdnc",
    "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"esr-thirdparty-sdnc\" \n\t\tkey=\"esr-thirdparty-sdnc.thirdparty-sdnc-id = 'SDWANController' AND \n\t\t     depth = '1'\"\n        pfx='tmp.aai.esr-thirdparty-sdnc' local-only='false' >\n\n",
    "comments": "",
    "outputs": 1,
    "x": 778,
    "y": 350.00390625,
    "z": "4c287bc.f107e84",
    "wires": [
      [
        "35c5eced.422b74",
        "5db3feca.9679c",
        "84542dcd.8c846"
      ]
    ]
  },
  {
    "id": "35c5eced.422b74",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1023,
    "y": 296.00390753149986,
    "z": "4c287bc.f107e84",
    "wires": [
      [
        "b858bea3.dfbd9"
      ]
    ]
  },
  {
    "id": "5db3feca.9679c",
    "type": "not-found",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1026.490966796875,
    "y": 343.5779431760311,
    "z": "4c287bc.f107e84",
    "wires": [
      [
        "ea674168.c4155"
      ]
    ]
  },
  {
    "id": "84542dcd.8c846",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1021.823974609375,
    "y": 384.91125616431236,
    "z": "4c287bc.f107e84",
    "wires": [
      [
        "95ebd94d.24be88"
      ]
    ]
  },
  {
    "id": "b858bea3.dfbd9",
    "type": "set",
    "name": "set controller data",
    "xml": "<set>\n<parameter name='prop.sdncRestApi.thirdpartySdnc.url' value=\"`$tmp.aai.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].service-url`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.user' value=\"`$tmp.aai.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].user-name`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.password' value=\"`$tmp.aai.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].password`\" />\n",
    "comments": "",
    "x": 1220.5000610351562,
    "y": 284.00390753149986,
    "z": "4c287bc.f107e84",
    "wires": []
  },
  {
    "id": "ea674168.c4155",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying esr-thirdparty-sdnc from AnAI with thirdparty-sdnc-id = ' + $tmp.thirdparty-sdnc-id`\" />\n\n",
    "comments": "",
    "x": 1203.0623779296875,
    "y": 331.8636792600155,
    "z": "4c287bc.f107e84",
    "wires": []
  },
  {
    "id": "95ebd94d.24be88",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying esr-thirdparty-sdnc from AnAI with thirdparty-sdnc-id = ' + $tmp.thirdparty-sdnc-id`\" />\n\n",
    "comments": "",
    "x": 1209.5965309143066,
    "y": 380.350448936224,
    "z": "4c287bc.f107e84",
    "wires": []
  },
  {
    "id": "3eb35468.4702ac",
    "type": "execute",
    "name": "execute RestApiCallNode Get token",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/actokentemplate.json'`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/controller/v2/tokens'`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"post\"/>\n<parameter name=\"responsePrefix\" value=\"token-result\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.openecomp.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>",
    "comments": "",
    "outputs": 1,
    "x": 786,
    "y": 461.00390625,
    "z": "4c287bc.f107e84",
    "wires": [
      [
        "d801cca4.51d79",
        "c1258051.e7f45"
      ]
    ]
  },
  {
    "id": "d801cca4.51d79",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1025.000072479248,
    "y": 439.00393772125244,
    "z": "4c287bc.f107e84",
    "wires": [
      [
        "f717dae9.6ebf18"
      ]
    ]
  },
  {
    "id": "c1258051.e7f45",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1017.250072479248,
    "y": 492.6468210220337,
    "z": "4c287bc.f107e84",
    "wires": [
      [
        "d37810c8.811c7"
      ]
    ]
  },
  {
    "id": "f717dae9.6ebf18",
    "type": "set",
    "name": "set token-id",
    "xml": "<set>\n<parameter name='prop.sdncRestApi.token_id' value='`$token-result.data.token_id`' />\n",
    "comments": "",
    "x": 1175,
    "y": 440.00390625,
    "z": "4c287bc.f107e84",
    "wires": []
  },
  {
    "id": "d37810c8.811c7",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing get token rest api\" />\n",
    "comments": "",
    "x": 1170.000072479248,
    "y": 492.39688205718994,
    "z": "4c287bc.f107e84",
    "wires": []
  },
  {
    "id": "9793f672.805878",
    "type": "switchNode",
    "name": "switch topology",
    "xml": "<switch test=\"`$ctx.network-data.network-request-input.network-input-parameters.param[$idx].name == 'topology'`\">\n",
    "comments": "",
    "outputs": 1,
    "x": 1230.25,
    "y": 224.00390753149986,
    "z": "4c287bc.f107e84",
    "wires": [
      [
        "cfe36c58.4801f"
      ]
    ]
  },
  {
    "id": "cfe36c58.4801f",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1404.2501258850098,
    "y": 224.00391134619713,
    "z": "4c287bc.f107e84",
    "wires": [
      [
        "3cd1ca28.cc1526"
      ]
    ]
  },
  {
    "id": "3cd1ca28.cc1526",
    "type": "set",
    "name": "set topology",
    "xml": "<set>\n<parameter name='prop.topology' value='`$ctx.network-data.network-request-input.network-input-parameters.param[$idx].value`' />\n",
    "comments": "",
    "x": 1567.2500114440918,
    "y": 223.60390600562096,
    "z": "4c287bc.f107e84",
    "wires": []
  },
  {
    "id": "d3877bd.f214188",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 707.7500457763672,
    "y": 707.0040292739868,
    "z": "4c287bc.f107e84",
    "wires": [
      [
        "7110150.fd1e8ec"
      ]
    ]
  },
  {
    "id": "7110150.fd1e8ec",
    "type": "execute",
    "name": "execute RestApiCallNode Create network orchestration",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/sdwan-network-orchestration.json'`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/controller/campus/v1/sdwan/net/network-orchestration-resources'`\" />\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"put\"/>\n<parameter name=\"responsePrefix\" value=\"orchestration-result\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.openecomp.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n<parameter name='customHttpHeaders' value=\"`'X-ACCESS-TOKEN=' + $prop.sdncRestApi.token_id`\" />",
    "comments": "",
    "outputs": 1,
    "x": 1028.2501525878906,
    "y": 696.0041122436523,
    "z": "4c287bc.f107e84",
    "wires": [
      []
    ]
  },
  {
    "id": "bc16f27b.ec50b",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 710.2500152587891,
    "y": 769.0039575994015,
    "z": "4c287bc.f107e84",
    "wires": [
      [
        "39c058d0.1d59d8",
        "4d96e12b.86876",
        "50f144c4.b6b2ac"
      ]
    ]
  },
  {
    "id": "4d96e12b.86876",
    "type": "execute",
    "name": "execute RestApiCallNode Create vpn",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/sdwan-vpn-create.json'`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/controller/campus/v1/sdwan/overlay-network/vpn'`\" />\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"post\"/>\n<parameter name=\"responsePrefix\" value=\"vpn-result\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.openecomp.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n<parameter name='customHttpHeaders' value=\"`'X-ACCESS-TOKEN=' + $prop.sdncRestApi.token_id`\" />",
    "comments": "",
    "outputs": 1,
    "x": 981.7500610351562,
    "y": 759.0040815770626,
    "z": "4c287bc.f107e84",
    "wires": [
      []
    ]
  },
  {
    "id": "39c058d0.1d59d8",
    "type": "set",
    "name": "set prop.vpn-id and prop.vpn1Id",
    "xml": "<set>\n<parameter name='prop.vpn-id' value='`$vpn-result.success[0].id`' />\n<parameter name='prop.vpn1Id' value='`$vpn-result.success[0].id`' />\n",
    "comments": "",
    "x": 977.7502174377441,
    "y": 811.0041809082031,
    "z": "4c287bc.f107e84",
    "wires": []
  },
  {
    "id": "50f144c4.b6b2ac",
    "type": "execute",
    "name": "execute RestApiCallNode Create vpn topology",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/sdwan-vpn-topology-create.json'`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/controller/campus/v1/sdwan/overlay-network/' + $prop.vpn-id + '/topology'`\" />\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"post\"/>\n<parameter name=\"responsePrefix\" value=\"vpn-result\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.openecomp.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n<parameter name='customHttpHeaders' value=\"`'X-ACCESS-TOKEN=' + $prop.sdncRestApi.token_id`\" />",
    "comments": "",
    "outputs": 1,
    "x": 1009.2500648498535,
    "y": 863.0039558410645,
    "z": "4c287bc.f107e84",
    "wires": [
      []
    ]
  },
  {
    "id": "29cb6e2b.ecafd2",
    "type": "set",
    "name": "set tenant-id to service-data",
    "xml": "<set>\n<parameter name='service-data.networks.network[$tmp.nidx].network-data.network-request-input.network-input-parameters.param[$network-topology-operation-input.network-request-input.network-input-parameters.param_length].name' value='tenant-id' />\n<parameter name='service-data.networks.network[$tmp.nidx].network-data.network-request-input.network-input-parameters.param[$network-topology-operation-input.network-request-input.network-input-parameters.param_length].value' value='`$prop.tenant-id`' />\n<parameter name='service-data.networks.network[$tmp.nidx].network-data.network-request-input.network-input-parameters.param_length' value='`$network-topology-operation-input.network-request-input.network-input-parameters.param_length + 1`' />",
    "comments": "",
    "x": 745.2501525878906,
    "y": 904.7540903091431,
    "z": "4c287bc.f107e84",
    "wires": []
  },
  {
    "id": "9bf6657f.dd37a8",
    "type": "get-resource",
    "name": "get-resource service-subscription",
    "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"service-subscription\" \n        key= 'service-subscription.service-type = $service-data.networks.network[$tmp.nidx].network-data.service-information.subscription-service-type \n        AND customer.global-customer-id = $service-data.networks.network[$tmp.nidx].network-data.service-information.global-customer-id'\n      force=\"true\" pfx=\"tmp.AnAI-data\">\n      \n",
    "comments": "",
    "outputs": 1,
    "x": 762.0715408325195,
    "y": 611.6825218200684,
    "z": "4c287bc.f107e84",
    "wires": [
      [
        "fbe99e6e.4017e",
        "457e75b8.5e8e7c"
      ]
    ]
  },
  {
    "id": "ba35b9dd.539428",
    "type": "switchNode",
    "name": "switch temp-ub-sub-account-id",
    "xml": "<switch test='`$tmp.AnAI-data.temp-ub-sub-account-id`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1174.071632385254,
    "y": 576.4326028823853,
    "z": "4c287bc.f107e84",
    "wires": [
      [
        "76b51f1a.0801",
        "efbb35c.45c87c8"
      ]
    ]
  },
  {
    "id": "76b51f1a.0801",
    "type": "outcome",
    "name": "NULL",
    "xml": "<outcome value=''>",
    "comments": "",
    "outputs": 1,
    "x": 1366.78609085083,
    "y": 550.432635307312,
    "z": "4c287bc.f107e84",
    "wires": [
      [
        "a2a000be.ae6b"
      ]
    ]
  },
  {
    "id": "efbb35c.45c87c8",
    "type": "other",
    "name": "Other",
    "xml": "<outcome value='Other'>",
    "comments": "",
    "outputs": 1,
    "x": 1367.071647644043,
    "y": 605.4326066970825,
    "z": "4c287bc.f107e84",
    "wires": [
      [
        "864dc517.ee5aa8"
      ]
    ]
  },
  {
    "id": "5407a489.2a82dc",
    "type": "set",
    "name": "set prop.tenant-id",
    "xml": "<set>\n<parameter name='prop.tenant-id' value='`$tmp.AnAI-data.temp-ub-sub-account-id`' />\n",
    "comments": "",
    "x": 1614.5002403259277,
    "y": 690.5754070281982,
    "z": "4c287bc.f107e84",
    "wires": []
  },
  {
    "id": "a2a000be.ae6b",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1506.2499885559082,
    "y": 550.7539038658142,
    "z": "4c287bc.f107e84",
    "wires": [
      [
        "d533a7b3.2b7aa8",
        "68abe37a.a97c3c",
        "ebb2a924.447738",
        "3179cec4.da2412",
        "df370d35.edba",
        "5f23c930.bf33c8",
        "d5098f7f.2d7c"
      ]
    ]
  },
  {
    "id": "3179cec4.da2412",
    "type": "set",
    "name": "set prop.customer-id",
    "xml": "<set>\n<parameter name='prop.customer-id' value='`$ctx.network-data.service-information.global-customer-id`' />\n",
    "comments": "",
    "x": 1717.8930969238281,
    "y": 361.3254642486572,
    "z": "4c287bc.f107e84",
    "wires": []
  },
  {
    "id": "d533a7b3.2b7aa8",
    "type": "execute",
    "name": "execute RestApiCallNode Create tenant",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/sdwan-tenant.json'`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/controller/campus/v1/baseservice/tenants'`\" />\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"post\"/>\n<parameter name=\"responsePrefix\" value=\"tenant-result\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.openecomp.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n<parameter name='customHttpHeaders' value=\"`'X-ACCESS-TOKEN=' + $prop.sdncRestApi.token_id`\" />",
    "comments": "",
    "outputs": 1,
    "x": 1776.8929138183594,
    "y": 491.89675521850586,
    "z": "4c287bc.f107e84",
    "wires": [
      []
    ]
  },
  {
    "id": "68abe37a.a97c3c",
    "type": "set",
    "name": "set prop.tenant-id",
    "xml": "<set>\n<parameter name='prop.tenant-id' value='`$tenant-result.data.tenantId`' />\n",
    "comments": "",
    "x": 1729.7502326965332,
    "y": 616.753984451294,
    "z": "4c287bc.f107e84",
    "wires": []
  },
  {
    "id": "ebb2a924.447738",
    "type": "execute",
    "name": "execute RestApiCallNode Create tenant auth",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/controller/campus/v1/baseservice/tenants/authorization/' + $prop.tenant-id`\" />\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"put\"/>\n<parameter name=\"responsePrefix\" value=\"tenant-result\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.openecomp.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n<parameter name='customHttpHeaders' value=\"`'X-ACCESS-TOKEN=' + $prop.sdncRestApi.token_id`\" />",
    "comments": "",
    "outputs": 1,
    "x": 1797.250228881836,
    "y": 652.503984451294,
    "z": "4c287bc.f107e84",
    "wires": [
      []
    ]
  },
  {
    "id": "df370d35.edba",
    "type": "get-resource",
    "name": "update-resource customer-id in service-subscription",
    "xml": "<update plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"service-subscription\" \n        key= 'service-subscription.service-type = $service-data.networks.network[$tmp.nidx].network-data.service-information.subscription-service-type \n        AND customer.global-customer-id = $service-data.networks.network[$tmp.nidx].network-data.service-information.global-customer-id'>\n<parameter name='temp-ub-sub-account-id' value='`$tenant-result.data.tenantId`' />\n<!--parameter name='temp-ub-sub-account-id' value='`$prop.customer-id`' /-->\n\n\n",
    "comments": "",
    "outputs": 1,
    "x": 1821.1786041259766,
    "y": 552.8968715667725,
    "z": "4c287bc.f107e84",
    "wires": [
      []
    ]
  },
  {
    "id": "fbe99e6e.4017e",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 972.571403503418,
    "y": 584.4285802841187,
    "z": "4c287bc.f107e84",
    "wires": [
      [
        "ba35b9dd.539428"
      ]
    ]
  },
  {
    "id": "457e75b8.5e8e7c",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 966.2499923706055,
    "y": 636.6428918838501,
    "z": "4c287bc.f107e84",
    "wires": [
      [
        "df05b13b.b352c"
      ]
    ]
  },
  {
    "id": "df05b13b.b352c",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing get token rest api\" />\n",
    "comments": "",
    "x": 1118.9999923706055,
    "y": 636.3929529190063,
    "z": "4c287bc.f107e84",
    "wires": []
  },
  {
    "id": "73dbb3c3.f1d1fc",
    "type": "set",
    "name": "set  vpn-id to service-data",
    "xml": "<set>\n<parameter name='service-data.networks.network[$tmp.nidx].network-data.network-request-input.network-input-parameters.param[$network-topology-operation-input.network-request-input.network-input-parameters.param_length].name' value='vpn-id' />\n<parameter name='service-data.networks.network[$tmp.nidx].network-data.network-request-input.network-input-parameters.param[$network-topology-operation-input.network-request-input.network-input-parameters.param_length].value' value='`$prop.vpn-id`' />\n<parameter name='service-data.networks.network[$tmp.nidx].network-data.network-request-input.network-input-parameters.param_length' value='`$network-topology-operation-input.network-request-input.network-input-parameters.param_length + 1`' />",
    "comments": "",
    "x": 743.5000762939453,
    "y": 942.5039682388306,
    "z": "4c287bc.f107e84",
    "wires": []
  },
  {
    "id": "864dc517.ee5aa8",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1425.7224044799805,
    "y": 688.5795984268188,
    "z": "4c287bc.f107e84",
    "wires": [
      [
        "5407a489.2a82dc",
        "75fd5cb0.1720a4"
      ]
    ]
  },
  {
    "id": "75fd5cb0.1720a4",
    "type": "execute",
    "name": "execute RestApiCallNode Create tenant auth",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/controller/campus/v1/baseservice/tenants/authorization/' + $prop.tenant-id`\" />\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"put\"/>\n<parameter name=\"responsePrefix\" value=\"tenant-result\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.openecomp.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n<parameter name='customHttpHeaders' value=\"`'X-ACCESS-TOKEN=' + $prop.sdncRestApi.token_id`\" />",
    "comments": "",
    "outputs": 1,
    "x": 1697.1510009765625,
    "y": 737.1510009765625,
    "z": "4c287bc.f107e84",
    "wires": [
      []
    ]
  },
  {
    "id": "5f23c930.bf33c8",
    "type": "set",
    "name": "set prop.userAccount",
    "xml": "<set>\n<parameter name='prop.userAccount' value='`$tmp.userAccountEmail`' />\n<parameter name='prop.userEmail' value='`$tmp.userAccountEmail`' />",
    "comments": "",
    "x": 1718,
    "y": 439,
    "z": "4c287bc.f107e84",
    "wires": []
  },
  {
    "id": "d5098f7f.2d7c",
    "type": "execute",
    "name": "execute concat customer-id and @test.com",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='concat' >\n    <parameter name=\"source\" value='`$prop.customer-id`'/>\n    <parameter name=\"outputPath\" value=\"tmp.userAccountEmail\"/>\n    <parameter name=\"target\" value=\"@test.com\"/>\n\n\n",
    "comments": "",
    "outputs": 1,
    "x": 1793.0038757324219,
    "y": 403.003942489624,
    "z": "4c287bc.f107e84",
    "wires": [
      []
    ]
  }
]
