[{"id":"1d70426f.3cd00e","type":"dgstart","name":"DGSTART","outputs":1,"x":171,"y":86,"z":"f633035a.675b5","wires":[["13d83fa4.5938b8"]]},{"id":"13d83fa4.5938b8","type":"service-logic","name":"GENERIC-RESOURCE-API ${project.version}","module":"GENERIC-RESOURCE-API","version":"${project.version}","comments":"","xml":"<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>","outputs":1,"x":246.28570556640625,"y":126.23811149597168,"z":"f633035a.675b5","wires":[["9cd6dac6.ecabf8"]]},{"id":"9cd6dac6.ecabf8","type":"method","name":"method vnf-topology-operation-activate","xml":"<method rpc='vnf-topology-operation-activate' mode='sync'>\n","comments":"","outputs":1,"x":267.42862701416016,"y":166,"z":"f633035a.675b5","wires":[["ef1ff1c.17b2a1"]]},{"id":"79db4033.6d4b1","type":"comment","name":"vnf-topology-operation-activate","info":"","comments":"","x":565.344856262207,"y":33.58634376525879,"z":"f633035a.675b5","wires":[]},{"id":"80bac9c7.944218","type":"switchNode","name":"switch request-action","xml":"<switch test='`$vnf-topology-operation-input.request-information.request-action`'>\n","comments":"","outputs":1,"x":574.523811340332,"y":264.8571376800537,"z":"f633035a.675b5","wires":[["24f00679.c7e4a2","bee28d9e.ba0cd8"]]},{"id":"24f00679.c7e4a2","type":"outcome","name":"CreateVnfInstance","xml":"<outcome value='CreateVnfInstance'>\n","comments":"","outputs":1,"x":792.9047737121582,"y":242.00002193450928,"z":"f633035a.675b5","wires":[["e9964824.c9d1f8"]]},{"id":"bee28d9e.ba0cd8","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":756.9047393798828,"y":287.7143497467041,"z":"f633035a.675b5","wires":[["17c20d02.b3db9b"]]},{"id":"e9964824.c9d1f8","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":979.7619018554688,"y":242.0000514984131,"z":"f633035a.675b5","wires":[[]]},{"id":"17c20d02.b3db9b","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"If svc-action is 'activate' then request-action must be 'CreateVnfInstance'\" />\n","comments":"","x":996.9047470092773,"y":287.7143077850342,"z":"f633035a.675b5","wires":[]},{"id":"ef1ff1c.17b2a1","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":247.66666412353516,"y":387.6666717529297,"z":"f633035a.675b5","wires":[["80bac9c7.944218","764ff2a2.204364","2b85cbc9.8b8434","2cfbf82b.88e3","252d8594.7e5f3a","83377877.1a8068","390a6c50.56aa84","a48cbf41.4fa728","45f1d568.50b334"]]},{"id":"764ff2a2.204364","type":"switchNode","name":"switch vnf_length","xml":"<switch test='`$service-data.vnfs.vnf_length`'>\n","comments":"","outputs":1,"x":560.9999847412109,"y":334.33336353302,"z":"f633035a.675b5","wires":[["410fc0a.79e9fc"]]},{"id":"410fc0a.79e9fc","type":"other","name":"NULL","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":747.6666641235352,"y":333.6666612625122,"z":"f633035a.675b5","wires":[["be1d3fae.f8f47"]]},{"id":"be1d3fae.f8f47","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"404\" />\n    <parameter name=\"error-message\" value=\"There are no VNFs in MD-SAL\" />\n","comments":"","x":929.3332901000977,"y":333.6666612625122,"z":"f633035a.675b5","wires":[]},{"id":"2b85cbc9.8b8434","type":"for","name":"for each vnf","xml":"<for index='idx' start='0' end='`$service-data.vnfs.vnf_length`' >\n","comments":"","outputs":1,"x":542.6666641235352,"y":382.66668128967285,"z":"f633035a.675b5","wires":[["518ecda4.6a0c2c"]]},{"id":"518ecda4.6a0c2c","type":"switchNode","name":"switch this vnf-id == input vnf-id","xml":"<switch test='`$service-data.vnfs.vnf[$idx].vnf-id == $vnf-topology-operation-input.vnf-information.vnf-id`'>\n","comments":"","outputs":1,"x":797.6667518615723,"y":381.3333492279053,"z":"f633035a.675b5","wires":[["41cdf599.c61944"]]},{"id":"41cdf599.c61944","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":1036.0000381469727,"y":380.333327293396,"z":"f633035a.675b5","wires":[["35723778.959e4"]]},{"id":"35723778.959e4","type":"set","name":"set vnf-index","xml":"<set>\n<parameter name='vnf-index' value='`$idx`' />\n","comments":"","x":1204.3332328796387,"y":380.3333492279053,"z":"f633035a.675b5","wires":[]},{"id":"2cfbf82b.88e3","type":"switchNode","name":"switch vnf-index","xml":"<switch test='`$vnf-index`'>\n","comments":"","outputs":1,"x":554.3333282470703,"y":429.3333511352539,"z":"f633035a.675b5","wires":[["b38d9002.1de9e"]]},{"id":"b38d9002.1de9e","type":"other","name":"NULL","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":735.9999465942383,"y":428.66668128967285,"z":"f633035a.675b5","wires":[["a7eff6a0.4b1ee8"]]},{"id":"a7eff6a0.4b1ee8","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"404\" />\n    <parameter name=\"error-message\" value=\"'Could not find VNF ' + $vnf-topology-operation-input.vnf-information.vnf-id + ' in MD-SAL'\" />\n","comments":"","x":902.666633605957,"y":428.33330726623535,"z":"f633035a.675b5","wires":[]},{"id":"390a6c50.56aa84","type":"returnSuccess","name":"return success","xml":"<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n","comments":"","x":549.3332672119141,"y":691.0000066757202,"z":"f633035a.675b5","wires":[]},{"id":"83377877.1a8068","type":"set","name":"set vnf-level-oper-status to Created","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-level-oper-status.order-status' value='Created' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-level-oper-status.last-rpc-action' value='`$vnf-topology-operation-input.sdnc-request-header.svc-action`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-level-oper-status.last-action' value='`$vnf-topology-operation-input.request-information.request-action`' />\n","comments":"","x":611.8133773803711,"y":643.3371334075928,"z":"f633035a.675b5","wires":[]},{"id":"252d8594.7e5f3a","type":"set","name":"copy input data","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.sdnc-request-header.' value='$vnf-topology-operation-input.sdnc-request-header.' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.request-information.' value='$vnf-topology-operation-input.request-information.' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.service-information.' value='$vnf-topology-operation-input.service-information.' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-information.' value='$vnf-topology-operation-input.vnf-information.' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-request-input.' value='$vnf-topology-operation-input.vnf-request-input.' />\n<parameter name=\"service-object-path\" value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'+$vnf-topology-operation-input.service-information.service-instance-id+'/service-data/service-topology/'`\" />\n","comments":"","x":552.6665191650391,"y":599.3333148956299,"z":"f633035a.675b5","wires":[]},{"id":"a48cbf41.4fa728","type":"switchNode","name":"switch current vnf-level-oper-status == PendingCreate","xml":"<switch test=\"`$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-level-oper-status.order-status == 'PendingCreate'`\">\n","comments":"","outputs":1,"x":676.0000381469727,"y":472.66663646698,"z":"f633035a.675b5","wires":[["10271e79.c3890a"]]},{"id":"10271e79.c3890a","type":"outcomeFalse","name":"false","xml":"<outcome value='false'>\n","comments":"","outputs":1,"x":962.333381652832,"y":472.33328437805176,"z":"f633035a.675b5","wires":[["d3a63bd0.e6341"]]},{"id":"d3a63bd0.e6341","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Order status must be PendingCreate, but is currently '\n      + $service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-level-oper-status.order-status`\" />\n","comments":"","x":1120.6666564941406,"y":471.6666088104248,"z":"f633035a.675b5","wires":[]},{"id":"8218f1b6.e20bd","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'No generic-vnf found in AAI for vnf ID ' + $service-data.vnfs.vnf[$vnf-index].vnf-id`\" />\n","comments":"","x":1066.0000038146973,"y":559.9999227523804,"z":"f633035a.675b5","wires":[]},{"id":"a48cac73.1cd8f8","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":897.0239028930664,"y":516.2857341766357,"z":"f633035a.675b5","wires":[["595dc206.979dec"]]},{"id":"4684d1a8.88798","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":905.5953330993652,"y":560.5714473724365,"z":"f633035a.675b5","wires":[["8218f1b6.e20bd"]]},{"id":"595dc206.979dec","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating generic-vnf in AAI\" />\n","comments":"","x":1068.6905975341797,"y":516.7621278762817,"z":"f633035a.675b5","wires":[]},{"id":"45f1d568.50b334","type":"save","name":"update generic-vnf prov-status to NVTPROV","xml":"<update plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\"\n   resource=\"generic-vnf\"\n   key=\"generic-vnf.vnf-id = $service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-topology-identifier-structure.vnf-id\"\n   force=\"true\" pfx=\"tmp.AnAI-data\">\n<parameter name=\"prov-status\" value=\"NVTPROV\" />\n","comments":"","outputs":1,"x":644.3333282470703,"y":535.9999904632568,"z":"f633035a.675b5","wires":[["a48cac73.1cd8f8","4684d1a8.88798"]]}]