[
    {
        "id": "94b540c9.238618",
        "type": "dgstart",
        "name": "DGSTART",
        "outputs": 1,
        "x": 149.75,
        "y": 94.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "dda31e25.b7e27"
            ]
        ]
    },
    {
        "id": "dda31e25.b7e27",
        "type": "service-logic",
        "name": "GENERIC-RESOURCE-API ${project.version}",
        "module": "GENERIC-RESOURCE-API",
        "version": "${project.version}",
        "comments": "",
        "xml": "<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>",
        "outputs": 1,
        "x": 281.0356903076172,
        "y": 143.98810863494873,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "a1958103.ff3f88"
            ]
        ]
    },
    {
        "id": "a1958103.ff3f88",
        "type": "method",
        "name": "method p2p-vnf-topology-operation-p2p-activate",
        "xml": "<method rpc='p2p-vnf-topology-operation-p2p-activate' mode='sync'>\n",
        "comments": "",
        "outputs": 1,
        "x": 284.1786193847656,
        "y": 228.75003242492676,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "a73db057.8ff74"
            ]
        ]
    },
    {
        "id": "a73db057.8ff74",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 433.988037109375,
        "y": 358.4166564941406,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "91bdee0e.c7f15",
                "957a18ba.9d8e",
                "11da7ad8.21f09d"
            ]
        ]
    },
    {
        "id": "91bdee0e.c7f15",
        "type": "returnSuccess",
        "name": "return success",
        "xml": "<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n",
        "comments": "",
        "x": 702.3216552734375,
        "y": 745.34716796875,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "1d1c9d38.a24823",
        "type": "comment",
        "name": "new for TransportSlicing",
        "info": "",
        "comments": "",
        "x": 733.75,
        "y": 419.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "957a18ba.9d8e",
        "type": "save",
        "name": "get service-instance from aai",
        "xml": "<!--<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" -->\n<!--\tresource=\"service-instance\"-->\n<!--\tkey='service-instance.service-instance-id = $service-data.vnfs.vnf[$tmp.vidx].vnf-data.service-information.service-instance-id-->\n<!--         AND customer.global-customer-id = $service-data.vnfs.vnf[$tmp.vidx].vnf-data.service-information.global-customer-id -->\n<!--         AND service-subscription.service-type = $service-data.vnfs.vnf[$tmp.vidx].vnf-data.service-information.subscription-service-type'-->\n<!--\tlocal-only=\"false\"-->\n<!--\tforce=\"true\" pfx=\"tmp.aai.service-instance\">-->\n\n<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"service-instance\"\n\tkey='service-instance.service-instance-id = $vnf-topology-operation-input.service-information.service-instance-id\n         AND customer.global-customer-id = $vnf-topology-operation-input.service-information.global-customer-id \n         AND service-subscription.service-type = $vnf-topology-operation-input.service-information.subscription-service-type'\n\tlocal-only=\"false\"\n\tforce=\"true\" pfx=\"tmp.aai.service-instance\">\n\n\n<!--$vnf-topology-operation-input.service-information.service-instance-id-->",
        "comments": "",
        "outputs": 1,
        "x": 753.75,
        "y": 515.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "255854de.861404",
                "fd908507.674308",
                "4a62dd9f.61cdac"
            ]
        ]
    },
    {
        "id": "255854de.861404",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 972.75,
        "y": 453.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "622587e3.99be58"
            ]
        ]
    },
    {
        "id": "fd908507.674308",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 982.240966796875,
        "y": 496.32403564453125,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "d8fc9dc9.3e6cf"
            ]
        ]
    },
    {
        "id": "4a62dd9f.61cdac",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 970.75,
        "y": 542.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "5e548c85.32cd14"
            ]
        ]
    },
    {
        "id": "d8fc9dc9.3e6cf",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.l3vpn.pe1_id`\" />\n\n",
        "comments": "",
        "x": 1135.8123779296875,
        "y": 499.6097717285156,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "5e548c85.32cd14",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
        "comments": "",
        "x": 1139.75,
        "y": 543.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "622587e3.99be58",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for index='rel-index' start='0' end='`$tmp.aai.service-instance.relationship-list.relationship_length`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 1169.75,
        "y": 449.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "439a3ae3.2ab694"
            ]
        ]
    },
    {
        "id": "439a3ae3.2ab694",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.aai.service-instance.relationship-list.relationship[$rel-index].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1393.08349609375,
        "y": 449.74993896484375,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "1016c8ba.b6da07"
            ]
        ]
    },
    {
        "id": "1016c8ba.b6da07",
        "type": "outcome",
        "name": "connectivity",
        "xml": "<outcome value='connectivity'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1593.7501335144043,
        "y": 450.75002098083496,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "f655b129.6c8e3"
            ]
        ]
    },
    {
        "id": "7d98821b.e6839c",
        "type": "set",
        "name": "set attachment_param for OTN A",
        "xml": "<set>\n<parameter name='src-node-id' value='`$tmp.aai.vpn-bindingA.src-access-node-id`' />\n<parameter name='dst-node-id' value='`$tmp.aai.vpn-bindingA.dst-access-node-id`' />\n<!--<parameter name='dst-tpn-id' value='1' />-->\n<parameter name='dst-tpn-id' value='`$tmp.aai.vpn-bindingA.customer-vpn-id`' />\n<parameter name='dst-ttp-id' value='`$tmp.aai.vpn-bindingA.dst-access-ltp-id`' />\n<parameter name='slice-instance-id' value='`$tmp.aai.service-instance.service-instance-id`' />\n<parameter name='otn-tunnel-name-src-domain' value='`$tmp.aai.vpn-bindingA.vpn-name`' />\n<parameter name='client-id' value='`$tmp.aai.vpn-bindingA.access-client-id`' />\n<parameter name='provider-id' value='`$tmp.aai.vpn-bindingA.access-provider-id`' />\n<parameter name='topology-id' value='`$tmp.aai.vpn-bindingA.access-topology-id`' />\n",
        "comments": "",
        "x": 4412.75,
        "y": 166.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "c978ce8f.5eb918",
        "type": "execute",
        "name": "execute RestApiCallNode Create OTN tunnel with token",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.ts-otn-src-domain-creation.templatefile`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainA.url + '/restconf/data/ietf-te:te'`\" />\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainA.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainA.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"patch\"/>\n<parameter name=\"responsePrefix\" value=\"otn-oof\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n<parameter name='customHttpHeaders' value=\"`'X-ACCESS-TOKEN=' + $prop.sdncRestApi.token_id`\" />",
        "comments": "",
        "outputs": 1,
        "x": 4493.75,
        "y": 481.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "c08a95fe.6696f8",
                "b0f4c0f5.92a118"
            ]
        ]
    },
    {
        "id": "c08a95fe.6696f8",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4803.25,
        "y": 450.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "f00f23ff.750aa8"
            ]
        ]
    },
    {
        "id": "b0f4c0f5.92a118",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4808.25,
        "y": 515.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "c22d4e2c.b8095"
            ]
        ]
    },
    {
        "id": "f00f23ff.750aa8",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create OTN tunnel rest api\" />\n",
        "comments": "",
        "x": 4979.25,
        "y": 450.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "c22d4e2c.b8095",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 4974.75,
        "y": 515.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            []
        ]
    },
    {
        "id": "d1f1dcb6.1fec3",
        "type": "set",
        "name": "set sotn_value",
        "xml": "<set>\n<!--<parameter name='eth-service-name' value='`$tmp.aai.connectivityA.connectivity-id`' />-->\n<parameter name='eth-service-name' value='`$tmp.aai.connectivityA.etht-svc-name`' />\n<parameter name='slice-id' value='`$vnf-topology-operation-input.service-information.service-instance-id`' />\n<parameter name='provider-id' value='`$tmp.aai.connectivityA.access-provider-id`' />\n<parameter name='client-id' value='`$tmp.aai.connectivityA.access-client-id`' />\n<parameter name='topology-id' value='`$tmp.aai.connectivityA.access-topology-id`' />\n<parameter name='otn-tunnel-name' value='`$tmp.aai.vpn-bindingA.vpn-name`' />\n<parameter name='ethernet-end-point-name' value='`$tmp.aai.connectivityA.connectivity-id`' />\n<parameter name='index-number' value='0' />\n<parameter name='eth-node-id' value='`$tmp.aai.connectivityA.access-node-id`' />\n<parameter name='eth-node-tp-id' value='`$tmp.aai.connectivityA.access-ltp-id`' />\n<parameter name='CIR' value='`$tmp.aai.vpn-bindingA.route-distinguisher *1000000`' />\n<parameter name='EIR' value='`$tmp.aai.vpn-bindingA.route-distinguisher *1000000`' />\n<parameter name='cvlan' value='`$tmp.aai.connectivityA.cvlan`' />\n",
        "comments": "",
        "x": 4360.25,
        "y": 669.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "251b183d.cbc77",
        "type": "execute",
        "name": "execute RestApiCallNode Create ethernet Service without token",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.ts-ethernet-service.templatefile`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainA.url + '/restconf/data/ietf-eth-tran-service:etht-svc'`\" />\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.restapi.connection-oof-url`\" />-->\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainA.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainA.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"patch\"/>\n<parameter name='dirPath' value=\"/opt/onap/sdnc/restconfapi/yang\" />\n<parameter name=\"responsePrefix\" value=\"vpn-result\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n",
        "comments": "",
        "outputs": 1,
        "x": 4514.25,
        "y": 717.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "be60985c.4fbc58",
                "b84a3cc3.684a28"
            ]
        ]
    },
    {
        "id": "be60985c.4fbc58",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4859.75,
        "y": 698.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "305db122.d214ee"
            ]
        ]
    },
    {
        "id": "b84a3cc3.684a28",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4863.75,
        "y": 738.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "d6fb6749.eab338"
            ]
        ]
    },
    {
        "id": "305db122.d214ee",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create ethernet service rest api\" />\n",
        "comments": "",
        "x": 5017.75,
        "y": 698.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "d6fb6749.eab338",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 5021.25,
        "y": 738.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "4fa6f4cb.4aa39c",
                "f065baf1.f73c4",
                "677bc6cc.c2278"
            ]
        ]
    },
    {
        "id": "d7ddb4d7.9c1b5",
        "type": "comment",
        "name": "TODO: FIXME:",
        "info": "put proper values based on connectivity resource retrieved from AAI",
        "comments": "",
        "x": 4357.75,
        "y": 625.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "4fa6f4cb.4aa39c",
        "type": "save",
        "name": "update vpn-binding A resource (aka. OTN domainA) in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding' \n      key='vpn-binding.vpn-id = $tmp.aai.vpn-bindingA.vpn-id' >\n<parameter name='vpn-id' value='`$tmp.aai.vpn-bindingA.vpn-id`' />\n<parameter name='vpn-name' value='`$tmp.aai.vpn-bindingA.vpn-name`' />\n\n<parameter name='operational-status' value='Activated' />\n",
        "comments": "",
        "outputs": 1,
        "x": 5351.75,
        "y": 703.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            []
        ]
    },
    {
        "id": "e1a352b3.d1c22",
        "type": "comment",
        "name": "TODO: FIXME",
        "info": "use proper vpn-binding id and connectivity id\n\nAlso, does CCSDK support \"update\" operation for vpn-binding and connectivity?",
        "comments": "",
        "x": 5215.75,
        "y": 662.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "f065baf1.f73c4",
        "type": "save",
        "name": "update connectivity resource in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='connectivity' \n      key='connectivity.connectivity-id = $tmp.aai.connectivityA.connectivity-id'>\n<parameter name='connectivity-id' value='`$tmp.aai.connectivityA.connectivity-id`' />\n<parameter name='operational-status' value='Activated' />\n",
        "comments": "",
        "outputs": 1,
        "x": 5278.75,
        "y": 749.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            []
        ]
    },
    {
        "id": "d8047beb.a120a",
        "type": "set",
        "name": "set pnf-name",
        "xml": "<set>\n<parameter name='tmp.src.domainA.pnf-name' value=\"`'networkId-providerId-' +\n                                                   $tmp.aai.vpn-bindingA.access-provider-id + '-clientId-' +\n                                                   $tmp.aai.vpn-bindingA.access-client-id + '-topologyId-' +\n                                                   $tmp.aai.vpn-bindingA.access-topology-id + '-nodeId-' +\n                                                   $tmp.aai.vpn-bindingA.src-access-node-id`\" />\n",
        "comments": "",
        "x": 4350.75,
        "y": 214.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "c0003a50.a00b1",
        "type": "get-resource",
        "name": "get-resource src pnf",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"pnf\" \n\t\tkey=\"pnf.pnf-name = $tmp.src.domainA.pnf-name\"\n        pfx='tmp.aai.source-pnf' local-only='false' >\n\n        <!--AND depth = '0'\"-->\n",
        "comments": "",
        "outputs": 1,
        "x": 4376.75,
        "y": 331.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "767b670a.725628",
                "8de69881.7810c",
                "dbb97564.e7a91"
            ]
        ]
    },
    {
        "id": "767b670a.725628",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4572.2501220703125,
        "y": 283.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "9fa9eef6.966618"
            ]
        ]
    },
    {
        "id": "8de69881.7810c",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4564.2501220703125,
        "y": 338.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "2b81f91f.bfddb6"
            ]
        ]
    },
    {
        "id": "9fa9eef6.966618",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 4716.6324462890625,
        "y": 283.4056701660156,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "33a206d2.a6527a"
            ]
        ]
    },
    {
        "id": "4f3c702b.c83bb",
        "type": "outcome",
        "name": "esr-thirdparty-sdnc",
        "xml": "<outcome value='esr-thirdparty-sdnc'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5298.75,
        "y": 285.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "cb134ba5.74bf48"
            ]
        ]
    },
    {
        "id": "33a206d2.a6527a",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for silentFailure='true' index='spvidx' start='0' end='`$tmp.aai.source-pnf.relationship-list.relationship_length`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 4900.75,
        "y": 281.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "893da1cb.bc091"
            ]
        ]
    },
    {
        "id": "893da1cb.bc091",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.aai.source-pnf.relationship-list.relationship[$spvidx].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5095.75,
        "y": 281.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "4f3c702b.c83bb"
            ]
        ]
    },
    {
        "id": "dbb97564.e7a91",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4569.2501220703125,
        "y": 395.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "b75e061e.d5ec88"
            ]
        ]
    },
    {
        "id": "b75e061e.d5ec88",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 4721.2501220703125,
        "y": 396.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "2b81f91f.bfddb6",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 4732.2501220703125,
        "y": 339.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "848a4c57.f2a3d",
        "type": "execute",
        "name": "get esr-thirdparty-sdnc",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"esr-thirdparty-sdnc\" \n\t\tkey=\"esr-thirdparty-sdnc.thirdparty-sdnc-id = $tmp.domainA.esr-thirdparty-id AND \n\t\t     depth = '1'\"\n        pfx='tmp.aai.domainA.esr-thirdparty-sdnc' local-only='false' >",
        "comments": "",
        "outputs": 1,
        "x": 5683.75,
        "y": 298.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "2e1535a4.41297a",
                "1778db70.6907f5",
                "72b5f7c.70da408"
            ]
        ]
    },
    {
        "id": "cb134ba5.74bf48",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 5477.75,
        "y": 285.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "19fba605.f323fa",
                "848a4c57.f2a3d"
            ]
        ]
    },
    {
        "id": "19fba605.f323fa",
        "type": "set",
        "name": "set esr-thirdparty-sdnc domainA id",
        "xml": "<set>\n<parameter name='tmp.domainA.esr-thirdparty-id' value=\"`$tmp.aai.source-pnf.relationship-list.relationship[$spvidx].relationship-data[0].relationship-value`\" />\n",
        "comments": "",
        "x": 5713.75,
        "y": 246.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "2e1535a4.41297a",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5893.75,
        "y": 289.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "780f3b99.e0b614"
            ]
        ]
    },
    {
        "id": "1778db70.6907f5",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5885.75,
        "y": 344.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "142c73b0.fb0d8c"
            ]
        ]
    },
    {
        "id": "72b5f7c.70da408",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5890.75,
        "y": 401.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "4764feda.35a838"
            ]
        ]
    },
    {
        "id": "4764feda.35a838",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 6042.75,
        "y": 402.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "142c73b0.fb0d8c",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 6053.75,
        "y": 347.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "780f3b99.e0b614",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 6038.13232421875,
        "y": 287.4056701660156,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "bba0e779.8df588"
            ]
        ]
    },
    {
        "id": "bba0e779.8df588",
        "type": "set",
        "name": "set controller domainA data",
        "xml": "<set>\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainA.url' value=\"`$tmp.aai.domainA.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].service-url`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainA.user' value=\"`$tmp.aai.domainA.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].user-name`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainA.password' value=\"`$tmp.aai.domainA.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].password`\" />\n\n\n<!--<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >-->\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/restconf/data/ietf-network:networks'`\" />-->\n<!--<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />-->\n<!--<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />-->\n<!--<parameter name=\"format\" value=\"json\"/>-->\n<!--<parameter name=\"httpMethod\" value=\"get\"/>-->\n<!--<parameter name=\"responsePrefix\" value=\"topology\"/>-->\n<!--<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>-->\n<!--<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>-->\n<!--<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>-->\n<!--<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>-->\n",
        "comments": "",
        "x": 6252.75,
        "y": 283.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "11da7ad8.21f09d",
        "type": "execute",
        "name": "execute properties",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.prop.PropertiesNode' method='readProperties' >\n    <parameter name='fileName' value='%SDNC_CONFIG_DIR%/generic-resource-api-dg.properties' />\n    <parameter name='contextPrefix' value='prop' />",
        "comments": "",
        "outputs": 1,
        "x": 719.75,
        "y": 463.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            []
        ]
    },
    {
        "id": "97981e3f.7665d",
        "type": "set",
        "name": "set attachment_param for OTN B",
        "xml": "<set>\n<parameter name='src-node-id' value='`$tmp.aai.vpn-bindingB.src-access-node-id`' />\n<parameter name='dst-node-id' value='`$tmp.aai.vpn-bindingB.dst-access-node-id`' />\n<!--<parameter name='src-tpn-id' value='1' />-->\n<parameter name='src-tpn-id' value='`$tmp.aai.vpn-bindingB.customer-vpn-id`' />\n<parameter name='src-ttp-id' value='`$tmp.aai.vpn-bindingB.src-access-ltp-id`' />\n<parameter name='slice-instance-id' value='`$tmp.aai.service-instance.service-instance-id`' />\n<parameter name='otn-tunnel-name-dst-domain' value='`$tmp.aai.vpn-bindingB.vpn-name`' />\n<parameter name='client-id' value='`$tmp.aai.vpn-bindingB.access-client-id`' />\n<parameter name='provider-id' value='`$tmp.aai.vpn-bindingB.access-provider-id`' />\n<parameter name='topology-id' value='`$tmp.aai.vpn-bindingB.access-topology-id`' />\n",
        "comments": "",
        "x": 3819.75,
        "y": 1623.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "1bef475b.0876b9",
        "type": "execute",
        "name": "execute RestApiCallNode Create OTN tunnel with token",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.ts-otn-dst-domain-creation.templatefile`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainB.url + '/restconf/data/ietf-te:te'`\" />\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainB.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainB.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"patch\"/>\n<parameter name=\"responsePrefix\" value=\"otn-oof\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n<parameter name='customHttpHeaders' value=\"`'X-ACCESS-TOKEN=' + $prop.sdncRestApi.token_id`\" />",
        "comments": "",
        "outputs": 1,
        "x": 3882.75,
        "y": 1952.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "a5d1d793.c9259",
                "24fe1da2.474a9a"
            ]
        ]
    },
    {
        "id": "a5d1d793.c9259",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4178.25,
        "y": 1919.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "b911fc3e.201c1"
            ]
        ]
    },
    {
        "id": "24fe1da2.474a9a",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4183.25,
        "y": 1984.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "467082f5.e654ac"
            ]
        ]
    },
    {
        "id": "b911fc3e.201c1",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create OTN tunnel rest api\" />\n",
        "comments": "",
        "x": 4346.25,
        "y": 1919.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "467082f5.e654ac",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 4356.75,
        "y": 1984.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            []
        ]
    },
    {
        "id": "ace90237.5528b8",
        "type": "set",
        "name": "set pnf-name",
        "xml": "<set>\n<parameter name='tmp.dst.domainB.pnf-name' value=\"`'networkId-providerId-' +\n                                                   $tmp.aai.vpn-bindingB.access-provider-id + '-clientId-' +\n                                                   $tmp.aai.vpn-bindingB.access-client-id + '-topologyId-' +\n                                                   $tmp.aai.vpn-bindingB.access-topology-id + '-nodeId-' +\n                                                   $tmp.aai.vpn-bindingB.dst-access-node-id`\" />\n",
        "comments": "",
        "x": 3758.75,
        "y": 1680.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "e4aaac37.9b5738",
        "type": "get-resource",
        "name": "get-resource dst pnf",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"pnf\" \n\t\tkey=\"pnf.pnf-name = $tmp.dst.domainB.pnf-name\"\n        pfx='tmp.aai.destination-pnf' local-only='false' >\n\n        <!--AND depth = '0'\"-->\n",
        "comments": "",
        "outputs": 1,
        "x": 3778.75,
        "y": 1777.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "57142ea4.bc3bb",
                "cc1afb43.a5676",
                "86a15efe.377578"
            ]
        ]
    },
    {
        "id": "57142ea4.bc3bb",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3981.2501220703125,
        "y": 1730.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "19ef9dfe.b1b91a"
            ]
        ]
    },
    {
        "id": "cc1afb43.a5676",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3973.2501220703125,
        "y": 1785.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "fc294828.8c7aa"
            ]
        ]
    },
    {
        "id": "19ef9dfe.b1b91a",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 4125.6324462890625,
        "y": 1728.4056701660156,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "a34e91d1.6b4f48"
            ]
        ]
    },
    {
        "id": "a34e91d1.6b4f48",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for silentFailure='true' index='dpvidx' start='0' end='`$tmp.aai.destination-pnf.relationship-list.relationship_length`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 4309.75,
        "y": 1742.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "bcf409d1.2bca88"
            ]
        ]
    },
    {
        "id": "86a15efe.377578",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3978.2501220703125,
        "y": 1842.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "9228ece.bfbed9"
            ]
        ]
    },
    {
        "id": "9228ece.bfbed9",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 4130.2501220703125,
        "y": 1843.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "fc294828.8c7aa",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 4141.2501220703125,
        "y": 1788.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "8fd77208.a2c738",
        "type": "outcome",
        "name": "esr-thirdparty-sdnc",
        "xml": "<outcome value='esr-thirdparty-sdnc'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4707.75,
        "y": 1746.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "2b23a5a1.db882a"
            ]
        ]
    },
    {
        "id": "bcf409d1.2bca88",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.aai.destination-pnf.relationship-list.relationship[$dpvidx].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4504.75,
        "y": 1742.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "8fd77208.a2c738"
            ]
        ]
    },
    {
        "id": "ee733a11.b10eb8",
        "type": "execute",
        "name": "get esr-thirdparty-sdnc",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"esr-thirdparty-sdnc\" \n\t\tkey=\"esr-thirdparty-sdnc.thirdparty-sdnc-id = $tmp.domainB.esr-thirdparty-id AND \n\t\t     depth = '1'\"\n        pfx='tmp.aai.domainB.esr-thirdparty-sdnc' local-only='false' >",
        "comments": "",
        "outputs": 1,
        "x": 5092.75,
        "y": 1745.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "8e9e736e.ee5478",
                "98c4188c.f20b2",
                "454707d0.8a14d8"
            ]
        ]
    },
    {
        "id": "2b23a5a1.db882a",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 4884.75,
        "y": 1738.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "923bc8de.eb024",
                "ee733a11.b10eb8"
            ]
        ]
    },
    {
        "id": "923bc8de.eb024",
        "type": "set",
        "name": "set esr-thirdparty-sdnc domainB id",
        "xml": "<set>\n<parameter name='tmp.domainB.esr-thirdparty-id' value=\"`$tmp.aai.destination-pnf.relationship-list.relationship[$dpvidx].relationship-data[0].relationship-value`\" />\n",
        "comments": "",
        "x": 5122.75,
        "y": 1693.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "35e39fbb.1f604",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 5451.75,
        "y": 1849.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "13ebe3ed.f2247c",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 5462.75,
        "y": 1794.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "b78b9bfd.914f38",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 5447.13232421875,
        "y": 1734.4056701660156,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "4076fb5b.40dc5c"
            ]
        ]
    },
    {
        "id": "4076fb5b.40dc5c",
        "type": "set",
        "name": "set controller domainB data",
        "xml": "<set>\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainB.url' value=\"`$tmp.aai.domainB.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].service-url`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainB.user' value=\"`$tmp.aai.domainB.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].user-name`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainB.password' value=\"`$tmp.aai.domainB.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].password`\" />\n\n\n<!--<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >-->\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/restconf/data/ietf-network:networks'`\" />-->\n<!--<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />-->\n<!--<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />-->\n<!--<parameter name=\"format\" value=\"json\"/>-->\n<!--<parameter name=\"httpMethod\" value=\"get\"/>-->\n<!--<parameter name=\"responsePrefix\" value=\"topology\"/>-->\n<!--<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>-->\n<!--<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>-->\n<!--<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>-->\n<!--<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>-->\n",
        "comments": "",
        "x": 5661.75,
        "y": 1730.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "8e9e736e.ee5478",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5302.75,
        "y": 1736.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "b78b9bfd.914f38"
            ]
        ]
    },
    {
        "id": "98c4188c.f20b2",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5294.75,
        "y": 1791.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "13ebe3ed.f2247c"
            ]
        ]
    },
    {
        "id": "454707d0.8a14d8",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5299.75,
        "y": 1848.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "35e39fbb.1f604"
            ]
        ]
    },
    {
        "id": "f655b129.6c8e3",
        "type": "save",
        "name": "get connectivity from aai",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"connectivity\"\n\t    key=\"connectivity.connectivity-id = $tmp.aai.service-instance.relationship-list.relationship[$rel-index].relationship-data[0].relationship-value\"\n\t\tlocal-only=\"false\" \n\t\tpfx=\"tmp.aai.connectivity\" >\n",
        "comments": "",
        "outputs": 1,
        "x": 1831.75,
        "y": 452.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "d8fbecfc.eada5",
                "70aafcb6.3ffce4",
                "18daf882.cb46e7"
            ]
        ]
    },
    {
        "id": "d8fbecfc.eada5",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2039.75,
        "y": 416.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "92d3d22d.c618f8"
            ]
        ]
    },
    {
        "id": "70aafcb6.3ffce4",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2040.240966796875,
        "y": 462.32403564453125,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "de1e5ed.546bf2"
            ]
        ]
    },
    {
        "id": "18daf882.cb46e7",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2037.75,
        "y": 505.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "b369c83a.de60d8"
            ]
        ]
    },
    {
        "id": "de1e5ed.546bf2",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.l3vpn.pe1_id`\" />\n\n",
        "comments": "",
        "x": 2202.8123779296875,
        "y": 462.6097717285156,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "b369c83a.de60d8",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
        "comments": "",
        "x": 2206.75,
        "y": 506.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "98b87635.4ab2",
        "type": "save",
        "name": "get vpn-binding from aai",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"vpn-binding\"\n\t    key=\"vpn-binding.vpn-id = $tmp.aai.connectivity.relationship-list.relationship[$cridx].relationship-data[0].relationship-value\"\n\t\tlocal-only=\"false\" \n\t\tpfx=\"tmp.aai.vpn-binding\" >\n",
        "comments": "",
        "outputs": 1,
        "x": 2512.75,
        "y": 505.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "133fd3a1.d9493c",
                "1efd7812.84eb68",
                "be58cccd.20957"
            ]
        ]
    },
    {
        "id": "c3829b9e.475158",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 2892.75,
        "y": 593.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "52401003.e54ba8"
            ]
        ]
    },
    {
        "id": "133fd3a1.d9493c",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2723.75,
        "y": 594.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "c3829b9e.475158"
            ]
        ]
    },
    {
        "id": "1efd7812.84eb68",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2726.240966796875,
        "y": 490.32403564453125,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "3a938444.bd8bbc"
            ]
        ]
    },
    {
        "id": "be58cccd.20957",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2721.75,
        "y": 534.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "9589b818.4000b"
            ]
        ]
    },
    {
        "id": "9589b818.4000b",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
        "comments": "",
        "x": 2889.75,
        "y": 534.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "3a938444.bd8bbc",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.l3vpn.pe1_id`\" />\n\n",
        "comments": "",
        "x": 2888.8125,
        "y": 489.6097412109375,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "92d3d22d.c618f8",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for silentFailure='true' index='cridx' start='0' end='`$tmp.aai.connectivity.relationship-list.relationship_length`' >\n\n",
        "comments": "",
        "outputs": 1,
        "x": 2240.75,
        "y": 411.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "7db3ded6.deaf"
            ]
        ]
    },
    {
        "id": "7db3ded6.deaf",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.aai.connectivity.relationship-list.relationship[$cridx].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2445.75,
        "y": 411.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "cfbe6a35.f2fd5"
            ]
        ]
    },
    {
        "id": "cfbe6a35.f2fd5",
        "type": "outcome",
        "name": "vpn-binding",
        "xml": "<outcome value='vpn-binding'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2611.75,
        "y": 411.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "66d97a83.58a794"
            ]
        ]
    },
    {
        "id": "66d97a83.58a794",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 2774.75,
        "y": 411.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "98b87635.4ab2",
                "eec13dad.1221b"
            ]
        ]
    },
    {
        "id": "ae8dd7ac.9cc1d",
        "type": "switchNode",
        "name": "switch vpn-binding has dst-access-ltp",
        "xml": "<switch test='`$tmp.aai.vpn-binding.dst-access-ltp-id`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3333.75,
        "y": 694.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "8935f293.cb1e78",
                "f32e6b37.4758a8"
            ]
        ]
    },
    {
        "id": "8935f293.cb1e78",
        "type": "outcome",
        "name": "Null",
        "xml": "<outcome value=''>\n",
        "comments": "",
        "outputs": 1,
        "x": 3547.75,
        "y": 731.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "394930dc.1bf1c"
            ]
        ]
    },
    {
        "id": "f32e6b37.4758a8",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3549.75,
        "y": 669.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "d8995170.21ddb"
            ]
        ]
    },
    {
        "id": "394930dc.1bf1c",
        "type": "switchNode",
        "name": "switch vpn-binding has src-access-ltp",
        "xml": "<switch test='`$tmp.aai.vpn-binding.src-access-ltp-id`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3127.75,
        "y": 1974.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "2a89d450.3404ec",
                "667fc503.5791f4"
            ]
        ]
    },
    {
        "id": "2a89d450.3404ec",
        "type": "outcome",
        "name": "Null",
        "xml": "<outcome value=''>\n",
        "comments": "",
        "outputs": 1,
        "x": 3380.75,
        "y": 2008.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "566098c5.d0033"
            ]
        ]
    },
    {
        "id": "667fc503.5791f4",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3380.75,
        "y": 1952.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "4eef4aff.e3dcc4"
            ]
        ]
    },
    {
        "id": "566098c5.d0033",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
        "comments": "",
        "x": 3531.75,
        "y": 2008.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "72ddf5d3.8c5f4c",
        "type": "set",
        "name": "set vpn-bindingA and connectivityA",
        "xml": "<set>\n<parameter name='tmp.aai.vpn-bindingA.' value=\"`$tmp.aai.vpn-binding.`\" />\n<parameter name='tmp.aai.connectivityA.' value=\"`$tmp.aai.connectivity.`\" />\n",
        "comments": "",
        "x": 4407.75,
        "y": 106.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "be167b48.23b5b",
        "type": "set",
        "name": "set vpn-bindingB and connectivityB",
        "xml": "<set>\n<parameter name='tmp.aai.vpn-bindingB.' value=\"`$tmp.aai.vpn-binding.`\" />\n<parameter name='tmp.aai.connectivityB.' value=\"`$tmp.aai.connectivity.`\" />\n\n",
        "comments": "",
        "x": 3815.75,
        "y": 1565.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "65804ebf.2b9b08",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 4098.75,
        "y": 363.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "72ddf5d3.8c5f4c",
                "7d98821b.e6839c",
                "d8047beb.a120a",
                "c0003a50.a00b1",
                "d1f1dcb6.1fec3",
                "251b183d.cbc77",
                "c978ce8f.5eb918"
            ]
        ]
    },
    {
        "id": "4eef4aff.e3dcc4",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 3531.75,
        "y": 1951.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "be167b48.23b5b",
                "97981e3f.7665d",
                "ace90237.5528b8",
                "e4aaac37.9b5738",
                "1bef475b.0876b9",
                "8a69ea43.cdd878",
                "bacb99d3.7d15e8"
            ]
        ]
    },
    {
        "id": "8a69ea43.cdd878",
        "type": "set",
        "name": "set sotn_value",
        "xml": "<set>\n<!--<parameter name='eth-service-name' value='`$tmp.aai.connectivityB.connectivity-id`' />-->\n<parameter name='eth-service-name' value='`$tmp.aai.connectivityB.etht-svc-name`' />\n<parameter name='slice-id' value='`$vnf-topology-operation-input.service-information.service-instance-id`' />\n<parameter name='provider-id' value='`$tmp.aai.connectivityB.access-provider-id`' />\n<parameter name='client-id' value='`$tmp.aai.connectivityB.access-client-id`' />\n<parameter name='topology-id' value='`$tmp.aai.connectivityB.access-topology-id`' />\n<parameter name='otn-tunnel-name' value='`$tmp.aai.vpn-bindingB.vpn-name`' />\n<parameter name='ethernet-end-point-name' value='`$tmp.aai.connectivityB.connectivity-id`' />\n<parameter name='index-number' value='0' />\n<parameter name='eth-node-id' value='`$tmp.aai.connectivityB.access-node-id`' />\n<parameter name='eth-node-tp-id' value='`$tmp.aai.connectivityB.access-ltp-id`' />\n<parameter name='CIR' value='`$tmp.aai.vpn-bindingB.route-distinguisher *1000000`' />\n<parameter name='EIR' value='`$tmp.aai.vpn-bindingB.route-distinguisher *1000000`' />\n<parameter name='cvlan' value='`$tmp.aai.connectivityB.cvlan`' />\n\n",
        "comments": "",
        "x": 3760.75,
        "y": 2094.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "bacb99d3.7d15e8",
        "type": "execute",
        "name": "execute RestApiCallNode Create ethernet Service without token",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.ts-ethernet-service.templatefile`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainB.url + '/restconf/data/ietf-eth-tran-service:etht-svc'`\" />\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.restapi.connection-oof-url`\" />-->\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainB.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainB.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"patch\"/>\n<parameter name='dirPath' value=\"/opt/onap/sdnc/restconfapi/yang\" />\n<parameter name=\"responsePrefix\" value=\"vpn-result\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n",
        "comments": "",
        "outputs": 1,
        "x": 3914.75,
        "y": 2142.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "17e90060.f79b78",
                "52bf852c.fdb45c"
            ]
        ]
    },
    {
        "id": "17e90060.f79b78",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4260.25,
        "y": 2123.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "ea0fe23c.016da8"
            ]
        ]
    },
    {
        "id": "52bf852c.fdb45c",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4264.25,
        "y": 2163.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "e4c3d59d.96b0f8"
            ]
        ]
    },
    {
        "id": "ea0fe23c.016da8",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create ethernet service rest api\" />\n",
        "comments": "",
        "x": 4418.25,
        "y": 2123.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "e4c3d59d.96b0f8",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 4421.75,
        "y": 2163.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "22d7dd70.1841ea",
                "3dfc3096.80b288",
                "d67d1410.76b2b8"
            ]
        ]
    },
    {
        "id": "d5f7c980.553e1",
        "type": "comment",
        "name": "TODO: FIXME:",
        "info": "put proper values based on connectivity resource retrieved from AAI",
        "comments": "",
        "x": 3758.25,
        "y": 2050.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "22d7dd70.1841ea",
        "type": "save",
        "name": "update vpn-binding B resource (aka. OTN domainB) in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding' \n      key='vpn-binding.vpn-id = $tmp.aai.vpn-bindingB.vpn-id' >\n<parameter name='vpn-id' value='`$tmp.aai.vpn-bindingB.vpn-id`' />\n<parameter name='vpn-name' value='`$tmp.aai.vpn-bindingB.vpn-name`' />\n\n<parameter name='operational-status' value='Activated' />\n",
        "comments": "",
        "outputs": 1,
        "x": 4761.75,
        "y": 2162.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            []
        ]
    },
    {
        "id": "e6c0853.c278578",
        "type": "comment",
        "name": "TODO: FIXME",
        "info": "use proper vpn-binding id and connectivity\n\nAlso, does CCSDK support \"update\" operation for vpn-binding and connectivity?",
        "comments": "",
        "x": 4619.75,
        "y": 2120.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "3dfc3096.80b288",
        "type": "save",
        "name": "update connectivity resource in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='connectivity' \n      key='connectivity.connectivity-id = $tmp.aai.connectivityB.connectivity-id'>\n<parameter name='connectivity-id' value='`$tmp.aai.connectivityB.connectivity-id`' />\n<parameter name='operational-status' value='Activated' />\n",
        "comments": "",
        "outputs": 1,
        "x": 4690.75,
        "y": 2211.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            []
        ]
    },
    {
        "id": "d6d9459c.52e34",
        "type": "set",
        "name": "set attachment_param (gfp-n) for OTN",
        "xml": "<set>\n<parameter name='gfp-n' value='`$tmp.aai.vpn-binding.route-distinguisher`' />\n",
        "comments": "",
        "x": 3324.75,
        "y": 634.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "eec13dad.1221b",
        "type": "set",
        "name": "unset tmp.aai.vpn-binding",
        "xml": "<set>\n<parameter name='tmp.aai.vpn-binding.' value='' />\n",
        "comments": "",
        "x": 2958.75,
        "y": 282.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "6859175e.358ec8",
        "type": "comment",
        "name": "only dst ttp exists. No src",
        "info": "",
        "comments": "",
        "x": 3919.75,
        "y": 320.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "cf1e5b9b.e9493",
        "type": "comment",
        "name": "only src ttp exists. No dst",
        "info": "",
        "comments": "",
        "x": 3476.75,
        "y": 1898.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "d8995170.21ddb",
        "type": "switchNode",
        "name": "switch vpn-binding has src-access-ltp",
        "xml": "<switch test='`$tmp.aai.vpn-binding.src-access-ltp-id`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3655.75,
        "y": 482.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "f7ea2bd8.a0e408",
                "d911a9d9.6b12a8"
            ]
        ]
    },
    {
        "id": "d911a9d9.6b12a8",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3897.75,
        "y": 1071.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "60ce8d2.37a5f74"
            ]
        ]
    },
    {
        "id": "f7ea2bd8.a0e408",
        "type": "outcome",
        "name": "Null",
        "xml": "<outcome value=''>\n",
        "comments": "",
        "outputs": 1,
        "x": 3891.75,
        "y": 362.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "65804ebf.2b9b08"
            ]
        ]
    },
    {
        "id": "60ce8d2.37a5f74",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 4055.75,
        "y": 1070.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "250c851.82c85fa",
                "3a8c3466.1fa784",
                "44e0a0bb.d00d2",
                "17d8e4eb.b52ccb",
                "dd94b2c2.353ff8"
            ]
        ]
    },
    {
        "id": "3a8c3466.1fa784",
        "type": "set",
        "name": "set attachment_param for OTN G",
        "xml": "<set>\n<parameter name='src-node-id' value='`$tmp.aai.vpn-bindingG.src-access-node-id`' />\n<parameter name='dst-node-id' value='`$tmp.aai.vpn-bindingG.dst-access-node-id`' />\n<!--<parameter name='dst-tpn-id' value='1' />-->\n<parameter name='src-tpn-id' value='`$tmp.aai.vpn-bindingG.customer-vpn-id`' />\n<parameter name='dst-tpn-id' value='`$tmp.aai.vpn-bindingG.customer-vpn-id`' />\n<parameter name='src-ttp-id' value='`$tmp.aai.vpn-bindingG.src-access-ltp-id`' />\n<parameter name='dst-ttp-id' value='`$tmp.aai.vpn-bindingG.dst-access-ltp-id`' />\n<parameter name='slice-instance-id' value='`$tmp.aai.service-instance.service-instance-id`' />\n<parameter name='otn-tunnel-name-domainG' value='`$tmp.aai.vpn-bindingG.vpn-name`' />\n<parameter name='client-id' value='`$tmp.aai.vpn-bindingG.access-client-id`' />\n<parameter name='provider-id' value='`$tmp.aai.vpn-bindingG.access-provider-id`' />\n<parameter name='topology-id' value='`$tmp.aai.vpn-bindingG.access-topology-id`' />\n",
        "comments": "",
        "x": 4319.75,
        "y": 953.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "dd94b2c2.353ff8",
        "type": "execute",
        "name": "execute RestApiCallNode Create OTN tunnel with token",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.ts-otn-domainG-creation.templatefile`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainG.url + '/restconf/data/ietf-te:te'`\" />\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainG.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainG.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"patch\"/>\n<parameter name=\"responsePrefix\" value=\"otn-oof\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n<parameter name='customHttpHeaders' value=\"`'X-ACCESS-TOKEN=' + $prop.sdncRestApi.token_id`\" />",
        "comments": "",
        "outputs": 1,
        "x": 4400.75,
        "y": 1268.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "d78a59cb.d6e7a",
                "667608aa.9739d"
            ]
        ]
    },
    {
        "id": "d78a59cb.d6e7a",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4710.25,
        "y": 1237.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "790b52bf.2108ec"
            ]
        ]
    },
    {
        "id": "667608aa.9739d",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4715.25,
        "y": 1302.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "5fb9f65f.6d5da"
            ]
        ]
    },
    {
        "id": "790b52bf.2108ec",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create OTN tunnel rest api\" />\n",
        "comments": "",
        "x": 4886.25,
        "y": 1237.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "5fb9f65f.6d5da",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 4881.75,
        "y": 1302.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            []
        ]
    },
    {
        "id": "44e0a0bb.d00d2",
        "type": "set",
        "name": "set pnf-name",
        "xml": "<set>\n<parameter name='tmp.domainG.pnf-name' value=\"`'networkId-providerId-' +\n                                                   $tmp.aai.vpn-bindingG.access-provider-id + '-clientId-' +\n                                                   $tmp.aai.vpn-bindingG.access-client-id + '-topologyId-' +\n                                                   $tmp.aai.vpn-bindingG.access-topology-id + '-nodeId-' +\n                                                   $tmp.aai.vpn-bindingG.src-access-node-id`\" />\n",
        "comments": "",
        "x": 4257.75,
        "y": 1001.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "17d8e4eb.b52ccb",
        "type": "get-resource",
        "name": "get-resource src pnf",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"pnf\" \n\t\tkey=\"pnf.pnf-name = $tmp.domainG.pnf-name\"\n        pfx='tmp.aai.domainG-pnf' local-only='false' >\n\n        <!--AND depth = '0'\"-->\n",
        "comments": "",
        "outputs": 1,
        "x": 4283.75,
        "y": 1118.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "a8ae3ef3.33406",
                "fcb06d11.9b839",
                "1567721b.17fbc6"
            ]
        ]
    },
    {
        "id": "a8ae3ef3.33406",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4479.2501220703125,
        "y": 1070.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "dc6575fd.da6538"
            ]
        ]
    },
    {
        "id": "fcb06d11.9b839",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4471.2501220703125,
        "y": 1125.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "9508c711.df3318"
            ]
        ]
    },
    {
        "id": "dc6575fd.da6538",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 4623.6324462890625,
        "y": 1070.4056701660156,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "5887f01d.382f28"
            ]
        ]
    },
    {
        "id": "5887f01d.382f28",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for silentFailure='true' index='spvidx' start='0' end='`$tmp.aai.domainG-pnf.relationship-list.relationship_length`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 4807.75,
        "y": 1068.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "7c993206.50f554"
            ]
        ]
    },
    {
        "id": "7c993206.50f554",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.aai.domainG-pnf.relationship-list.relationship[$spvidx].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5002.75,
        "y": 1068.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "f4906a1c.c87a88"
            ]
        ]
    },
    {
        "id": "1567721b.17fbc6",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4476.2501220703125,
        "y": 1182.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "9c97fc0c.fac84"
            ]
        ]
    },
    {
        "id": "9c97fc0c.fac84",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 4628.2501220703125,
        "y": 1183.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "9508c711.df3318",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 4639.2501220703125,
        "y": 1126.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "250c851.82c85fa",
        "type": "set",
        "name": "set vpn-bindingG and connectivityG",
        "xml": "<set>\n<parameter name='tmp.aai.vpn-bindingG.' value=\"`$tmp.aai.vpn-binding.`\" />\n<parameter name='tmp.aai.connectivityG.' value=\"`$tmp.aai.connectivity.`\" />\n",
        "comments": "",
        "x": 4314.75,
        "y": 893.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "f4906a1c.c87a88",
        "type": "outcome",
        "name": "esr-thirdparty-sdnc",
        "xml": "<outcome value='esr-thirdparty-sdnc'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5205.75,
        "y": 1072.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "f2ceb67e.1c0c"
            ]
        ]
    },
    {
        "id": "d6942a62.437338",
        "type": "execute",
        "name": "get esr-thirdparty-sdnc",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"esr-thirdparty-sdnc\" \n\t\tkey=\"esr-thirdparty-sdnc.thirdparty-sdnc-id = $tmp.domainG.esr-thirdparty-id AND \n\t\t     depth = '1'\"\n        pfx='tmp.aai.domainG.esr-thirdparty-sdnc' local-only='false' >",
        "comments": "",
        "outputs": 1,
        "x": 5590.75,
        "y": 1085.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "2bfb5437.ab1884",
                "14e65a71.083eb6",
                "1ec347c1.300068"
            ]
        ]
    },
    {
        "id": "f2ceb67e.1c0c",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 5384.75,
        "y": 1072.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "e257c8b7.b2bd68",
                "d6942a62.437338"
            ]
        ]
    },
    {
        "id": "e257c8b7.b2bd68",
        "type": "set",
        "name": "set esr-thirdparty-sdnc domainG id",
        "xml": "<set>\n<parameter name='tmp.domainG.esr-thirdparty-id' value=\"`$tmp.aai.domainG-pnf.relationship-list.relationship[$spvidx].relationship-data[0].relationship-value`\" />\n",
        "comments": "",
        "x": 5620.75,
        "y": 1033.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "2bfb5437.ab1884",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5800.75,
        "y": 1076.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "c27aaf5c.aef2b8"
            ]
        ]
    },
    {
        "id": "14e65a71.083eb6",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5792.75,
        "y": 1131.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "d07e83df.f79d38"
            ]
        ]
    },
    {
        "id": "1ec347c1.300068",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5797.75,
        "y": 1188.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "d1674575.d6f7d8"
            ]
        ]
    },
    {
        "id": "d1674575.d6f7d8",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 5949.75,
        "y": 1189.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "d07e83df.f79d38",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 5960.75,
        "y": 1134.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "c27aaf5c.aef2b8",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 5945.13232421875,
        "y": 1074.4056701660156,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "1298a74.3cdd059"
            ]
        ]
    },
    {
        "id": "1298a74.3cdd059",
        "type": "set",
        "name": "set controller domainG data",
        "xml": "<set>\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainG.url' value=\"`$tmp.aai.domainG.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].service-url`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainG.user' value=\"`$tmp.aai.domainG.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].user-name`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainG.password' value=\"`$tmp.aai.domainG.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].password`\" />\n\n\n<!--<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >-->\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/restconf/data/ietf-network:networks'`\" />-->\n<!--<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />-->\n<!--<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />-->\n<!--<parameter name=\"format\" value=\"json\"/>-->\n<!--<parameter name=\"httpMethod\" value=\"get\"/>-->\n<!--<parameter name=\"responsePrefix\" value=\"topology\"/>-->\n<!--<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>-->\n<!--<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>-->\n<!--<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>-->\n<!--<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>-->\n",
        "comments": "",
        "x": 6159.75,
        "y": 1070.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "8ad3b61d.5ba128",
        "type": "comment",
        "name": "both src and dst exist",
        "info": "",
        "comments": "",
        "x": 3933.75,
        "y": 1011.75,
        "z": "30d84baa.6f57bc",
        "wires": []
    },
    {
        "id": "52401003.e54ba8",
        "type": "switchNode",
        "name": "switch vpn-binding is not already Activated (i.e. is either Created or Modified)",
        "xml": "<switch test=\"`$tmp.aai.vpn-binding.operational-status != 'Activated' `\">\n",
        "comments": "",
        "outputs": 1,
        "x": 2495.75,
        "y": 738.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "84b154c7.dcfaf",
                "d81b7512.e15008"
            ]
        ]
    },
    {
        "id": "d81b7512.e15008",
        "type": "outcomeFalse",
        "name": "false",
        "xml": "<outcome value='false'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2902.75,
        "y": 756.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "cf7d3373.5ca978"
            ]
        ]
    },
    {
        "id": "84b154c7.dcfaf",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2902.75,
        "y": 701.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "37e2ea9b.dd967e"
            ]
        ]
    },
    {
        "id": "37e2ea9b.dd967e",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 3058.75,
        "y": 699.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            [
                "d6d9459c.52e34",
                "ae8dd7ac.9cc1d"
            ]
        ]
    },
    {
        "id": "cf7d3373.5ca978",
        "type": "block",
        "name": "block",
        "xml": "<block>",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 3035.75,
        "y": 757.75,
        "z": "30d84baa.6f57bc",
        "wires": [
            []
        ]
    },
    {
        "id": "677bc6cc.c2278",
        "type": "save",
        "name": "update service-instance resource in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='service-instance' \n      key='service-instance.service-instance-id = $vnf-topology-operation-input.service-information.service-instance-id\n         AND customer.global-customer-id = $vnf-topology-operation-input.service-information.global-customer-id \n         AND service-subscription.service-type = $vnf-topology-operation-input.service-information.subscription-service-type'>\n<parameter name='service-instance-id' value='`$tmp.aai.service-instance.service-instance-id`' />\n<parameter name='orchestration-status' value='Activated' />\n",
        "comments": "",
        "outputs": 1,
        "x": 5298.5,
        "y": 810.25,
        "z": "30d84baa.6f57bc",
        "wires": [
            []
        ]
    },
    {
        "id": "d67d1410.76b2b8",
        "type": "save",
        "name": "update service-instance resource in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='service-instance' \n      key='service-instance.service-instance-id = $vnf-topology-operation-input.service-information.service-instance-id\n         AND customer.global-customer-id = $vnf-topology-operation-input.service-information.global-customer-id \n         AND service-subscription.service-type = $vnf-topology-operation-input.service-information.subscription-service-type'>\n<parameter name='service-instance-id' value='`$tmp.aai.service-instance.service-instance-id`' />\n<parameter name='orchestration-status' value='Activated' />\n",
        "comments": "",
        "outputs": 1,
        "x": 4710.25,
        "y": 2278,
        "z": "30d84baa.6f57bc",
        "wires": [
            []
        ]
    }
]