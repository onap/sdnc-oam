[{"id":"b0fd1620.655ca8","type":"dgstart","name":"DGSTART","outputs":1,"x":117.14286041259766,"y":72.41365623474121,"z":"8a262f9.d3b0dd","wires":[["fcf0f4fe.e9bb18"]]},{"id":"fcf0f4fe.e9bb18","type":"service-logic","name":"GENERIC-RESOURCE-API ${project.version}","module":"GENERIC-RESOURCE-API","version":"${project.version}","comments":"","xml":"<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>","outputs":1,"x":230.4285659790039,"y":112.65176773071289,"z":"8a262f9.d3b0dd","wires":[["5737a65.f324958"]]},{"id":"5737a65.f324958","type":"method","name":"method vf-module-topology-operation-changeassign","xml":"<method rpc='vf-module-topology-operation-changeassign' mode='sync'>\n","comments":"","outputs":1,"x":248.5714874267578,"y":152.4136562347412,"z":"8a262f9.d3b0dd","wires":[["4abc51a9.9cd8c"]]},{"id":"61ca3b27.a41de4","type":"comment","name":"vf-module-topology-operation-changeassign","info":"","comments":"","x":511.4877166748047,"y":20,"z":"8a262f9.d3b0dd","wires":[]},{"id":"7dfa083f.7c7818","type":"switchNode","name":"switch request-action","xml":"<switch test='`$vf-module-topology-operation-input.request-information.request-action`'>\n","comments":"","outputs":1,"x":520.6666717529297,"y":251.27079391479492,"z":"8a262f9.d3b0dd","wires":[["c33e4ad4.c0edb8","da84ffdd.6915e"]]},{"id":"c33e4ad4.c0edb8","type":"outcome","name":"CreateVfModuleInstance","xml":"<outcome value='CreateVfModuleInstance'>\n","comments":"","outputs":1,"x":771.7142868041992,"y":228.41368007659912,"z":"8a262f9.d3b0dd","wires":[["3077b832.2ed128"]]},{"id":"da84ffdd.6915e","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":715.380931854248,"y":273.79466915130615,"z":"8a262f9.d3b0dd","wires":[["8fe60c4e.59625"]]},{"id":"3077b832.2ed128","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":961.5714511871338,"y":228.41371154785156,"z":"8a262f9.d3b0dd","wires":[[]]},{"id":"8fe60c4e.59625","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"If svc-action is 'changeassign' then request-action must be 'CreateVfModuleInstance'\" />\n","comments":"","x":980.3809394836426,"y":274.12798166275024,"z":"8a262f9.d3b0dd","wires":[]},{"id":"4abc51a9.9cd8c","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":185.95240783691406,"y":447.41358184814453,"z":"8a262f9.d3b0dd","wires":[["7dfa083f.7c7818","f5c6235a.e5fb2","c7eb83e5.8873e","107d6ef2.21d321","b393522d.ebf8","5127faf1.b10724","a93934ef.4212f8","4009e4a7.3072ac","8b4b59af.488c98"]]},{"id":"c7eb83e5.8873e","type":"switchNode","name":"switch service-data.vnfs.vnf_length","xml":"<switch test='`$service-data.vnfs.vnf_length`'>\n","comments":"","outputs":1,"x":565.476188659668,"y":382.4136209487915,"z":"8a262f9.d3b0dd","wires":[["c2872a88.cea778","5d46a347.9bd9ec"]]},{"id":"c2872a88.cea778","type":"other","name":"NULL","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":806.1904602050781,"y":359.5563611984253,"z":"8a262f9.d3b0dd","wires":[["ac2a3460.e0ea48"]]},{"id":"5d46a347.9bd9ec","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":805.9523010253906,"y":400.50887966156006,"z":"8a262f9.d3b0dd","wires":[["ac71c92d.84f758"]]},{"id":"ac2a3460.e0ea48","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"There are no VNFs defined in MD-SAL\" />\n","comments":"","x":972.8570747375488,"y":358.842116355896,"z":"8a262f9.d3b0dd","wires":[]},{"id":"ac71c92d.84f758","type":"for","name":"for each vnf","xml":"<for index='idx' start='0' end='`$service-data.vnfs.vnf_length`' >\n","comments":"","outputs":1,"x":968.1904449462891,"y":400.175498008728,"z":"8a262f9.d3b0dd","wires":[["a47006.25b19ff8"]]},{"id":"a47006.25b19ff8","type":"switchNode","name":"switch service data vnf == input vnf","xml":"<switch test='`$service-data.vnfs.vnf[$idx].vnf-id == $vf-module-topology-operation-input.vnf-information.vnf-id`'>\n","comments":"","outputs":1,"x":1219.5236625671387,"y":399.8421850204468,"z":"8a262f9.d3b0dd","wires":[["5ce5b7fa.0d1d78"]]},{"id":"5ce5b7fa.0d1d78","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":1449.523754119873,"y":399.17553901672363,"z":"8a262f9.d3b0dd","wires":[["cd0a1d92.dc903"]]},{"id":"f5c6235a.e5fb2","type":"set","name":"set vnf-index to -1","xml":"<set>\n<parameter name='vnf-index' value='-1' />\n","comments":"","x":509.52378845214844,"y":320.50879287719727,"z":"8a262f9.d3b0dd","wires":[]},{"id":"7fe7d854.f89c68","type":"set","name":"set vnf-index to idx","xml":"<set>\n<parameter name='vnf-index' value='`$idx`' />\n","comments":"","x":1771.1903915405273,"y":370.1754970550537,"z":"8a262f9.d3b0dd","wires":[]},{"id":"107d6ef2.21d321","type":"switchNode","name":"switch vnf-index","xml":"<switch test='`$vnf-index`'>\n","comments":"","outputs":1,"x":501.1904716491699,"y":447.1754951477051,"z":"8a262f9.d3b0dd","wires":[["236ee71d.7e03e8"]]},{"id":"236ee71d.7e03e8","type":"outcome","name":"-1","xml":"<outcome value='-1'>\n","comments":"","outputs":1,"x":679.5238571166992,"y":446.5088710784912,"z":"8a262f9.d3b0dd","wires":[["b4969d42.1ba18"]]},{"id":"b4969d42.1ba18","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unable to find VNF ID ' + $vf-module-topology-operation-input.vnf-information.vnf-id + ' in MD-SAL'`\" />\n","comments":"","x":839.5237655639648,"y":445.8421745300293,"z":"8a262f9.d3b0dd","wires":[]},{"id":"cd0a1d92.dc903","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1597.8572158813477,"y":398.0952377319336,"z":"8a262f9.d3b0dd","wires":[["7fe7d854.f89c68","b2e87734.818bf8"]]},{"id":"b2e87734.818bf8","type":"break","name":"break","xml":"<break>\n","comments":"","x":1732.8571815490723,"y":419.7618236541748,"z":"8a262f9.d3b0dd","wires":[]},{"id":"5127faf1.b10724","type":"switchNode","name":"switch service-data...vf-module_length","xml":"<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length`'>\n","comments":"","outputs":1,"x":573.8095016479492,"y":545.746992111206,"z":"8a262f9.d3b0dd","wires":[["238393a.e361b6c","84f2544f.9fa598"]]},{"id":"238393a.e361b6c","type":"other","name":"NULL","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":824.523811340332,"y":524.5563955307007,"z":"8a262f9.d3b0dd","wires":[["b17a37a3.5da6a8"]]},{"id":"84f2544f.9fa598","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":824.2856521606445,"y":565.5089139938354,"z":"8a262f9.d3b0dd","wires":[["48eb0930.e76c88"]]},{"id":"b17a37a3.5da6a8","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'There are no VF modules defined in MD-SAL for VNF ' + $vf-module-topology-operation-input.vnf-information.vnf-id`\" />\n","comments":"","x":991.1904258728027,"y":523.8421506881714,"z":"8a262f9.d3b0dd","wires":[]},{"id":"48eb0930.e76c88","type":"for","name":"for each vf-module","xml":"<for index='idx' start='0' end='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length`' >\n","comments":"","outputs":1,"x":986.523796081543,"y":565.1755323410034,"z":"8a262f9.d3b0dd","wires":[["a7ccbbe5.35ea78"]]},{"id":"a7ccbbe5.35ea78","type":"switchNode","name":"switch service data vf-module == input vf-module","xml":"<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$idx].vf-module-id == $vf-module-topology-operation-input.vf-module-information.vf-module-id`'>\n","comments":"","outputs":1,"x":1292.8569564819336,"y":564.8422679901123,"z":"8a262f9.d3b0dd","wires":[["2eb4d955.2cf836"]]},{"id":"2eb4d955.2cf836","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":1562.8570098876953,"y":562.5088729858398,"z":"8a262f9.d3b0dd","wires":[["5d682e3b.dc58e"]]},{"id":"b393522d.ebf8","type":"set","name":"set vf-module-index to -1","xml":"<set>\n<parameter name='vf-module-index' value='-1' />\n","comments":"","x":529.5237731933594,"y":495.5088310241699,"z":"8a262f9.d3b0dd","wires":[]},{"id":"f40c30e1.61b41","type":"set","name":"set vf-module-index to idx","xml":"<set>\n<parameter name='vf-module-index' value='`$idx`' />\n","comments":"","x":1892.8571014404297,"y":533.5088520050049,"z":"8a262f9.d3b0dd","wires":[]},{"id":"a93934ef.4212f8","type":"switchNode","name":"switch vf-module-index","xml":"<switch test='`$vf-module-index`'>\n","comments":"","outputs":1,"x":526.1904754638672,"y":613.8422508239746,"z":"8a262f9.d3b0dd","wires":[["4fd6152b.16dabc"]]},{"id":"4fd6152b.16dabc","type":"outcome","name":"-1","xml":"<outcome value='-1'>\n","comments":"","outputs":1,"x":704.5238609313965,"y":613.1756267547607,"z":"8a262f9.d3b0dd","wires":[["cc9a90b4.f6dbb"]]},{"id":"cc9a90b4.f6dbb","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unable to find VF module ID ' + $vf-module-topology-operation-input.vf-module-information.vf-module-id + ' in MD-SAL'`\" />\n","comments":"","x":864.5237693786621,"y":612.5089302062988,"z":"8a262f9.d3b0dd","wires":[]},{"id":"5d682e3b.dc58e","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1696.1905517578125,"y":561.4286127090454,"z":"8a262f9.d3b0dd","wires":[["f40c30e1.61b41","d486457b.03c4f8"]]},{"id":"d486457b.03c4f8","type":"break","name":"break","xml":"<break>\n","comments":"","x":1831.190517425537,"y":583.0951986312866,"z":"8a262f9.d3b0dd","wires":[]},{"id":"a0333722.8ea4a8","type":"set","name":"set order-status to Created","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-level-oper-status.order-status'\n  value='Created' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-level-oper-status.last-rpc-action'\n  value='`$vf-module-topology-operation-input.sdnc-request-header.svc-action`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-level-oper-status.last-action'\n  value='`$vf-module-topology-operation-input.sdnc-request-header.request-action`' />\n","comments":"","x":1190.6191673278809,"y":1242.2947263717651,"z":"8a262f9.d3b0dd","wires":[]},{"id":"ecc4c033.4934b","type":"switchNode","name":"switch order-status","xml":"<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-level-oper-status.order-status`'>\n","comments":"","outputs":1,"x":1161.2857513427734,"y":940.4613428115845,"z":"8a262f9.d3b0dd","wires":[["18af91b1.b4607e","c6e4455a.385a08"]]},{"id":"18af91b1.b4607e","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":1339.285846710205,"y":959.1756715774536,"z":"8a262f9.d3b0dd","wires":[["4b7e6c1f.d39d34"]]},{"id":"77862466.1fd07c","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1510.476303100586,"y":911.4614152908325,"z":"8a262f9.d3b0dd","wires":[[]]},{"id":"4b7e6c1f.d39d34","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Order status is ' + $service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-level-oper-status.order-status + ' instead of PendingDelete'`\" />\n","comments":"","x":1524.9525032043457,"y":959.1757125854492,"z":"8a262f9.d3b0dd","wires":[]},{"id":"e2290aa1.d8ade8","type":"set","name":"copy ONAP model information","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-information.onap-model-information.'\n   value='$vf-module-topology-operation-input.vf-module-information.onap-model-information.' />\n\n","comments":"","x":1201.285789489746,"y":1195.628098487854,"z":"8a262f9.d3b0dd","wires":[]},{"id":"5e9cf84d.a657c8","type":"returnSuccess","name":"return success","xml":"<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n","comments":"","x":1150.6190757751465,"y":1290.6280221939087,"z":"8a262f9.d3b0dd","wires":[]},{"id":"c6e4455a.385a08","type":"outcome","name":"PendingDelete","xml":"<outcome value='PendingDelete'>\n","comments":"","outputs":1,"x":1363.9524765014648,"y":910.7143249511719,"z":"8a262f9.d3b0dd","wires":[["77862466.1fd07c"]]},{"id":"b15e0f26.9f255","type":"get-resource","name":"get-resource VF_MODULE_MODEL","xml":"<get-resource plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource' resource='SQL'\n  key='SELECT * from VF_MODULE_MODEL WHERE customization_uuid = $vf-module-topology-operation-input.vf-module-information.onap-model-information.model-customization-uuid'\n  pfx='db.vf-module-model'>\n\n","comments":"","outputs":1,"x":1219.9524765014648,"y":1128.9613523483276,"z":"8a262f9.d3b0dd","wires":[["cb0b3c5c.5f7e1","b17682d4.5ebac"]]},{"id":"31afce54.dcccd2","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'No model found for VF module customization UUID ' + $vf-module-topology-operation-input.vf-module-information.onap-model-information.model-customization-uuid`\" />\n","comments":"","x":1665.3808975219727,"y":1153.3898248672485,"z":"8a262f9.d3b0dd","wires":[]},{"id":"cb0b3c5c.5f7e1","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1489.738166809082,"y":1109.3421831130981,"z":"8a262f9.d3b0dd","wires":[["369bc4d.584033c"]]},{"id":"b17682d4.5ebac","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":1498.3095970153809,"y":1153.627896308899,"z":"8a262f9.d3b0dd","wires":[["31afce54.dcccd2"]]},{"id":"369bc4d.584033c","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error reading VF_MODULE_MODEL table\" />\n","comments":"","x":1664.7380981445312,"y":1108.485083580017,"z":"8a262f9.d3b0dd","wires":[]},{"id":"a08b9f60.bbfe9","type":"comment","name":"check removed with US622450","info":"","comments":"","x":1123.0000839233398,"y":901.4286489486694,"z":"8a262f9.d3b0dd","wires":[]},{"id":"d5239776.31c288","type":"call","name":"call self-serve-vfmodule-changeassign","xml":"<call module='GENERIC-RESOURCE-API' rpc='self-serve-vfmodule-changeassign' mode='sync' >\n","comments":"","outputs":1,"x":991.0713653564453,"y":779.3214492797852,"z":"8a262f9.d3b0dd","wires":[["bbd3a989.474468","59a233fe.2e88dc"]]},{"id":"bbd3a989.474468","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1240.8213500976562,"y":779.5714378356934,"z":"8a262f9.d3b0dd","wires":[["687f4b0d.09ec54"]]},{"id":"687f4b0d.09ec54","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n<parameter name='error-code' value='500' />\n<parameter name='error-message' value=\"`'Encountered error performing changeassign for self-serve vf-module resources with error: '+ $error-message`\" />\n","comments":"","x":1400.3927764892578,"y":779.2143325805664,"z":"8a262f9.d3b0dd","wires":[]},{"id":"cfae1886.258a38","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":931.5715560913086,"y":1129.4287605285645,"z":"8a262f9.d3b0dd","wires":[["b15e0f26.9f255","e2290aa1.d8ade8","a0333722.8ea4a8","5e9cf84d.a657c8","cd0f22a5.dc021"]]},{"id":"59a233fe.2e88dc","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":1247.1428031921387,"y":823.4285106658936,"z":"8a262f9.d3b0dd","wires":[["7b0941d7.b782a"]]},{"id":"7b0941d7.b782a","type":"returnSuccess","name":"return success","xml":"<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n","comments":"","x":1404.285789489746,"y":823.428524017334,"z":"8a262f9.d3b0dd","wires":[]},{"id":"cd0f22a5.dc021","type":"switchNode","name":"switch model-customization-id","xml":"<switch test='`$vf-module-topology-operation-input.vf-module-information.onap-model-information.model-customization-uuid`'>\n","comments":"","outputs":1,"x":1200.1428909301758,"y":1064.7351522445679,"z":"8a262f9.d3b0dd","wires":[["cfea71c0.e656b"]]},{"id":"cfea71c0.e656b","type":"outcome","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":1405.1428909301758,"y":1064.7351350784302,"z":"8a262f9.d3b0dd","wires":[["8536c8b7.3c5328"]]},{"id":"8536c8b7.3c5328","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"vf-module-information.onap-model-information.model-customization-uuid is a required input\" />\n","comments":"","x":1556.5714569091797,"y":1064.7351331710815,"z":"8a262f9.d3b0dd","wires":[]},{"id":"8600ce57.b79a7","type":"comment","name":"model-customization-uuid validation moved from validate-vnf-input DG","info":"","comments":"","x":1218.8928909301758,"y":1027.2351388931274,"z":"8a262f9.d3b0dd","wires":[]},{"id":"6520c566.a6984c","type":"comment","name":"SELF-SERVE FORK","info":"","comments":"","x":811.428581237793,"y":735.7142686843872,"z":"8a262f9.d3b0dd","wires":[]},{"id":"4009e4a7.3072ac","type":"call","name":"call self-serve-vf-module-forking-logic","xml":"<call module='GENERIC-RESOURCE-API' rpc='self-serve-vf-module-forking-logic' mode='sync' >\n","comments":"","outputs":1,"x":570.4443664550781,"y":675.5361385345459,"z":"8a262f9.d3b0dd","wires":[[]]},{"id":"8b4b59af.488c98","type":"switchNode","name":"switch ss.self-serve-flag","xml":"<switch test=\"`$ss.self-serve-flag`\">\n","comments":"","outputs":1,"x":527.1585235595703,"y":948.2504901885986,"z":"8a262f9.d3b0dd","wires":[["c383fd19.54e6f","99f7c2d8.5c5fc"]]},{"id":"c383fd19.54e6f","type":"outcomeFalse","name":"false","xml":"<outcome value='false'>\n","comments":"","outputs":1,"x":750.1584587097168,"y":1129.1071338653564,"z":"8a262f9.d3b0dd","wires":[["cfae1886.258a38"]]},{"id":"99f7c2d8.5c5fc","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":749.8727569580078,"y":778.9647436141968,"z":"8a262f9.d3b0dd","wires":[["d5239776.31c288"]]}]