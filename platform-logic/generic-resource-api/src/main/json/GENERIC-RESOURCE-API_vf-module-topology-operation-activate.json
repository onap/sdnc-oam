[{"id":"337d138c.bd860c","type":"dgstart","name":"DGSTART","outputs":1,"x":166,"y":99,"z":"7e26ba33.ff379c","wires":[["7b7d5045.e3ed88"]]},{"id":"7b7d5045.e3ed88","type":"service-logic","name":"GENERIC-RESOURCE-API 1.2.0-SNAPSHOT-111501","module":"GENERIC-RESOURCE-API","version":"${project.version}","comments":"","xml":"<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>","outputs":1,"x":241.28570556640625,"y":139.23811149597168,"z":"7e26ba33.ff379c","wires":[["178cbe76.e405c2"]]},{"id":"178cbe76.e405c2","type":"method","name":"method vf-module-topology-operation-activate","xml":"<method rpc='vf-module-topology-operation-activate' mode='sync'>\n","comments":"","outputs":1,"x":279.42862701416016,"y":179,"z":"7e26ba33.ff379c","wires":[["7ad84d5.ddd54b4"]]},{"id":"2e05fce6.b7077c","type":"comment","name":"vf-module-topology-operation-activate","info":"","comments":"","x":560.344856262207,"y":46.58634376525879,"z":"7e26ba33.ff379c","wires":[]},{"id":"6b11f375.d6b234","type":"switchNode","name":"switch request-action","xml":"<switch test='`$vf-module-topology-operation-input.request-information.request-action`'>\n","comments":"","outputs":1,"x":569.523811340332,"y":277.8571376800537,"z":"7e26ba33.ff379c","wires":[["ca864a3c.b57fa","a22ccbdf.71d6a8"]]},{"id":"ca864a3c.b57fa","type":"outcome","name":"CreateVfModuleInstance","xml":"<outcome value='CreateVfModuleInstance'>\n","comments":"","outputs":1,"x":820.5714263916016,"y":255.0000238418579,"z":"7e26ba33.ff379c","wires":[["b8d4475b.7c9c78"]]},{"id":"a22ccbdf.71d6a8","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":764.2380714416504,"y":300.38101291656494,"z":"7e26ba33.ff379c","wires":[["8a848662.fa6a9"]]},{"id":"b8d4475b.7c9c78","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1010.4285907745361,"y":255.00005531311035,"z":"7e26ba33.ff379c","wires":[[]]},{"id":"8a848662.fa6a9","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"If svc-action is 'activate' then request-action must be 'CreateVfModuleInstance'\" />\n","comments":"","x":1029.238079071045,"y":300.71432542800903,"z":"7e26ba33.ff379c","wires":[]},{"id":"7ad84d5.ddd54b4","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":211,"y":507.3332939147949,"z":"7e26ba33.ff379c","wires":[["6b11f375.d6b234","d6c00bee.05efe","37854dca.8b64e2","8069dd5e.a773","9ac48f31.d8d8a","9bfbdc79.ba427","a5b5375e.7ca088","27a9f73b.62e578","5d4969ce.bde85","f2bcbc68.9397a8","e4c92740.69477","b157a1e5.10b48","faa9a227.378dd8"]]},{"id":"37854dca.8b64e2","type":"switchNode","name":"switch service-data.vnfs.vnf_length","xml":"<switch test='`$service-data.vnfs.vnf_length`'>\n","comments":"","outputs":1,"x":614.3333282470703,"y":408.9999647140503,"z":"7e26ba33.ff379c","wires":[["693320f.d842b6","dd19916f.8aa7f8"]]},{"id":"693320f.d842b6","type":"other","name":"NULL","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":855.0475997924805,"y":386.1427049636841,"z":"7e26ba33.ff379c","wires":[["abc4990a.3038e8"]]},{"id":"dd19916f.8aa7f8","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":854.809440612793,"y":427.09522342681885,"z":"7e26ba33.ff379c","wires":[["7703b9f5.05d37"]]},{"id":"abc4990a.3038e8","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"There are no VNFs defined in MD-SAL\" />\n","comments":"","x":1021.7142143249512,"y":385.4284601211548,"z":"7e26ba33.ff379c","wires":[]},{"id":"7703b9f5.05d37","type":"for","name":"for each vnf","xml":"<for index='idx' start='0' end='`$service-data.vnfs.vnf_length`' >\n","comments":"","outputs":1,"x":1017.0475845336914,"y":426.7618417739868,"z":"7e26ba33.ff379c","wires":[["bb13990c.e8c7d8"]]},{"id":"bb13990c.e8c7d8","type":"switchNode","name":"switch service data vnf == input vnf","xml":"<switch test='`$service-data.vnfs.vnf[$idx].vnf-id == $vf-module-topology-operation-input.vnf-information.vnf-id`'>\n","comments":"","outputs":1,"x":1268.380802154541,"y":426.42852878570557,"z":"7e26ba33.ff379c","wires":[["8d584be.6c77938"]]},{"id":"8d584be.6c77938","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":1498.3808937072754,"y":425.7618827819824,"z":"7e26ba33.ff379c","wires":[["f961b167.86d35"]]},{"id":"d6c00bee.05efe","type":"set","name":"set vnf-index to -1","xml":"<set>\n<parameter name='vnf-index' value='-1' />\n","comments":"","x":558.3809280395508,"y":347.09513664245605,"z":"7e26ba33.ff379c","wires":[]},{"id":"5eaf36e7.03dd48","type":"set","name":"set vnf-index to idx","xml":"<set>\n<parameter name='vnf-index' value='`$idx`' />\n","comments":"","x":1820.0475311279297,"y":396.7618408203125,"z":"7e26ba33.ff379c","wires":[]},{"id":"8069dd5e.a773","type":"switchNode","name":"switch vnf-index","xml":"<switch test='`$vnf-index`'>\n","comments":"","outputs":1,"x":550.0476112365723,"y":473.76183891296387,"z":"7e26ba33.ff379c","wires":[["97809a7e.5cef68"]]},{"id":"97809a7e.5cef68","type":"outcome","name":"-1","xml":"<outcome value='-1'>\n","comments":"","outputs":1,"x":728.3809967041016,"y":473.09521484375,"z":"7e26ba33.ff379c","wires":[["882723bc.f6eff8"]]},{"id":"882723bc.f6eff8","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unable to find VNF ID ' + $vf-module-topology-operation-input.vnf-information.vnf-id + ' in MD-SAL'`\" />\n","comments":"","x":888.3809051513672,"y":472.4285182952881,"z":"7e26ba33.ff379c","wires":[]},{"id":"f961b167.86d35","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1646.71435546875,"y":424.6815814971924,"z":"7e26ba33.ff379c","wires":[["5eaf36e7.03dd48","9372e5fd.7dc6b8"]]},{"id":"9372e5fd.7dc6b8","type":"break","name":"break","xml":"<break>","comments":"","x":1781.7143211364746,"y":446.3481674194336,"z":"7e26ba33.ff379c","wires":[]},{"id":"9bfbdc79.ba427","type":"switchNode","name":"switch service-data...vf-module_length","xml":"<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length`'>\n","comments":"","outputs":1,"x":622.6666412353516,"y":572.3333358764648,"z":"7e26ba33.ff379c","wires":[["d4d11e13.e0c678","85fe63da.7c39c"]]},{"id":"d4d11e13.e0c678","type":"other","name":"NULL","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":873.3809509277344,"y":551.1427392959595,"z":"7e26ba33.ff379c","wires":[["93aecdbc.eb0c1"]]},{"id":"85fe63da.7c39c","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":873.1427917480469,"y":592.0952577590942,"z":"7e26ba33.ff379c","wires":[["57f3d70.e3377a8"]]},{"id":"93aecdbc.eb0c1","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'There are no VF modules defined in MD-SAL for VNF ' + $vf-module-topology-operation-input.vnf-information.vnf-id`\" />\n","comments":"","x":1040.047565460205,"y":550.4284944534302,"z":"7e26ba33.ff379c","wires":[]},{"id":"57f3d70.e3377a8","type":"for","name":"for each vf-module","xml":"<for index='idx' start='0' end='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length`' >\n","comments":"","outputs":1,"x":1035.3809356689453,"y":591.7618761062622,"z":"7e26ba33.ff379c","wires":[["8a98ccde.879228"]]},{"id":"8a98ccde.879228","type":"switchNode","name":"switch service data vf-module == input vf-module","xml":"<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$idx].vf-module-id == $vf-module-topology-operation-input.vf-module-information.vf-module-id`'>\n","comments":"","outputs":1,"x":1341.714096069336,"y":591.4286117553711,"z":"7e26ba33.ff379c","wires":[["b6208171.261ee8"]]},{"id":"b6208171.261ee8","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":1611.7141494750977,"y":589.0952167510986,"z":"7e26ba33.ff379c","wires":[["b1bfd4cc.bb437"]]},{"id":"9ac48f31.d8d8a","type":"set","name":"set vf-module-index to -1","xml":"<set>\n<parameter name='vf-module-index' value='-1' />\n","comments":"","x":578.3809127807617,"y":522.0951747894287,"z":"7e26ba33.ff379c","wires":[]},{"id":"5f437518.a679ec","type":"set","name":"set vf-module-index to idx","xml":"<set>\n<parameter name='vf-module-index' value='`$idx`' />\n","comments":"","x":1941.714241027832,"y":560.0951957702637,"z":"7e26ba33.ff379c","wires":[]},{"id":"a5b5375e.7ca088","type":"switchNode","name":"switch vf-module-index","xml":"<switch test='`$vf-module-index`'>\n","comments":"","outputs":1,"x":575.0476150512695,"y":640.4285945892334,"z":"7e26ba33.ff379c","wires":[["6f538373.910014"]]},{"id":"6f538373.910014","type":"outcome","name":"-1","xml":"<outcome value='-1'>\n","comments":"","outputs":1,"x":753.3810005187988,"y":639.7619705200195,"z":"7e26ba33.ff379c","wires":[["58a4ffbb.fc124"]]},{"id":"58a4ffbb.fc124","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unable to find VF module ID ' + $vf-module-topology-operation-input.vf-module-information.vf-module-id + ' in MD-SAL'`\" />\n","comments":"","x":913.3809089660645,"y":639.0952739715576,"z":"7e26ba33.ff379c","wires":[]},{"id":"b1bfd4cc.bb437","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1745.0476913452148,"y":588.0149564743042,"z":"7e26ba33.ff379c","wires":[["5f437518.a679ec","36b227aa.e3d698"]]},{"id":"36b227aa.e3d698","type":"break","name":"break","xml":"<break>","comments":"","x":1880.0476570129395,"y":609.6815423965454,"z":"7e26ba33.ff379c","wires":[]},{"id":"27a9f73b.62e578","type":"set","name":"set order-status to Created","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-level-oper-status.order-status'\n  value='Created' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-level-oper-status.last-rpc-action'\n  value='`$vf-module-topology-operation-input.sdnc-request-header.svc-action`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-level-oper-status.last-action'\n  value='`$vf-module-topology-operation-input.sdnc-request-header.request-action`' />\n","comments":"","x":592.6667327880859,"y":959.0000171661377,"z":"7e26ba33.ff379c","wires":[]},{"id":"5d4969ce.bde85","type":"switchNode","name":"switch order-status","xml":"<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-level-oper-status.order-status`'>\n","comments":"","outputs":1,"x":565.9999618530273,"y":709.6666564941406,"z":"7e26ba33.ff379c","wires":[["987121c8.0c1a68","530de7f8.44cb6"]]},{"id":"987121c8.0c1a68","type":"outcome","name":"PendingCreate","xml":"<outcome value='PendingCreate'>\n","comments":"","outputs":1,"x":777.6667060852051,"y":687.9999809265137,"z":"7e26ba33.ff379c","wires":[["a84ca6b5.da3d88"]]},{"id":"530de7f8.44cb6","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":754.6666946411133,"y":733.380952835083,"z":"7e26ba33.ff379c","wires":[["effec6ed.0edc7"]]},{"id":"a84ca6b5.da3d88","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":932.5238418579102,"y":687.3333835601807,"z":"7e26ba33.ff379c","wires":[[]]},{"id":"effec6ed.0edc7","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Order status is ' + $service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-level-oper-status.order-status + ' instead of PendingCreate'`\" />\n","comments":"","x":951.9999923706055,"y":733.3810129165649,"z":"7e26ba33.ff379c","wires":[]},{"id":"f2bcbc68.9397a8","type":"set","name":"copy input data","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.sdnc-request-header.'\n   value='$vf-module-topology-operation-input.sdnc-request-header.' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.request-information.'\n   value='$vf-module-topology-operation-input.request-information.' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.service-information.'\n   value='$vf-module-topology-operation-input.service-information.' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vnf-information.'\n   value='$vf-module-topology-operation-input.vnf-information.' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-information.'\n   value='$vf-module-topology-operation-input.vf-module-information.' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-request-input.'\n   value='$vf-module-topology-operation-input.vf-module-request-input.' />\n<parameter name=\"service-object-path\" \n   value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'+$vf-module-operation-input.service-information.service-instance-id+'/service-data/service-topology/'`\" />\n\n","comments":"","x":557.6666717529297,"y":910.6666622161865,"z":"7e26ba33.ff379c","wires":[]},{"id":"e4c92740.69477","type":"save","name":"update vf-module to Active","xml":"<update plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\"\n   resource=\"vf-module\"\n   key=\"vf-module.vf-module-id = $service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-id\n      AND generic-vnf.vnf-id = $service-data.vnfs.vnf[$vnf-index].vnf-id\"\n   force=\"true\" pfx=\"tmp.AnAI-data\">\n<parameter name=\"orchestration-status\" value=\"Active\" />\n","comments":"","outputs":1,"x":590.9999389648438,"y":797.3332824707031,"z":"7e26ba33.ff379c","wires":[["d96a2015.ffda68","403061ad.d84698"]]},{"id":"dca667f3.845448","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'No vf-module found in AAI for vf module ID ' + $service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-id`\" />\n","comments":"","x":987.6666984558105,"y":820.666651725769,"z":"7e26ba33.ff379c","wires":[]},{"id":"d96a2015.ffda68","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":800.3572654724121,"y":777.6191215515137,"z":"7e26ba33.ff379c","wires":[["71186405.23183c"]]},{"id":"403061ad.d84698","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":808.9286956787109,"y":821.9048347473145,"z":"7e26ba33.ff379c","wires":[["dca667f3.845448"]]},{"id":"71186405.23183c","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating vf-module in AAI\" />\n","comments":"","x":990.357292175293,"y":777.4288568496704,"z":"7e26ba33.ff379c","wires":[]},{"id":"b157a1e5.10b48","type":"update","name":"Update EIPAM_IP_ASSIGNMENTS to ACTIVE","xml":"<update resource='SQL' force='true' plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource' \n  key='UPDATE EIPAM_IP_ASSIGNMENTS SET status = \"ACTIVE\" WHERE info = $service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-id'>\n","comments":"","outputs":1,"x":654.3333282470703,"y":867.333306312561,"z":"7e26ba33.ff379c","wires":[["418bbe55.d0411"]]},{"id":"418bbe55.d0411","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":921,"y":865.6666460037231,"z":"7e26ba33.ff379c","wires":[["a192004d.9936d"]]},{"id":"a192004d.9936d","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating EIPAM_IP_ASSIGNMENTS table\" />\n","comments":"","x":1071,"y":863.9999589920044,"z":"7e26ba33.ff379c","wires":[]},{"id":"faa9a227.378dd8","type":"returnSuccess","name":"return success","xml":"<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n","comments":"","x":552.6666412353516,"y":1007.3333129882812,"z":"7e26ba33.ff379c","wires":[]}]