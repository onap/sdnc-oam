[
  {
    "id": "827d7697.e161a8",
    "type": "dgstart",
    "name": "DGSTART",
    "outputs": 1,
    "x": 93,
    "y": 84,
    "z": "2b9e11cc.456d3e",
    "wires": [
      [
        "6fb89758.08cae8"
      ]
    ]
  },
  {
    "id": "6fb89758.08cae8",
    "type": "service-logic",
    "name": "GENERIC-RESOURCE-API ${project.version}",
    "module": "GENERIC-RESOURCE-API",
    "version": "${project.version}",
    "comments": "",
    "xml": "<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>",
    "outputs": 1,
    "x": 305.00000381469727,
    "y": 156.0000171661377,
    "z": "2b9e11cc.456d3e",
    "wires": [
      [
        "c0e8cad3.da0c8"
      ]
    ]
  },
  {
    "id": "c0e8cad3.da0c8",
    "type": "method",
    "name": "method network-topology-operation-delete",
    "xml": "<method rpc='network-topology-operation-delete' mode='sync'>\n",
    "comments": "",
    "outputs": 1,
    "x": 293.0001220703125,
    "y": 244,
    "z": "2b9e11cc.456d3e",
    "wires": [
      [
        "a6f45139.fa877"
      ]
    ]
  },
  {
    "id": "a6f45139.fa877",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 569.0000305175781,
    "y": 252.00001335144043,
    "z": "2b9e11cc.456d3e",
    "wires": [
      [
        "30175b96.175abc",
        "ecfd60c5.b2e578",
        "cfff2d7f.0d80f8",
        "dc355ee1.94a83",
        "6101a41d.088144",
        "d633fa40.e632f",
        "c7fcf65d.3267e",
        "a8af32f0.52f9a"
      ]
    ]
  },
  {
    "id": "30175b96.175abc",
    "type": "call",
    "name": "call GENERIC-RESOURCE-API:validate-network-input-parameters",
    "xml": "<call module='GENERIC-RESOURCE-API' rpc='validate-network-input-parameters' mode='sync' >\n",
    "comments": "",
    "outputs": 1,
    "x": 890,
    "y": 35,
    "z": "2b9e11cc.456d3e",
    "wires": [
      []
    ]
  },
  {
    "id": "ecfd60c5.b2e578",
    "type": "get-resource",
    "name": "get-resource esr-thirdparty-sdnc",
    "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"esr-thirdparty-sdnc\" \n\t\tkey=\"esr-thirdparty-sdnc.thirdparty-sdnc-id = $tmp.thirdparty-sdnc-id AND \n\t\t     depth = '1'\"\n        pfx='tmp.aai.esr-thirdparty-sdnc' local-only='false' >\n\n",
    "comments": "",
    "outputs": 1,
    "x": 847,
    "y": 378,
    "z": "2b9e11cc.456d3e",
    "wires": [
      [
        "f7a8fca4.b3ad",
        "aa0ec94f.00fa6",
        "1ecf0d2.4909473"
      ]
    ]
  },
  {
    "id": "f7a8fca4.b3ad",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1163,
    "y": 322,
    "z": "2b9e11cc.456d3e",
    "wires": [
      [
        "f83a9763.b4b58"
      ]
    ]
  },
  {
    "id": "aa0ec94f.00fa6",
    "type": "not-found",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1166.490966796875,
    "y": 369.57403564453125,
    "z": "2b9e11cc.456d3e",
    "wires": [
      [
        "b04696c4.58fe88"
      ]
    ]
  },
  {
    "id": "1ecf0d2.4909473",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1161.823974609375,
    "y": 410.9073486328125,
    "z": "2b9e11cc.456d3e",
    "wires": [
      [
        "479ab3c0.7b5764"
      ]
    ]
  },
  {
    "id": "b04696c4.58fe88",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Network model is_bound_to_vpn=true but no vpn_binding is present\" />\n\n",
    "comments": "",
    "x": 1343.0623779296875,
    "y": 357.8597717285156,
    "z": "2b9e11cc.456d3e",
    "wires": []
  },
  {
    "id": "479ab3c0.7b5764",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Unexpected error retrieving vpn binding\" />\n\n",
    "comments": "",
    "x": 1349.5965309143066,
    "y": 406.3465414047241,
    "z": "2b9e11cc.456d3e",
    "wires": []
  },
  {
    "id": "f83a9763.b4b58",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 1341.205322265625,
    "y": 314.57403564453125,
    "z": "2b9e11cc.456d3e",
    "wires": [
      []
    ]
  },
  {
    "id": "cfff2d7f.0d80f8",
    "type": "for",
    "name": "for each network-input-parameters",
    "xml": "<for index='idx' start='0' end='`$service-data.networks.network[$tmp.nidx].network-data.network-request-input.network-input-parameters.param_length`' >\n",
    "comments": "",
    "outputs": 1,
    "x": 852,
    "y": 213,
    "z": "2b9e11cc.456d3e",
    "wires": [
      [
        "8482cde8.2496f8"
      ]
    ]
  },
  {
    "id": "8482cde8.2496f8",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1133.8333740234375,
    "y": 191.33334350585938,
    "z": "2b9e11cc.456d3e",
    "wires": [
      [
        "f44089bc.f2b86",
        "bd431753.a4c8f"
      ]
    ]
  },
  {
    "id": "f44089bc.f2b86",
    "type": "switchNode",
    "name": "switch name",
    "xml": "<switch test=\"`$service-data.networks.network[$tmp.nidx].network-data.network-request-input.network-input-parameters.param[$idx].name == 'name'`\">\n",
    "comments": "",
    "outputs": 1,
    "x": 1342,
    "y": 152,
    "z": "2b9e11cc.456d3e",
    "wires": [
      [
        "a1e5b819.cd782"
      ]
    ]
  },
  {
    "id": "a1e5b819.cd782",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1529,
    "y": 152,
    "z": "2b9e11cc.456d3e",
    "wires": [
      [
        "8d993f14.d7c67"
      ]
    ]
  },
  {
    "id": "8d993f14.d7c67",
    "type": "set",
    "name": "set name",
    "xml": "<set>\n<parameter name='prop.l3vpn.name' value='`$service-data.networks.network[$tmp.nidx].network-data.network-request-input.network-input-parameters.param[$idx].value`' />\n",
    "comments": "",
    "x": 1697,
    "y": 152.60000610351562,
    "z": "2b9e11cc.456d3e",
    "wires": []
  },
  {
    "id": "bd431753.a4c8f",
    "type": "switchNode",
    "name": "switch service-type",
    "xml": "<switch test=\"`$service-data.networks.network[$tmp.nidx].network-data.network-request-input.network-input-parameters.param[$idx].name == 'service-type'`\">\n",
    "comments": "",
    "outputs": 1,
    "x": 1345.9999389648438,
    "y": 213.5999755859375,
    "z": "2b9e11cc.456d3e",
    "wires": [
      [
        "264d1797.9d01f8"
      ]
    ]
  },
  {
    "id": "264d1797.9d01f8",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1530.9999389648438,
    "y": 211.5999755859375,
    "z": "2b9e11cc.456d3e",
    "wires": [
      [
        "b160eb3c.cbb848"
      ]
    ]
  },
  {
    "id": "b160eb3c.cbb848",
    "type": "set",
    "name": "set service-type",
    "xml": "<set>\n<parameter name='prop.l3vpn.service-type' value='`$service-data.networks.network[$tmp.nidx].network-data.network-request-input.network-input-parameters.param[$idx].value`' />\n",
    "comments": "",
    "x": 1699.9999389648438,
    "y": 209.5999755859375,
    "z": "2b9e11cc.456d3e",
    "wires": []
  },
  {
    "id": "dc355ee1.94a83",
    "type": "set",
    "name": "set controller data",
    "xml": "<set>\n<parameter name='prop.sdncRestApi.thirdpartySdnc.url' value=\"`$tmp.aai.esr-thirdparty-sdnc.esr-system-info-list[0].esr-system-info.serviceUrl`\" />\n<parameter name='prop.sdncRestApi.templateDir' value='/opt/onap/sdnc/data' />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.user' value=\"`$tmp.aai.esr-thirdparty-sdnc.esr-system-info-list[0].esr-system-info.user-name`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.password' value=\"`$tmp.aai.esr-thirdparty-sdnc.esr-system-info-list[0].esr-system-info.password`\" />\n",
    "comments": "",
    "x": 812,
    "y": 489,
    "z": "2b9e11cc.456d3e",
    "wires": []
  },
  {
    "id": "cb586993.f0a33",
    "type": "execute",
    "name": "execute REST DELETE VPN",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"$prop.sdncRestApi.tempDir +'/l3smvpntemplate.json'\"/>\n<parameter name=\"restapiUrl\" value=\"$prop.sdncRestApi.thirdpartySdnc.url +'/restconf/data/huawei-ac-net-l3vpn-svc:l3vpn-svc-cfg/vpn-services/vpnservice='+$prop.l3vpn.name'\"/>\n<parameter name=\"restapiUser\" value=\"$prop.sdncRestApi.thirdpartySdnc.user\"/>\n<parameter name=\"restapiPassword\" value=\"$prop.sdncRestApi.thirdpartySdnc.password\"/>\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"delete\"/>\n<parameter name=\"responsePrefix\" value=\"restapi-result\"/>",
    "comments": "",
    "outputs": 1,
    "x": 1323,
    "y": 566,
    "z": "2b9e11cc.456d3e",
    "wires": [
      []
    ]
  },
  {
    "id": "6101a41d.088144",
    "type": "switchNode",
    "name": "switch service-type",
    "xml": "<switch test=\"`$prop.l3vpn.service-type`\">\n",
    "comments": "",
    "outputs": 1,
    "x": 793,
    "y": 584,
    "z": "2b9e11cc.456d3e",
    "wires": [
      [
        "4afcdb87.e97234"
      ]
    ]
  },
  {
    "id": "4afcdb87.e97234",
    "type": "outcomeTrue",
    "name": "l3vpn-ipwan",
    "xml": "<outcome value='l3vpn-ipwan'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1043,
    "y": 568,
    "z": "2b9e11cc.456d3e",
    "wires": [
      [
        "cb586993.f0a33"
      ]
    ]
  },
  {
    "id": "d633fa40.e632f",
    "type": "switchNode",
    "name": "switch service-data.networks.network_length",
    "xml": "<switch test='`$service-data.networks.network_length`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 832,
    "y": 108,
    "z": "2b9e11cc.456d3e",
    "wires": [
      [
        "cd115f81.9765",
        "8c843586.ed486"
      ]
    ]
  },
  {
    "id": "cd115f81.9765",
    "type": "other",
    "name": "outcome Null",
    "xml": "<outcome value=''>\n",
    "comments": "",
    "outputs": 1,
    "x": 1277,
    "y": 34.00006103515625,
    "z": "2b9e11cc.456d3e",
    "wires": [
      [
        "9468f013.3839a8"
      ]
    ]
  },
  {
    "id": "9468f013.3839a8",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"network-topology-operation-input.network-request-input.network-id not found in service-data\" />\n",
    "comments": "",
    "x": 1467.7774658203125,
    "y": 20.889007568359375,
    "z": "2b9e11cc.456d3e",
    "wires": []
  },
  {
    "id": "8c843586.ed486",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1161.0003662109375,
    "y": 99.00007629394531,
    "z": "2b9e11cc.456d3e",
    "wires": [
      [
        "c38355cb.b91f58"
      ]
    ]
  },
  {
    "id": "c38355cb.b91f58",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 1332.2698974609375,
    "y": 82.55461120605469,
    "z": "2b9e11cc.456d3e",
    "wires": [
      [
        "da8d2eef.9ecfc8",
        "2abc9e2a.3b6932"
      ]
    ]
  },
  {
    "id": "da8d2eef.9ecfc8",
    "type": "for",
    "name": "for nidx..service-data.networks.network[]",
    "xml": "<for index='nidx' start='0' end='`$service-data.networks.network_length`' >\n",
    "comments": "",
    "outputs": 1,
    "x": 1630.285888671875,
    "y": 63.428619384765625,
    "z": "2b9e11cc.456d3e",
    "wires": [
      [
        "788ddd9c.802654"
      ]
    ]
  },
  {
    "id": "2abc9e2a.3b6932",
    "type": "switchNode",
    "name": "switch tmp.nidx ",
    "xml": "<switch test=\"`$tmp.nidx`\">\n\n",
    "comments": "",
    "outputs": 1,
    "x": 1551.5872802734375,
    "y": 106.41180419921875,
    "z": "2b9e11cc.456d3e",
    "wires": [
      [
        "d0a99363.1c30e"
      ]
    ]
  },
  {
    "id": "d0a99363.1c30e",
    "type": "outcome",
    "name": "NULL",
    "xml": "<outcome value=''>\n",
    "comments": "",
    "outputs": 1,
    "x": 1752.015869140625,
    "y": 111.98321533203125,
    "z": "2b9e11cc.456d3e",
    "wires": [
      [
        "ea14dde0.93393"
      ]
    ]
  },
  {
    "id": "788ddd9c.802654",
    "type": "switchNode",
    "name": "switch networkid found",
    "xml": "<switch test=\"`$service-data.networks.network[$nidx].network-id == $network-topology-operation-input.network-information.network-id`\">\n\n",
    "comments": "",
    "outputs": 1,
    "x": 1940.7144775390625,
    "y": 61.6787109375,
    "z": "2b9e11cc.456d3e",
    "wires": [
      [
        "c02919ae.22f7c"
      ]
    ]
  },
  {
    "id": "ea14dde0.93393",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"network-topology-operation-input.network-request-input.network-id not found in service-data\" />\n",
    "comments": "",
    "x": 1923.4443359375,
    "y": 112.12606811523438,
    "z": "2b9e11cc.456d3e",
    "wires": []
  },
  {
    "id": "c02919ae.22f7c",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2146.666748046875,
    "y": 60.571441650390625,
    "z": "2b9e11cc.456d3e",
    "wires": [
      [
        "64769a39.b95ddc"
      ]
    ]
  },
  {
    "id": "64769a39.b95ddc",
    "type": "set",
    "name": "set tmp.nidx and ctx.network-data",
    "xml": "<set>\n<parameter name='tmp.nidx' value='`$nidx`' />\n<parameter name='ctx.network-data.' value='`$service-data.networks.network[$nidx].`' />\n",
    "comments": "",
    "x": 2385.198486328125,
    "y": 56.321441650390625,
    "z": "2b9e11cc.456d3e",
    "wires": []
  },
  {
    "id": "c7fcf65d.3267e",
    "type": "block",
    "name": "block : saveNetworkData",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "comments": "",
    "outputs": 1,
    "x": 811,
    "y": 674,
    "z": "2b9e11cc.456d3e",
    "wires": [
      [
        "90f2187a.a0ed98",
        "d97a2187.fc0188",
        "8edd5656.7d422",
        "8bc5ebfa.1b543"
      ]
    ]
  },
  {
    "id": "a8af32f0.52f9a",
    "type": "returnSuccess",
    "name": "return success",
    "xml": "<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n",
    "comments": "",
    "x": 771.6665802001953,
    "y": 807.3332815170288,
    "z": "2b9e11cc.456d3e",
    "wires": []
  },
  {
    "id": "8edd5656.7d422",
    "type": "set",
    "name": "copy input to service-data",
    "xml": "<set>\n<parameter name='service-data.networks.network[$tmp.nidx].network-data.sdnc-request-header.' value='`$network-topology-operation-input.sdnc-request-header.`' />\n<parameter name='service-data.networks.network[$tmp.nidx].network-data.request-information.' value='`$network-topology-operation-input.request-information.`' />\n",
    "comments": "",
    "x": 1104.0000076293945,
    "y": 654.3333120346069,
    "z": "2b9e11cc.456d3e",
    "wires": []
  },
  {
    "id": "90f2187a.a0ed98",
    "type": "set",
    "name": "set networkId",
    "xml": "<set>\n<parameter name='networkId' value='`$network-topology-operation-input.network-information.network-id`' />\n",
    "comments": "",
    "x": 1068.2895622253418,
    "y": 698.0511589050293,
    "z": "2b9e11cc.456d3e",
    "wires": []
  },
  {
    "id": "d97a2187.fc0188",
    "type": "set",
    "name": "set object-path",
    "xml": "<set>\n<parameter name='network-object-path' value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $network-topology-operation-input.service-information.service-instance-id\n + '/service-data/networks/network/'\n + $networkId\n + '/network-data/'` \" />\n \n",
    "comments": "",
    "x": 1074.0039291381836,
    "y": 735.1940507888794,
    "z": "2b9e11cc.456d3e",
    "wires": []
  },
  {
    "id": "8bc5ebfa.1b543",
    "type": "set",
    "name": "set network-level-oper-status",
    "xml": "<set>\n<parameter name='service-data.networks.network[$tmp.nidx].network-data.network-level-oper-status.order-status' value='Deleted' />\n<parameter name='service-data.networks.network[$tmp.nidx].network-data.network-level-oper-status.last-rpc-action' value='`$network-topology-operation-input.sdnc-request-header.svc-action`' />\n<parameter name='service-data.networks.network[$tmp.nidx].network-data.network-level-oper-status.last-action' value='`$network-topology-operation-input.request-information.request-action`' />\n",
    "comments": "",
    "x": 1117.9999389648438,
    "y": 782.333270072937,
    "z": "2b9e11cc.456d3e",
    "wires": []
  }
]
