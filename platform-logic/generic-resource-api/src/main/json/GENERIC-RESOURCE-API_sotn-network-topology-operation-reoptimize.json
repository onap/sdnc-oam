[
  {
    "id": "15b0419a.e26dee",
    "type": "dgstart",
    "name": "DGSTART",
    "outputs": 1,
    "x": 120,
    "y": 61,
    "z": "15c4a63a.aa4faa",
    "wires": [
      [
        "6815a4c5.0efb9c"
      ]
    ]
  },
  {
    "id": "6815a4c5.0efb9c",
    "type": "service-logic",
    "name": "GENERIC-RESOURCE-API ${project.version}",
    "module": "GENERIC-RESOURCE-API",
    "version": "${project.version}",
    "comments": "",
    "xml": "<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>",
    "outputs": 1,
    "x": 338.49999237060547,
    "y": 141.9999928767793,
    "z": "15c4a63a.aa4faa",
    "wires": [
      [
        "d5b3e707.f31098"
      ]
    ]
  },
  {
    "id": "d5b3e707.f31098",
    "type": "method",
    "name": "sotn-network-topology-operation-reoptimize",
    "xml": "<method rpc='sotn-network-topology-operation-reoptimize' mode='sync'>\n",
    "comments": "",
    "outputs": 1,
    "x": 339.5,
    "y": 195,
    "z": "15c4a63a.aa4faa",
    "wires": [
      [
        "7f97e8a1.e24508"
      ]
    ]
  },
  {
    "id": "7f97e8a1.e24508",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 397.5,
    "y": 291,
    "z": "15c4a63a.aa4faa",
    "wires": [
      [
        "31802b08.09e044",
        "14d973bf.4cdedc",
        "9552f533.97eea8",
        "2e5ec23a.5a37ce",
        "5c05f1b4.b350e"
      ]
    ]
  },
  {
    "id": "31802b08.09e044",
    "type": "set",
    "name": "set tmp.network.parent-network-id,etc",
    "xml": "<set>\n<parameter name='tmp.network.network-id' value='`$network-topology-operation-input.network-information.network-id`' />\n<parameter name='tmp.network.service-instance-id' value='`$network-topology-operation-input.service-information.service-instance-id`' />\n\n\n",
    "comments": "",
    "x": 765,
    "y": 185,
    "z": "15c4a63a.aa4faa",
    "wires": []
  },
  {
    "id": "5e2dbb4f.c097a4",
    "type": "comment",
    "name": "set tmp connectivity-id to fetch resource from MDSAL",
    "info": "",
    "comments": "",
    "x": 834.9603271484375,
    "y": 150.03179931640625,
    "z": "15c4a63a.aa4faa",
    "wires": []
  },
  {
    "id": "9552f533.97eea8",
    "type": "execute",
    "name": "generate allotted-resource tmp.ar-url",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"`$prop.restapi.services`\"/>\n    <parameter name=\"outputPath\" value=\"tmp.service-data-ar-url\"/>\n    <parameter name=\"target\" value=\"{service-instance-id}\"/>\n    <parameter name=\"replacement\" value=\"`$tmp.network.service-instance-id`\"/>\n",
    "comments": "",
    "outputs": 1,
    "x": 771,
    "y": 351,
    "z": "15c4a63a.aa4faa",
    "wires": [
      []
    ]
  },
  {
    "id": "14d973bf.4cdedc",
    "type": "execute",
    "name": "execute Properties",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.prop.PropertiesNode' method='readProperties' >\n    <parameter name='fileName' value='%SDNC_CONFIG_DIR%/generic-resource-api-dg.properties' />\n    <parameter name='contextPrefix' value='prop' />\n",
    "comments": "",
    "outputs": 1,
    "x": 708.9999389648438,
    "y": 268,
    "z": "15c4a63a.aa4faa",
    "wires": [
      []
    ]
  },
  {
    "id": "613f99be.2767e8",
    "type": "comment",
    "name": "Used to Get Provided resource by id to MDSAL, same as self-link",
    "info": "",
    "comments": "",
    "x": 886.738037109375,
    "y": 319.22210693359375,
    "z": "15c4a63a.aa4faa",
    "wires": []
  },
  {
    "id": "1a55c7df.726138",
    "type": "comment",
    "name": "Obtain different URL, template location etc",
    "info": "For saving resource information to MDSAL & for AAI",
    "comments": "",
    "x": 804.738037109375,
    "y": 233.22216796875,
    "z": "15c4a63a.aa4faa",
    "wires": []
  },
  {
    "id": "25b6aedb.d1ced2",
    "type": "comment",
    "name": "GET connection-attachment-allotted-resource from mdsal",
    "info": "",
    "comments": "",
    "x": 844.5529174804688,
    "y": 388.8784132003784,
    "z": "15c4a63a.aa4faa",
    "wires": []
  },
  {
    "id": "2e5ec23a.5a37ce",
    "type": "execute",
    "name": "execute RestApiCallNode - get-resource connection-attachment-allotted-resource",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.service-data-ar-url`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='GET' />\n    <parameter name=\"responsePrefix\" value=\"mdsal-psd\" />\n\n",
    "comments": "",
    "outputs": 1,
    "x": 888.7484741210938,
    "y": 421.34368419647217,
    "z": "15c4a63a.aa4faa",
    "wires": [
      [
        "52460873.480268",
        "c51dc36.f4e1a4"
      ]
    ]
  },
  {
    "id": "52460873.480268",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1276,
    "y": 409.9999952316284,
    "z": "15c4a63a.aa4faa",
    "wires": [
      [
        "1d9fb343.db506d"
      ]
    ]
  },
  {
    "id": "c51dc36.f4e1a4",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1267.8518028259277,
    "y": 445.0660800933838,
    "z": "15c4a63a.aa4faa",
    "wires": [
      [
        "98bf450d.f63998"
      ]
    ]
  },
  {
    "id": "1d9fb343.db506d",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1407.0000953674316,
    "y": 410.00005626678467,
    "z": "15c4a63a.aa4faa",
    "wires": [
      []
    ]
  },
  {
    "id": "98bf450d.f63998",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"404\" />\n    <parameter name=\"error-message\" value=\"Error: Parent service data not available\" />\n    \n",
    "comments": "",
    "x": 1414.0005836486816,
    "y": 444.3334913253784,
    "z": "15c4a63a.aa4faa",
    "wires": []
  },
  {
    "id": "5c05f1b4.b350e",
    "type": "for",
    "name": "for pidx..mdsal-psd.service-data.provided-allotted-resources.provided-allotted-resource[]",
    "xml": "<for index='pidx' start='0' end='`$mdsal-psd.service[0].service-data.provided-allotted-resources.provided-allotted-resource_length`' >\n\n",
    "comments": "",
    "outputs": 1,
    "x": 898,
    "y": 471,
    "z": "15c4a63a.aa4faa",
    "wires": [
      [
        "c38a17f2.bcdfa8"
      ]
    ]
  },
  {
    "id": "c38a17f2.bcdfa8",
    "type": "block",
    "name": "block atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 828.8458251953125,
    "y": 538.2246079444885,
    "z": "15c4a63a.aa4faa",
    "wires": [
      [
        "40df0222.1ce9fc",
        "72dc6006.49c59",
        "977dd494.cf3c88",
        "493fe023.d11d5",
        "eae53808.6b9bc8",
        "91e299a2.2b1cf8",
        "2d10c8d9.e3eee8",
        "d71aa1e9.a197f",
        "76503965.4cb688",
        "f116f2ea.6453c"
      ]
    ]
  },
  {
    "id": "40df0222.1ce9fc",
    "type": "set",
    "name": "set prop.ar.provided-allotted-resource-id",
    "xml": "<set>\n<parameter name='prop.ar.provided-allotted-resource-id' value='`$mdsal-psd.service[0].service-data.provided-allotted-resources.provided-allotted-resource[$pidx].allotted-resource-id`' />\n\n",
    "comments": "",
    "x": 1098.8153076171875,
    "y": 521.0274047851562,
    "z": "15c4a63a.aa4faa",
    "wires": []
  },
  {
    "id": "72dc6006.49c59",
    "type": "execute",
    "name": "generate tmp.ar-url-connection url",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"`$prop.restapi.connection-attachment-allottedresource`\"/>\n    <parameter name=\"outputPath\" value=\"tmp.ar-url-connection\"/>\n    <parameter name=\"target\" value=\"{allotted-resource-id}\"/>\n    <parameter name=\"replacement\" value=\"`$prop.ar.provided-allotted-resource-id`\"/>\n",
    "comments": "",
    "outputs": 1,
    "x": 1084.815185546875,
    "y": 561.572386264801,
    "z": "15c4a63a.aa4faa",
    "wires": [
      []
    ]
  },
  {
    "id": "977dd494.cf3c88",
    "type": "execute",
    "name": "execute RestApiCallNode - get-resource connection-attachment-allotted-resource",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.ar-url-connection`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='GET' />\n    <parameter name=\"responsePrefix\" value=\"mdsal-providedAr\" />\n",
    "comments": "",
    "outputs": 1,
    "x": 1228.81494140625,
    "y": 601.2389512062073,
    "z": "15c4a63a.aa4faa",
    "wires": [
      [
        "8170aa19.982a38",
        "6552e307.df3c7c"
      ]
    ]
  },
  {
    "id": "8170aa19.982a38",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1604.1851043701172,
    "y": 581.7610926628113,
    "z": "15c4a63a.aa4faa",
    "wires": [
      [
        "5fc7b487.38480c"
      ]
    ]
  },
  {
    "id": "6552e307.df3c7c",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1596.036907196045,
    "y": 616.8271775245667,
    "z": "15c4a63a.aa4faa",
    "wires": [
      [
        "c4de5f01.5514e"
      ]
    ]
  },
  {
    "id": "5fc7b487.38480c",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1735.1851997375488,
    "y": 581.7611536979675,
    "z": "15c4a63a.aa4faa",
    "wires": [
      []
    ]
  },
  {
    "id": "c4de5f01.5514e",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"404\" />\n    <parameter name=\"error-message\" value=\"Error: Parent service data not available\" />\n    \n",
    "comments": "",
    "x": 1742.1856880187988,
    "y": 616.0945887565613,
    "z": "15c4a63a.aa4faa",
    "wires": []
  },
  {
    "id": "91e299a2.2b1cf8",
    "type": "set",
    "name": "set model-data",
    "xml": "<set>\n<parameter name='connection-attachment-topology-operation-input.allotted-resource-information.onap-model-information.' value=\"`$mdsal-providedAr.connection-attachment-allotted-resource[0].allotted-resource-data.connection-attachment-topology.onap-model-information.` \" />",
    "comments": "",
    "x": 1028.0000610351562,
    "y": 777.0000033378601,
    "z": "15c4a63a.aa4faa",
    "wires": []
  },
  {
    "id": "eae53808.6b9bc8",
    "type": "set",
    "name": "set connection-attachment-ar-identifiers",
    "xml": "<set>\n<parameter name='connection-attachment-topology-operation-input.service-information.service-instance-id' value=\"`$mdsal-providedAr.connection-attachment-allotted-resource[0].allotted-resource-data.connection-attachment-topology.allotted-resource-identifiers.consuming-service-instance-id` \" />\n<parameter name='connection-attachment-topology-operation-input.allotted-resource-information.parent-service-instance-id' value=\"`$mdsal-providedAr.connection-attachment-allotted-resource[0].allotted-resource-data.connection-attachment-topology.allotted-resource-identifiers.parent-service-instance-id` \" />\n<parameter name='connection-attachment-topology-operation-input.allotted-resource-information.allotted-resource-type' value=\"`$mdsal-providedAr.connection-attachment-allotted-resource[0].allotted-resource-data.connection-attachment-topology.allotted-resource-identifiers.allotted-resource-type` \" />\n<parameter name='connection-attachment-topology-operation-input.allotted-resource-information.allotted-resource-id' value=\"`$mdsal-providedAr.connection-attachment-allotted-resource[0].allotted-resource-data.connection-attachment-topology.allotted-resource-identifiers.allotted-resource-id` \" />\n",
    "comments": "",
    "x": 1105.3017578125,
    "y": 738.0159945487976,
    "z": "15c4a63a.aa4faa",
    "wires": []
  },
  {
    "id": "493fe023.d11d5",
    "type": "set",
    "name": "set request-info, service-info, allotted-info",
    "xml": "<set>\n<parameter name='connection-attachment-topology-operation-input.request-information.request-action' value=\"`$mdsal-providedAr.connection-attachment-allotted-resource[0].allotted-resource-status.action` \" />\n<parameter name='connection-attachment-topology-operation-input.sdnc-request-header.svc-action' value=\"`$mdsal-providedAr.connection-attachment-allotted-resource[0].allotted-resource-status.rpc-action` \" />\n<parameter name='connection-attachment-topology-operation-input.request-information.' value=\"`$mdsal-providedAr.connection-attachment-allotted-resource[0].allotted-resource-data.allotted-resource-operation-information.request-information.` \" />\n<parameter name='connection-attachment-topology-operation-input.sdnc-request-header.' value=\"`$mdsal-providedAr.connection-attachment-allotted-resource[0].allotted-resource-data.allotted-resource-operation-information.sdnc-request-header.` \" />\n<parameter name='connection-attachment-topology-operation-input.service-information.' value=\"`$mdsal-providedAr.connection-attachment-allotted-resource[0].allotted-resource-data.allotted-resource-operation-information.service-information.` \" />\n<parameter name='connection-attachment-topology-operation-input.allotted-resource-information.' value=\"`$mdsal-providedAr.connection-attachment-allotted-resource[0].allotted-resource-data.allotted-resource-operation-information.allotted-resource-information.` \" />\n<parameter name='connection-attachment-topology-operation-input.connection-attachment-request-input.' value=\"`$mdsal-providedAr.connection-attachment-allotted-resource[0].allotted-resource-data.allotted-resource-operation-information.connection-attachment-request-input.` \" />\n",
    "comments": "",
    "x": 1113.1585693359375,
    "y": 696.8253817558289,
    "z": "15c4a63a.aa4faa",
    "wires": []
  },
  {
    "id": "f116f2ea.6453c",
    "type": "call",
    "name": "call sotn-attachment-topology-operation-activate",
    "xml": "<call module='GENERIC-RESOURCE-API' rpc='sotn-attachment-topology-operation-activate' mode='sync' >\n",
    "comments": "",
    "outputs": 1,
    "x": 1119.0001220703125,
    "y": 941.0000610351562,
    "z": "15c4a63a.aa4faa",
    "wires": [
      []
    ]
  },
  {
    "id": "d71aa1e9.a197f",
    "type": "call",
    "name": "call sotn-attachment-topology-operation-deactivate",
    "xml": "<call module='GENERIC-RESOURCE-API' rpc='sotn-attachment-topology-operation-deactivate' mode='sync' >\n",
    "comments": "",
    "outputs": 1,
    "x": 1138.0001831054688,
    "y": 860,
    "z": "15c4a63a.aa4faa",
    "wires": [
      []
    ]
  },
  {
    "id": "76503965.4cb688",
    "type": "set",
    "name": "set request-action and svc-action",
    "xml": "<set>\n<parameter name='connection-attachment-topology-operation-input.sdnc-request-header.svc-action' value=\"activate\" />\n<parameter name='connection-attachment-topology-operation-input.request-information.request-action' value=\"ActivateSOTNAttachmentInstance\" />\n\n\n",
    "comments": "",
    "x": 1078.0001831054688,
    "y": 899,
    "z": "15c4a63a.aa4faa",
    "wires": []
  },
  {
    "id": "2d10c8d9.e3eee8",
    "type": "set",
    "name": "set request-action and svc-action",
    "xml": "<set>\n<parameter name='connection-attachment-topology-operation-input.sdnc-request-header.svc-action' value=\"deactivate\" />\n<parameter name='connection-attachment-topology-operation-input.request-information.request-action' value=\"DeactivateSOTNAttachmentInstance\" />\n<parameter name='connection-attachment-topology-operation-input.service-information.global-customer-id' value=\"`$mdsal-psd.service[0].service-data.service-information.global-customer-id` \" />\n<parameter name='connection-attachment-topology-operation-input.service-information.subscription-service-type' value=\"`$mdsal-psd.service[0].service-data.service-information.subscription-service-type` \" />\n<parameter name='connection-attachment-topology-operation-input.service-information.subscriber-name' value=\"`$mdsal-psd.service[0].service-data.service-information.subscriber-name` \" />",
    "comments": "",
    "x": 1083,
    "y": 820.0000033378601,
    "z": "15c4a63a.aa4faa",
    "wires": []
  },
  {
    "id": "b11de602.13daf8",
    "type": "comment",
    "name": "SET connection-attachment-allotted-resource in input parameters",
    "info": "",
    "comments": "",
    "x": 1186,
    "y": 657.0000033378601,
    "z": "15c4a63a.aa4faa",
    "wires": []
  }
]
