[
  {
    "id": "ba830c79.783fc",
    "type": "dgstart",
    "name": "DGSTART",
    "outputs": 1,
    "x": 112,
    "y": 60,
    "z": "e5bf33cc.860bc",
    "wires": [
      [
        "4ae6deec.cd3f3"
      ]
    ]
  },
  {
    "id": "4ae6deec.cd3f3",
    "type": "service-logic",
    "name": "GENERIC-RESOURCE-API ${project.version}",
    "module": "GENERIC-RESOURCE-API",
    "version": "${project.version}",
    "comments": "",
    "xml": "<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>",
    "outputs": 1,
    "x": 330.49999237060547,
    "y": 140.9999928767793,
    "z": "e5bf33cc.860bc",
    "wires": [
      [
        "d2d46081.2fceb"
      ]
    ]
  },
  {
    "id": "d2d46081.2fceb",
    "type": "method",
    "name": "sotn-network-topology-operation-reoptimize",
    "xml": "<method rpc='sotn-network-topology-operation-reoptimize' mode='sync'>\n",
    "comments": "",
    "outputs": 1,
    "x": 331.5,
    "y": 194,
    "z": "e5bf33cc.860bc",
    "wires": [
      [
        "36051f70.beb8c"
      ]
    ]
  },
  {
    "id": "36051f70.beb8c",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 409.50000762939453,
    "y": 252.000009059906,
    "z": "e5bf33cc.860bc",
    "wires": [
      [
        "7af3f162.64be",
        "def5a09c.a5553",
        "ecfb074a.096988",
        "17f9a997.150a06",
        "a8c6638b.cba29",
        "59b44687.021ed8"
      ]
    ]
  },
  {
    "id": "7af3f162.64be",
    "type": "set",
    "name": "set tmp.network.parent-network-id,etc",
    "xml": "<set>\n<parameter name='tmp.network.network-id' value='`$network-topology-operation-input.network-information.network-id`' />\n<parameter name='tmp.network.service-instance-id' value='`$network-topology-operation-input.service-information.service-instance-id`' />\n\n\n",
    "comments": "",
    "x": 757.0000152587891,
    "y": 147.00000476837158,
    "z": "e5bf33cc.860bc",
    "wires": []
  },
  {
    "id": "e6874582.0b2958",
    "type": "comment",
    "name": "set tmp connectivity-id to fetch resource from MDSAL",
    "info": "",
    "comments": "",
    "x": 826.9603424072266,
    "y": 112.03180408477783,
    "z": "e5bf33cc.860bc",
    "wires": []
  },
  {
    "id": "def5a09c.a5553",
    "type": "execute",
    "name": "execute Properties",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.prop.PropertiesNode' method='readProperties' >\n    <parameter name='fileName' value='%SDNC_CONFIG_DIR%/generic-resource-api-dg.properties' />\n    <parameter name='contextPrefix' value='prop' />\n",
    "comments": "",
    "outputs": 1,
    "x": 700.9999542236328,
    "y": 230.00000476837158,
    "z": "e5bf33cc.860bc",
    "wires": [
      []
    ]
  },
  {
    "id": "5022e1ba.bc98c",
    "type": "comment",
    "name": "Obtain different URL, template location etc",
    "info": "For saving resource information to MDSAL & for AAI",
    "comments": "",
    "x": 796.7380523681641,
    "y": 195.22217273712158,
    "z": "e5bf33cc.860bc",
    "wires": []
  },
  {
    "id": "ecfb074a.096988",
    "type": "for",
    "name": "for pidx..mdsal-psd.service-data.provided-allotted-resources.provided-allotted-resource[]",
    "xml": "<for index='pidx' start='0' end='`$service-data.provided-allotted-resources.provided-allotted-resource_length`' >\n",
    "comments": "",
    "outputs": 1,
    "x": 911.0000991821289,
    "y": 312.0000705718994,
    "z": "e5bf33cc.860bc",
    "wires": [
      [
        "d7a2d973.f454d8"
      ]
    ]
  },
  {
    "id": "d7a2d973.f454d8",
    "type": "block",
    "name": "block atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 882.8459091186523,
    "y": 368.224645614624,
    "z": "e5bf33cc.860bc",
    "wires": [
      [
        "23cb526c.80076e",
        "39defcd5.3339e4",
        "165dda1d.49d8c6",
        "6d05051.63437fc",
        "2355af77.170bb",
        "c3991295.942e1",
        "5cbe5e79.5b38f",
        "5573aa15.2f76f4",
        "92a8c0e.7e8084",
        "53bd8f16.8bed2"
      ]
    ]
  },
  {
    "id": "23cb526c.80076e",
    "type": "set",
    "name": "set prop.ar.provided-allotted-resource-id",
    "xml": "<set>\n<parameter name='prop.ar.provided-allotted-resource-id' value='`$service-data.provided-allotted-resources.provided-allotted-resource[$pidx].allotted-resource-id`' />\n\n",
    "comments": "",
    "x": 1152.8153915405273,
    "y": 351.02744245529175,
    "z": "e5bf33cc.860bc",
    "wires": []
  },
  {
    "id": "39defcd5.3339e4",
    "type": "execute",
    "name": "generate tmp.ar-url-connection url",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"`$prop.restapi.connection-attachment-allottedresource`\"/>\n    <parameter name=\"outputPath\" value=\"tmp.ar-url-connection\"/>\n    <parameter name=\"target\" value=\"{allotted-resource-id}\"/>\n    <parameter name=\"replacement\" value='`$prop.ar.provided-allotted-resource-id`'/>\n",
    "comments": "",
    "outputs": 1,
    "x": 1141.815284729004,
    "y": 403.5724229812622,
    "z": "e5bf33cc.860bc",
    "wires": [
      []
    ]
  },
  {
    "id": "165dda1d.49d8c6",
    "type": "execute",
    "name": "execute RestApiCallNode - get-resource connection-attachment-allotted-resource",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.ar-url-connection`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='GET' />\n    <parameter name=\"responsePrefix\" value=\"mdsal-providedAr\" />\n",
    "comments": "",
    "outputs": 1,
    "x": 1282.8151321411133,
    "y": 459.2390090227127,
    "z": "e5bf33cc.860bc",
    "wires": [
      [
        "cd095866.b31848",
        "1215888c.ee51e7"
      ]
    ]
  },
  {
    "id": "cd095866.b31848",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1658.185203552246,
    "y": 459.7611274719238,
    "z": "e5bf33cc.860bc",
    "wires": [
      [
        "7c49cfc5.d8cce"
      ]
    ]
  },
  {
    "id": "1215888c.ee51e7",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1650.0370063781738,
    "y": 494.8272123336792,
    "z": "e5bf33cc.860bc",
    "wires": [
      [
        "77edea1f.976304"
      ]
    ]
  },
  {
    "id": "7c49cfc5.d8cce",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1789.1852989196777,
    "y": 459.7611885070801,
    "z": "e5bf33cc.860bc",
    "wires": [
      []
    ]
  },
  {
    "id": "77edea1f.976304",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"404\" />\n    <parameter name=\"error-message\" value=\"Error: Parent service data not available\" />\n    \n",
    "comments": "",
    "x": 1796.1857872009277,
    "y": 494.0946235656738,
    "z": "e5bf33cc.860bc",
    "wires": []
  },
  {
    "id": "c3991295.942e1",
    "type": "set",
    "name": "set model-data to input",
    "xml": "<set>\n<parameter name='connection-attachment-topology-operation-input.allotted-resource-information.onap-model-information.' value=\"`$mdsal-providedAr.connection-attachment-allotted-resource[0].allotted-resource-data.connection-attachment-topology.onap-model-information.` \" />",
    "comments": "",
    "x": 1123.0001907348633,
    "y": 594.0000371932983,
    "z": "e5bf33cc.860bc",
    "wires": []
  },
  {
    "id": "2355af77.170bb",
    "type": "set",
    "name": "set connection-attachment-ar-identifiers to input",
    "xml": "<set>\n<parameter name='connection-attachment-topology-operation-input.service-information.service-instance-id' value=\"`$mdsal-providedAr.connection-attachment-allotted-resource[0].allotted-resource-data.connection-attachment-topology.allotted-resource-identifiers.consuming-service-instance-id` \" />\n<parameter name='connection-attachment-topology-operation-input.allotted-resource-information.parent-service-instance-id' value=\"`$mdsal-providedAr.connection-attachment-allotted-resource[0].allotted-resource-data.connection-attachment-topology.allotted-resource-identifiers.parent-service-instance-id` \" />\n<parameter name='connection-attachment-topology-operation-input.allotted-resource-information.allotted-resource-type' value=\"`$mdsal-providedAr.connection-attachment-allotted-resource[0].allotted-resource-data.connection-attachment-topology.allotted-resource-identifiers.allotted-resource-type` \" />\n<parameter name='connection-attachment-topology-operation-input.allotted-resource-information.allotted-resource-id' value=\"`$mdsal-providedAr.connection-attachment-allotted-resource[0].allotted-resource-data.connection-attachment-topology.allotted-resource-identifiers.allotted-resource-id` \" />\n",
    "comments": "",
    "x": 1198.301872253418,
    "y": 556.0159864425659,
    "z": "e5bf33cc.860bc",
    "wires": []
  },
  {
    "id": "6d05051.63437fc",
    "type": "set",
    "name": "set ar-data to input",
    "xml": "<set>\n<parameter name='connection-attachment-topology-operation-input.request-information.request-action' value=\"`$mdsal-providedAr.connection-attachment-allotted-resource[0].allotted-resource-status.action` \" />\n<parameter name='connection-attachment-topology-operation-input.sdnc-request-header.svc-action' value=\"`$mdsal-providedAr.connection-attachment-allotted-resource[0].allotted-resource-status.rpc-action` \" />\n<parameter name='connection-attachment-topology-operation-input.request-information.' value=\"`$mdsal-providedAr.connection-attachment-allotted-resource[0].allotted-resource-data.allotted-resource-operation-information.request-information.` \" />\n<parameter name='connection-attachment-topology-operation-input.sdnc-request-header.' value=\"`$mdsal-providedAr.connection-attachment-allotted-resource[0].allotted-resource-data.allotted-resource-operation-information.sdnc-request-header.` \" />\n<parameter name='connection-attachment-topology-operation-input.service-information.' value=\"`$mdsal-providedAr.connection-attachment-allotted-resource[0].allotted-resource-data.allotted-resource-operation-information.service-information.` \" />\n<parameter name='connection-attachment-topology-operation-input.allotted-resource-information.' value=\"`$mdsal-providedAr.connection-attachment-allotted-resource[0].allotted-resource-data.allotted-resource-operation-information.allotted-resource-information.` \" />\n<parameter name='connection-attachment-topology-operation-input.connection-attachment-request-input.' value=\"`$mdsal-providedAr.connection-attachment-allotted-resource[0].allotted-resource-data.allotted-resource-operation-information.connection-attachment-request-input.` \" />\n",
    "comments": "",
    "x": 1105.1586456298828,
    "y": 514.8253927230835,
    "z": "e5bf33cc.860bc",
    "wires": []
  },
  {
    "id": "53bd8f16.8bed2",
    "type": "call",
    "name": "call sotn-attachment-topology-operation-activate",
    "xml": "<call module='GENERIC-RESOURCE-API' rpc='sotn-attachment-topology-operation-activate' mode='sync' >\n",
    "comments": "",
    "outputs": 1,
    "x": 1199.0001945495605,
    "y": 769.0000486373901,
    "z": "e5bf33cc.860bc",
    "wires": [
      []
    ]
  },
  {
    "id": "5573aa15.2f76f4",
    "type": "call",
    "name": "call sotn-attachment-topology-operation-deactivate",
    "xml": "<call module='GENERIC-RESOURCE-API' rpc='sotn-attachment-topology-operation-deactivate' mode='sync' >\n",
    "comments": "",
    "outputs": 1,
    "x": 1208.0002746582031,
    "y": 678.0000429153442,
    "z": "e5bf33cc.860bc",
    "wires": [
      []
    ]
  },
  {
    "id": "92a8c0e.7e8084",
    "type": "set",
    "name": "set request-action and svc-action",
    "xml": "<set>\n<parameter name='connection-attachment-topology-operation-input.sdnc-request-header.svc-action' value=\"activate\" />\n<parameter name='connection-attachment-topology-operation-input.request-information.request-action' value=\"ActivateSOTNAttachmentInstance\" />\n\n\n",
    "comments": "",
    "x": 1154.0002746582031,
    "y": 723.0000457763672,
    "z": "e5bf33cc.860bc",
    "wires": []
  },
  {
    "id": "5cbe5e79.5b38f",
    "type": "set",
    "name": "set request-action and svc-action",
    "xml": "<set>\n<parameter name='connection-attachment-topology-operation-input.sdnc-request-header.svc-action' value=\"deactivate\" />\n<parameter name='connection-attachment-topology-operation-input.request-information.request-action' value=\"DeactivateSOTNAttachmentInstance\" />\n<parameter name='connection-attachment-topology-operation-input.service-information.global-customer-id' value=\"`$service-data.service-information.global-customer-id` \" />\n<parameter name='connection-attachment-topology-operation-input.service-information.subscription-service-type' value=\"`$service-data.service-information.subscription-service-type` \" />\n<parameter name='connection-attachment-topology-operation-input.service-information.subscriber-name' value=\"`$service-data.service-information.subscriber-name` \" />",
    "comments": "",
    "x": 1154.000114440918,
    "y": 637.0000410079956,
    "z": "e5bf33cc.860bc",
    "wires": []
  },
  {
    "id": "17f9a997.150a06",
    "type": "set",
    "name": "set service-data in tmp var",
    "xml": "<set>\n<parameter name = 'tmp.service-data.' value=\"`$service-data.`\"/>\n",
    "comments": "",
    "x": 719.0001983642578,
    "y": 266.0000944137573,
    "z": "e5bf33cc.860bc",
    "wires": []
  },
  {
    "id": "a8c6638b.cba29",
    "type": "set",
    "name": "set tmp.service-data to service-data",
    "xml": "<set>\n<parameter name = 'service-data. '  value = \"`$tmp.service-data.`\"/>\n",
    "comments": "",
    "x": 822.0003814697266,
    "y": 845.0001068115234,
    "z": "e5bf33cc.860bc",
    "wires": []
  },
  {
    "id": "59b44687.021ed8",
    "type": "returnSuccess",
    "name": "return success",
    "xml": "<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n",
    "comments": "",
    "x": 743.0001831054688,
    "y": 889.0000267028809,
    "z": "e5bf33cc.860bc",
    "wires": []
  }
]
