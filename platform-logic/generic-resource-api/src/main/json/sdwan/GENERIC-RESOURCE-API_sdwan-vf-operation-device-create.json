[
    {
        "id": "5c12f35e.e1cabc",
        "type": "switchNode",
        "name": "switch this vnf-id == input vnf-id",
        "xml": "<switch test=\"`$service-data.vnfs.vnf[$idx].vnf-id == $vf-module-topology-operation-input.vnf-information.vnf-id`\">    \n",
        "comments": "",
        "outputs": 1,
        "x": 887.3294982910156,
        "y": 250.16278743743896,
        "z": "67d8f5f.109b30c",
        "wires": [
            [
                "fc9a82de.84ce"
            ]
        ]
    },
    {
        "id": "b009e5d5.1d5ff8",
        "type": "service-logic",
        "name": "GENERIC-RESOURCE-API ${project.version}",
        "module": "GENERIC-RESOURCE-API",
        "version": "${project.version}",
        "comments": "",
        "xml": "<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>",
        "outputs": 1,
        "x": 177,
        "y": 143.99999141693115,
        "z": "67d8f5f.109b30c",
        "wires": [
            [
                "9b496cef.08cf1"
            ]
        ]
    },
    {
        "id": "9b496cef.08cf1",
        "type": "method",
        "name": "sdwan-vf-operation-device-create",
        "xml": "<method rpc='sdwan-vf-operation-device-create' mode='sync'>\n",
        "comments": "",
        "outputs": 1,
        "x": 176,
        "y": 243.99999141693115,
        "z": "67d8f5f.109b30c",
        "wires": [
            [
                "a4608885.5f82c8"
            ]
        ]
    },
    {
        "id": "7da866ae.544bb8",
        "type": "dgstart",
        "name": "DGSTART",
        "outputs": 1,
        "x": 98.50000381469727,
        "y": 39,
        "z": "67d8f5f.109b30c",
        "wires": [
            [
                "b009e5d5.1d5ff8"
            ]
        ]
    },
    {
        "id": "a4608885.5f82c8",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 334.99998474121094,
        "y": 360,
        "z": "67d8f5f.109b30c",
        "wires": [
            [
                "4e77e130.304fb",
                "802c77ca.22e778",
                "9922275a.527928",
                "e01d2f82.7429f",
                "a8f9e83.8a6e918",
                "c8a186f7.659098",
                "b9b958fd.141f08",
                "f27c9cac.ebc18",
                "35a34bb1.948374",
                "178a7bac.307b74",
                "7fbeb541.aa905c",
                "4845313f.7a00d",
                "e8cf2ce.61834d",
                "d9a88b51.5c3ff8"
            ]
        ]
    },
    {
        "id": "4e77e130.304fb",
        "type": "for",
        "name": "for each vnf",
        "xml": "<for index='idx' start='0' end='`$service-data.vnfs.vnf_length`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 635.3294067382812,
        "y": 251.49612426757812,
        "z": "67d8f5f.109b30c",
        "wires": [
            [
                "5c12f35e.e1cabc"
            ]
        ]
    },
    {
        "id": "ddad9e6f.97581",
        "type": "set",
        "name": "set vnf-index",
        "xml": "<set>\n<parameter name='vnf-index' value='`$idx`' />\n",
        "comments": "",
        "x": 1258.9959869384766,
        "y": 252.1627902984619,
        "z": "67d8f5f.109b30c",
        "wires": []
    },
    {
        "id": "fc9a82de.84ce",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1105.6628150939941,
        "y": 252.16276931762695,
        "z": "67d8f5f.109b30c",
        "wires": [
            [
                "ddad9e6f.97581"
            ]
        ]
    },
    {
        "id": "e01d2f82.7429f",
        "type": "for",
        "name": "for loop idx - VF input parameters",
        "xml": "<for index=\"idx\" start=\"0\" end=\"`$vf-module-topology-operation-input.vf-module-request-input.vf-module-input-parameters.param_length`\">\n\n",
        "comments": "",
        "outputs": 1,
        "x": 709.2501907348633,
        "y": 473.66665744781494,
        "z": "67d8f5f.109b30c",
        "wires": [
            [
                "7ea0d8c4.d056e8"
            ]
        ]
    },
    {
        "id": "7ea0d8c4.d056e8",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 924.0285339355469,
        "y": 471.22224140167236,
        "z": "67d8f5f.109b30c",
        "wires": [
            [
                "c6b87ab0.44cce8",
                "f6199a92.b6bb08"
            ]
        ]
    },
    {
        "id": "c6b87ab0.44cce8",
        "type": "execute",
        "name": "execute split parameterName",
        "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='split' >\n<parameter name=\"original_string\" value='`$vf-module-topology-operation-input.vf-module-request-input.vf-module-input-parameters.param[$idx].name`'/>\n<parameter name=\"regex\" value=\"_\"/>\n<parameter name=\"ctx_memory_result_key\" value=\"param-prefix\"/>\n",
        "comments": "",
        "outputs": 1,
        "x": 1120.2847366333008,
        "y": 448.97037982940674,
        "z": "67d8f5f.109b30c",
        "wires": [
            []
        ]
    },
    {
        "id": "f6199a92.b6bb08",
        "type": "set",
        "name": "set parameterName",
        "xml": "<set>\n<parameter name=\"`vf-module-topology-operation-input.vf-module-request-input.vf-module-input-parameters.param[$idx].name`\" value='`$param-prefix[$param-prefix_length -1]`'/>\n",
        "comments": "",
        "x": 1089.7291641235352,
        "y": 485.97049617767334,
        "z": "67d8f5f.109b30c",
        "wires": []
    },
    {
        "id": "92e456fa.39e618",
        "type": "comment",
        "name": "Take the parameter names by removing prefix",
        "info": "",
        "comments": "",
        "x": 1093.2503929138184,
        "y": 408.3333258628845,
        "z": "67d8f5f.109b30c",
        "wires": []
    },
    {
        "id": "802c77ca.22e778",
        "type": "switchNode",
        "name": "switch vnf_length",
        "xml": "<switch test='`$service-data.vnfs.vnf_length`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 649.75,
        "y": 206.99999332427979,
        "z": "67d8f5f.109b30c",
        "wires": [
            [
                "b9775757.c586e8"
            ]
        ]
    },
    {
        "id": "b9775757.c586e8",
        "type": "other",
        "name": "NULL",
        "xml": "<outcome value=''>\n",
        "comments": "",
        "outputs": 1,
        "x": 836.4166793823242,
        "y": 206.33329105377197,
        "z": "67d8f5f.109b30c",
        "wires": [
            [
                "8ca0a76c.6a9638"
            ]
        ]
    },
    {
        "id": "8ca0a76c.6a9638",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"404\" />\n    <parameter name=\"error-message\" value=\"There are no VNFs in MD-SAL\" />\n",
        "comments": "",
        "x": 1018.0833053588867,
        "y": 206.33329105377197,
        "z": "67d8f5f.109b30c",
        "wires": []
    },
    {
        "id": "9922275a.527928",
        "type": "switchNode",
        "name": "switch vf-modules.vf-module_length",
        "xml": "<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 690.9999895095825,
        "y": 326.9999942779541,
        "z": "67d8f5f.109b30c",
        "wires": [
            [
                "c5166da1.64b87",
                "f58b3753.891bc8"
            ]
        ]
    },
    {
        "id": "c5166da1.64b87",
        "type": "other",
        "name": "Null",
        "xml": "<outcome value=''>\n",
        "comments": "",
        "outputs": 1,
        "x": 922,
        "y": 302.99999141693115,
        "z": "67d8f5f.109b30c",
        "wires": [
            [
                "4d85b0fa.e45f4"
            ]
        ]
    },
    {
        "id": "f58b3753.891bc8",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 922,
        "y": 342.99999141693115,
        "z": "67d8f5f.109b30c",
        "wires": [
            [
                "3cc5230a.5b2c3c"
            ]
        ]
    },
    {
        "id": "4d85b0fa.e45f4",
        "type": "set",
        "name": "set vf-index",
        "xml": "<set>\n<parameter name='vf-index' value='0' />\n",
        "comments": "",
        "x": 1064.5,
        "y": 302.99999141693115,
        "z": "67d8f5f.109b30c",
        "wires": []
    },
    {
        "id": "3cc5230a.5b2c3c",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 1066.3570442199707,
        "y": 342.93650341033936,
        "z": "67d8f5f.109b30c",
        "wires": [
            [
                "1560cc74.e1f714",
                "105e52c3.2d94dd"
            ]
        ]
    },
    {
        "id": "105e52c3.2d94dd",
        "type": "set",
        "name": "set vf-index",
        "xml": "<set>\n<parameter name='vf-index' value='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length`' />\n\n\n",
        "comments": "",
        "x": 1219.055519104004,
        "y": 312.5556021030061,
        "z": "67d8f5f.109b30c",
        "wires": []
    },
    {
        "id": "1560cc74.e1f714",
        "type": "for",
        "name": "for each existing vf-index",
        "xml": "<for index='idx' start='0' end='`$vf-index`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 1275.4840240478516,
        "y": 365.7777318954468,
        "z": "67d8f5f.109b30c",
        "wires": [
            [
                "e9396ecf.61386"
            ]
        ]
    },
    {
        "id": "9bfcdd3d.e8854",
        "type": "comment",
        "name": "make sure this network doesn't exist already",
        "info": "",
        "comments": "",
        "x": 1499.1347541809082,
        "y": 324.0317893028259,
        "z": "67d8f5f.109b30c",
        "wires": []
    },
    {
        "id": "e9396ecf.61386",
        "type": "switchNode",
        "name": "switch vf-module-id found",
        "xml": "<switch test=\"`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$idx].vf-module-id == $vf-module-topology-operation-input.vf-module-information.vf-module-id`\">\n",
        "comments": "",
        "outputs": 1,
        "x": 1550.7697448730469,
        "y": 365.34923458099365,
        "z": "67d8f5f.109b30c",
        "wires": [
            [
                "7c76b41d.ea06ac"
            ]
        ]
    },
    {
        "id": "7c76b41d.ea06ac",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1451.499942779541,
        "y": 423.9206657409668,
        "z": "67d8f5f.109b30c",
        "wires": [
            [
                "91b09a0a.6c6428"
            ]
        ]
    },
    {
        "id": "91b09a0a.6c6428",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$idx].vf-module-id already found in service-data\" />\n",
        "comments": "",
        "x": 1599.2500457763672,
        "y": 423.7778578097932,
        "z": "67d8f5f.109b30c",
        "wires": []
    },
    {
        "id": "35a34bb1.948374",
        "type": "set",
        "name": "copy input data to service data",
        "xml": "<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-id' value='`$prop.device-vf-index`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.sdnc-request-header.' value='`$vf-module-topology-operation-input.sdnc-request-header.`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.request-information.' value='`$vf-module-topology-operation-input.request-information.`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.service-information.' value='`$vf-module-topology-operation-input.service-information.`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.vnf-information.' value='`$vf-module-topology-operation-input.vnf-information.`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.vf-module-information.' value='`$vf-module-topology-operation-input.vf-module-information.`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.vf-module-request-input.' value='`$vf-module-topology-operation-input.vf-module-request-input.`' />\n\n<!--parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.vf-module-topology.' value='`$tmp.vf-module-topology.`' /-->\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length' value='`$vf-index+1`' />\n\n",
        "comments": "",
        "x": 702.8531951904297,
        "y": 753.496214389801,
        "z": "67d8f5f.109b30c",
        "wires": []
    },
    {
        "id": "f27c9cac.ebc18",
        "type": "execute",
        "name": "execute generate-vf-module-index",
        "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='generateUUID' >\n<parameter name=\"ctx-destination\" value=\"prop.device-vf-index\"/>\n",
        "comments": "",
        "outputs": 1,
        "x": 711.1866912841797,
        "y": 700.162947177887,
        "z": "67d8f5f.109b30c",
        "wires": [
            []
        ]
    },
    {
        "id": "b9b958fd.141f08",
        "type": "set",
        "name": "set new vf-module_length",
        "xml": "<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length' value='`$vf-index + 1`' />",
        "comments": "",
        "x": 685.1866683959961,
        "y": 646.1628408432007,
        "z": "67d8f5f.109b30c",
        "wires": []
    },
    {
        "id": "a8f9e83.8a6e918",
        "type": "set",
        "name": "set vf-module-request-input.",
        "xml": "<set>\n<parameter name='vf-module-request-input.' value='`$vf-module-topology-operation-input.vf-module-request-input.`' />\n",
        "comments": "",
        "x": 700.1863288879395,
        "y": 536.154221534729,
        "z": "67d8f5f.109b30c",
        "wires": []
    },
    {
        "id": "c8a186f7.659098",
        "type": "call",
        "name": "call sdwan-get-vf-module-device-param",
        "xml": "<call module='GENERIC-RESOURCE-API' rpc='sdwan-get-vf-module-device-param' mode='sync' >\n",
        "comments": "",
        "outputs": 1,
        "x": 726.1867065429688,
        "y": 592.1544551849365,
        "z": "67d8f5f.109b30c",
        "wires": [
            []
        ]
    },
    {
        "id": "178a7bac.307b74",
        "type": "set",
        "name": "set vf-module-object-path",
        "xml": "<set>\n<parameter name='vf-module-object-path' value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $vf-module-topology-operation-input.service-information.service-instance-id\n + '/service-data/vnfs/vnf/'\n + $service-data.vnfs.vnf[$vnf-index].vnf-id\n + '/vnf-data/vf-modules/vf-module/'\n + $prop.device-vf-index\n + '/vf-module-data/vf-module-topology/'`\"/>\n<parameter name='vnf-object-path'\n value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $vf-module-topology-operation-input.service-information.service-instance-id\n + '/service-data/vnfs/vnf/'\n + $service-data.vnfs.vnf[$vnf-index].vnf-id\n + '/vnf-data/vnf-topology/'`\"/>\n<parameter name='service-object-path'\n value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $vf-module-topology-operation-input.service-information.service-instance-id\n + '/service-data/service-topology/'`\"/>\n",
        "comments": "",
        "x": 698.0000877380371,
        "y": 804.0000596046448,
        "z": "67d8f5f.109b30c",
        "wires": []
    },
    {
        "id": "7fbeb541.aa905c",
        "type": "set",
        "name": "set vf-module-level-oper-status",
        "xml": "<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.vf-module-level-oper-status.order-status'  value='Created' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.vf-module-level-oper-status.last-rpc-action'  value='`$vf-module-topology-operation-input.sdnc-request-header.svc-action`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.vf-module-level-oper-status.last-action'  value='`$vf-module-topology-operation-input.sdnc-request-header.request-action`' />\n",
        "comments": "",
        "x": 705.5001907348633,
        "y": 852.0000238418579,
        "z": "67d8f5f.109b30c",
        "wires": []
    },
    {
        "id": "e8cf2ce.61834d",
        "type": "save",
        "name": "save sdwan vpn resource in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='device' \n      key='device.device-id = $prop.device-vf-index' >\n<parameter name='device-id' value='`$prop.device-vf-index`' />\n<parameter name='esn' value='`$prop.device.esn`' />\n<parameter name='device-name' value='`$prop.device.name`' />\n<parameter name='description' value='`$prop.device.description`' />\n<parameter name='vendor' value='`$prop.device.vendor`' />\n<parameter name='class' value='`$prop.device.class`' />\n<parameter name='type' value='`$prop.device.deviceModel`' />\n<parameter name='version' value='`$prop.device.version`' />\n<parameter name='system-ip' value='`$prop.device.systemIp`' />\n<parameter name='operational-status' value='Created' />\n<parameter name='model-customization-id' value='`$vf-module-topology-operation-input.vf-module-information.onap-model-information.model-customization-uuid`' />\n<parameter name='model-invariant-id' value='`$vf-module-topology-operation-input.vf-module-information.onap-model-information.model-invariant-uuid`' />\n<parameter name='model-version-id' value='`$vf-module-topology-operation-input.vf-module-information.onap-model-information.model-version`' />\n<parameter name='selflink' value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'  + $vf-module-topology-operation-input.service-information.service-instance-id  + '/service-data/vnfs/vnf/'  + $service-data.vnfs.vnf[$vnf-index].vnf-id  + '/vnf-data/vf-modules/vf-module/' + $prop.device-vf-index + '/vf-module-data/'` \" />\n",
        "comments": "",
        "outputs": 1,
        "x": 713.0001373291016,
        "y": 910.4999666213989,
        "z": "67d8f5f.109b30c",
        "wires": [
            []
        ]
    },
    {
        "id": "d9a88b51.5c3ff8",
        "type": "save",
        "name": "save service relationship in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='generic-vnf:relationship-list' \n      key='generic-vnf.vnf-id = $service-data.vnfs.vnf[$vnf-index].vnf-id' \n      force=\"true\" pfx=\"tmp.AnAI-data\">\n<parameter name=\"relationship-list.relationship[0].related-to\" value=\"device\" />\n<parameter name=\"relationship-list.relationship[0].related-link\" value=\"`'/network/devices/device/' + $prop.device-vf-index`\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"device.device-id\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$prop.device-vf-index`\" />\n\n",
        "comments": "",
        "outputs": 1,
        "x": 708.9999847412109,
        "y": 945.5000228881836,
        "z": "67d8f5f.109b30c",
        "wires": [
            []
        ]
    },
    {
        "id": "4845313f.7a00d",
        "type": "returnSuccess",
        "name": "return success",
        "xml": "<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n",
        "comments": "",
        "x": 657.7225151062012,
        "y": 991.6738657951355,
        "z": "67d8f5f.109b30c",
        "wires": []
    },
    {
        "id": "b5bea2af.4d20d",
        "type": "comment",
        "name": "TODO: if SO passes vnf-id, need to update prop.sdncCreate as true",
        "info": "if SO passes vnf-id, need to update prop.sdncCreate as true",
        "comments": "",
        "x": 806.6974792480469,
        "y": 141.0160083770752,
        "z": "67d8f5f.109b30c",
        "wires": []
    }
]