[
    {
        "id": "5de743a6.6e9fdc",
        "type": "service-logic",
        "name": "GENERIC-RESOURCE-API ${project.version}",
        "module": "GENERIC-RESOURCE-API",
        "version": "${project.version}",
        "comments": "",
        "xml": "<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>",
        "outputs": 1,
        "x": 292.03125,
        "y": 127.03125,
        "z": "56fc6b1a.95dca4",
        "wires": [
            [
                "831852f4.73c97"
            ]
        ]
    },
    {
        "id": "831852f4.73c97",
        "type": "method",
        "name": "sdwan-vf-operation-wanport-create",
        "xml": "<method rpc='sdwan-vf-operation-wanport-create' mode='sync'>\n",
        "comments": "",
        "outputs": 1,
        "x": 291.03125,
        "y": 227.03125,
        "z": "56fc6b1a.95dca4",
        "wires": [
            [
                "f0bca81d.b6a0f8"
            ]
        ]
    },
    {
        "id": "8410a95b.8b6678",
        "type": "dgstart",
        "name": "DGSTART",
        "outputs": 1,
        "x": 148.53124618530273,
        "y": 36.03125762939453,
        "z": "56fc6b1a.95dca4",
        "wires": [
            [
                "5de743a6.6e9fdc"
            ]
        ]
    },
    {
        "id": "f0bca81d.b6a0f8",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 450.03123474121094,
        "y": 343.03125858306885,
        "z": "56fc6b1a.95dca4",
        "wires": [
            [
                "54bfa066.4da69",
                "1eb4450c.b37a3b",
                "ff1f4bbb.9c88d8",
                "262e8a6c.764e06",
                "1438dd60.41b403",
                "fa6eaef6.2d96",
                "fdda37d.d3044c8",
                "9b9a9c47.ff729",
                "89e460e0.31c23",
                "cf5e55a3.da5e38",
                "3ce6fee1.f7c372",
                "37eaec79.c59c14",
                "981dfc9a.eb48b",
                "461f9f03.a33d2"
            ]
        ]
    },
    {
        "id": "54bfa066.4da69",
        "type": "for",
        "name": "for each vnf",
        "xml": "<for index='idx' start='0' end='`$service-data.vnfs.vnf_length`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 750.3606567382812,
        "y": 234.52738285064697,
        "z": "56fc6b1a.95dca4",
        "wires": [
            [
                "53ca6ad5.693354"
            ]
        ]
    },
    {
        "id": "53ca6ad5.693354",
        "type": "switchNode",
        "name": "switch this vnf-id == input vnf-id",
        "xml": "<switch test=\"`$service-data.vnfs.vnf[$idx].vnf-id == $vf-module-topology-operation-input.vnf-information.vnf-id`\">    \n",
        "comments": "",
        "outputs": 1,
        "x": 1002.3607482910156,
        "y": 233.1940460205078,
        "z": "56fc6b1a.95dca4",
        "wires": [
            [
                "3af25422.f8b80c"
            ]
        ]
    },
    {
        "id": "61e228fb.8092e8",
        "type": "set",
        "name": "set vnf-index",
        "xml": "<set>\n<parameter name='vnf-index' value='`$idx`' />\n",
        "comments": "",
        "x": 1374.0272369384766,
        "y": 235.19404888153076,
        "z": "56fc6b1a.95dca4",
        "wires": []
    },
    {
        "id": "3af25422.f8b80c",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1220.6940650939941,
        "y": 235.1940279006958,
        "z": "56fc6b1a.95dca4",
        "wires": [
            [
                "61e228fb.8092e8"
            ]
        ]
    },
    {
        "id": "262e8a6c.764e06",
        "type": "for",
        "name": "for loop idx - VF input parameters",
        "xml": "<for index=\"idx\" start=\"0\" end=\"`$vf-module-topology-operation-input.vf-module-request-input.vf-module-input-parameters.param_length`\">\n\n",
        "comments": "",
        "outputs": 1,
        "x": 824.2814407348633,
        "y": 456.6979160308838,
        "z": "56fc6b1a.95dca4",
        "wires": [
            [
                "6641b8fa.11e218"
            ]
        ]
    },
    {
        "id": "6641b8fa.11e218",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 1039.0597839355469,
        "y": 454.2534999847412,
        "z": "56fc6b1a.95dca4",
        "wires": [
            [
                "4c2187d7.70c4d8",
                "32a53869.510578"
            ]
        ]
    },
    {
        "id": "4c2187d7.70c4d8",
        "type": "execute",
        "name": "execute split parameterName",
        "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='split' >\n<parameter name=\"original_string\" value='`$vf-module-topology-operation-input.vf-module-request-input.vf-module-input-parameters.param[$idx].name`'/>\n<parameter name=\"regex\" value=\"_\"/>\n<parameter name=\"ctx_memory_result_key\" value=\"param-prefix\"/>\n",
        "comments": "",
        "outputs": 1,
        "x": 1235.3159866333008,
        "y": 432.0016384124756,
        "z": "56fc6b1a.95dca4",
        "wires": [
            []
        ]
    },
    {
        "id": "32a53869.510578",
        "type": "set",
        "name": "set parameterName",
        "xml": "<set>\n<parameter name=\"`vf-module-topology-operation-input.vf-module-request-input.vf-module-input-parameters.param[$idx].name`\" value='`$param-prefix[$param-prefix_length -1]`'/>\n",
        "comments": "",
        "x": 1204.7604141235352,
        "y": 469.0017547607422,
        "z": "56fc6b1a.95dca4",
        "wires": []
    },
    {
        "id": "ab557068.64844",
        "type": "comment",
        "name": "Take the parameter names by removing prefix",
        "info": "",
        "comments": "",
        "x": 1208.2816429138184,
        "y": 391.36458444595337,
        "z": "56fc6b1a.95dca4",
        "wires": []
    },
    {
        "id": "1eb4450c.b37a3b",
        "type": "switchNode",
        "name": "switch vnf_length",
        "xml": "<switch test='`$service-data.vnfs.vnf_length`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 764.78125,
        "y": 190.03125190734863,
        "z": "56fc6b1a.95dca4",
        "wires": [
            [
                "e279b1ab.b937f"
            ]
        ]
    },
    {
        "id": "e279b1ab.b937f",
        "type": "other",
        "name": "NULL",
        "xml": "<outcome value=''>\n",
        "comments": "",
        "outputs": 1,
        "x": 951.4479293823242,
        "y": 189.36454963684082,
        "z": "56fc6b1a.95dca4",
        "wires": [
            [
                "c52a39f4.c6da18"
            ]
        ]
    },
    {
        "id": "c52a39f4.c6da18",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"404\" />\n    <parameter name=\"error-message\" value=\"There are no VNFs in MD-SAL\" />\n",
        "comments": "",
        "x": 1133.1145553588867,
        "y": 189.36454963684082,
        "z": "56fc6b1a.95dca4",
        "wires": []
    },
    {
        "id": "ff1f4bbb.9c88d8",
        "type": "switchNode",
        "name": "switch vf-modules.vf-module_length",
        "xml": "<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 806.0312395095825,
        "y": 310.03125286102295,
        "z": "56fc6b1a.95dca4",
        "wires": [
            [
                "cd7442d9.34306",
                "6d930136.d20cb"
            ]
        ]
    },
    {
        "id": "cd7442d9.34306",
        "type": "other",
        "name": "Null",
        "xml": "<outcome value=''>\n",
        "comments": "",
        "outputs": 1,
        "x": 1037.03125,
        "y": 286.03125,
        "z": "56fc6b1a.95dca4",
        "wires": [
            [
                "c51e25a8.593288"
            ]
        ]
    },
    {
        "id": "6d930136.d20cb",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1037.03125,
        "y": 326.03125,
        "z": "56fc6b1a.95dca4",
        "wires": [
            [
                "8a36da98.f826b8"
            ]
        ]
    },
    {
        "id": "c51e25a8.593288",
        "type": "set",
        "name": "set vf-index",
        "xml": "<set>\n<parameter name='vf-index' value='0' />\n",
        "comments": "",
        "x": 1179.53125,
        "y": 286.03125,
        "z": "56fc6b1a.95dca4",
        "wires": []
    },
    {
        "id": "8a36da98.f826b8",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 1181.3882942199707,
        "y": 325.9677619934082,
        "z": "56fc6b1a.95dca4",
        "wires": [
            [
                "26e4ea27.208ad6",
                "44db3104.e81c6"
            ]
        ]
    },
    {
        "id": "44db3104.e81c6",
        "type": "set",
        "name": "set vf-index",
        "xml": "<set>\n<parameter name='vf-index' value='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length`' />\n\n\n",
        "comments": "",
        "x": 1334.086769104004,
        "y": 295.58686068607494,
        "z": "56fc6b1a.95dca4",
        "wires": []
    },
    {
        "id": "26e4ea27.208ad6",
        "type": "for",
        "name": "for each existing vf-index",
        "xml": "<for index='idx' start='0' end='`$vf-index`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 1390.5152740478516,
        "y": 348.8089904785156,
        "z": "56fc6b1a.95dca4",
        "wires": [
            [
                "3b7c03ef.0af89c"
            ]
        ]
    },
    {
        "id": "5b9f74ec.1882ec",
        "type": "comment",
        "name": "make sure this network doesn't exist already",
        "info": "",
        "comments": "",
        "x": 1614.1660041809082,
        "y": 307.0630478858948,
        "z": "56fc6b1a.95dca4",
        "wires": []
    },
    {
        "id": "3b7c03ef.0af89c",
        "type": "switchNode",
        "name": "switch vf-module-id found",
        "xml": "<switch test=\"`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$idx].vf-module-id == $vf-module-topology-operation-input.vf-module-information.vf-module-id`\">\n",
        "comments": "",
        "outputs": 1,
        "x": 1665.8009948730469,
        "y": 348.3804931640625,
        "z": "56fc6b1a.95dca4",
        "wires": [
            [
                "84bba4b1.816e38"
            ]
        ]
    },
    {
        "id": "84bba4b1.816e38",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1566.531192779541,
        "y": 406.95192432403564,
        "z": "56fc6b1a.95dca4",
        "wires": [
            [
                "4d582e07.7c7a1"
            ]
        ]
    },
    {
        "id": "4d582e07.7c7a1",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$idx].vf-module-id already found in service-data\" />\n",
        "comments": "",
        "x": 1714.2812957763672,
        "y": 406.80911639286205,
        "z": "56fc6b1a.95dca4",
        "wires": []
    },
    {
        "id": "9b9a9c47.ff729",
        "type": "set",
        "name": "copy input data to service data",
        "xml": "<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-id' value='`$prop.wan-port-vf-index`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.sdnc-request-header.' value='`$vf-module-topology-operation-input.sdnc-request-header.`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.request-information.' value='`$vf-module-topology-operation-input.request-information.`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.service-information.' value='`$vf-module-topology-operation-input.service-information.`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.vnf-information.' value='`$vf-module-topology-operation-input.vnf-information.`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.vf-module-information.' value='`$vf-module-topology-operation-input.vf-module-information.`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.vf-module-request-input.' value='`$vf-module-topology-operation-input.vf-module-request-input.`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.vf-module-topology.' value='`$tmp.vf-module-topology.`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length' value='`$vf-index+1`' />\n",
        "comments": "",
        "x": 821.8844604492188,
        "y": 730.527437210083,
        "z": "56fc6b1a.95dca4",
        "wires": []
    },
    {
        "id": "fdda37d.d3044c8",
        "type": "execute",
        "name": "execute generate-vf-module-index",
        "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='generateUUID' >\n<parameter name=\"ctx-destination\" value=\"prop.wan-port-vf-index\"/>\n",
        "comments": "",
        "outputs": 1,
        "x": 831.2179641723633,
        "y": 682.1941680908203,
        "z": "56fc6b1a.95dca4",
        "wires": [
            []
        ]
    },
    {
        "id": "fa6eaef6.2d96",
        "type": "set",
        "name": "set new vf-module_length",
        "xml": "<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length' value='`$vf-index + 1`' />",
        "comments": "",
        "x": 803.2179107666016,
        "y": 629.1941051483154,
        "z": "56fc6b1a.95dca4",
        "wires": []
    },
    {
        "id": "1438dd60.41b403",
        "type": "set",
        "name": "set vf-module-request-input.",
        "xml": "<set>\n<parameter name='vf-module-request-input.' value='`$vf-module-topology-operation-input.vf-module-request-input.`' />\n",
        "comments": "",
        "x": 815.2175788879395,
        "y": 519.1854801177979,
        "z": "56fc6b1a.95dca4",
        "wires": []
    },
    {
        "id": "89e460e0.31c23",
        "type": "set",
        "name": "set vf-module-object-path",
        "xml": "<set>\n<parameter name='vf-module-id' value='`$prop.wan-port-vf-index`' />\n<parameter name='vf-module-object-path' value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $vf-module-topology-operation-input.service-information.service-instance-id\n + '/service-data/vnfs/vnf/'\n + $service-data.vnfs.vnf[$vnf-index].vnf-id\n + '/vnf-data/vf-modules/vf-module/'\n + $prop.wan-port-vf-index\n + '/vf-module-data/vf-module-topology/'`\"/>\n<parameter name='vnf-object-path'\n value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $vf-module-topology-operation-input.service-information.service-instance-id\n + '/service-data/vnfs/vnf/'\n + $service-data.vnfs.vnf[$vnf-index].vnf-id\n + '/vnf-data/vnf-topology/'`\"/>\n<parameter name='service-object-path'\n value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $vf-module-topology-operation-input.service-information.service-instance-id\n + '/service-data/service-topology/'`\"/>\n",
        "comments": "",
        "x": 807.0313243865967,
        "y": 788.0312948226929,
        "z": "56fc6b1a.95dca4",
        "wires": []
    },
    {
        "id": "cf5e55a3.da5e38",
        "type": "set",
        "name": "set vf-module-level-oper-status",
        "xml": "<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.vf-module-level-oper-status.order-status'  value='Created' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.vf-module-level-oper-status.last-rpc-action'  value='`$vf-module-topology-operation-input.sdnc-request-header.svc-action`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.vf-module-level-oper-status.last-action'  value='`$vf-module-topology-operation-input.sdnc-request-header.request-action`' />",
        "comments": "",
        "x": 821.5313835144043,
        "y": 838.0311880111694,
        "z": "56fc6b1a.95dca4",
        "wires": []
    },
    {
        "id": "981dfc9a.eb48b",
        "type": "save",
        "name": "save sdwan vpn resource in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='wan-port-config' \n      key='wan-port-config.wan-port-config-id = $prop.wan-port-vf-index' >\n<parameter name=\"wan-port-config-id\" value=\"`$prop.wan-port-vf-index`\" />\n<parameter name=\"wan-port-config-name\" value=\"`$prop.wan.name`\" />\n<parameter name=\"device-id\" value=\"`$prop.wan.deviceName`\" />\n<parameter name='vlan-id' value=\"`$prop.wan.vlanId`\" />\n<parameter name=\"ip-address\" value=\"`$prop.wan.ipAddress`\" />\n<parameter name=\"provider-ip-address\" value=\"`$prop.wan.providerIpAddress`\" />\n<parameter name=\"input-bandwidth\" value=\"`$prop.wan.inputBandwidth`\" />\n<parameter name=\"output-bandwidth\" value=\"`$prop.wan.outputBandwidth`\" />\n<parameter name=\"description\" value=\"`$prop.wan.description`\" />\n<parameter name=\"port-type\" value=\"`$prop.wan.portType`\" />\n<parameter name=\"port-number\" value=\"`$prop.wan.portNumber`\" />\n<parameter name=\"transport-network-name\" value=\"`$prop.wan.transportNetworkName`\" />\n<parameter name='operational-status' value='Created' />\n<parameter name='model-customization-id' value='`$vf-module-topology-operation-input.vf-module-information.onap-model-information.model-customization-uuid`' />\n<parameter name='model-invariant-id' value='`$vf-module-topology-operation-input.vf-module-information.onap-model-information.model-invariant-uuid`' />\n<parameter name='model-version-id' value='`$vf-module-topology-operation-input.vf-module-information.onap-model-information.model-version`' />\n<parameter name='selflink' value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'  + $vf-module-topology-operation-input.service-information.service-instance-id  + '/service-data/vnfs/vnf/'  + $service-data.vnfs.vnf[$vnf-index].vnf-id  + '/vnf-data/vf-modules/vf-module/' + $prop.wan-port-vf-index + '/vf-module-data/'` \" />\n",
        "comments": "",
        "outputs": 1,
        "x": 825.0312919616699,
        "y": 881.5312337875366,
        "z": "56fc6b1a.95dca4",
        "wires": [
            []
        ]
    },
    {
        "id": "461f9f03.a33d2",
        "type": "save",
        "name": "save service relationship in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='generic-vnf:relationship-list' \n      key='generic-vnf.vnf-id = $service-data.vnfs.vnf[$vnf-index].vnf-id' \n      force=\"true\" pfx=\"tmp.AnAI-data\">\n<parameter name=\"relationship-list.relationship[0].related-to\" value=\"wan-port-config\" />\n<parameter name=\"relationship-list.relationship[0].related-link\" value=\"`'/network/wan-port-configs/wan-port-config/' + $prop.wan-port-vf-index`\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"wan-port-config.wan-port-config-id\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$prop.wan-port-vf-index`\" />\n",
        "comments": "",
        "outputs": 1,
        "x": 822.0312194824219,
        "y": 927.5312652587891,
        "z": "56fc6b1a.95dca4",
        "wires": [
            []
        ]
    },
    {
        "id": "3ce6fee1.f7c372",
        "type": "returnSuccess",
        "name": "return success",
        "xml": "<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n",
        "comments": "",
        "x": 772.7537651062012,
        "y": 974.7051243782043,
        "z": "56fc6b1a.95dca4",
        "wires": []
    },
    {
        "id": "37eaec79.c59c14",
        "type": "call",
        "name": "call sdwan-get-wan-param",
        "xml": "<call module='GENERIC-RESOURCE-API' rpc='sdwan-get-wan-param' mode='sync' >\n",
        "comments": "",
        "outputs": 1,
        "x": 814.9201202392578,
        "y": 581.9201335906982,
        "z": "56fc6b1a.95dca4",
        "wires": [
            []
        ]
    }
]