[
    {
        "id": "46f43033.b08aa",
        "type": "service-logic",
        "name": "GENERIC-RESOURCE-API ${project.version}",
        "module": "GENERIC-RESOURCE-API",
        "version": "${project.version}",
        "comments": "",
        "xml": "<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>",
        "outputs": 1,
        "x": 242.50000762939453,
        "y": 162.9999942779541,
        "z": "51dfaac9.123bf4",
        "wires": [
            [
                "2a1aba7b.383b46"
            ]
        ]
    },
    {
        "id": "2a1aba7b.383b46",
        "type": "method",
        "name": "sdwan-vf-operation-wanport-create",
        "xml": "<method rpc='sdwan-vf-operation-wanport-create' mode='sync'>\n",
        "comments": "",
        "outputs": 1,
        "x": 241.50000762939453,
        "y": 262.9999942779541,
        "z": "51dfaac9.123bf4",
        "wires": [
            [
                "82dd2bc8.a243d8"
            ]
        ]
    },
    {
        "id": "4cd53241.2a47ac",
        "type": "dgstart",
        "name": "DGSTART",
        "outputs": 1,
        "x": 99.00000381469727,
        "y": 72.00000190734863,
        "z": "51dfaac9.123bf4",
        "wires": [
            [
                "46f43033.b08aa"
            ]
        ]
    },
    {
        "id": "82dd2bc8.a243d8",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 400.49999237060547,
        "y": 379.00000286102295,
        "z": "51dfaac9.123bf4",
        "wires": [
            [
                "c6522e10.ee4f4",
                "b69f2dbb.b245a",
                "70da8c81.de18b4",
                "28a76507.6ef48a",
                "828b96f5.1728b8",
                "f4db3790.b1da98",
                "c1c0712.3f07c9",
                "30947429.22145c",
                "d7de3343.45742",
                "61b5706a.60491",
                "614ea376.a81a9c",
                "88bb68a0.dfbe88",
                "638be1ac.5e677",
                "b9c19b78.4455c8",
                "a12303d8.4742d"
            ]
        ]
    },
    {
        "id": "c6522e10.ee4f4",
        "type": "for",
        "name": "for each vnf",
        "xml": "<for index='idx' start='0' end='`$service-data.vnfs.vnf_length`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 700.8294143676758,
        "y": 270.4961271286011,
        "z": "51dfaac9.123bf4",
        "wires": [
            [
                "bd4f89f3.c40d28"
            ]
        ]
    },
    {
        "id": "bd4f89f3.c40d28",
        "type": "switchNode",
        "name": "switch this vnf-id == input vnf-id",
        "xml": "<switch test=\"`$service-data.vnfs.vnf[$idx].vnf-id == $vf-module-topology-operation-input.vnf-information.vnf-id`\">    \n",
        "comments": "",
        "outputs": 1,
        "x": 952.8295059204102,
        "y": 269.1627902984619,
        "z": "51dfaac9.123bf4",
        "wires": [
            [
                "4b47b82d.fb6c88"
            ]
        ]
    },
    {
        "id": "e0ab4537.8d1398",
        "type": "set",
        "name": "set vnf-index",
        "xml": "<set>\n<parameter name='vnf-index' value='`$idx`' />\n",
        "comments": "",
        "x": 1324.495994567871,
        "y": 271.16279315948486,
        "z": "51dfaac9.123bf4",
        "wires": []
    },
    {
        "id": "4b47b82d.fb6c88",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1171.1628227233887,
        "y": 271.1627721786499,
        "z": "51dfaac9.123bf4",
        "wires": [
            [
                "e0ab4537.8d1398"
            ]
        ]
    },
    {
        "id": "28a76507.6ef48a",
        "type": "for",
        "name": "for loop idx - VF input parameters",
        "xml": "<for index=\"idx\" start=\"0\" end=\"`$vf-module-topology-operation-input.vf-module-request-input.vf-module-input-parameters.param_length`\">\n\n",
        "comments": "",
        "outputs": 1,
        "x": 774.7501983642578,
        "y": 492.6666603088379,
        "z": "51dfaac9.123bf4",
        "wires": [
            [
                "877963c9.aba4d"
            ]
        ]
    },
    {
        "id": "877963c9.aba4d",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 989.5285415649414,
        "y": 490.2222442626953,
        "z": "51dfaac9.123bf4",
        "wires": [
            [
                "49edbfcd.1defd",
                "d86fba2e.1d9328"
            ]
        ]
    },
    {
        "id": "49edbfcd.1defd",
        "type": "execute",
        "name": "execute split parameterName",
        "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='split' >\n<parameter name=\"original_string\" value='`$vf-module-topology-operation-input.vf-module-request-input.vf-module-input-parameters.param[$idx].name`'/>\n<parameter name=\"regex\" value=\"_\"/>\n<parameter name=\"ctx_memory_result_key\" value=\"param-prefix\"/>\n",
        "comments": "",
        "outputs": 1,
        "x": 1185.7847442626953,
        "y": 467.9703826904297,
        "z": "51dfaac9.123bf4",
        "wires": [
            []
        ]
    },
    {
        "id": "d86fba2e.1d9328",
        "type": "set",
        "name": "set parameterName",
        "xml": "<set>\n<parameter name=\"`vf-module-topology-operation-input.vf-module-request-input.vf-module-input-parameters.param[$idx].name`\" value='`$param-prefix[$param-prefix_length -1]`'/>\n",
        "comments": "",
        "x": 1155.2291717529297,
        "y": 504.9704990386963,
        "z": "51dfaac9.123bf4",
        "wires": []
    },
    {
        "id": "b344d045.d9f5d",
        "type": "comment",
        "name": "Take the parameter names by removing prefix",
        "info": "",
        "comments": "",
        "x": 1158.750400543213,
        "y": 427.33332872390747,
        "z": "51dfaac9.123bf4",
        "wires": []
    },
    {
        "id": "b69f2dbb.b245a",
        "type": "switchNode",
        "name": "switch vnf_length",
        "xml": "<switch test='`$service-data.vnfs.vnf_length`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 715.2500076293945,
        "y": 225.99999618530273,
        "z": "51dfaac9.123bf4",
        "wires": [
            [
                "a24ba20.f46586"
            ]
        ]
    },
    {
        "id": "a24ba20.f46586",
        "type": "other",
        "name": "NULL",
        "xml": "<outcome value=''>\n",
        "comments": "",
        "outputs": 1,
        "x": 901.9166870117188,
        "y": 225.33329391479492,
        "z": "51dfaac9.123bf4",
        "wires": [
            [
                "3a59570e.8ae488"
            ]
        ]
    },
    {
        "id": "3a59570e.8ae488",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"404\" />\n    <parameter name=\"error-message\" value=\"There are no VNFs in MD-SAL\" />\n",
        "comments": "",
        "x": 1083.5833129882812,
        "y": 225.33329391479492,
        "z": "51dfaac9.123bf4",
        "wires": []
    },
    {
        "id": "70da8c81.de18b4",
        "type": "switchNode",
        "name": "switch vf-modules.vf-module_length",
        "xml": "<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 756.499997138977,
        "y": 345.99999713897705,
        "z": "51dfaac9.123bf4",
        "wires": [
            [
                "68e53c45.649fe4",
                "2b815068.5257f"
            ]
        ]
    },
    {
        "id": "68e53c45.649fe4",
        "type": "other",
        "name": "Null",
        "xml": "<outcome value=''>\n",
        "comments": "",
        "outputs": 1,
        "x": 987.5000076293945,
        "y": 321.9999942779541,
        "z": "51dfaac9.123bf4",
        "wires": [
            [
                "ff3b6f78.bf0a5"
            ]
        ]
    },
    {
        "id": "2b815068.5257f",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 987.5000076293945,
        "y": 361.9999942779541,
        "z": "51dfaac9.123bf4",
        "wires": [
            [
                "1b35e9a0.0443d6"
            ]
        ]
    },
    {
        "id": "ff3b6f78.bf0a5",
        "type": "set",
        "name": "set vf-index",
        "xml": "<set>\n<parameter name='vf-index' value='0' />\n",
        "comments": "",
        "x": 1130.0000076293945,
        "y": 321.9999942779541,
        "z": "51dfaac9.123bf4",
        "wires": []
    },
    {
        "id": "1b35e9a0.0443d6",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 1131.8570518493652,
        "y": 361.9365062713623,
        "z": "51dfaac9.123bf4",
        "wires": [
            [
                "5f41df12.1ea44",
                "cccaae51.bbeab"
            ]
        ]
    },
    {
        "id": "cccaae51.bbeab",
        "type": "set",
        "name": "set vf-index",
        "xml": "<set>\n<parameter name='vf-index' value='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length`' />\n\n\n",
        "comments": "",
        "x": 1284.5555267333984,
        "y": 331.55560496402904,
        "z": "51dfaac9.123bf4",
        "wires": []
    },
    {
        "id": "5f41df12.1ea44",
        "type": "for",
        "name": "for each existing vf-index",
        "xml": "<for index='idx' start='0' end='`$vf-index`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 1340.984031677246,
        "y": 384.7777347564697,
        "z": "51dfaac9.123bf4",
        "wires": [
            [
                "645f7d2b.d1c994"
            ]
        ]
    },
    {
        "id": "ae85ce7a.6f68",
        "type": "comment",
        "name": "make sure this network doesn't exist already",
        "info": "",
        "comments": "",
        "x": 1564.6347618103027,
        "y": 343.0317921638489,
        "z": "51dfaac9.123bf4",
        "wires": []
    },
    {
        "id": "645f7d2b.d1c994",
        "type": "switchNode",
        "name": "switch vf-module-id found",
        "xml": "<switch test=\"`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$idx].vf-module-id == $vf-module-topology-operation-input.vf-module-information.vf-module-id`\">\n",
        "comments": "",
        "outputs": 1,
        "x": 1616.2697525024414,
        "y": 384.3492374420166,
        "z": "51dfaac9.123bf4",
        "wires": [
            [
                "909092b5.03f89"
            ]
        ]
    },
    {
        "id": "909092b5.03f89",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1516.9999504089355,
        "y": 442.92066860198975,
        "z": "51dfaac9.123bf4",
        "wires": [
            [
                "b42da082.103d1"
            ]
        ]
    },
    {
        "id": "b42da082.103d1",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$idx].vf-module-id already found in service-data\" />\n",
        "comments": "",
        "x": 1664.7500534057617,
        "y": 442.77786067081615,
        "z": "51dfaac9.123bf4",
        "wires": []
    },
    {
        "id": "30947429.22145c",
        "type": "set",
        "name": "copy input data to service data",
        "xml": "<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-id' value='`$prop.wan-port-vf-index`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.sdnc-request-header.' value='`$vf-module-topology-operation-input.sdnc-request-header.`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.request-information.' value='`$vf-module-topology-operation-input.request-information.`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.service-information.' value='`$vf-module-topology-operation-input.service-information.`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.vnf-information.' value='`$vf-module-topology-operation-input.vnf-information.`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.vf-module-information.' value='`$vf-module-topology-operation-input.vf-module-information.`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.vf-module-request-input.' value='`$vf-module-topology-operation-input.vf-module-request-input.`' />\n\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.vf-module-topology.' value='`$tmp.vf-module-topology.`' />\n\n",
        "comments": "",
        "x": 769.353157043457,
        "y": 772.4961929321289,
        "z": "51dfaac9.123bf4",
        "wires": []
    },
    {
        "id": "c1c0712.3f07c9",
        "type": "execute",
        "name": "execute generate-vf-module-index",
        "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='generateUUID' >\n<parameter name=\"ctx-destination\" value=\"prop.wan-port-vf-index\"/>\n",
        "comments": "",
        "outputs": 1,
        "x": 781.6867218017578,
        "y": 718.1629123687744,
        "z": "51dfaac9.123bf4",
        "wires": [
            []
        ]
    },
    {
        "id": "f4db3790.b1da98",
        "type": "set",
        "name": "set new vf-module_length",
        "xml": "<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length' value='`$vf-index + 1`' />",
        "comments": "",
        "x": 753.6866683959961,
        "y": 665.1628494262695,
        "z": "51dfaac9.123bf4",
        "wires": []
    },
    {
        "id": "828b96f5.1728b8",
        "type": "set",
        "name": "set vf-module-request-input.",
        "xml": "<set>\n<parameter name='vf-module-request-input.' value='`$vf-module-topology-operation-input.vf-module-request-input.`' />\n",
        "comments": "",
        "x": 765.686336517334,
        "y": 555.154224395752,
        "z": "51dfaac9.123bf4",
        "wires": []
    },
    {
        "id": "d7de3343.45742",
        "type": "set",
        "name": "set vf-module-object-path",
        "xml": "<set>\n<parameter name='vf-module-id' value='`$vf-module-topology-operation-input.vnf-information.vnf-id`' />    \n<parameter name='vf-module-object-path' value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $vf-module-topology-operation-input.service-information.service-instance-id\n + '/service-data/vnfs/vnf/'\n + $service-data.vnfs.vnf[$vnf-index].vnf-id\n + '/vnf-data/vf-modules/vf-module/'\n + $prop.wan-port-vf-index\n + '/vf-module-data/vf-module-topology/'`\"/>\n<parameter name='vnf-object-path'\n value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $vf-module-topology-operation-input.service-information.service-instance-id\n + '/service-data/vnfs/vnf/'\n + $service-data.vnfs.vnf[$vnf-index].vnf-id\n + '/vnf-data/vnf-topology/'`\"/>\n<parameter name='service-object-path'\n value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $vf-module-topology-operation-input.service-information.service-instance-id\n + '/service-data/service-topology/'`\"/>\n",
        "comments": "",
        "x": 754.5000534057617,
        "y": 854.0000581741333,
        "z": "51dfaac9.123bf4",
        "wires": []
    },
    {
        "id": "61b5706a.60491",
        "type": "set",
        "name": "set vf-module-level-oper-status",
        "xml": "<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.vf-module-level-oper-status.order-status'  value='Created' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.vf-module-level-oper-status.last-rpc-action'  value='`$vf-module-topology-operation-input.sdnc-request-header.svc-action`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.vf-module-level-oper-status.last-action'  value='`$vf-module-topology-operation-input.sdnc-request-header.request-action`' />",
        "comments": "",
        "x": 772.0001411437988,
        "y": 888.9999313354492,
        "z": "51dfaac9.123bf4",
        "wires": []
    },
    {
        "id": "638be1ac.5e677",
        "type": "save",
        "name": "save sdwan vpn resource in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='wan-port-config' \n      key='wan-port-config.wan-port-config-id = $prop.vnf-index' >\n<parameter name=\"wan-port-config-id\" value=\"`$prop.vnf-index`\" />\n<parameter name=\"wan-port-config-name\" value=\"`$prop.wan.name`\" />\n<parameter name=\"device-id\" value=\"`$prop.wan.deviceName`\" />\n<parameter name='vlan-id' value=\"`$prop.wan.vlanId`\" />\n<parameter name=\"ip-address\" value=\"`$prop.wan.ipAddress`\" />\n<parameter name=\"provider-ip-address\" value=\"`$prop.wan.providerIpAddress`\" />\n<parameter name=\"input-bandwidth\" value=\"`$prop.wan.inputBandwidth`\" />\n<parameter name=\"output-bandwidth\" value=\"`$prop.wan.outputBandwidth`\" />\n<parameter name=\"description\" value=\"`$prop.wan.description`\" />\n<parameter name=\"port-type\" value=\"`$prop.wan.portType`\" />\n<parameter name=\"port-number\" value=\"`$prop.wan.portNumber`\" />\n<parameter name=\"transport-network-name\" value=\"`$prop.wan.transportNetworkName`\" />\n<parameter name='operational-status' value='Created' />\n<parameter name='model-customization-id' value='`$vf-module-topology-operation-input.vf-module-information.onap-model-information.model-customization-uuid`' />\n<parameter name='model-invariant-id' value='`$vf-module-topology-operation-input.vf-module-information.onap-model-information.model-invariant-uuid`' />\n<parameter name='model-version-id' value='`$vf-module-topology-operation-input.vf-module-information.onap-model-information.model-version`' />\n<parameter name='selflink' value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'  + $vf-module-topology-operation-input.service-information.service-instance-id  + '/service-data/vnfs/vnf/'  + $service-data.vnfs.vnf[$vnf-index].vnf-id  + '/vnf-data/vf-modules/vf-module/' + $prop.wan-port-vf-index + '/vf-module-data/'` \" />\n",
        "comments": "",
        "outputs": 1,
        "x": 775.5000495910645,
        "y": 932.4999771118164,
        "z": "51dfaac9.123bf4",
        "wires": [
            []
        ]
    },
    {
        "id": "b9c19b78.4455c8",
        "type": "save",
        "name": "save service relationship in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='generic-vnf:relationship-list' \n      key='generic-vnf.vnf-id = $service-data.vnfs.vnf[$vnf-index].vnf-id' \n      force=\"true\" pfx=\"tmp.AnAI-data\">\n<parameter name=\"relationship-list.relationship[0].related-to\" value=\"wan-port-config\" />\n<parameter name=\"relationship-list.relationship[0].related-link\" value=\"`'/network/wan-port-configs/wan-port-config/' + $prop.wan-port-vf-index`\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"wan-port-config.wan-port-config-id\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$prop.wan-port-vf-index`\" />\n",
        "comments": "",
        "outputs": 1,
        "x": 772.4999771118164,
        "y": 978.5000085830688,
        "z": "51dfaac9.123bf4",
        "wires": [
            []
        ]
    },
    {
        "id": "614ea376.a81a9c",
        "type": "returnSuccess",
        "name": "return success",
        "xml": "<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n",
        "comments": "",
        "x": 723.2225227355957,
        "y": 1025.6738677024841,
        "z": "51dfaac9.123bf4",
        "wires": []
    },
    {
        "id": "88bb68a0.dfbe88",
        "type": "call",
        "name": "call sdwan-get-wan-param",
        "xml": "<call module='GENERIC-RESOURCE-API' rpc='sdwan-get-wan-param' mode='sync' >\n",
        "comments": "",
        "outputs": 1,
        "x": 765.3888778686523,
        "y": 617.8888778686523,
        "z": "51dfaac9.123bf4",
        "wires": [
            []
        ]
    },
    {
        "id": "a12303d8.4742d",
        "type": "set",
        "name": "set increment vf-module_length",
        "xml": "<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length' value='`$vf-index + 1`' />\n",
        "comments": "",
        "x": 766.0312728881836,
        "y": 814.0312480926514,
        "z": "51dfaac9.123bf4",
        "wires": []
    }
]