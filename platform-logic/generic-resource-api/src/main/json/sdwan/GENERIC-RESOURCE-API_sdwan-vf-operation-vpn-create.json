[
    {
        "id": "86705660.0abdc8",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 476.00390625,
        "y": 401.9999997615814,
        "z": "12e5b519.7c42cb",
        "wires": [
            [
                "33a55b62.a48504",
                "c9956259.20d27",
                "92e109fc.d487c8",
                "fa6a2af9.45d408",
                "96b8a138.b9de9",
                "1072d79c.c97df8",
                "7fb4c42e.fff1cc",
                "8252c529.c8dc08",
                "d1676675.1b3088",
                "80911d80.565f6",
                "f1c0f2fa.5d8e8",
                "69439d08.c30934",
                "a6352f7.5aa86d"
            ]
        ]
    },
    {
        "id": "4414eba1.be7024",
        "type": "service-logic",
        "name": "GENERIC-RESOURCE-API ${project.version}",
        "module": "GENERIC-RESOURCE-API",
        "version": "${project.version}",
        "comments": "",
        "xml": "<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>",
        "outputs": 1,
        "x": 318.00392150878906,
        "y": 185.99999117851257,
        "z": "12e5b519.7c42cb",
        "wires": [
            [
                "665e6349.0f20bc"
            ]
        ]
    },
    {
        "id": "665e6349.0f20bc",
        "type": "method",
        "name": "sdwan-vf-operation-vpn-create",
        "xml": "<method rpc='sdwan-vf-operation-vpn-create' mode='sync'>\n",
        "comments": "",
        "outputs": 1,
        "x": 317.00392150878906,
        "y": 285.9999911785126,
        "z": "12e5b519.7c42cb",
        "wires": [
            [
                "86705660.0abdc8"
            ]
        ]
    },
    {
        "id": "c5e65dcf.93a1d",
        "type": "dgstart",
        "name": "DGSTART",
        "outputs": 1,
        "x": 147.50392150878906,
        "y": 96.9999988079071,
        "z": "12e5b519.7c42cb",
        "wires": [
            [
                "4414eba1.be7024"
            ]
        ]
    },
    {
        "id": "c9956259.20d27",
        "type": "for",
        "name": "for loop idx - VF input parameters",
        "xml": "<for index=\"idx\" start=\"0\" end=\"`$vf-module-topology-operation-input.vf-module-request-input.vf-module-input-parameters.param_length`\">\n\n",
        "comments": "",
        "outputs": 1,
        "x": 851.2541379928589,
        "y": 410.66667890548706,
        "z": "12e5b519.7c42cb",
        "wires": [
            [
                "5f7e52d8.71003c"
            ]
        ]
    },
    {
        "id": "5f7e52d8.71003c",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 1066.0324811935425,
        "y": 408.2222628593445,
        "z": "12e5b519.7c42cb",
        "wires": [
            [
                "b5888647.1272c8",
                "f88a8224.ffbd4"
            ]
        ]
    },
    {
        "id": "b5888647.1272c8",
        "type": "execute",
        "name": "execute split parameterName",
        "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='split' >\n<parameter name=\"original_string\" value='`$vf-module-topology-operation-input.vf-module-request-input.vf-module-input-parameters.param[$idx].name`'/>\n<parameter name=\"regex\" value=\"_\"/>\n<parameter name=\"ctx_memory_result_key\" value=\"param-prefix\"/>\n",
        "comments": "",
        "outputs": 1,
        "x": 1262.2886838912964,
        "y": 385.97040128707886,
        "z": "12e5b519.7c42cb",
        "wires": [
            []
        ]
    },
    {
        "id": "f88a8224.ffbd4",
        "type": "set",
        "name": "set parameterName",
        "xml": "<set>\n<parameter name=\"`vf-module-topology-operation-input.vf-module-request-input.vf-module-input-parameters.param[$idx].name`\" value='`$param-prefix[$param-prefix_length -1]`'/>\n",
        "comments": "",
        "x": 1231.7331113815308,
        "y": 422.97051763534546,
        "z": "12e5b519.7c42cb",
        "wires": []
    },
    {
        "id": "84649b93.490df8",
        "type": "comment",
        "name": "Take the parameter names by removing prefix",
        "info": "",
        "comments": "",
        "x": 1235.254340171814,
        "y": 345.33334732055664,
        "z": "12e5b519.7c42cb",
        "wires": []
    },
    {
        "id": "33a55b62.a48504",
        "type": "switchNode",
        "name": "switch vf-modules.vf-module_length",
        "xml": "<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 833.0039367675781,
        "y": 264.0000157356262,
        "z": "12e5b519.7c42cb",
        "wires": [
            [
                "5e528a3d.403a94",
                "e1430919.889a48"
            ]
        ]
    },
    {
        "id": "5e528a3d.403a94",
        "type": "other",
        "name": "Null",
        "xml": "<outcome value=''>\n",
        "comments": "",
        "outputs": 1,
        "x": 1064.0039472579956,
        "y": 240.00001287460327,
        "z": "12e5b519.7c42cb",
        "wires": [
            [
                "d1fe70de.0d5a2"
            ]
        ]
    },
    {
        "id": "e1430919.889a48",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1064.0039472579956,
        "y": 280.00001287460327,
        "z": "12e5b519.7c42cb",
        "wires": [
            [
                "550ac6cc.1a43f8"
            ]
        ]
    },
    {
        "id": "d1fe70de.0d5a2",
        "type": "set",
        "name": "set vf-index",
        "xml": "<set>\n<parameter name='vf-index' value='0' />\n",
        "comments": "",
        "x": 1206.5039472579956,
        "y": 240.00001287460327,
        "z": "12e5b519.7c42cb",
        "wires": []
    },
    {
        "id": "550ac6cc.1a43f8",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 1208.3609914779663,
        "y": 279.9365248680115,
        "z": "12e5b519.7c42cb",
        "wires": [
            [
                "2b30e41b.b2df2c",
                "735539ef.d045e8"
            ]
        ]
    },
    {
        "id": "735539ef.d045e8",
        "type": "set",
        "name": "set vf-index",
        "xml": "<set>\n<parameter name='vf-index' value='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length`' />\n\n\n",
        "comments": "",
        "x": 1361.0594663619995,
        "y": 249.5556235606782,
        "z": "12e5b519.7c42cb",
        "wires": []
    },
    {
        "id": "2b30e41b.b2df2c",
        "type": "for",
        "name": "for each existing vf-index",
        "xml": "<for index='idx' start='0' end='`$vf-index`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 1417.4879713058472,
        "y": 302.7777533531189,
        "z": "12e5b519.7c42cb",
        "wires": [
            [
                "e7001097.30f29"
            ]
        ]
    },
    {
        "id": "87bb5bc0.359988",
        "type": "comment",
        "name": "make sure this network doesn't exist already",
        "info": "",
        "comments": "",
        "x": 1641.1387014389038,
        "y": 261.03181076049805,
        "z": "12e5b519.7c42cb",
        "wires": []
    },
    {
        "id": "e7001097.30f29",
        "type": "switchNode",
        "name": "switch vf-module-id found",
        "xml": "<switch test=\"`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$idx].vf-module-id == $vf-module-topology-operation-input.vf-module-information.vf-module-id`\">\n",
        "comments": "",
        "outputs": 1,
        "x": 1692.7736921310425,
        "y": 302.34925603866577,
        "z": "12e5b519.7c42cb",
        "wires": [
            [
                "c77c794f.c68788"
            ]
        ]
    },
    {
        "id": "c77c794f.c68788",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1593.5038900375366,
        "y": 360.9206871986389,
        "z": "12e5b519.7c42cb",
        "wires": [
            [
                "1ae23876.21a108"
            ]
        ]
    },
    {
        "id": "1ae23876.21a108",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$idx].vf-module-id already found in service-data\" />\n",
        "comments": "",
        "x": 1741.2539930343628,
        "y": 360.7778792674653,
        "z": "12e5b519.7c42cb",
        "wires": []
    },
    {
        "id": "1072d79c.c97df8",
        "type": "set",
        "name": "copy input data to service data",
        "xml": "<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-id' value='`$prop.vpn-vf-index`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.sdnc-request-header.' value='`$vf-module-topology-operation-input.sdnc-request-header.`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.request-information.' value='`$vf-module-topology-operation-input.request-information.`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.service-information.' value='`$vf-module-topology-operation-input.service-information.`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.vnf-information.' value='`$vf-module-topology-operation-input.vnf-information.`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.vf-module-information.' value='`$vf-module-topology-operation-input.vf-module-information.`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.vf-module-request-input.' value='`$vf-module-topology-operation-input.vf-module-request-input.`' />\n\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.vf-module-topology.' value='`$tmp.vf-module-topology.`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length' value='`$vf-index+1`' />\n\n\n",
        "comments": "",
        "x": 846.8571271896362,
        "y": 713.4962668418884,
        "z": "12e5b519.7c42cb",
        "wires": []
    },
    {
        "id": "96b8a138.b9de9",
        "type": "execute",
        "name": "execute generate-vf-module-index",
        "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='generateUUID' >\n<parameter name=\"ctx-destination\" value=\"prop.vpn-vf-index\"/>\n",
        "comments": "",
        "outputs": 1,
        "x": 858.1906995773315,
        "y": 666.1629691123962,
        "z": "12e5b519.7c42cb",
        "wires": [
            []
        ]
    },
    {
        "id": "fa6a2af9.45d408",
        "type": "set",
        "name": "set new vf-module_length",
        "xml": "<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length' value='`$vf-index + 1`' />",
        "comments": "",
        "x": 830.1907606124878,
        "y": 617.1629691123962,
        "z": "12e5b519.7c42cb",
        "wires": []
    },
    {
        "id": "92e109fc.d487c8",
        "type": "set",
        "name": "set vf-module-request-input.",
        "xml": "<set>\n<parameter name='vf-module-request-input.' value='`$vf-module-topology-operation-input.vf-module-request-input.`' />\n",
        "comments": "",
        "x": 830.1902875900269,
        "y": 563.1542572975159,
        "z": "12e5b519.7c42cb",
        "wires": []
    },
    {
        "id": "7fb4c42e.fff1cc",
        "type": "set",
        "name": "set vf-module-level-oper-status",
        "xml": "<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.vf-module-level-oper-status.order-status'  value='Created' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.vf-module-level-oper-status.last-rpc-action'  value='`$vf-module-topology-operation-input.sdnc-request-header.svc-action`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.vf-module-level-oper-status.last-action'  value='`$vf-module-topology-operation-input.sdnc-request-header.request-action`' />",
        "comments": "",
        "x": 840.5041151046753,
        "y": 811.000087916851,
        "z": "12e5b519.7c42cb",
        "wires": []
    },
    {
        "id": "69439d08.c30934",
        "type": "save",
        "name": "save sdwan vpn resource in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='sdwan-vpn' \n      key='sdwan-vpn.sdwan-vpn-id = $prop.vpn-vf-index' >\n<parameter name='sdwan-vpn-id' value='`$prop.vpn-vf-index`' />\n<parameter name='sdwan-vpn-name' value='`$prop.name`' />\n<parameter name='topology' value='`$prop.topology`' />\n<parameter name='operational-status' value='Created' />\n<!--parameter name='model-customization-id' value='`$vf-module-topology-operation-input.vf-module-information.onap-model-information.model-customization-uuid`' />\n<parameter name='model-invariant-id' value='`$vf-module-topology-operation-input.vf-module-information.onap-model-information.model-invariant-uuid`' />\n<parameter name='model-version-id' value='`$vf-module-topology-operation-input.vf-module-information.onap-model-information.model-version`' /-->\n<parameter name='selflink' value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'  + $vf-module-topology-operation-input.service-information.service-instance-id  + '/service-data/vnfs/vnf/'  + $service-data.vnfs.vnf[$vnf-index].vnf-id  + '/vnf-data/vf-modules/vf-module/' + $prop.vpn-vf-index + '/vf-module-data/'` \" />\n",
        "comments": "",
        "outputs": 1,
        "x": 847.0039758682251,
        "y": 856.5000357627869,
        "z": "12e5b519.7c42cb",
        "wires": [
            []
        ]
    },
    {
        "id": "8252c529.c8dc08",
        "type": "returnSuccess",
        "name": "return success",
        "xml": "<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n",
        "comments": "",
        "x": 794.7264490127563,
        "y": 949.6739263534546,
        "z": "12e5b519.7c42cb",
        "wires": []
    },
    {
        "id": "d1676675.1b3088",
        "type": "for",
        "name": "for loop i - Network input parameters",
        "xml": "<for index=\"idx\" start=\"0\" end=\"`$vf-module-topology-operation-input.vf-module-request-input.vf-module-input-parameters.param_length`\">\n",
        "comments": "",
        "outputs": 1,
        "x": 858.2578535079956,
        "y": 499.5039267539978,
        "z": "12e5b519.7c42cb",
        "wires": [
            [
                "63318660.a4e798"
            ]
        ]
    },
    {
        "id": "63318660.a4e798",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 1145.480731010437,
        "y": 499.7262406349182,
        "z": "12e5b519.7c42cb",
        "wires": [
            [
                "1e3ec759.b2be29",
                "bfacfb85.875b78"
            ]
        ]
    },
    {
        "id": "1e3ec759.b2be29",
        "type": "switchNode",
        "name": "switch name",
        "xml": "<switch test=\"`$vf-module-topology-operation-input.vf-module-request-input.vf-module-input-parameters.param[$idx].name == 'name'`\">\n\n",
        "comments": "",
        "outputs": 1,
        "x": 1333.7025747299194,
        "y": 482.05954480171204,
        "z": "12e5b519.7c42cb",
        "wires": [
            [
                "4c3c07dc.109bb8"
            ]
        ]
    },
    {
        "id": "bfacfb85.875b78",
        "type": "switchNode",
        "name": "switch topology",
        "xml": "<switch test=\"`$vf-module-topology-operation-input.vf-module-request-input.vf-module-input-parameters.param[$idx].name == 'topology'`\">",
        "comments": "",
        "outputs": 1,
        "x": 1344.5422353744507,
        "y": 522.0595428943634,
        "z": "12e5b519.7c42cb",
        "wires": [
            [
                "8910bf6.fa8bd4"
            ]
        ]
    },
    {
        "id": "4c3c07dc.109bb8",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1520.7025747299194,
        "y": 478.05954480171204,
        "z": "12e5b519.7c42cb",
        "wires": [
            [
                "330c74f0.0fa8ac"
            ]
        ]
    },
    {
        "id": "8910bf6.fa8bd4",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1514.5422353744507,
        "y": 518.0595428943634,
        "z": "12e5b519.7c42cb",
        "wires": [
            [
                "c760e70.ca63518"
            ]
        ]
    },
    {
        "id": "330c74f0.0fa8ac",
        "type": "set",
        "name": "set name",
        "xml": "<set>\n<parameter name='prop.name' value='`$vf-module-topology-operation-input.vf-module-request-input.vf-module-input-parameters.param[$idx].value`' />\n\n",
        "comments": "",
        "x": 1670.7027044296265,
        "y": 476.6595513820648,
        "z": "12e5b519.7c42cb",
        "wires": []
    },
    {
        "id": "c760e70.ca63518",
        "type": "set",
        "name": "set topology",
        "xml": "<set>\n<parameter name='prop.topology' value='`$vf-module-topology-operation-input.vf-module-request-input.vf-module-input-parameters.param[$idx].value`' />\n",
        "comments": "",
        "x": 1701.8756761550903,
        "y": 516.5206997394562,
        "z": "12e5b519.7c42cb",
        "wires": []
    },
    {
        "id": "80911d80.565f6",
        "type": "call",
        "name": "call GENERIC-RESOURCE-API:validate-sdwan-vf-vpn-input-parameters",
        "xml": "<call module='GENERIC-RESOURCE-API' rpc='validate-sdwan-vf-vpn-input-parameters' mode='sync' >\n",
        "comments": "",
        "outputs": 1,
        "x": 954.5077972412109,
        "y": 190.0039086341858,
        "z": "12e5b519.7c42cb",
        "wires": [
            []
        ]
    },
    {
        "id": "f1c0f2fa.5d8e8",
        "type": "set",
        "name": "set vf-module-object-path",
        "xml": "<set>\n<parameter name='vf-module-id' value='`$prop.vpn-vf-index`' />\n<parameter name='vf-module-object-path' value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $vf-module-topology-operation-input.service-information.service-instance-id\n + '/service-data/vnfs/vnf/'\n + $service-data.vnfs.vnf[$vnf-index].vnf-id\n + '/vnf-data/vf-modules/vf-module/'\n + $prop.vpn-vf-index\n + '/vf-module-data/vf-module-topology/'`\"/>\n<parameter name='vnf-object-path'\n value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $vf-module-topology-operation-input.service-information.service-instance-id\n + '/service-data/vnfs/vnf/'\n + $service-data.vnfs.vnf[$vnf-index].vnf-id\n + '/vnf-data/vnf-topology/'`\"/>\n<parameter name='service-object-path'\n value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $vf-module-topology-operation-input.service-information.service-instance-id\n + '/service-data/service-topology/'`\"/>\n",
        "comments": "",
        "x": 832.5039930343628,
        "y": 762.0313073992729,
        "z": "12e5b519.7c42cb",
        "wires": []
    },
    {
        "id": "a6352f7.5aa86d",
        "type": "save",
        "name": "save service relationship in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='generic-vnf:relationship-list' \n      key='generic-vnf.vnf-id = $service-data.vnfs.vnf[$vnf-index].vnf-id' \n      force=\"true\" pfx=\"tmp.AnAI-data\">\n<parameter name=\"relationship-list.relationship[0].related-to\" value=\"sdwan-vpn\" />\n<parameter name=\"relationship-list.relationship[0].related-link\" value=\"`'/network/sdwan-vpns/sdwan-vpn/' + $prop.vpn-vf-index`\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"sdwan-vpn.id\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$prop.vpn-vf-index`\" />\n\n",
        "comments": "",
        "outputs": 1,
        "x": 847.004054069519,
        "y": 904.0001769065857,
        "z": "12e5b519.7c42cb",
        "wires": [
            []
        ]
    }
]