[
    {
        "id": "f782e37.109032",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 583,
        "y": 401.1628177165985,
        "z": "5ddf8caa.1b92e4",
        "wires": [
            [
                "3a0d40d2.1b88f",
                "fdf59618.623758",
                "d535f520.a2b4c8",
                "5957a088.cf332",
                "9afb8db9.2b0d5",
                "1b22ffce.90ac5",
                "9c073f69.f288d",
                "8cc9cbda.e9db18",
                "1db1621b.e18c6e",
                "33fd1f45.d7ff5",
                "2ebef402.b67dec",
                "a78628f7.4e9428",
                "9f1428de.0587b8",
                "69722b7c.abba54",
                "86d99a3f.07f208"
            ]
        ]
    },
    {
        "id": "3a0d40d2.1b88f",
        "type": "for",
        "name": "for loop idx - VF input parameters",
        "xml": "<for index=\"idx\" start=\"0\" end=\"`$vf-module-topology-operation-input.vf-module-request-input.vf-module-input-parameters.param_length`\">\n\n",
        "comments": "",
        "outputs": 1,
        "x": 929.2501602172852,
        "y": 383.82948660850525,
        "z": "5ddf8caa.1b92e4",
        "wires": [
            [
                "edd147b1.5a9678"
            ]
        ]
    },
    {
        "id": "edd147b1.5a9678",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 1144.0285034179688,
        "y": 381.38507056236267,
        "z": "5ddf8caa.1b92e4",
        "wires": [
            [
                "239191e9.78691e",
                "1a76d1a9.524ade"
            ]
        ]
    },
    {
        "id": "239191e9.78691e",
        "type": "execute",
        "name": "execute split parameterName",
        "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='split' >\n<parameter name=\"original_string\" value='`$vf-module-topology-operation-input.vf-module-request-input.vf-module-input-parameters.param[$idx].name`'/>\n<parameter name=\"regex\" value=\"_\"/>\n<parameter name=\"ctx_memory_result_key\" value=\"param-prefix\"/>\n",
        "comments": "",
        "outputs": 1,
        "x": 1340.2847061157227,
        "y": 359.13320899009705,
        "z": "5ddf8caa.1b92e4",
        "wires": [
            []
        ]
    },
    {
        "id": "1a76d1a9.524ade",
        "type": "set",
        "name": "set parameterName",
        "xml": "<set>\n<parameter name=\"`vf-module-topology-operation-input.vf-module-request-input.vf-module-input-parameters.param[$idx].name`\" value='`$param-prefix[$param-prefix_length -1]`'/>\n",
        "comments": "",
        "x": 1309.729133605957,
        "y": 396.13332533836365,
        "z": "5ddf8caa.1b92e4",
        "wires": []
    },
    {
        "id": "24f00d92.239812",
        "type": "comment",
        "name": "Take the parameter names by removing prefix",
        "info": "",
        "comments": "",
        "x": 967.2503623962402,
        "y": 340.4961540699005,
        "z": "5ddf8caa.1b92e4",
        "wires": []
    },
    {
        "id": "d535f520.a2b4c8",
        "type": "set",
        "name": "set new vf-module_length",
        "xml": "<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length' value='`$vf-index + 1`' />",
        "comments": "",
        "x": 908.1867752075195,
        "y": 542.3257596492767,
        "z": "5ddf8caa.1b92e4",
        "wires": []
    },
    {
        "id": "fdf59618.623758",
        "type": "set",
        "name": "set vf-module-request-input.",
        "xml": "<set>\n<parameter name='vf-module-request-input.' value='`$vf-module-topology-operation-input.vf-module-request-input.`' />\n",
        "comments": "",
        "x": 915.1863632202148,
        "y": 437.3170254230499,
        "z": "5ddf8caa.1b92e4",
        "wires": []
    },
    {
        "id": "9c073f69.f288d",
        "type": "set",
        "name": "copy input data to service data",
        "xml": "<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-id' value='`$prop.vf-id`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.sdnc-request-header.' value='`$vf-module-topology-operation-input.sdnc-request-header.`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.request-information.' value='`$vf-module-topology-operation-input.request-information.`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.service-information.' value='`$vf-module-topology-operation-input.service-information.`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.vnf-information.' value='`$vf-module-topology-operation-input.vnf-information.`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.vf-module-information.' value='`$vf-module-topology-operation-input.vf-module-information.`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.vf-module-request-input.' value='`$vf-module-topology-operation-input.vf-module-request-input.`' />\n\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.vf-module-topology.' value='`$tmp.vf-module-topology.`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length' value='`$vf-index+1`' />\n",
        "comments": "",
        "x": 920.3531188964844,
        "y": 650.4963715076447,
        "z": "5ddf8caa.1b92e4",
        "wires": []
    },
    {
        "id": "8cc9cbda.e9db18",
        "type": "set",
        "name": "set vf-module-object-path",
        "xml": "<set>\n<parameter name='vf-module-id' value='`$prop.vf-id`'/> \n<parameter name='vf-module-object-path' value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $vf-module-topology-operation-input.service-information.service-instance-id\n + '/service-data/vnfs/vnf/'\n + $service-data.vnfs.vnf[$vnf-index].vnf-id\n + '/vnf-data/vf-modules/vf-module/'\n + $vf-module-topology-operation-input.vf-module-information.vf-module-id\n + '/vf-module-data/vf-module-topology/'`\"/>\n<parameter name='vnf-object-path'\n value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $vf-module-topology-operation-input.service-information.service-instance-id\n + '/service-data/vnfs/vnf/'\n + $service-data.vnfs.vnf[$vnf-index].vnf-id\n + '/vnf-data/vnf-topology/'`\"/>\n<parameter name='service-object-path'\n value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $vf-module-topology-operation-input.service-information.service-instance-id\n + '/service-data/service-topology/'`\"/>\n",
        "comments": "",
        "x": 908.5000438690186,
        "y": 702.0002176761627,
        "z": "5ddf8caa.1b92e4",
        "wires": []
    },
    {
        "id": "1db1621b.e18c6e",
        "type": "save",
        "name": "save sdwan lan-port-config resource in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='lan-port-config' \n      key='lan-port-config.lan-port-config-id = $prop.vf-id' >\n<parameter name=\"lan-port-config-id\" value=\"`$prop.vf-id`\" />\n<parameter name=\"device-id\" value='`$prop.lan.deviceName`' />\n<parameter name=\"port-switch\" value='`$prop.lan.portSwitch`' />\n<parameter name=\"port-type\" value='`$prop.lan.portType`' />\n<parameter name=\"port-number\" value='`$prop.lan.portnumber`' />\n<parameter name=\"ipv4-address\" value='`$prop.lan.ipAddress`' />\n<parameter name='vlan-tag' value='`$prop.lan.vlanId`' />\n<parameter name='operational-status' value='Created' />\n<parameter name='model-customization-id' value='`$vf-module-topology-operation-input.vf-module-information.onap-model-information.model-customization-uuid`' />\n<parameter name='model-invariant-id' value='`$vf-module-topology-operation-input.vf-module-information.onap-model-information.model-invariant-uuid`' />\n<parameter name='model-version-id' value='`$vf-module-topology-operation-input.vf-module-information.onap-model-information.model-version`' />\n<parameter name='selflink' value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'  + $vf-module-topology-operation-input.service-information.service-instance-id  + '/service-data/vnfs/vnf/'  + $service-data.vnfs.vnf[$vnf-index].vnf-id  + '/vnf-data/vf-modules/vf-module/' + $prop.vf-id + '/vf-module-data/'` \" />\n",
        "comments": "",
        "outputs": 1,
        "x": 963.5000228881836,
        "y": 794.5002000331879,
        "z": "5ddf8caa.1b92e4",
        "wires": [
            []
        ]
    },
    {
        "id": "33fd1f45.d7ff5",
        "type": "save",
        "name": "save service relationship in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='generic-vnf:relationship-list' \n      key='generic-vnf.vnf-id = $service-data.vnfs.vnf[$vnf-index].vnf-id' \n      force=\"true\" pfx=\"tmp.AnAI-data\">\n<parameter name=\"relationship-list.relationship[0].related-to\" value=\"lan-port-config\" />\n<parameter name=\"relationship-list.relationship[0].related-link\" value=\"`'/network/lan-port-configs/lan-port-config/' + $prop.vf-id`\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"lan-port-config-id\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$prop.vf-id`\" />\n",
        "comments": "",
        "outputs": 1,
        "x": 923.4999389648438,
        "y": 841.5001881122589,
        "z": "5ddf8caa.1b92e4",
        "wires": [
            []
        ]
    },
    {
        "id": "2ebef402.b67dec",
        "type": "returnSuccess",
        "name": "return success",
        "xml": "<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n",
        "comments": "",
        "x": 874.222484588623,
        "y": 888.6740472316742,
        "z": "5ddf8caa.1b92e4",
        "wires": []
    },
    {
        "id": "5957a088.cf332",
        "type": "switchNode",
        "name": "switch vnf_length",
        "xml": "<switch test='`$service-data.vnfs.vnf_length`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 884.4205684661865,
        "y": 90.66670227050781,
        "z": "5ddf8caa.1b92e4",
        "wires": [
            [
                "26211aa4.6aca76"
            ]
        ]
    },
    {
        "id": "26211aa4.6aca76",
        "type": "other",
        "name": "NULL",
        "xml": "<outcome value=''>\n",
        "comments": "",
        "outputs": 1,
        "x": 1071.0872478485107,
        "y": 90,
        "z": "5ddf8caa.1b92e4",
        "wires": [
            [
                "60b9b040.3db19"
            ]
        ]
    },
    {
        "id": "60b9b040.3db19",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"404\" />\n    <parameter name=\"error-message\" value=\"There are no VNFs in MD-SAL\" />\n",
        "comments": "",
        "x": 1252.7538738250732,
        "y": 90,
        "z": "5ddf8caa.1b92e4",
        "wires": []
    },
    {
        "id": "9afb8db9.2b0d5",
        "type": "switchNode",
        "name": "switch vf-modules.vf-module_length",
        "xml": "<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 922.6705904006958,
        "y": 267.66669631004333,
        "z": "5ddf8caa.1b92e4",
        "wires": [
            [
                "925220d0.8e6e8",
                "8d034f0b.c8c8d"
            ]
        ]
    },
    {
        "id": "925220d0.8e6e8",
        "type": "other",
        "name": "Null",
        "xml": "<outcome value=''>\n",
        "comments": "",
        "outputs": 1,
        "x": 1153.6706008911133,
        "y": 243.66669344902039,
        "z": "5ddf8caa.1b92e4",
        "wires": [
            [
                "f6929bd3.916468"
            ]
        ]
    },
    {
        "id": "8d034f0b.c8c8d",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1153.6706008911133,
        "y": 283.6666934490204,
        "z": "5ddf8caa.1b92e4",
        "wires": [
            [
                "28516ca8.58b9a4"
            ]
        ]
    },
    {
        "id": "f6929bd3.916468",
        "type": "set",
        "name": "set vf-index",
        "xml": "<set>\n<parameter name='vf-index' value='0' />\n",
        "comments": "",
        "x": 1296.1706008911133,
        "y": 243.66669344902039,
        "z": "5ddf8caa.1b92e4",
        "wires": []
    },
    {
        "id": "28516ca8.58b9a4",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 1298.027645111084,
        "y": 283.6032054424286,
        "z": "5ddf8caa.1b92e4",
        "wires": [
            [
                "fe45ce64.2ccb7",
                "e4014c75.a1a78"
            ]
        ]
    },
    {
        "id": "e4014c75.a1a78",
        "type": "set",
        "name": "set vf-index",
        "xml": "<set>\n<parameter name='vf-index' value='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length`' />\n\n\n",
        "comments": "",
        "x": 1450.7261199951172,
        "y": 253.22230413509533,
        "z": "5ddf8caa.1b92e4",
        "wires": []
    },
    {
        "id": "fe45ce64.2ccb7",
        "type": "for",
        "name": "for each existing vf-index",
        "xml": "<for index='idx' start='0' end='`$vf-index`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 1507.1546249389648,
        "y": 306.444433927536,
        "z": "5ddf8caa.1b92e4",
        "wires": [
            [
                "c9dd9d48.363c4"
            ]
        ]
    },
    {
        "id": "93986914.2633c8",
        "type": "comment",
        "name": "make sure this network doesn't exist already",
        "info": "",
        "comments": "",
        "x": 1730.8053550720215,
        "y": 264.69849133491516,
        "z": "5ddf8caa.1b92e4",
        "wires": []
    },
    {
        "id": "c9dd9d48.363c4",
        "type": "switchNode",
        "name": "switch vf-module-id found",
        "xml": "<switch test=\"`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$idx].vf-module-id == $vf-module-topology-operation-input.vf-module-information.vf-module-id`\">\n",
        "comments": "",
        "outputs": 1,
        "x": 1782.4403457641602,
        "y": 306.0159366130829,
        "z": "5ddf8caa.1b92e4",
        "wires": [
            [
                "3a28d2c1.9fee3e"
            ]
        ]
    },
    {
        "id": "3a28d2c1.9fee3e",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1683.1705436706543,
        "y": 364.58736777305603,
        "z": "5ddf8caa.1b92e4",
        "wires": [
            [
                "c7dfb468.8d2468"
            ]
        ]
    },
    {
        "id": "c7dfb468.8d2468",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$idx].vf-module-id already found in service-data\" />\n",
        "comments": "",
        "x": 1830.9206466674805,
        "y": 364.44455984188244,
        "z": "5ddf8caa.1b92e4",
        "wires": []
    },
    {
        "id": "1b22ffce.90ac5",
        "type": "call",
        "name": "call sdwan-get-vf-module-lanport-param",
        "xml": "<call module='GENERIC-RESOURCE-API' rpc='sdwan-get-vf-module-lanport-param' mode='sync' >\n",
        "comments": "",
        "outputs": 1,
        "x": 954.0000381469727,
        "y": 490.1628510951996,
        "z": "5ddf8caa.1b92e4",
        "wires": [
            []
        ]
    },
    {
        "id": "a78628f7.4e9428",
        "type": "set",
        "name": "set vf-module-level-oper-status",
        "xml": "<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.vf-module-level-oper-status.order-status'  value='Created' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.vf-module-level-oper-status.last-rpc-action'  value='`$vf-module-topology-operation-input.sdnc-request-header.svc-action`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.vf-module-level-oper-status.last-action'  value='`$vf-module-topology-operation-input.sdnc-request-header.request-action`' />\n",
        "comments": "",
        "x": 925.0000076293945,
        "y": 744.1667354106903,
        "z": "5ddf8caa.1b92e4",
        "wires": []
    },
    {
        "id": "ceaeb6e4.45d088",
        "type": "dgstart",
        "name": "DGSTART",
        "outputs": 1,
        "x": 252.00000762939453,
        "y": 117.16673541069031,
        "z": "5ddf8caa.1b92e4",
        "wires": [
            [
                "b9aae3a1.4ae74"
            ]
        ]
    },
    {
        "id": "b9aae3a1.4ae74",
        "type": "service-logic",
        "name": "GENERIC-RESOURCE-API ${project.version}",
        "module": "GENERIC-RESOURCE-API",
        "version": "${project.version}",
        "comments": "",
        "xml": "<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>",
        "outputs": 1,
        "x": 366.5000057220459,
        "y": 224.16672682762146,
        "z": "5ddf8caa.1b92e4",
        "wires": [
            [
                "486cfe7f.88b42"
            ]
        ]
    },
    {
        "id": "486cfe7f.88b42",
        "type": "method",
        "name": "sdwan-vf-operation-lanport-create",
        "xml": "<method rpc='sdwan-vf-operation-lanport-create' mode='sync'>\n",
        "comments": "",
        "outputs": 1,
        "x": 365.5000057220459,
        "y": 324.16672682762146,
        "z": "5ddf8caa.1b92e4",
        "wires": [
            [
                "f782e37.109032"
            ]
        ]
    },
    {
        "id": "9f1428de.0587b8",
        "type": "execute",
        "name": "execute generate-vf-id",
        "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='generateUUID' >\n<parameter name=\"ctx-destination\" value=\"prop.vf-id\"/>\n",
        "comments": "",
        "outputs": 1,
        "x": 907.0000534057617,
        "y": 598.6667287349701,
        "z": "5ddf8caa.1b92e4",
        "wires": [
            []
        ]
    },
    {
        "id": "69722b7c.abba54",
        "type": "for",
        "name": "for each vnf",
        "xml": "<for index='idx' start='0' end='`$service-data.vnfs.vnf_length`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 873.9999885559082,
        "y": 145.16673731803894,
        "z": "5ddf8caa.1b92e4",
        "wires": [
            [
                "c4314464.ea4888"
            ]
        ]
    },
    {
        "id": "c4314464.ea4888",
        "type": "switchNode",
        "name": "switch this vnf-id == input vnf-id",
        "xml": "<switch test=\"`$service-data.vnfs.vnf[$idx].vnf-id == $vf-module-topology-operation-input.vnf-information.vnf-id`\">    \n",
        "comments": "",
        "outputs": 1,
        "x": 1125.0000839233398,
        "y": 140.83335781097412,
        "z": "5ddf8caa.1b92e4",
        "wires": [
            [
                "7e2619a7.4c1a38"
            ]
        ]
    },
    {
        "id": "7e2619a7.4c1a38",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1343.3334007263184,
        "y": 142.8333396911621,
        "z": "5ddf8caa.1b92e4",
        "wires": [
            [
                "e7b8aabb.779c28"
            ]
        ]
    },
    {
        "id": "e7b8aabb.779c28",
        "type": "set",
        "name": "set vnf-index",
        "xml": "<set>\n<parameter name='vnf-index' value='`$idx`' />\n",
        "comments": "",
        "x": 1496.6665725708008,
        "y": 142.83336067199707,
        "z": "5ddf8caa.1b92e4",
        "wires": []
    },
    {
        "id": "86d99a3f.07f208",
        "type": "switchNode",
        "name": "switch vnf-index",
        "xml": "<switch test='`$vnf-index`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 888.0000076293945,
        "y": 206.1667354106903,
        "z": "5ddf8caa.1b92e4",
        "wires": [
            [
                "885839d2.ea1b48"
            ]
        ]
    },
    {
        "id": "885839d2.ea1b48",
        "type": "other",
        "name": "Null",
        "xml": "<outcome value=''>\n",
        "comments": "",
        "outputs": 1,
        "x": 1050.0000534057617,
        "y": 205.166734457016,
        "z": "5ddf8caa.1b92e4",
        "wires": [
            [
                "1a2b1c2a.3b4624"
            ]
        ]
    },
    {
        "id": "1a2b1c2a.3b4624",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"vnf id not found in service-data\" />\n",
        "comments": "",
        "x": 1199.250144958496,
        "y": 202.94461226463318,
        "z": "5ddf8caa.1b92e4",
        "wires": []
    }
]