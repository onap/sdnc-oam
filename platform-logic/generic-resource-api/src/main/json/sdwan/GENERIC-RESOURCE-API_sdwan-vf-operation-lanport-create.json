[
    {
        "id": "3d343d97.916e12",
        "type": "method",
        "name": "sdwan-vf-operation-lanport-create",
        "xml": "<method rpc='sdwan-vf-operation-lanport-create' mode='sync'>\n",
        "comments": "",
        "outputs": 1,
        "x": 285,
        "y": 241.99999237060547,
        "z": "be7b9c9c.26b5d",
        "wires": [
            [
                "72bd87e4.7210f8"
            ]
        ]
    },
    {
        "id": "72bd87e4.7210f8",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 444.99999237060547,
        "y": 374.9999885559082,
        "z": "be7b9c9c.26b5d",
        "wires": [
            [
                "fa08bbfd.f36978",
                "662c5c91.bf14f4",
                "3a8662b6.7187de",
                "d0f313c6.a0ddd",
                "87f25b72.4b1968",
                "c96f1257.64bf8",
                "9ca9880e.f474f8",
                "23949443.ee4acc",
                "64302671.d03c08",
                "305a60f0.cd87a",
                "17d1be09.26b4d2",
                "8ab4415a.f464b",
                "b65f8656.be0f98",
                "8944476b.d5f828"
            ]
        ]
    },
    {
        "id": "78ad706e.d12e1",
        "type": "service-logic",
        "name": "GENERIC-RESOURCE-API ${project.version}",
        "module": "GENERIC-RESOURCE-API",
        "version": "${project.version}",
        "comments": "",
        "xml": "<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>",
        "outputs": 1,
        "x": 286,
        "y": 141.99999237060547,
        "z": "be7b9c9c.26b5d",
        "wires": [
            [
                "3d343d97.916e12"
            ]
        ]
    },
    {
        "id": "7c5370ed.0ab17",
        "type": "dgstart",
        "name": "DGSTART",
        "outputs": 1,
        "x": 115.5,
        "y": 53,
        "z": "be7b9c9c.26b5d",
        "wires": [
            [
                "78ad706e.d12e1"
            ]
        ]
    },
    {
        "id": "fa08bbfd.f36978",
        "type": "for",
        "name": "for loop idx - VF input parameters",
        "xml": "<for index=\"idx\" start=\"0\" end=\"`$vf-module-topology-operation-input.vf-module-request-input.vf-module-input-parameters.param_length`\">\n\n",
        "comments": "",
        "outputs": 1,
        "x": 791.2501525878906,
        "y": 357.66665744781494,
        "z": "be7b9c9c.26b5d",
        "wires": [
            [
                "c93f649f.0099c8"
            ]
        ]
    },
    {
        "id": "c93f649f.0099c8",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 1006.0284957885742,
        "y": 355.22224140167236,
        "z": "be7b9c9c.26b5d",
        "wires": [
            [
                "8f744d78.f7a31",
                "7468dc64.d34424"
            ]
        ]
    },
    {
        "id": "8f744d78.f7a31",
        "type": "execute",
        "name": "execute split parameterName",
        "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='split' >\n<parameter name=\"original_string\" value='`$vf-module-topology-operation-input.vf-module-request-input.vf-module-input-parameters.param[$idx].name`'/>\n<parameter name=\"regex\" value=\"_\"/>\n<parameter name=\"ctx_memory_result_key\" value=\"param-prefix\"/>\n",
        "comments": "",
        "outputs": 1,
        "x": 1202.2846984863281,
        "y": 332.97037982940674,
        "z": "be7b9c9c.26b5d",
        "wires": [
            []
        ]
    },
    {
        "id": "7468dc64.d34424",
        "type": "set",
        "name": "set parameterName",
        "xml": "<set>\n<parameter name=\"`vf-module-topology-operation-input.vf-module-request-input.vf-module-input-parameters.param[$idx].name`\" value='`$param-prefix[$param-prefix_length -1]`'/>\n",
        "comments": "",
        "x": 1171.7291259765625,
        "y": 369.97049617767334,
        "z": "be7b9c9c.26b5d",
        "wires": []
    },
    {
        "id": "143889df.349216",
        "type": "comment",
        "name": "Take the parameter names by removing prefix",
        "info": "",
        "comments": "",
        "x": 829.2503547668457,
        "y": 314.3333249092102,
        "z": "be7b9c9c.26b5d",
        "wires": []
    },
    {
        "id": "3a8662b6.7187de",
        "type": "set",
        "name": "set new vf-module_length",
        "xml": "<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length' value='`$vf-index + 1`' />",
        "comments": "",
        "x": 770.186767578125,
        "y": 516.1629304885864,
        "z": "be7b9c9c.26b5d",
        "wires": []
    },
    {
        "id": "662c5c91.bf14f4",
        "type": "set",
        "name": "set vf-module-request-input.",
        "xml": "<set>\n<parameter name='vf-module-request-input.' value='`$vf-module-topology-operation-input.vf-module-request-input.`' />\n",
        "comments": "",
        "x": 770.1862945556641,
        "y": 462.15421867370605,
        "z": "be7b9c9c.26b5d",
        "wires": []
    },
    {
        "id": "64302671.d03c08",
        "type": "set",
        "name": "copy input data to service data",
        "xml": "<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-id' value='`$prop.lan-vf-index`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.sdnc-request-header.' value='`$vf-module-topology-operation-input.sdnc-request-header.`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.request-information.' value='`$vf-module-topology-operation-input.request-information.`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.service-information.' value='`$vf-module-topology-operation-input.service-information.`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.vnf-information.' value='`$vf-module-topology-operation-input.vnf-information.`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.vf-module-information.' value='`$vf-module-topology-operation-input.vf-module-information.`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.vf-module-request-input.' value='`$vf-module-topology-operation-input.vf-module-request-input.`' />\n\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.vf-module-topology.' value='`$tmp.vf-module-topology.`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length' value='`$vf-index+1`' />\n",
        "comments": "",
        "x": 782.3531112670898,
        "y": 624.3335423469543,
        "z": "be7b9c9c.26b5d",
        "wires": []
    },
    {
        "id": "23949443.ee4acc",
        "type": "execute",
        "name": "execute generate-vf-module-index",
        "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='generateUUID' >\n<parameter name=\"ctx-destination\" value=\"prop.lan-vf-index\"/>\n",
        "comments": "",
        "outputs": 1,
        "x": 794.6866760253906,
        "y": 570.0002617835999,
        "z": "be7b9c9c.26b5d",
        "wires": [
            []
        ]
    },
    {
        "id": "305a60f0.cd87a",
        "type": "set",
        "name": "set vf-module-object-path",
        "xml": "<set>\n<parameter name='vf-module-object-path' value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $vf-module-topology-operation-input.service-information.service-instance-id\n + '/service-data/vnfs/vnf/'\n + $service-data.vnfs.vnf[$vnf-index].vnf-id\n + '/vnf-data/vf-modules/vf-module/'\n + $vf-module-topology-operation-input.vf-module-information.vf-module-id\n + '/vf-module-data/vf-module-topology/'`\"/>\n<parameter name='vnf-object-path'\n value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $vf-module-topology-operation-input.service-information.service-instance-id\n + '/service-data/vnfs/vnf/'\n + $service-data.vnfs.vnf[$vnf-index].vnf-id\n + '/vnf-data/vnf-topology/'`\"/>\n<parameter name='service-object-path'\n value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $vf-module-topology-operation-input.service-information.service-instance-id\n + '/service-data/service-topology/'`\"/>\n",
        "comments": "",
        "x": 770.500036239624,
        "y": 675.8373885154724,
        "z": "be7b9c9c.26b5d",
        "wires": []
    },
    {
        "id": "17d1be09.26b4d2",
        "type": "set",
        "name": "set vf-module-level-oper-status",
        "xml": "<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.vf-module-level-oper-status.order-status'  value='Created' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.vf-module-level-oper-status.last-rpc-action'  value='`$vf-module-topology-operation-input.sdnc-request-header.svc-action`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-index].vf-module-data.vf-module-level-oper-status.last-action'  value='`$vf-module-topology-operation-input.sdnc-request-header.request-action`' />",
        "comments": "",
        "x": 785.0000953674316,
        "y": 725.837281703949,
        "z": "be7b9c9c.26b5d",
        "wires": []
    },
    {
        "id": "8ab4415a.f464b",
        "type": "save",
        "name": "save sdwan lan-port-config resource in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='lan-port-config' \n      key='lan-port-config.lan-port-config-id = $prop.lan-vf-index' >\n<parameter name=\"lan-port-config-id\" value=\"`$prop.vnf-index`\" />\n<parameter name=\"device-id\" value=\"`$prop.lan.deviceName`\" />\n<parameter name=\"port-switch\" value=\"`$prop.lan.portSwitch`\" />\n<parameter name=\"port-type\" value=\"`$prop.lan.portType`\" />\n<parameter name=\"port-number\" value=\"`$prop.lan.portnumber`\" />\n<parameter name=\"ipv4-address\" value=\"`$prop.lan.ipAddress`\" />\n<parameter name='vlan-tag' value=\"`$prop.lan.vlanId`\" />\n<parameter name='operational-status' value='Created' />\n<parameter name='model-customization-id' value='`$vf-module-topology-operation-input.vf-module-information.onap-model-information.model-customization-uuid`' />\n<parameter name='model-invariant-id' value='`$vf-module-topology-operation-input.vf-module-information.onap-model-information.model-invariant-uuid`' />\n<parameter name='model-version-id' value='`$vf-module-topology-operation-input.vf-module-information.onap-model-information.model-version`' />\n<parameter name='selflink' value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'  + $vf-module-topology-operation-input.service-information.service-instance-id  + '/service-data/vnfs/vnf/'  + $service-data.vnfs.vnf[$vnf-index].vnf-id  + '/vnf-data/vf-modules/vf-module/' + $prop.site-vf-index + '/vf-module-data/'` \" />\n",
        "comments": "",
        "outputs": 1,
        "x": 817.5000152587891,
        "y": 766.3373422622681,
        "z": "be7b9c9c.26b5d",
        "wires": [
            []
        ]
    },
    {
        "id": "b65f8656.be0f98",
        "type": "save",
        "name": "save service relationship in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='generic-vnf:relationship-list' \n      key='generic-vnf.vnf-id = $service-data.vnfs.vnf[$vnf-index].vnf-id' \n      force=\"true\" pfx=\"tmp.AnAI-data\">\n<parameter name=\"relationship-list.relationship[0].related-to\" value=\"sdwan-vpn\" />\n<parameter name=\"relationship-list.relationship[0].related-link\" value=\"`'/network/sdwan-vpns/sdwan-vpn/' + $prop.lan-vf-index`\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"lan-port-config-id\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$prop.lan-vf-index`\" />\n",
        "comments": "",
        "outputs": 1,
        "x": 785.4999313354492,
        "y": 815.3373589515686,
        "z": "be7b9c9c.26b5d",
        "wires": [
            []
        ]
    },
    {
        "id": "8944476b.d5f828",
        "type": "returnSuccess",
        "name": "return success",
        "xml": "<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n",
        "comments": "",
        "x": 736.2224769592285,
        "y": 862.5112180709839,
        "z": "be7b9c9c.26b5d",
        "wires": []
    },
    {
        "id": "87f25b72.4b1968",
        "type": "for",
        "name": "for each vnf",
        "xml": "<for index='idx' start='0' end='`$service-data.vnfs.vnf_length`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 729,
        "y": 165.99999713897705,
        "z": "be7b9c9c.26b5d",
        "wires": [
            [
                "e80313cd.820e4"
            ]
        ]
    },
    {
        "id": "e80313cd.820e4",
        "type": "switchNode",
        "name": "switch this vnf-id == input vnf-id",
        "xml": "<switch test=\"`$service-data.vnfs.vnf[$idx].vnf-id == $vf-module-topology-operation-input.vnf-information.vnf-id`\">    \n",
        "comments": "",
        "outputs": 1,
        "x": 981.0000915527344,
        "y": 164.6666603088379,
        "z": "be7b9c9c.26b5d",
        "wires": [
            [
                "b80badb7.d9753"
            ]
        ]
    },
    {
        "id": "8bc04fc8.d6a11",
        "type": "set",
        "name": "set vnf-index",
        "xml": "<set>\n<parameter name='vnf-index' value='`$idx`' />\n",
        "comments": "",
        "x": 1352.6665802001953,
        "y": 166.66666316986084,
        "z": "be7b9c9c.26b5d",
        "wires": []
    },
    {
        "id": "b80badb7.d9753",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1199.333408355713,
        "y": 166.66664218902588,
        "z": "be7b9c9c.26b5d",
        "wires": [
            [
                "8bc04fc8.d6a11"
            ]
        ]
    },
    {
        "id": "d0f313c6.a0ddd",
        "type": "switchNode",
        "name": "switch vnf_length",
        "xml": "<switch test='`$service-data.vnfs.vnf_length`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 743.4205932617188,
        "y": 121.50386619567871,
        "z": "be7b9c9c.26b5d",
        "wires": [
            [
                "7ab34e25.1cd4e"
            ]
        ]
    },
    {
        "id": "7ab34e25.1cd4e",
        "type": "other",
        "name": "NULL",
        "xml": "<outcome value=''>\n",
        "comments": "",
        "outputs": 1,
        "x": 930.087272644043,
        "y": 120.8371639251709,
        "z": "be7b9c9c.26b5d",
        "wires": [
            [
                "984b3a64.7e1a38"
            ]
        ]
    },
    {
        "id": "984b3a64.7e1a38",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"404\" />\n    <parameter name=\"error-message\" value=\"There are no VNFs in MD-SAL\" />\n",
        "comments": "",
        "x": 1111.7538986206055,
        "y": 120.8371639251709,
        "z": "be7b9c9c.26b5d",
        "wires": []
    },
    {
        "id": "c96f1257.64bf8",
        "type": "switchNode",
        "name": "switch vf-modules.vf-module_length",
        "xml": "<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 784.6705827713013,
        "y": 241.50386714935303,
        "z": "be7b9c9c.26b5d",
        "wires": [
            [
                "ab6c63f4.e55a6",
                "14b85aee.617c65"
            ]
        ]
    },
    {
        "id": "ab6c63f4.e55a6",
        "type": "other",
        "name": "Null",
        "xml": "<outcome value=''>\n",
        "comments": "",
        "outputs": 1,
        "x": 1015.6705932617188,
        "y": 217.50386428833008,
        "z": "be7b9c9c.26b5d",
        "wires": [
            [
                "342d6918.bdf256"
            ]
        ]
    },
    {
        "id": "14b85aee.617c65",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1015.6705932617188,
        "y": 257.5038642883301,
        "z": "be7b9c9c.26b5d",
        "wires": [
            [
                "eedb45d.e2420b8"
            ]
        ]
    },
    {
        "id": "342d6918.bdf256",
        "type": "set",
        "name": "set vf-index",
        "xml": "<set>\n<parameter name='vf-index' value='0' />\n",
        "comments": "",
        "x": 1158.1705932617188,
        "y": 217.50386428833008,
        "z": "be7b9c9c.26b5d",
        "wires": []
    },
    {
        "id": "eedb45d.e2420b8",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 1160.0276374816895,
        "y": 257.4403762817383,
        "z": "be7b9c9c.26b5d",
        "wires": [
            [
                "a00dcbbe.533a58",
                "7019e496.422f8c"
            ]
        ]
    },
    {
        "id": "7019e496.422f8c",
        "type": "set",
        "name": "set vf-index",
        "xml": "<set>\n<parameter name='vf-index' value='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length`' />\n\n\n",
        "comments": "",
        "x": 1312.7261123657227,
        "y": 227.05947497440502,
        "z": "be7b9c9c.26b5d",
        "wires": []
    },
    {
        "id": "a00dcbbe.533a58",
        "type": "for",
        "name": "for each existing vf-index",
        "xml": "<for index='idx' start='0' end='`$vf-index`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 1369.1546173095703,
        "y": 280.2816047668457,
        "z": "be7b9c9c.26b5d",
        "wires": [
            [
                "19e6409a.9c554f"
            ]
        ]
    },
    {
        "id": "f530bc4a.54c5c",
        "type": "comment",
        "name": "make sure this network doesn't exist already",
        "info": "",
        "comments": "",
        "x": 1592.805347442627,
        "y": 238.53566217422485,
        "z": "be7b9c9c.26b5d",
        "wires": []
    },
    {
        "id": "19e6409a.9c554f",
        "type": "switchNode",
        "name": "switch vf-module-id found",
        "xml": "<switch test=\"`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$idx].vf-module-id == $vf-module-topology-operation-input.vf-module-information.vf-module-id`\">\n",
        "comments": "",
        "outputs": 1,
        "x": 1644.4403381347656,
        "y": 279.8531074523926,
        "z": "be7b9c9c.26b5d",
        "wires": [
            [
                "24af0b91.ce5344"
            ]
        ]
    },
    {
        "id": "24af0b91.ce5344",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1545.1705360412598,
        "y": 338.4245386123657,
        "z": "be7b9c9c.26b5d",
        "wires": [
            [
                "bf4e4104.4edb"
            ]
        ]
    },
    {
        "id": "bf4e4104.4edb",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$idx].vf-module-id already found in service-data\" />\n",
        "comments": "",
        "x": 1692.920639038086,
        "y": 338.28173068119213,
        "z": "be7b9c9c.26b5d",
        "wires": []
    },
    {
        "id": "9ca9880e.f474f8",
        "type": "call",
        "name": "call sdwan-get-vf-module-lanport-param",
        "xml": "<call module='GENERIC-RESOURCE-API' rpc='sdwan-get-vf-module-lanport-param' mode='sync' >\n",
        "comments": "",
        "outputs": 1,
        "x": 804.0000152587891,
        "y": 408.99999809265137,
        "z": "be7b9c9c.26b5d",
        "wires": [
            []
        ]
    }
]