[
  {
    "id":"89ae3f75.efc06",
    "type":"dgstart",
    "name":"DGSTART",
    "outputs":1,
    "x":141,
    "y":83,
    "z":"307d8ab2.24f886",
    "wires":[
      [
        "a0627d9f.9732f8"
      ]
    ]
  },
  {
    "id":"a0627d9f.9732f8",
    "type":"service-logic",
    "name":"GENERIC-RESOURCE-API ${project.version}",
    "module":"GENERIC-RESOURCE-API",
    "version":"${project.version}",
    "comments":"",
    "xml":"<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>",
    "outputs":1,
    "x":237.23807907104492,
    "y":143.95239067077637,
    "z":"307d8ab2.24f886",
    "wires":[
      [
        "d2b128d2.d9f3b"
      ]
    ]
  },
  {
    "id":"d2b128d2.d9f3b",
    "type":"method",
    "name":"tunnelxconn-topology-operation-activate",
    "xml":"<method rpc='tunnelxconn-topology-operation-activate' mode='sync'>\n",
    "comments":"",
    "outputs":1,
    "x":283.15485763549805,
    "y":179.19044589996338,
    "z":"307d8ab2.24f886",
    "wires":[
      [
        "e0a0d26a.cd7c18"
      ]
    ]
  },
  {
    "id":"e0a0d26a.cd7c18",
    "type":"block",
    "name":"block : atomic",
    "xml":"<block atomic=\"true\">",
    "atomic":"true",
    "comments":"",
    "outputs":1,
    "x":191.47619247436523,
    "y":322.5237879753113,
    "z":"307d8ab2.24f886",
    "wires":[
      [
        "3595ac23.ea8734",
        "f82799c8.167508",
        "e00d09b3.2a3938",
        "2679eac0.b2cc36",
        "1a8f12fd.5ade8d",
        "d30bace3.5a7f2",
        "6c7cdfc8.6b2608",
        "e60cbd81.14ee9",
        "e233eb48.73f8b",
        "69d61c38.40caa4",
        "d2103b31.1f83e8",
        "3936aa7e.049e66"
      ]
    ]
  },
  {
    "id":"f82799c8.167508",
    "type":"returnSuccess",
    "name":"return success",
    "xml":"<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n",
    "comments":"",
    "x":458.0001106262207,
    "y":992.2145080566406,
    "z":"307d8ab2.24f886",
    "wires":[

    ]
  },
  {
    "id":"3595ac23.ea8734",
    "type":"set",
    "name":"set output to api handler",
    "xml":"<set>\n<parameter name='allotted-resource-id' value='`$tmp.ar.allotted-resource-id`' />\n<parameter name='tunnelxconn-object-path' value=\"`$tmp.ar.self-link`\"/>\n<parameter name='service-object-path' value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $tunnelxconn-topology-operation-input.service-information.service-instance-id\n + '/service-data/service-topology/'`\"/>\n \n",
    "comments":"",
    "x":486.75402450561523,
    "y":956.3370542526245,
    "z":"307d8ab2.24f886",
    "wires":[

    ]
  },
  {
    "id":"69d61c38.40caa4",
    "type":"set",
    "name":"set allotted-resource-oper-status",
    "xml":"<set>\n<parameter name='tx-ar.allotted-resource-data.allotted-resource-oper-status.order-status' value='Active' />\n<parameter name='tx-ar.allotted-resource-data.allotted-resource-oper-status.last-action' value='`$tunnelxconn-topology-operation-input.request-information.request-action`' />\n<parameter name='tx-ar.allotted-resource-data.allotted-resource-oper-status.last-rpc-action' value='`$tunnelxconn-topology-operation-input.sdnc-request-header.svc-action`' />\n<parameter name='tx-ar.allotted-resource-data.allotted-resource-oper-status.last-svc-request-id' value='`$tunnelxconn-topology-operation-input.sdnc-request-header.svc-request-id`' />\n<parameter name='tx-ar.allotted-resource-data.allotted-resource-oper-status.create-timestamp' value='`$tmp.current-time`' />\n",
    "comments":"",
    "x":497.7542190551758,
    "y":703.0514001846313,
    "z":"307d8ab2.24f886",
    "wires":[

    ]
  },
  {
    "id":"2679eac0.b2cc36",
    "type":"set",
    "name":"set tmp.ar.self-link",
    "xml":"<set>\n<parameter name='tmp.ar.self-link' value=\"`'restconf/config/GENERIC-RESOURCE-API:tunnelxconn-allotted-resources/tunnelxconn-allotted-resource/'\n + $tmp.ar.allotted-resource-id\n + '/allotted-resource-data/tunnelxconn-topology/'` \" />\n\n",
    "comments":"",
    "x":453.73806381225586,
    "y":296.33332538604736,
    "z":"307d8ab2.24f886",
    "wires":[

    ]
  },
  {
    "id":"e00d09b3.2a3938",
    "type":"set",
    "name":"set tmp.ar.allotted-resource-id,etc",
    "xml":"<set>\n<parameter name='tmp.ar.allotted-resource-id' value='`$tunnelxconn-topology-operation-input.allotted-resource-information.allotted-resource-id`' />\n<parameter name='tmp.ar.parent-service-instance-id' value='`$tunnelxconn-topology-operation-input.allotted-resource-information.parent-service-instance-id`' />\n<parameter name='tmp.ar.brg-vnf-id' value='`$tunnelxconn-topology-operation-input.allotted-resource-data.tunnelxconn-topology.tunnelxconn-assignments.tunnelxconn-vnf-id`' />\n\n\n",
    "comments":"",
    "x":500.9973258972168,
    "y":262.59259128570557,
    "z":"307d8ab2.24f886",
    "wires":[

    ]
  },
  {
    "id":"1a8f12fd.5ade8d",
    "type":"execute",
    "name":"execute Properties",
    "xml":"<execute plugin='org.onap.ccsdk.sli.plugins.prop.PropertiesNode' method='readProperties' >\n    <parameter name='fileName' value='%SDNC_CONFIG_DIR%/generic-resource-api-dg.properties' />\n    <parameter name='contextPrefix' value='prop' />\n",
    "comments":"",
    "outputs":1,
    "x":459.9934196472168,
    "y":332.23152446746826,
    "z":"307d8ab2.24f886",
    "wires":[
      [

      ]
    ]
  },
  {
    "id":"6c7cdfc8.6b2608",
    "type":"execute",
    "name":"execute RestApiCallNode - Get AR by id",
    "xml":"<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.ar-url`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='GET' />\n    <parameter name=\"responsePrefix\" value=\"mdsal-ar\" />\n\n",
    "comments":"",
    "outputs":1,
    "x":522.5187530517578,
    "y":493.4594917297363,
    "z":"307d8ab2.24f886",
    "wires":[
      [
        "4b2d666b.abe658",
        "c5e31c5.77e05e"
      ]
    ]
  },
  {
    "id":"d30bace3.5a7f2",
    "type":"execute",
    "name":"generate allotted-resource url",
    "xml":"<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"`$prop.restapi.tx-allottedresource`\"/>\n    <parameter name=\"outputPath\" value=\"tmp.ar-url\"/>\n    <parameter name=\"target\" value=\"{allotted-resource-id}\"/>\n    <parameter name=\"replacement\" value=\"`$tmp.ar.allotted-resource-id`\"/>\n",
    "comments":"",
    "outputs":1,
    "x":488.0648536682129,
    "y":392.0172290802002,
    "z":"307d8ab2.24f886",
    "wires":[
      [

      ]
    ]
  },
  {
    "id":"4b2d666b.abe658",
    "type":"success",
    "name":"success",
    "xml":"<outcome value='success'>\n",
    "comments":"",
    "outputs":1,
    "x":779.8148918151855,
    "y":492.26725220680237,
    "z":"307d8ab2.24f886",
    "wires":[
      [
        "56d62b25.1f49bc"
      ]
    ]
  },
  {
    "id":"e60cbd81.14ee9",
    "type":"execute",
    "name":"execute RestApiCallNode - PUT AR by id",
    "xml":"<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='templateFileName' value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.tx.templatefile`\" />\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.ar-url`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='PUT' />\n    <parameter name=\"responsePrefix\" value=\"mdsal-ar\" />\n\n",
    "comments":"",
    "outputs":1,
    "x":530.5293121337891,
    "y":846.4341316223145,
    "z":"307d8ab2.24f886",
    "wires":[
      [
        "46ade8d5.b547e",
        "20a825ec.94755a",
        "ce5466bc.b050b"
      ]
    ]
  },
  {
    "id":"46ade8d5.b547e",
    "type":"not-found",
    "name":"not-found",
    "xml":"<outcome value='not-found'>\n",
    "comments":"",
    "outputs":1,
    "x":800.837329864502,
    "y":899.432332418859,
    "z":"307d8ab2.24f886",
    "wires":[
      [
        "83dde006.65958"
      ]
    ]
  },
  {
    "id":"20a825ec.94755a",
    "type":"failure",
    "name":"failure",
    "xml":"<outcome value='failure'>\n",
    "comments":"",
    "outputs":1,
    "x":791.8373794555664,
    "y":867.9323581680655,
    "z":"307d8ab2.24f886",
    "wires":[
      [
        "83dde006.65958"
      ]
    ]
  },
  {
    "id":"ce5466bc.b050b",
    "type":"success",
    "name":"success",
    "xml":"<outcome value='success'>\n",
    "comments":"",
    "outputs":1,
    "x":795.5874176025391,
    "y":838.2894630432129,
    "z":"307d8ab2.24f886",
    "wires":[
      [
        "f7831c73.19aa18"
      ]
    ]
  },
  {
    "id":"83dde006.65958",
    "type":"returnFailure",
    "name":"return failure",
    "xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating md-sal for tunnelxconn-allotted-resource\" />\n",
    "comments":"",
    "x":961.5874176025391,
    "y":868.6823820099235,
    "z":"307d8ab2.24f886",
    "wires":[

    ]
  },
  {
    "id":"56d62b25.1f49bc",
    "type":"block",
    "name":"block: atomic",
    "xml":"<block atomic=\"true\">\n",
    "atomic":"false",
    "comments":"",
    "outputs":1,
    "x":960.8148460388184,
    "y":492.7672016620636,
    "z":"307d8ab2.24f886",
    "wires":[
      [
        "e624279a.12ec8",
        "a31618b2.409b8"
      ]
    ]
  },
  {
    "id":"e624279a.12ec8",
    "type":"switchNode",
    "name":"switch tx length",
    "xml":"<switch test='`$mdsal-ar.tunnelxconn-allotted-resource_length`'>\n",
    "comments":"",
    "outputs":1,
    "x":1206.6720924377441,
    "y":527.052964925766,
    "z":"307d8ab2.24f886",
    "wires":[
      [
        "3cddd823.41afe"
      ]
    ]
  },
  {
    "id":"3cddd823.41afe",
    "type":"other",
    "name":"outcome 1",
    "xml":"<outcome value='1'>\n",
    "comments":"",
    "outputs":1,
    "x":1397.6720962524414,
    "y":527.0529625415802,
    "z":"307d8ab2.24f886",
    "wires":[
      [
        "6be9fe1e.f9c138"
      ]
    ]
  },
  {
    "id":"d7146c6d.b9cef8",
    "type":"set",
    "name":"set tx-ar from get",
    "xml":"<set>\n<parameter name='tx-ar.' value='$mdsal-ar.tunnelxconn-allotted-resource[0].' />\n",
    "comments":"",
    "x":1797.5292320251465,
    "y":527.6243867874146,
    "z":"307d8ab2.24f886",
    "wires":[

    ]
  },
  {
    "id":"6be9fe1e.f9c138",
    "type":"block",
    "name":"block: atomic",
    "xml":"<block atomic='true'>\n",
    "atomic":"false",
    "comments":"",
    "outputs":1,
    "x":1568.5290794372559,
    "y":527.6244316101074,
    "z":"307d8ab2.24f886",
    "wires":[
      [
        "d7146c6d.b9cef8",
        "357a7eb2.2788c2",
        "aecdfd17.ff094"
      ]
    ]
  },
  {
    "id":"357a7eb2.2788c2",
    "type":"set",
    "name":"set oper-status",
    "xml":"<set>\n<parameter name='tx-ar.allotted-resource-data.allotted-resource-oper-status.last-action' value='`$tx-ar.allotted-resource-data.allotted-resource-operation-information.request-information.request-action`' />\n<parameter name='tx-ar.allotted-resource-data.allotted-resource-oper-status.last-rpc-action' value='`$tx-ar.allotted-resource-status.rpc-action`' />\n<parameter name='tx-ar.allotted-resource-data.allotted-resource-oper-status.last-svc-request-id' value='`$tx-ar.allotted-resource-data.allotted-resource-operation-information.sdnc-request-header.svc-request-id`' />\n\n",
    "comments":"",
    "x":1795.5294761657715,
    "y":595.0529508590698,
    "z":"307d8ab2.24f886",
    "wires":[

    ]
  },
  {
    "id":"787114c9.2806c4",
    "type":"comment",
    "name":"GET tunnelxconn-allotted-resource from mdsal",
    "info":"",
    "comments":"",
    "x":547.8148155212402,
    "y":456.7671926021576,
    "z":"307d8ab2.24f886",
    "wires":[

    ]
  },
  {
    "id":"aecdfd17.ff094",
    "type":"switchNode",
    "name":"switch order-status",
    "xml":"<switch test='`$tx-ar.allotted-resource-data.allotted-resource-oper-status.order-status`'>\n",
    "comments":"",
    "outputs":1,
    "x":1805.52925491333,
    "y":560.6243848800659,
    "z":"307d8ab2.24f886",
    "wires":[
      [
        "60364cde.e8654c",
        "5dbfe46e.a42744"
      ]
    ]
  },
  {
    "id":"60364cde.e8654c",
    "type":"outcome",
    "name":"outcome Created",
    "xml":"<outcome value='Created'>\n",
    "comments":"",
    "outputs":1,
    "x":2017.1292114257812,
    "y":521.6243848800659,
    "z":"307d8ab2.24f886",
    "wires":[
      [
        "2e5253bb.935b44"
      ]
    ]
  },
  {
    "id":"5dbfe46e.a42744",
    "type":"outcome",
    "name":"outcome Other",
    "xml":"<outcome value='Other'>\n",
    "comments":"",
    "outputs":1,
    "x":2042.8435859680176,
    "y":557.052975654602,
    "z":"307d8ab2.24f886",
    "wires":[
      [
        "2e5253bb.935b44"
      ]
    ]
  },
  {
    "id":"3137dae9.e2b426",
    "type":"comment",
    "name":"Set allotted-resource-identifiers",
    "info":"",
    "comments":"",
    "x":503.33863830566406,
    "y":547.3386459350586,
    "z":"307d8ab2.24f886",
    "wires":[

    ]
  },
  {
    "id":"a31618b2.409b8",
    "type":"set",
    "name":"save backup copy of mdsal-ar for rollback",
    "xml":"<set>\n<parameter name='bk-tx-ar' value='$mdsal-ar.' />\n",
    "comments":"",
    "x":1286.3864250183105,
    "y":492.76729369163513,
    "z":"307d8ab2.24f886",
    "wires":[

    ]
  },
  {
    "id":"f725e409.258e68",
    "type":"comment",
    "name":"Create urls for restapi",
    "info":"",
    "comments":"",
    "x":458.9576606750488,
    "y":361.6243562698364,
    "z":"307d8ab2.24f886",
    "wires":[

    ]
  },
  {
    "id":"f7831c73.19aa18",
    "type":"block",
    "name":"block",
    "xml":"<block>\n",
    "atomic":"false",
    "comments":"",
    "outputs":1,
    "x":937.2433853149414,
    "y":834.481632232666,
    "z":"307d8ab2.24f886",
    "wires":[
      [

      ]
    ]
  },
  {
    "id":"6917ca0.586c538",
    "type":"comment",
    "name":"TO DO: vnf/put parent",
    "info":"",
    "comments":"",
    "x":461.2433776855469,
    "y":735.1481952667236,
    "z":"307d8ab2.24f886",
    "wires":[

    ]
  },
  {
    "id":"e233eb48.73f8b",
    "type":"execute",
    "name":"execute getTime",
    "xml":"<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='setTime' >\n    <parameter name=\"outputPath\" value=\"tmp.current-time\" />\n\n",
    "comments":"",
    "outputs":1,
    "x":445.24338150024414,
    "y":664.4815549850464,
    "z":"307d8ab2.24f886",
    "wires":[
      [

      ]
    ]
  },
  {
    "id":"c5e31c5.77e05e",
    "type":"other",
    "name":"other",
    "xml":"<outcome value='Other'>\n",
    "comments":"",
    "outputs":1,
    "x":779.5766868591309,
    "y":528.4814250469208,
    "z":"307d8ab2.24f886",
    "wires":[
      [
        "dd1ff459.39f8a8"
      ]
    ]
  },
  {
    "id":"dd1ff459.39f8a8",
    "type":"block",
    "name":"block: atomic",
    "xml":"<block atomic=\"true\">\n",
    "atomic":"false",
    "comments":"",
    "outputs":1,
    "x":959.5766372680664,
    "y":529.1479756832123,
    "z":"307d8ab2.24f886",
    "wires":[
      [

      ]
    ]
  },
  {
    "id":"d2103b31.1f83e8",
    "type":"set",
    "name":"set id",
    "xml":"<set>\n<parameter name='tx-ar.allotted-resource-id' value=\"`$tmp.ar.allotted-resource-id` \" />\n<parameter name='tx-ar.allotted-resource-status.action' value=\"`$tunnelxconn-topology-operation-input.request-information.request-action` \" />\n<parameter name='tx-ar.allotted-resource-status.rpc-name' value=\"tunnelxconn-topology-operation\" />\n<parameter name='tx-ar.allotted-resource-status.rpc-action' value=\"`$tunnelxconn-topology-operation-input.sdnc-request-header.svc-action` \" />\n<parameter name='tx-ar.allotted-resource-data.allotted-resource-operation-information.request-information.' value=\"`$tunnelxconn-topology-operation-input.request-information.` \" />\n<parameter name='tx-ar.allotted-resource-data.allotted-resource-operation-information.sdnc-request-header.' value=\"`$tunnelxconn-topology-operation-input.sdnc-request-header.` \" />\n<parameter name='tx-ar.allotted-resource-data.allotted-resource-operation-information.service-information.' value=\"`$tunnelxconn-topology-operation-input.service-information.` \" />\n<parameter name='tx-ar.allotted-resource-data.allotted-resource-operation-information.allotted-resource-information.' value=\"`$tunnelxconn-topology-operation-input.allotted-resource-information.` \" />\n<parameter name='tx-ar.allotted-resource-data.allotted-resource-operation-information.tunnelxconn-request-input.' value=\"`$tunnelxconn-topology-operation-input.tunnelxconn-request-input.` \" />",
    "comments":"",
    "x":428.24342346191406,
    "y":584.1481666564941,
    "z":"307d8ab2.24f886",
    "wires":[

    ]
  },
  {
    "id":"2e5253bb.935b44",
    "type":"block",
    "name":"block",
    "xml":"<block>\n",
    "atomic":"false",
    "comments":"",
    "outputs":1,
    "x":2231.5997276306152,
    "y":523.0000190734863,
    "z":"307d8ab2.24f886",
    "wires":[
      [

      ]
    ]
  },
  {
    "id":"3936aa7e.049e66",
    "type":"update",
    "name":"update AAI allotted-resource",
    "xml":"<update plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"allotted-resource\" \n\t\tkey=\"customer.global-customer-id = $service-data.service-information.global-customer-id AND\n\t\t\tservice-subscription.service-type = $service-data.service-information.subscription-service-type AND\n\t\t\tservice-instance.service-instance-id = $service-data.service-information.service-instance-id AND\n\t\t\tallotted-resource.id = $tmp.ar.allotted-resource-id\"\n        pfx='pfx' local-only='false' force='false'>\n\t<parameter name=\"operational-status\" value=\"in-service-path\" />\n",
    "comments":"",
    "outputs":1,
    "x":488.85716247558594,
    "y":768.2380628585815,
    "z":"307d8ab2.24f886",
    "wires":[
      [
        "578afeed.16a8f8",
        "fb8f774e.d3d13"
      ]
    ]
  },
  {
    "id":"578afeed.16a8f8",
    "type":"failure",
    "name":"failure",
    "xml":"<outcome value='failure'>\n",
    "comments":"",
    "outputs":1,
    "x":744.6190567016602,
    "y":751.1905598640442,
    "z":"307d8ab2.24f886",
    "wires":[
      [
        "9bc7661.b85f498"
      ]
    ]
  },
  {
    "id":"9bc7661.b85f498",
    "type":"returnFailure",
    "name":"return failure",
    "xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"AAI failed\" />\n",
    "comments":"",
    "x":911.142936706543,
    "y":762.8096308708191,
    "z":"307d8ab2.24f886",
    "wires":[

    ]
  },
  {
    "id":"fb8f774e.d3d13",
    "type":"failure",
    "name":"not-found",
    "xml":"<outcome value='not-found'>\n",
    "comments":"",
    "outputs":1,
    "x":751.7143440246582,
    "y":783.9525275230408,
    "z":"307d8ab2.24f886",
    "wires":[
      [
        "9bc7661.b85f498"
      ]
    ]
  }
]