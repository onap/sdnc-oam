[
  {
    "id": "61751fea.5e29c",
    "type": "save",
    "name": "get all-vpn-bindings from aai",
    "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"vpn-bindings\"\n\t    key=\"selflink = 'https://aai.onap:8443/aai/v24/network/vpn-bindings\"\n\t\tlocal-only=\"false\" \n\t\tpfx=\"tmp.aai.all-vpn-bindings\" >\n",
    "comments": "",
    "outputs": 1,
    "x": 309,
    "y": 328,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "9390d80.e27dda8",
        "a2edd3b5.431178",
        "d95bcddf.5304c8"
      ]
    ]
  },
  {
    "id": "9390d80.e27dda8",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 497,
    "y": 341,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "122deece.249539"
      ]
    ]
  },
  {
    "id": "a2edd3b5.431178",
    "type": "not-found",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 504.4909362792969,
    "y": 383.57403564453125,
    "z": "b60623c5.e2d9e8",
    "wires": [
      []
    ]
  },
  {
    "id": "d95bcddf.5304c8",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 495,
    "y": 430,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "c3fd03f5.ced1a"
      ]
    ]
  },
  {
    "id": "122deece.249539",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 670,
    "y": 339,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "26858e32.576aa2"
      ]
    ]
  },
  {
    "id": "26858e32.576aa2",
    "type": "for",
    "name": "for vpnidx in all-vpn-bindings",
    "xml": "<for index='vpnbidx' start='0' end='`$tmp.aai.all-vpn-bindings.vpn-binding_length`' >\n",
    "comments": "",
    "outputs": 1,
    "x": 899,
    "y": 340,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "b9b3eee1.451228"
      ]
    ]
  },
  {
    "id": "b9b3eee1.451228",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic='true'>",
    "atomic": "true",
    "comments": "",
    "outputs": 1,
    "x": 1114,
    "y": 341,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "1ab82d5c.a19413"
      ]
    ]
  },
  {
    "id": "7e7f1310.5e5bcc",
    "type": "switchNode",
    "name": "switch vpnuuid is for this slice",
    "xml": "<!--<switch test=\"`$tmp.slicevpnuuids[$tmp.aai.all-vpn-bindings.vpn-binding[$vpnbidx].vpn-id] != '' `\">-->\n\n<!-- Replace vpn-type with slice-id (a new attribbute in the latest AAI) -->\n<switch test=\"`$tmp.aai.all-vpn-bindings.vpn-binding[$vpnbidx].slice-id == $tmp.aai.service-instance.service-instance-id `\">\n\n",
    "comments": "",
    "outputs": 1,
    "x": 1368,
    "y": 263,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "55ca13fd.72ee7c",
        "6e8bc799.ce2fa8"
      ]
    ]
  },
  {
    "id": "55ca13fd.72ee7c",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1585,
    "y": 242,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "1ab82d5c.a19413"
      ]
    ]
  },
  {
    "id": "6e8bc799.ce2fa8",
    "type": "outcomeFalse",
    "name": "false",
    "xml": "<outcome value='false'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1585,
    "y": 291,
    "z": "b60623c5.e2d9e8",
    "wires": [
      []
    ]
  },
  {
    "id": "1ab82d5c.a19413",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic='true'>",
    "atomic": "true",
    "comments": "",
    "outputs": 1,
    "x": 1769,
    "y": 328,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "554ac9a2.79f95",
        "2ade390a.34dac6",
        "c0e6872b.6bc578"
      ]
    ]
  },
  {
    "id": "c3307b8c.0344e",
    "type": "dgstart",
    "name": "DGSTART",
    "outputs": 1,
    "x": 128,
    "y": 69,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "7e5b3842.1b2ff"
      ]
    ]
  },
  {
    "id": "7e5b3842.1b2ff",
    "type": "service-logic",
    "name": "GENERIC-RESOURCE-API ${project.version}",
    "module": "GENERIC-RESOURCE-API",
    "version": "${project.version}",
    "comments": "",
    "xml": "<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>",
    "outputs": 1,
    "x": 412.2856903076172,
    "y": 130.23810863494873,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "ff8ac0a6.a31ac8"
      ]
    ]
  },
  {
    "id": "ff8ac0a6.a31ac8",
    "type": "method",
    "name": "method cll-vnf-topology-operation-cll-F1-Activate-w-Protection",
    "xml": "<method rpc='cll-vnf-topology-operation-cll-F1-Activate-w-Protection' mode='sync'>\n",
    "comments": "",
    "outputs": 1,
    "x": 418.42860412597656,
    "y": 215.00003051757812,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "610b4dde.c4293c"
      ]
    ]
  },
  {
    "id": "610b4dde.c4293c",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 728.238037109375,
    "y": 206.66668701171875,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "61751fea.5e29c",
        "fda13949.60eb78",
        "47d2cfff.4a0e4",
        "8845442c.1d5de8",
        "72564454.b964f4"
      ]
    ]
  },
  {
    "id": "554ac9a2.79f95",
    "type": "set",
    "name": "set tmp.aai.vpn-binding",
    "xml": "<set>\n<parameter name='tmp.aai.vpn-binding.' value=\"`$tmp.aai.all-vpn-bindings.vpn-binding[$vpnbidx].`\" />\n",
    "comments": "",
    "x": 1986,
    "y": 266,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "e1c41eb3.6dc5b8",
    "type": "set",
    "name": "set attachment_param for OTN A",
    "xml": "<set>\n<parameter name='src-node-id' value='`$tmp.aai.vpn-bindingA.src-access-node-id`' />\n<parameter name='dst-node-id' value='`$tmp.aai.vpn-bindingA.dst-access-node-id`' />\n<!--<parameter name='dst-tpn-id' value='1' />-->\n<parameter name='dst-tpn-id' value='`$tmp.aai.vpn-bindingA.customer-vpn-id`' />\n<parameter name='dst-ttp-id' value='`$tmp.aai.vpn-bindingA.dst-access-ltp-id`' />\n<parameter name='slice-instance-id' value='`$tmp.aai.service-instance.service-instance-id`' />\n<parameter name='otn-tunnel-name-src-domain' value='`$tmp.aai.vpn-bindingA.vpn-name`' />\n<parameter name='client-id' value='`$tmp.aai.vpn-bindingA.access-client-id`' />\n<parameter name='provider-id' value='`$tmp.aai.vpn-bindingA.access-provider-id`' />\n<parameter name='topology-id' value='`$tmp.aai.vpn-bindingA.access-topology-id`' />\n",
    "comments": "",
    "x": 4155,
    "y": 152,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "7981558d.d1f29c",
    "type": "execute",
    "name": "execute RestApiCallNode Create OTN tunnel with token",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.cll-otn-src-domain-creation.templatefile`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainA.url + '/restconf/data/ietf-te:te'`\" />\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainA.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainA.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"patch\"/>\n<parameter name=\"responsePrefix\" value=\"otn-oof\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n<parameter name='customHttpHeaders' value=\"`'X-ACCESS-TOKEN=' + $prop.sdncRestApi.token_id`\" />",
    "comments": "",
    "outputs": 1,
    "x": 4236,
    "y": 467,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "4cd7b5eb.5f75fc",
        "8c7597f3.3a32c"
      ]
    ]
  },
  {
    "id": "4cd7b5eb.5f75fc",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 4545.5,
    "y": 436,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "6a15735b.8f38bc"
      ]
    ]
  },
  {
    "id": "8c7597f3.3a32c",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 4550.5,
    "y": 501,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "531c74ae.aa6424"
      ]
    ]
  },
  {
    "id": "6a15735b.8f38bc",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create OTN tunnel rest api\" />\n",
    "comments": "",
    "x": 4721.5,
    "y": 436,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "531c74ae.aa6424",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "comments": "",
    "outputs": 1,
    "x": 4717,
    "y": 501,
    "z": "b60623c5.e2d9e8",
    "wires": [
      []
    ]
  },
  {
    "id": "43cf60a0.0fca68",
    "type": "set",
    "name": "set sotn_value",
    "xml": "<set>\n<!--<parameter name='eth-service-name' value='`$tmp.aai.connectivityA.connectivity-id`' />-->\n<parameter name='eth-service-name' value='`$tmp.aai.connectivityA.etht-svc-name`' />\n<parameter name='slice-id' value='`$vnf-topology-operation-input.service-information.service-instance-id`' />\n<parameter name='provider-id' value='`$tmp.aai.connectivityA.access-provider-id`' />\n<parameter name='client-id' value='`$tmp.aai.connectivityA.access-client-id`' />\n<parameter name='topology-id' value='`$tmp.aai.connectivityA.access-topology-id`' />\n<parameter name='otn-tunnel-name' value='`$tmp.aai.vpn-bindingA.vpn-name`' />\n<parameter name='ethernet-end-point-name' value='`$tmp.aai.connectivityA.connectivity-id`' />\n<parameter name='index-number' value='0' />\n<parameter name='eth-node-id' value='`$tmp.aai.connectivityA.access-node-id`' />\n<parameter name='eth-node-tp-id' value='`$tmp.aai.connectivityA.access-ltp-id`' />\n<parameter name='CIR' value='`$tmp.aai.vpn-bindingA.route-distinguisher *1000000`' />\n<parameter name='EIR' value='`$tmp.aai.vpn-bindingA.route-distinguisher *1000000`' />\n<parameter name='cvlan' value='`$tmp.aai.connectivityA.cvlan`' />\n",
    "comments": "",
    "x": 4100.5,
    "y": 721,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "1699b103.56f9ff",
    "type": "execute",
    "name": "execute RestApiCallNode Create ethernet Service without token",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.ts-ethernet-service.templatefile`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainA.url + '/restconf/data/ietf-eth-tran-service:etht-svc'`\" />\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.restapi.connection-oof-url`\" />-->\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainA.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainA.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"patch\"/>\n<parameter name='dirPath' value=\"/opt/onap/sdnc/restconfapi/yang\" />\n<parameter name=\"responsePrefix\" value=\"vpn-result\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n",
    "comments": "",
    "outputs": 1,
    "x": 4254.5,
    "y": 769,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "430829b5.022a48",
        "ab60153e.89b358"
      ]
    ]
  },
  {
    "id": "430829b5.022a48",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 4600,
    "y": 750,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "af17e669.a567c"
      ]
    ]
  },
  {
    "id": "ab60153e.89b358",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 4604,
    "y": 790,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "879a181e.1e28f"
      ]
    ]
  },
  {
    "id": "af17e669.a567c",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create ethernet service rest api\" />\n",
    "comments": "",
    "x": 4758,
    "y": 750,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "879a181e.1e28f",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "comments": "",
    "outputs": 1,
    "x": 4761.5,
    "y": 790,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "c2dfb11c.b0c48",
        "18154ac9.e63ffd"
      ]
    ]
  },
  {
    "id": "c2dfb11c.b0c48",
    "type": "save",
    "name": "update vpn-binding A resource (aka. OTN domainA) in AAI",
    "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding' \n      key='vpn-binding.vpn-id = $tmp.aai.vpn-bindingA.vpn-id' >\n<parameter name='vpn-id' value='`$tmp.aai.vpn-bindingA.vpn-id`' />\n<parameter name='vpn-name' value='`$tmp.aai.vpn-bindingA.vpn-name`' />\n\n<parameter name='operational-status' value='Activated' />\n",
    "comments": "",
    "outputs": 1,
    "x": 5092,
    "y": 755,
    "z": "b60623c5.e2d9e8",
    "wires": [
      []
    ]
  },
  {
    "id": "4bfe8ff3.b5155",
    "type": "comment",
    "name": "TODO: FIXME",
    "info": "use proper vpn-binding id and connectivity id\n\nAlso, does CCSDK support \"update\" operation for vpn-binding and connectivity?",
    "comments": "",
    "x": 4956,
    "y": 714,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "18154ac9.e63ffd",
    "type": "save",
    "name": "update connectivity resource in AAI",
    "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='connectivity' \n      key='connectivity.connectivity-id = $tmp.aai.connectivityA.connectivity-id'>\n<parameter name='connectivity-id' value='`$tmp.aai.connectivityA.connectivity-id`' />\n<parameter name='operational-status' value='Activated' />\n",
    "comments": "",
    "outputs": 1,
    "x": 5019,
    "y": 801,
    "z": "b60623c5.e2d9e8",
    "wires": [
      []
    ]
  },
  {
    "id": "be8a4aef.c70ad",
    "type": "set",
    "name": "set pnf-name",
    "xml": "<set>\n<parameter name='tmp.src.domainA.pnf-name' value=\"`'networkId-providerId-' +\n                                                   $tmp.aai.vpn-bindingA.access-provider-id + '-clientId-' +\n                                                   $tmp.aai.vpn-bindingA.access-client-id + '-topologyId-' +\n                                                   $tmp.aai.vpn-bindingA.access-topology-id + '-nodeId-' +\n                                                   $tmp.aai.vpn-bindingA.src-access-node-id`\" />\n",
    "comments": "",
    "x": 4093,
    "y": 200,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "c13323e9.9191e8",
    "type": "get-resource",
    "name": "get-resource src pnf",
    "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"pnf\" \n\t\tkey=\"pnf.pnf-name = $tmp.src.domainA.pnf-name\"\n        pfx='tmp.aai.source-pnf' local-only='false' >\n\n        <!--AND depth = '0'\"-->\n",
    "comments": "",
    "outputs": 1,
    "x": 4119,
    "y": 317,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "fa844cfe.7b9158",
        "40f7f2e0.45e324",
        "9ec0d41c.764348"
      ]
    ]
  },
  {
    "id": "fa844cfe.7b9158",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 4314.5001220703125,
    "y": 269,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "c5cba661.1feb9"
      ]
    ]
  },
  {
    "id": "40f7f2e0.45e324",
    "type": "not-found",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 4306.5001220703125,
    "y": 324,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "fa86521c.e230b8"
      ]
    ]
  },
  {
    "id": "c5cba661.1feb9",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 4458.8824462890625,
    "y": 268.6556701660156,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "fff76825.ceb828"
      ]
    ]
  },
  {
    "id": "12d83cc7.207cc3",
    "type": "outcome",
    "name": "esr-thirdparty-sdnc",
    "xml": "<outcome value='esr-thirdparty-sdnc'>\n",
    "comments": "",
    "outputs": 1,
    "x": 5041,
    "y": 271,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "f3a906e6.516618"
      ]
    ]
  },
  {
    "id": "fff76825.ceb828",
    "type": "for",
    "name": "for each relationship",
    "xml": "<for silentFailure='true' index='spvidx' start='0' end='`$tmp.aai.source-pnf.relationship-list.relationship_length`' >\n",
    "comments": "",
    "outputs": 1,
    "x": 4643,
    "y": 267,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "8f09ed7e.8205c8"
      ]
    ]
  },
  {
    "id": "8f09ed7e.8205c8",
    "type": "switchNode",
    "name": "switch related-to",
    "xml": "<switch test='`$tmp.aai.source-pnf.relationship-list.relationship[$spvidx].related-to`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 4838,
    "y": 267,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "12d83cc7.207cc3"
      ]
    ]
  },
  {
    "id": "9ec0d41c.764348",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 4311.5001220703125,
    "y": 381,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "4cb38d5a.2cd9fc"
      ]
    ]
  },
  {
    "id": "4cb38d5a.2cd9fc",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
    "comments": "",
    "x": 4463.5001220703125,
    "y": 382,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "fa86521c.e230b8",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
    "comments": "",
    "x": 4474.5001220703125,
    "y": 325,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "fd5c650b.7ed3f8",
    "type": "execute",
    "name": "get esr-thirdparty-sdnc",
    "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"esr-thirdparty-sdnc\" \n\t\tkey=\"esr-thirdparty-sdnc.thirdparty-sdnc-id = $tmp.domainA.esr-thirdparty-id AND \n\t\t     depth = '1'\"\n        pfx='tmp.aai.domainA.esr-thirdparty-sdnc' local-only='false' >",
    "comments": "",
    "outputs": 1,
    "x": 5426,
    "y": 284,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "11189fd0.36c55",
        "2f53389c.6ed7",
        "160dc233.835476"
      ]
    ]
  },
  {
    "id": "f3a906e6.516618",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 5220,
    "y": 271,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "8e3bb227.50f04",
        "fd5c650b.7ed3f8"
      ]
    ]
  },
  {
    "id": "8e3bb227.50f04",
    "type": "set",
    "name": "set esr-thirdparty-sdnc domainA id",
    "xml": "<set>\n<parameter name='tmp.domainA.esr-thirdparty-id' value=\"`$tmp.aai.source-pnf.relationship-list.relationship[$spvidx].relationship-data[0].relationship-value`\" />\n",
    "comments": "",
    "x": 5456,
    "y": 232,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "11189fd0.36c55",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 5636,
    "y": 275,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "aadf27e6.e781b8"
      ]
    ]
  },
  {
    "id": "2f53389c.6ed7",
    "type": "not-found",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 5628,
    "y": 330,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "fd2ad840.4523f"
      ]
    ]
  },
  {
    "id": "160dc233.835476",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 5633,
    "y": 387,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "2a94704d.0d4"
      ]
    ]
  },
  {
    "id": "2a94704d.0d4",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
    "comments": "",
    "x": 5785,
    "y": 388,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "fd2ad840.4523f",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
    "comments": "",
    "x": 5796,
    "y": 333,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "aadf27e6.e781b8",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 5780.38232421875,
    "y": 272.6556701660156,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "cdb54fc1.4aeb5"
      ]
    ]
  },
  {
    "id": "cdb54fc1.4aeb5",
    "type": "set",
    "name": "set controller domainA data",
    "xml": "<set>\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainA.url' value=\"`$tmp.aai.domainA.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].service-url`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainA.user' value=\"`$tmp.aai.domainA.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].user-name`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainA.password' value=\"`$tmp.aai.domainA.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].password`\" />\n\n\n<!--<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >-->\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/restconf/data/ietf-network:networks'`\" />-->\n<!--<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />-->\n<!--<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />-->\n<!--<parameter name=\"format\" value=\"json\"/>-->\n<!--<parameter name=\"httpMethod\" value=\"get\"/>-->\n<!--<parameter name=\"responsePrefix\" value=\"topology\"/>-->\n<!--<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>-->\n<!--<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>-->\n<!--<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>-->\n<!--<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>-->\n",
    "comments": "",
    "x": 5995,
    "y": 269,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "33053457.2cf334",
    "type": "set",
    "name": "set attachment_param for OTN B",
    "xml": "<set>\n<parameter name='src-node-id' value='`$tmp.aai.vpn-bindingB.src-access-node-id`' />\n<parameter name='dst-node-id' value='`$tmp.aai.vpn-bindingB.dst-access-node-id`' />\n<!--<parameter name='src-tpn-id' value='1' />-->\n<parameter name='src-tpn-id' value='`$tmp.aai.vpn-bindingB.customer-vpn-id`' />\n<parameter name='src-ttp-id' value='`$tmp.aai.vpn-bindingB.src-access-ltp-id`' />\n<parameter name='slice-instance-id' value='`$tmp.aai.service-instance.service-instance-id`' />\n<parameter name='otn-tunnel-name-dst-domain' value='`$tmp.aai.vpn-bindingB.vpn-name`' />\n<parameter name='client-id' value='`$tmp.aai.vpn-bindingB.access-client-id`' />\n<parameter name='provider-id' value='`$tmp.aai.vpn-bindingB.access-provider-id`' />\n<parameter name='topology-id' value='`$tmp.aai.vpn-bindingB.access-topology-id`' />\n",
    "comments": "",
    "x": 3562,
    "y": 1609,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "4445f35f.408fdc",
    "type": "execute",
    "name": "execute RestApiCallNode Create OTN tunnel with token",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.cll-otn-dst-domain-creation.templatefile`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainB.url + '/restconf/data/ietf-te:te'`\" />\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainB.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainB.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"patch\"/>\n<parameter name=\"responsePrefix\" value=\"otn-oof\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n<parameter name='customHttpHeaders' value=\"`'X-ACCESS-TOKEN=' + $prop.sdncRestApi.token_id`\" />",
    "comments": "",
    "outputs": 1,
    "x": 3625,
    "y": 1938,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "862258db.691038",
        "af408a0a.92301"
      ]
    ]
  },
  {
    "id": "862258db.691038",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 3920.5,
    "y": 1905,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "95d8110a.825b98"
      ]
    ]
  },
  {
    "id": "af408a0a.92301",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 3925.5,
    "y": 1970,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "ef7aa326.5032b8"
      ]
    ]
  },
  {
    "id": "95d8110a.825b98",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create OTN tunnel rest api\" />\n",
    "comments": "",
    "x": 4088.5,
    "y": 1905,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "ef7aa326.5032b8",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "comments": "",
    "outputs": 1,
    "x": 4099,
    "y": 1970,
    "z": "b60623c5.e2d9e8",
    "wires": [
      []
    ]
  },
  {
    "id": "f246db35.fbb0b8",
    "type": "set",
    "name": "set pnf-name",
    "xml": "<set>\n<parameter name='tmp.dst.domainB.pnf-name' value=\"`'networkId-providerId-' +\n                                                   $tmp.aai.vpn-bindingB.access-provider-id + '-clientId-' +\n                                                   $tmp.aai.vpn-bindingB.access-client-id + '-topologyId-' +\n                                                   $tmp.aai.vpn-bindingB.access-topology-id + '-nodeId-' +\n                                                   $tmp.aai.vpn-bindingB.dst-access-node-id`\" />\n",
    "comments": "",
    "x": 3501,
    "y": 1666,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "2f733fde.bfa8d8",
    "type": "get-resource",
    "name": "get-resource dst pnf",
    "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"pnf\" \n\t\tkey=\"pnf.pnf-name = $tmp.dst.domainB.pnf-name\"\n        pfx='tmp.aai.destination-pnf' local-only='false' >\n\n        <!--AND depth = '0'\"-->\n",
    "comments": "",
    "outputs": 1,
    "x": 3521,
    "y": 1763,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "d82ed114.d26fe",
        "9b6a74e2.82fcf",
        "105e680c.d4fe88"
      ]
    ]
  },
  {
    "id": "d82ed114.d26fe",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 3723.5001220703125,
    "y": 1716,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "3d1669ca.d8e9be"
      ]
    ]
  },
  {
    "id": "9b6a74e2.82fcf",
    "type": "not-found",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 3715.5001220703125,
    "y": 1771,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "28df2cef.da0a5c"
      ]
    ]
  },
  {
    "id": "3d1669ca.d8e9be",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 3867.8824462890625,
    "y": 1713.6556701660156,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "b0c477a0.14b6b8"
      ]
    ]
  },
  {
    "id": "b0c477a0.14b6b8",
    "type": "for",
    "name": "for each relationship",
    "xml": "<for silentFailure='true' index='dpvidx' start='0' end='`$tmp.aai.destination-pnf.relationship-list.relationship_length`' >\n",
    "comments": "",
    "outputs": 1,
    "x": 4052,
    "y": 1728,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "e68df009.7524f"
      ]
    ]
  },
  {
    "id": "105e680c.d4fe88",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 3720.5001220703125,
    "y": 1828,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "3376d063.6334f8"
      ]
    ]
  },
  {
    "id": "3376d063.6334f8",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
    "comments": "",
    "x": 3872.5001220703125,
    "y": 1829,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "28df2cef.da0a5c",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
    "comments": "",
    "x": 3883.5001220703125,
    "y": 1774,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "86c78b55.020ad8",
    "type": "outcome",
    "name": "esr-thirdparty-sdnc",
    "xml": "<outcome value='esr-thirdparty-sdnc'>\n",
    "comments": "",
    "outputs": 1,
    "x": 4450,
    "y": 1732,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "de4526ed.169098"
      ]
    ]
  },
  {
    "id": "e68df009.7524f",
    "type": "switchNode",
    "name": "switch related-to",
    "xml": "<switch test='`$tmp.aai.destination-pnf.relationship-list.relationship[$dpvidx].related-to`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 4247,
    "y": 1728,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "86c78b55.020ad8"
      ]
    ]
  },
  {
    "id": "bd56a946.09bfc8",
    "type": "execute",
    "name": "get esr-thirdparty-sdnc",
    "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"esr-thirdparty-sdnc\" \n\t\tkey=\"esr-thirdparty-sdnc.thirdparty-sdnc-id = $tmp.domainB.esr-thirdparty-id AND \n\t\t     depth = '1'\"\n        pfx='tmp.aai.domainB.esr-thirdparty-sdnc' local-only='false' >",
    "comments": "",
    "outputs": 1,
    "x": 4835,
    "y": 1731,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "e62cd9e9.79901",
        "3835956c.352dfa",
        "ef4cce16.af464"
      ]
    ]
  },
  {
    "id": "de4526ed.169098",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 4627,
    "y": 1724,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "84662003.28e938",
        "bd56a946.09bfc8"
      ]
    ]
  },
  {
    "id": "84662003.28e938",
    "type": "set",
    "name": "set esr-thirdparty-sdnc domainB id",
    "xml": "<set>\n<parameter name='tmp.domainB.esr-thirdparty-id' value=\"`$tmp.aai.destination-pnf.relationship-list.relationship[$dpvidx].relationship-data[0].relationship-value`\" />\n",
    "comments": "",
    "x": 4865,
    "y": 1679,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "2e3a7484.41bcbc",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
    "comments": "",
    "x": 5194,
    "y": 1835,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "acb63215.67cbc8",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
    "comments": "",
    "x": 5205,
    "y": 1780,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "bb7e5ab5.c4089",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 5189.38232421875,
    "y": 1719.6556701660156,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "7c187be.7c53484"
      ]
    ]
  },
  {
    "id": "7c187be.7c53484",
    "type": "set",
    "name": "set controller domainB data",
    "xml": "<set>\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainB.url' value=\"`$tmp.aai.domainB.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].service-url`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainB.user' value=\"`$tmp.aai.domainB.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].user-name`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainB.password' value=\"`$tmp.aai.domainB.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].password`\" />\n\n\n<!--<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >-->\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/restconf/data/ietf-network:networks'`\" />-->\n<!--<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />-->\n<!--<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />-->\n<!--<parameter name=\"format\" value=\"json\"/>-->\n<!--<parameter name=\"httpMethod\" value=\"get\"/>-->\n<!--<parameter name=\"responsePrefix\" value=\"topology\"/>-->\n<!--<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>-->\n<!--<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>-->\n<!--<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>-->\n<!--<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>-->\n",
    "comments": "",
    "x": 5404,
    "y": 1716,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "e62cd9e9.79901",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 5045,
    "y": 1722,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "bb7e5ab5.c4089"
      ]
    ]
  },
  {
    "id": "3835956c.352dfa",
    "type": "not-found",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 5037,
    "y": 1777,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "acb63215.67cbc8"
      ]
    ]
  },
  {
    "id": "ef4cce16.af464",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 5042,
    "y": 1834,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "2e3a7484.41bcbc"
      ]
    ]
  },
  {
    "id": "1dc25027.0c33f8",
    "type": "switchNode",
    "name": "switch vpn-binding has dst-access-ltp",
    "xml": "<switch test='`$tmp.aai.vpn-binding.dst-access-ltp-id`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 3076,
    "y": 680,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "22e86b98.d5cd94",
        "18519633.e9ee92"
      ]
    ]
  },
  {
    "id": "22e86b98.d5cd94",
    "type": "outcome",
    "name": "Null",
    "xml": "<outcome value=''>\n",
    "comments": "",
    "outputs": 1,
    "x": 3290,
    "y": 717,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "d8801466.520d4"
      ]
    ]
  },
  {
    "id": "18519633.e9ee92",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 3292,
    "y": 655,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "6bc727fb.e5e2c8"
      ]
    ]
  },
  {
    "id": "d8801466.520d4",
    "type": "switchNode",
    "name": "switch vpn-binding has src-access-ltp",
    "xml": "<switch test='`$tmp.aai.vpn-binding.src-access-ltp-id`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2870,
    "y": 1960,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "57adf29e.03275c",
        "3c463d1c.a1e9ca"
      ]
    ]
  },
  {
    "id": "57adf29e.03275c",
    "type": "outcome",
    "name": "Null",
    "xml": "<outcome value=''>\n",
    "comments": "",
    "outputs": 1,
    "x": 3123,
    "y": 1994,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "163451dc.e800ce"
      ]
    ]
  },
  {
    "id": "3c463d1c.a1e9ca",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 3123,
    "y": 1938,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "72b99bc1.9d63c4"
      ]
    ]
  },
  {
    "id": "163451dc.e800ce",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
    "comments": "",
    "x": 3274,
    "y": 1994,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "2a6d840b.d2c9ec",
    "type": "set",
    "name": "set vpn-bindingA and connectivityA",
    "xml": "<set>\n<parameter name='tmp.aai.vpn-bindingA.' value=\"`$tmp.aai.vpn-binding.`\" />\n<parameter name='tmp.aai.connectivityA.' value=\"`$tmp.aai.connectivity.`\" />\n",
    "comments": "",
    "x": 4150,
    "y": 92,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "24792ed6.12e172",
    "type": "set",
    "name": "set vpn-bindingB and connectivityB",
    "xml": "<set>\n<parameter name='tmp.aai.vpn-bindingB.' value=\"`$tmp.aai.vpn-binding.`\" />\n<parameter name='tmp.aai.connectivityB.' value=\"`$tmp.aai.connectivity.`\" />\n\n",
    "comments": "",
    "x": 3558,
    "y": 1551,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "fe0662dd.a80948",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "comments": "",
    "outputs": 1,
    "x": 3841,
    "y": 349,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "2a6d840b.d2c9ec",
        "e1c41eb3.6dc5b8",
        "be8a4aef.c70ad",
        "c13323e9.9191e8",
        "7981558d.d1f29c",
        "1721d523.151643",
        "9094f518.043e98",
        "f54721e.ec69de"
      ]
    ]
  },
  {
    "id": "72b99bc1.9d63c4",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 3274,
    "y": 1937,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "24792ed6.12e172",
        "33053457.2cf334",
        "f246db35.fbb0b8",
        "2f733fde.bfa8d8",
        "4445f35f.408fdc",
        "7c2a5c1b.45951c",
        "db1559a9.21dcb8",
        "64935ddb.b635b4"
      ]
    ]
  },
  {
    "id": "1ddc6cc6.41baa3",
    "type": "set",
    "name": "set sotn_value",
    "xml": "<set>\n<!--<parameter name='eth-service-name' value='`$tmp.aai.connectivityB.connectivity-id`' />-->\n<parameter name='eth-service-name' value='`$tmp.aai.connectivityB.etht-svc-name`' />\n<parameter name='slice-id' value='`$vnf-topology-operation-input.service-information.service-instance-id`' />\n<parameter name='provider-id' value='`$tmp.aai.connectivityB.access-provider-id`' />\n<parameter name='client-id' value='`$tmp.aai.connectivityB.access-client-id`' />\n<parameter name='topology-id' value='`$tmp.aai.connectivityB.access-topology-id`' />\n<parameter name='otn-tunnel-name' value='`$tmp.aai.vpn-bindingB.vpn-name`' />\n<parameter name='ethernet-end-point-name' value='`$tmp.aai.connectivityB.connectivity-id`' />\n<parameter name='index-number' value='0' />\n<parameter name='eth-node-id' value='`$tmp.aai.connectivityB.access-node-id`' />\n<parameter name='eth-node-tp-id' value='`$tmp.aai.connectivityB.access-ltp-id`' />\n<parameter name='CIR' value='`$tmp.aai.vpn-bindingB.route-distinguisher *1000000`' />\n<parameter name='EIR' value='`$tmp.aai.vpn-bindingB.route-distinguisher *1000000`' />\n<parameter name='cvlan' value='`$tmp.aai.connectivityB.cvlan`' />\n\n",
    "comments": "",
    "x": 3512,
    "y": 2236,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "88e2026c.753db8",
    "type": "execute",
    "name": "execute RestApiCallNode Create ethernet Service without token",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.ts-ethernet-service.templatefile`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainB.url + '/restconf/data/ietf-eth-tran-service:etht-svc'`\" />\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.restapi.connection-oof-url`\" />-->\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainB.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainB.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"patch\"/>\n<parameter name='dirPath' value=\"/opt/onap/sdnc/restconfapi/yang\" />\n<parameter name=\"responsePrefix\" value=\"vpn-result\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n",
    "comments": "",
    "outputs": 1,
    "x": 3666,
    "y": 2284,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "e41adb3.0072828",
        "6a4db145.9abb38"
      ]
    ]
  },
  {
    "id": "e41adb3.0072828",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 4011.5,
    "y": 2265,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "b46428d7.0cf41"
      ]
    ]
  },
  {
    "id": "6a4db145.9abb38",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 4015.5,
    "y": 2305,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "1616e093.24d98f"
      ]
    ]
  },
  {
    "id": "b46428d7.0cf41",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create ethernet service rest api\" />\n",
    "comments": "",
    "x": 4169.5,
    "y": 2265,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "1616e093.24d98f",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "comments": "",
    "outputs": 1,
    "x": 4173,
    "y": 2305,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "f5ad5aa7.4c2ca",
        "f30a934b.4a146"
      ]
    ]
  },
  {
    "id": "f5ad5aa7.4c2ca",
    "type": "save",
    "name": "update vpn-binding B resource (aka. OTN domainB) in AAI",
    "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding' \n      key='vpn-binding.vpn-id = $tmp.aai.vpn-bindingB.vpn-id' >\n<parameter name='vpn-id' value='`$tmp.aai.vpn-bindingB.vpn-id`' />\n<parameter name='vpn-name' value='`$tmp.aai.vpn-bindingB.vpn-name`' />\n\n<parameter name='operational-status' value='Activated' />\n",
    "comments": "",
    "outputs": 1,
    "x": 4513,
    "y": 2304,
    "z": "b60623c5.e2d9e8",
    "wires": [
      []
    ]
  },
  {
    "id": "14882444.425ec4",
    "type": "comment",
    "name": "TODO: FIXME",
    "info": "use proper vpn-binding id and connectivity\n\nAlso, does CCSDK support \"update\" operation for vpn-binding and connectivity?",
    "comments": "",
    "x": 4371,
    "y": 2262,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "f30a934b.4a146",
    "type": "save",
    "name": "update connectivity resource in AAI",
    "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='connectivity' \n      key='connectivity.connectivity-id = $tmp.aai.connectivityB.connectivity-id'>\n<parameter name='connectivity-id' value='`$tmp.aai.connectivityB.connectivity-id`' />\n<parameter name='operational-status' value='Activated' />\n",
    "comments": "",
    "outputs": 1,
    "x": 4442,
    "y": 2353,
    "z": "b60623c5.e2d9e8",
    "wires": [
      []
    ]
  },
  {
    "id": "35b5f42.3d7048c",
    "type": "set",
    "name": "set attachment_param (gfp-n) for OTN",
    "xml": "<set>\n<parameter name='gfp-n' value='`$tmp.aai.vpn-binding.route-distinguisher`' />\n",
    "comments": "",
    "x": 3067,
    "y": 620,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "672937f1.5c86c",
    "type": "comment",
    "name": "only dst ttp exists. No src",
    "info": "",
    "comments": "",
    "x": 3662,
    "y": 306,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "cf6d8000.914ec",
    "type": "comment",
    "name": "only src ttp exists. No dst",
    "info": "",
    "comments": "",
    "x": 3219,
    "y": 1884,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "6bc727fb.e5e2c8",
    "type": "switchNode",
    "name": "switch vpn-binding has src-access-ltp",
    "xml": "<switch test='`$tmp.aai.vpn-binding.src-access-ltp-id`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 3398,
    "y": 468,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "16d04d16.35cc13",
        "81d801a9.0be79"
      ]
    ]
  },
  {
    "id": "81d801a9.0be79",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 3640,
    "y": 1057,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "87bd1b21.78447"
      ]
    ]
  },
  {
    "id": "16d04d16.35cc13",
    "type": "outcome",
    "name": "Null",
    "xml": "<outcome value=''>\n",
    "comments": "",
    "outputs": 1,
    "x": 3634,
    "y": 348,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "fe0662dd.a80948"
      ]
    ]
  },
  {
    "id": "87bd1b21.78447",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 3798,
    "y": 1056,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "6a4fd43b.29d0a4",
        "bb732000.b077a",
        "14bb373f.07c761",
        "ee3130b2.515378",
        "25e58429.ad4ee4",
        "13fd978.b0ce7e9"
      ]
    ]
  },
  {
    "id": "bb732000.b077a",
    "type": "set",
    "name": "set attachment_param for OTN G",
    "xml": "<set>\n<parameter name='src-node-id' value='`$tmp.aai.vpn-bindingG.src-access-node-id`' />\n<parameter name='dst-node-id' value='`$tmp.aai.vpn-bindingG.dst-access-node-id`' />\n<!--<parameter name='dst-tpn-id' value='1' />-->\n<parameter name='src-tpn-id' value='`$tmp.aai.vpn-bindingG.customer-vpn-id`' />\n<parameter name='dst-tpn-id' value='`$tmp.aai.vpn-bindingG.customer-vpn-id`' />\n<parameter name='src-ttp-id' value='`$tmp.aai.vpn-bindingG.src-access-ltp-id`' />\n<parameter name='dst-ttp-id' value='`$tmp.aai.vpn-bindingG.dst-access-ltp-id`' />\n<parameter name='slice-instance-id' value='`$tmp.aai.service-instance.service-instance-id`' />\n<parameter name='otn-tunnel-name-domainG' value='`$tmp.aai.vpn-bindingG.vpn-name`' />\n<parameter name='client-id' value='`$tmp.aai.vpn-bindingG.access-client-id`' />\n<parameter name='provider-id' value='`$tmp.aai.vpn-bindingG.access-provider-id`' />\n<parameter name='topology-id' value='`$tmp.aai.vpn-bindingG.access-topology-id`' />\n",
    "comments": "",
    "x": 4062,
    "y": 939,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "25e58429.ad4ee4",
    "type": "execute",
    "name": "execute RestApiCallNode Create OTN tunnel with token",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.cll-otn-domainG-creation.templatefile`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainG.url + '/restconf/data/ietf-te:te'`\" />\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainG.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainG.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"patch\"/>\n<parameter name=\"responsePrefix\" value=\"otn-oof\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n<parameter name='customHttpHeaders' value=\"`'X-ACCESS-TOKEN=' + $prop.sdncRestApi.token_id`\" />",
    "comments": "",
    "outputs": 1,
    "x": 4143,
    "y": 1254,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "69f73464.0e3e8c",
        "5f37ff67.4bb2f"
      ]
    ]
  },
  {
    "id": "69f73464.0e3e8c",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 4452.5,
    "y": 1223,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "43cec921.9d623"
      ]
    ]
  },
  {
    "id": "5f37ff67.4bb2f",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 4457.5,
    "y": 1288,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "a900d0fc.b4f8e"
      ]
    ]
  },
  {
    "id": "43cec921.9d623",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create OTN tunnel rest api\" />\n",
    "comments": "",
    "x": 4628.5,
    "y": 1223,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "a900d0fc.b4f8e",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "comments": "",
    "outputs": 1,
    "x": 4624,
    "y": 1288,
    "z": "b60623c5.e2d9e8",
    "wires": [
      []
    ]
  },
  {
    "id": "14bb373f.07c761",
    "type": "set",
    "name": "set pnf-name",
    "xml": "<set>\n<parameter name='tmp.domainG.pnf-name' value=\"`'networkId-providerId-' +\n                                                   $tmp.aai.vpn-bindingG.access-provider-id + '-clientId-' +\n                                                   $tmp.aai.vpn-bindingG.access-client-id + '-topologyId-' +\n                                                   $tmp.aai.vpn-bindingG.access-topology-id + '-nodeId-' +\n                                                   $tmp.aai.vpn-bindingG.src-access-node-id`\" />\n",
    "comments": "",
    "x": 4000,
    "y": 987,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "ee3130b2.515378",
    "type": "get-resource",
    "name": "get-resource src pnf",
    "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"pnf\" \n\t\tkey=\"pnf.pnf-name = $tmp.domainG.pnf-name\"\n        pfx='tmp.aai.domainG-pnf' local-only='false' >\n\n        <!--AND depth = '0'\"-->\n",
    "comments": "",
    "outputs": 1,
    "x": 4026,
    "y": 1104,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "7994d48a.ca38a4",
        "46376621.e31dd8",
        "662f2070.bc1d4"
      ]
    ]
  },
  {
    "id": "7994d48a.ca38a4",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 4221.5001220703125,
    "y": 1056,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "28f98c5.d17c774"
      ]
    ]
  },
  {
    "id": "46376621.e31dd8",
    "type": "not-found",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 4213.5001220703125,
    "y": 1111,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "b6666e55.258c4"
      ]
    ]
  },
  {
    "id": "28f98c5.d17c774",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 4365.8824462890625,
    "y": 1055.6556701660156,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "abee57b5.2a2df"
      ]
    ]
  },
  {
    "id": "abee57b5.2a2df",
    "type": "for",
    "name": "for each relationship",
    "xml": "<for silentFailure='true' index='spvidx' start='0' end='`$tmp.aai.domainG-pnf.relationship-list.relationship_length`' >\n",
    "comments": "",
    "outputs": 1,
    "x": 4550,
    "y": 1054,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "4e7ce11e.d4486"
      ]
    ]
  },
  {
    "id": "4e7ce11e.d4486",
    "type": "switchNode",
    "name": "switch related-to",
    "xml": "<switch test='`$tmp.aai.domainG-pnf.relationship-list.relationship[$spvidx].related-to`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 4745,
    "y": 1054,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "cd73aa8e.57927"
      ]
    ]
  },
  {
    "id": "662f2070.bc1d4",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 4218.5001220703125,
    "y": 1168,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "65647ec7.0c6e5"
      ]
    ]
  },
  {
    "id": "65647ec7.0c6e5",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
    "comments": "",
    "x": 4370.5001220703125,
    "y": 1169,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "b6666e55.258c4",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
    "comments": "",
    "x": 4381.5001220703125,
    "y": 1112,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "6a4fd43b.29d0a4",
    "type": "set",
    "name": "set vpn-bindingG and connectivityG",
    "xml": "<set>\n<parameter name='tmp.aai.vpn-bindingG.' value=\"`$tmp.aai.vpn-binding.`\" />\n<parameter name='tmp.aai.connectivityG.' value=\"`$tmp.aai.connectivity.`\" />\n",
    "comments": "",
    "x": 4057,
    "y": 879,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "cd73aa8e.57927",
    "type": "outcome",
    "name": "esr-thirdparty-sdnc",
    "xml": "<outcome value='esr-thirdparty-sdnc'>\n",
    "comments": "",
    "outputs": 1,
    "x": 4948,
    "y": 1058,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "d2b1d416.053a58"
      ]
    ]
  },
  {
    "id": "66918eb9.ab92e8",
    "type": "execute",
    "name": "get esr-thirdparty-sdnc",
    "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"esr-thirdparty-sdnc\" \n\t\tkey=\"esr-thirdparty-sdnc.thirdparty-sdnc-id = $tmp.domainG.esr-thirdparty-id AND \n\t\t     depth = '1'\"\n        pfx='tmp.aai.domainG.esr-thirdparty-sdnc' local-only='false' >",
    "comments": "",
    "outputs": 1,
    "x": 5333,
    "y": 1071,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "f8b9a196.010a1",
        "fd17d420.f985",
        "40d42743.f42fd8"
      ]
    ]
  },
  {
    "id": "d2b1d416.053a58",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 5127,
    "y": 1058,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "c71b3067.5066e8",
        "66918eb9.ab92e8"
      ]
    ]
  },
  {
    "id": "c71b3067.5066e8",
    "type": "set",
    "name": "set esr-thirdparty-sdnc domainG id",
    "xml": "<set>\n<parameter name='tmp.domainG.esr-thirdparty-id' value=\"`$tmp.aai.domainG-pnf.relationship-list.relationship[$spvidx].relationship-data[0].relationship-value`\" />\n",
    "comments": "",
    "x": 5363,
    "y": 1019,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "f8b9a196.010a1",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 5543,
    "y": 1062,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "27038b3e.3bcfc4"
      ]
    ]
  },
  {
    "id": "fd17d420.f985",
    "type": "not-found",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 5535,
    "y": 1117,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "967c6c86.0bbb78"
      ]
    ]
  },
  {
    "id": "40d42743.f42fd8",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 5540,
    "y": 1174,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "35455e8c.6afe9a"
      ]
    ]
  },
  {
    "id": "35455e8c.6afe9a",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
    "comments": "",
    "x": 5692,
    "y": 1175,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "967c6c86.0bbb78",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
    "comments": "",
    "x": 5703,
    "y": 1120,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "27038b3e.3bcfc4",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 5687.38232421875,
    "y": 1059.6556701660156,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "501ec52c.0a5be4"
      ]
    ]
  },
  {
    "id": "501ec52c.0a5be4",
    "type": "set",
    "name": "set controller domainG data",
    "xml": "<set>\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainG.url' value=\"`$tmp.aai.domainG.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].service-url`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainG.user' value=\"`$tmp.aai.domainG.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].user-name`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainG.password' value=\"`$tmp.aai.domainG.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].password`\" />\n\n\n<!--<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >-->\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/restconf/data/ietf-network:networks'`\" />-->\n<!--<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />-->\n<!--<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />-->\n<!--<parameter name=\"format\" value=\"json\"/>-->\n<!--<parameter name=\"httpMethod\" value=\"get\"/>-->\n<!--<parameter name=\"responsePrefix\" value=\"topology\"/>-->\n<!--<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>-->\n<!--<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>-->\n<!--<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>-->\n<!--<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>-->\n",
    "comments": "",
    "x": 5902,
    "y": 1056,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "ce5771d5.1db118",
    "type": "comment",
    "name": "both src and dst exist",
    "info": "",
    "comments": "",
    "x": 3676,
    "y": 997,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "2ade390a.34dac6",
    "type": "switchNode",
    "name": "switch vpn-binding is not already Activated (i.e. is either Created or Modified)",
    "xml": "<switch test=\"`$tmp.aai.vpn-binding.operational-status != 'Activated' `\">\n",
    "comments": "",
    "outputs": 1,
    "x": 2238,
    "y": 724,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "faa20144.28683",
        "a3241eaf.e05748"
      ]
    ]
  },
  {
    "id": "a3241eaf.e05748",
    "type": "outcomeFalse",
    "name": "false",
    "xml": "<outcome value='false'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2645,
    "y": 742,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "73c18a9e.ba438c"
      ]
    ]
  },
  {
    "id": "faa20144.28683",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2645,
    "y": 687,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "d5f3133.6f4a0f"
      ]
    ]
  },
  {
    "id": "d5f3133.6f4a0f",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 2801,
    "y": 685,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "35b5f42.3d7048c",
        "1dc25027.0c33f8"
      ]
    ]
  },
  {
    "id": "73c18a9e.ba438c",
    "type": "block",
    "name": "block",
    "xml": "<block>",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 2778,
    "y": 743,
    "z": "b60623c5.e2d9e8",
    "wires": [
      []
    ]
  },
  {
    "id": "fda13949.60eb78",
    "type": "set",
    "name": "unset tmp.aai.all-vpn-bindings",
    "xml": "<set>\n<parameter name='tmp.aai.all-vpn-bindings.' value=\"\" />\n",
    "comments": "",
    "x": 955,
    "y": 159,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "38085312.8a965c",
    "type": "comment",
    "name": "CLL new",
    "info": "construct two array structures like these:\n\n${otn-tunnels-name-list[${1}].otn-tunnel-name}\n\n----------------\n${ethernet-srv-end-points-list[${1}].ethernet-end-point-name}\n${ethernet-srv-end-points-list[${1}].index-number},\n${ethernet-srv-end-points-list[${1}].eth-node-id},\n${ethernet-srv-end-points-list[${1}].eth-node-tp-id},\n${ethernet-srv-end-points-list[${1}].leafOrRootAccess}\n${ethernet-srv-end-points-list[${1}].cvlan}\n${ethernet-srv-end-points-list[${1}].CIR}\n${ethernet-srv-end-points-list[${1}].EIR}",
    "comments": "",
    "x": 4072,
    "y": 577,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "1721d523.151643",
    "type": "set",
    "name": "set leaf-otn-tunnels-list array",
    "xml": "<set>\n<parameter name='`leaf-tunnels-list[$leaftunsidx].tunnel-name`' value='`$tmp.aai.vpn-binding.vpn-name`' />\n<parameter name='`leaf-tunnels-list[$leaftunsidx].vpn-id`' value='`$tmp.aai.vpn-binding.vpn-id`' />\n<parameter name='`leaf-tunnels-list_length`' value='`$leaftunsidx + 1`' />\n",
    "comments": "",
    "x": 4132,
    "y": 616,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "47d2cfff.4a0e4",
    "type": "set",
    "name": "unset leaf-otn-tunnels-list array",
    "xml": "<set>\n<parameter name='`leaf-tunnels-list.`' value='' />\n<parameter name='`leaf-tunnels-list_length`' value='0' />\n<parameter name='`leaftunsidx`' value='0' />\n",
    "comments": "",
    "x": 948,
    "y": 67,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "be7a05aa.4b83b",
    "type": "comment",
    "name": "CLL new",
    "info": "construct two array structures like these:\n\n${otn-tunnels-name-list[${1}].otn-tunnel-name}\n\n----------------\n${ethernet-srv-end-points-list[${1}].ethernet-end-point-name}\n${ethernet-srv-end-points-list[${1}].index-number},\n${ethernet-srv-end-points-list[${1}].eth-node-id},\n${ethernet-srv-end-points-list[${1}].eth-node-tp-id},\n${ethernet-srv-end-points-list[${1}].leafOrRootAccess}\n${ethernet-srv-end-points-list[${1}].cvlan}\n${ethernet-srv-end-points-list[${1}].CIR}\n${ethernet-srv-end-points-list[${1}].EIR}",
    "comments": "",
    "x": 3484,
    "y": 2093,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "7c2a5c1b.45951c",
    "type": "set",
    "name": "set root-otn-tunnels-list array",
    "xml": "<set>\n<parameter name='`root-tunnels-list[$roottunsidx].tunnel-name`' value='`$tmp.aai.vpn-binding.vpn-name`' />\n<parameter name='`root-tunnels-list[$roottunsidx].vpn-id`' value='`$tmp.aai.vpn-binding.vpn-id`' />\n<parameter name='`root-tunnels-list_length`' value='`$roottunsidx + 1`' />\n",
    "comments": "",
    "x": 3540,
    "y": 2142,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "f179b432.4e819",
    "type": "set",
    "name": "unset root-otn-tunnels-list array",
    "xml": "<set>\n<parameter name='`root-tunnels-list.`' value='' />\n<parameter name='`root-tunnels-list_length`' value='0' />\n<parameter name='`roottunsidx`' value='0' />\n",
    "comments": "",
    "x": 948,
    "y": 106,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "8845442c.1d5de8",
    "type": "execute",
    "name": "execute properties",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.prop.PropertiesNode' method='readProperties' >\n    <parameter name='fileName' value='%SDNC_CONFIG_DIR%/generic-resource-api-dg.properties' />\n    <parameter name='contextPrefix' value='prop' />",
    "comments": "",
    "outputs": 1,
    "x": 979,
    "y": 207,
    "z": "b60623c5.e2d9e8",
    "wires": [
      []
    ]
  },
  {
    "id": "72564454.b964f4",
    "type": "save",
    "name": "get service-instance from aai",
    "xml": "<!--<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" -->\n<!--\tresource=\"service-instance\"-->\n<!--\tkey='service-instance.service-instance-id = $service-data.vnfs.vnf[$tmp.vidx].vnf-data.service-information.service-instance-id-->\n<!--         AND customer.global-customer-id = $service-data.vnfs.vnf[$tmp.vidx].vnf-data.service-information.global-customer-id -->\n<!--         AND service-subscription.service-type = $service-data.vnfs.vnf[$tmp.vidx].vnf-data.service-information.subscription-service-type'-->\n<!--\tlocal-only=\"false\"-->\n<!--\tforce=\"true\" pfx=\"tmp.aai.service-instance\">-->\n\n<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"service-instance\"\n\tkey='service-instance.service-instance-id = $vnf-topology-operation-input.service-information.service-instance-id\n         AND customer.global-customer-id = $vnf-topology-operation-input.service-information.global-customer-id \n         AND service-subscription.service-type = $vnf-topology-operation-input.service-information.subscription-service-type'\n\tlocal-only=\"false\"\n\tforce=\"true\" pfx=\"tmp.aai.service-instance\">\n\n\n<!--$vnf-topology-operation-input.service-information.service-instance-id-->",
    "comments": "",
    "outputs": 1,
    "x": 189,
    "y": 682,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "130c8849.c68768",
        "9607da93.a7cfb8",
        "675a11bf.37e84"
      ]
    ]
  },
  {
    "id": "130c8849.c68768",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 408,
    "y": 620,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "19b84d16.53d643"
      ]
    ]
  },
  {
    "id": "9607da93.a7cfb8",
    "type": "not-found",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 417.490966796875,
    "y": 662.5740356445312,
    "z": "b60623c5.e2d9e8",
    "wires": [
      []
    ]
  },
  {
    "id": "675a11bf.37e84",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 406,
    "y": 709,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "13e02ffd.705ef8"
      ]
    ]
  },
  {
    "id": "19b84d16.53d643",
    "type": "for",
    "name": "for each relationship",
    "xml": "<for index='rel-index' start='0' end='`$tmp.aai.service-instance.relationship-list.relationship_length`' >\n",
    "comments": "",
    "outputs": 1,
    "x": 605,
    "y": 616,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "95aa58da.ce0078"
      ]
    ]
  },
  {
    "id": "13e02ffd.705ef8",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
    "comments": "",
    "x": 575,
    "y": 710,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "95aa58da.ce0078",
    "type": "switchNode",
    "name": "switch related-to",
    "xml": "<switch test='`$tmp.aai.service-instance.relationship-list.relationship[$rel-index].related-to`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 828.33349609375,
    "y": 615.9999389648438,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "82937c17.5a3278"
      ]
    ]
  },
  {
    "id": "82937c17.5a3278",
    "type": "outcome",
    "name": "connectivity",
    "xml": "<outcome value='connectivity'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1029.0001335144043,
    "y": 617.000020980835,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "7d4de732.7e236"
      ]
    ]
  },
  {
    "id": "7d4de732.7e236",
    "type": "save",
    "name": "get connectivity from aai",
    "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"connectivity\"\n\t    key=\"connectivity.connectivity-id = $tmp.aai.service-instance.relationship-list.relationship[$rel-index].relationship-data[0].relationship-value\"\n\t\tlocal-only=\"false\" \n\t\tpfx=\"tmp.aai.connectivity\" >\n",
    "comments": "",
    "outputs": 1,
    "x": 159,
    "y": 879,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "f6447d51.51534",
        "d2723085.ef21f",
        "14bf719a.197f76"
      ]
    ]
  },
  {
    "id": "f6447d51.51534",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 367,
    "y": 843,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "93da3cfa.70c248"
      ]
    ]
  },
  {
    "id": "d2723085.ef21f",
    "type": "not-found",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 367.490966796875,
    "y": 888.5740356445312,
    "z": "b60623c5.e2d9e8",
    "wires": [
      []
    ]
  },
  {
    "id": "14bf719a.197f76",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 365,
    "y": 932,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "836041f9.6829f8"
      ]
    ]
  },
  {
    "id": "836041f9.6829f8",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
    "comments": "",
    "x": 534,
    "y": 933,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "a94aa53a.b107d8",
    "type": "for",
    "name": "for each relationship",
    "xml": "<for silentFailure='true' index='cridx' start='0' end='`$tmp.aai.connectivity.relationship-list.relationship_length`' >\n\n",
    "comments": "",
    "outputs": 1,
    "x": 506,
    "y": 1427,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "21c47827.df1568"
      ]
    ]
  },
  {
    "id": "21c47827.df1568",
    "type": "switchNode",
    "name": "switch related-to",
    "xml": "<switch test='`$tmp.aai.connectivity.relationship-list.relationship[$cridx].related-to`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 709,
    "y": 1439,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "18be783b.f07278"
      ]
    ]
  },
  {
    "id": "18be783b.f07278",
    "type": "outcome",
    "name": "UNI",
    "xml": "<outcome value='uni'>\n",
    "comments": "",
    "outputs": 1,
    "x": 875,
    "y": 1436,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "11fb7f76.b02469"
      ]
    ]
  },
  {
    "id": "11fb7f76.b02469",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 1036,
    "y": 1433,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "47d6d37a.9fb43c",
        "1c027792.461348",
        "ea05bf35.5069",
        "9d31ed5b.d2c91",
        "23eb7cf4.f6cfdc",
        "99b18acf.7ec528"
      ]
    ]
  },
  {
    "id": "1c027792.461348",
    "type": "set",
    "name": "unset tmp.aai.uni",
    "xml": "<set>\n<parameter name='tmp.aai.uni.' value='' />\n",
    "comments": "",
    "x": 1242,
    "y": 1032.9999389648438,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "47d6d37a.9fb43c",
    "type": "save",
    "name": "get uni from aai",
    "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"uni\"\n\t    key=\"uni.id = $tmp.aai.connectivity.relationship-list.relationship[$cridx].relationship-data[0].relationship-value\"\n\t\tlocal-only=\"false\" \n\t\tpfx=\"tmp.aai.uni\" >\n",
    "comments": "",
    "outputs": 1,
    "x": 1239,
    "y": 1077.9999389648438,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "2a120b9c.2b340c",
        "41aafa7d.002584",
        "b80f04fd.7f4018"
      ]
    ]
  },
  {
    "id": "41aafa7d.002584",
    "type": "not-found",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1434.490966796875,
    "y": 1051.5739135742188,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "b752ad58.1bdf1"
      ]
    ]
  },
  {
    "id": "b80f04fd.7f4018",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1430,
    "y": 1095.9998779296875,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "81604b65.13211"
      ]
    ]
  },
  {
    "id": "b752ad58.1bdf1",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.l3vpn.pe1_id`\" />\n\n",
    "comments": "",
    "x": 1597.0625,
    "y": 1050.859619140625,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "81604b65.13211",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
    "comments": "",
    "x": 1598,
    "y": 1095.9998779296875,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "1b5d0889.20238f",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 1600,
    "y": 1142.9998779296875,
    "z": "b60623c5.e2d9e8",
    "wires": [
      []
    ]
  },
  {
    "id": "2a120b9c.2b340c",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1431,
    "y": 1142.9998779296875,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "1b5d0889.20238f"
      ]
    ]
  },
  {
    "id": "450a13df.b4e0a4",
    "type": "comment",
    "name": "CLL new",
    "info": "construct two array structures like these:\n\n${otn-tunnels-name-list[${1}].otn-tunnel-name}\n\n----------------\n${ethernet-srv-end-points-list[${1}].ethernet-end-point-name}\n${ethernet-srv-end-points-list[${1}].index-number},\n${ethernet-srv-end-points-list[${1}].eth-node-id},\n${ethernet-srv-end-points-list[${1}].eth-node-tp-id},\n${ethernet-srv-end-points-list[${1}].leafOrRootAccess}\n${ethernet-srv-end-points-list[${1}].cvlan}\n${ethernet-srv-end-points-list[${1}].CIR}\n${ethernet-srv-end-points-list[${1}].EIR}",
    "comments": "",
    "x": 1213,
    "y": 1664,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "ea05bf35.5069",
    "type": "set",
    "name": "set ethernet-srv-end-points-list array",
    "xml": "<set>\n<!--<parameter name='`ethernet-srv-end-points-list[$epidx].ethernet-end-point-name`' value='`$tmp.aai.connectivity.connectivity-id`' />-->\n<parameter name='`ethernet-srv-end-points-list[$epidx].ethernet-end-point-name`' value='`$tmp.aai.uni.id`' />\n<parameter name='`ethernet-srv-end-points-list[$epidx].index-number`' value='0' />\n<parameter name='`ethernet-srv-end-points-list[$epidx].eth-node-id`' value='`$tmp.uni-node-id-short`' />\n<parameter name='`ethernet-srv-end-points-list[$epidx].eth-node-tp-id`' value='`$tmp.aai.uni.tp-id`' />\n<parameter name='`ethernet-srv-end-points-list[$epidx].leafOrRootAccess`' value='`$leafOrRootAccess`' />\n<parameter name='`ethernet-srv-end-points-list[$epidx].cvlan`' value='`$tmp.aai.connectivity.cvlan`' />\n<parameter name='`ethernet-srv-end-points-list[$epidx].CIR`' value='`$tmp.aai.uni.data-source * 1000000`' />\n<parameter name='`ethernet-srv-end-points-list[$epidx].EIR`' value='`$tmp.aai.uni.data-source * 1000000`' />\n\n<parameter name='`ethernet-srv-end-points-list_length`' value='`$epidx + 1`' />\n",
    "comments": "",
    "x": 1304,
    "y": 1718,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "93a880c5.cd0b3",
    "type": "set",
    "name": "unset ethernet-srv-end-points-list",
    "xml": "<set>\n<parameter name='`ethernet-srv-end-points-list.`' value='' />\n<parameter name='`ethernet-srv-end-points-list_length`' value='0' />\n<parameter name='`epidx`' value='0' />",
    "comments": "",
    "x": 1980.5,
    "y": 1131,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "481f95ef.87ef1c",
    "type": "set",
    "name": "unset ethernet-srv-end-points-list",
    "xml": "<set>\n<parameter name='`ethernet-srv-end-points-list.`' value='' />\n<parameter name='`ethernet-srv-end-points-list_length`' value='0' />\n<parameter name='`epidx`' value='0' />",
    "comments": "",
    "x": 1985.5,
    "y": 1233,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "c1ad05eb.c84b48",
    "type": "for",
    "name": "for each relationship",
    "xml": "<for silentFailure='true' index='cridx' start='0' end='`$tmp.aai.connectivity.relationship-list.relationship_length`' >\n\n",
    "comments": "",
    "outputs": 1,
    "x": 469,
    "y": 1683,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "7f234491.70b134"
      ]
    ]
  },
  {
    "id": "7f234491.70b134",
    "type": "switchNode",
    "name": "switch related-to",
    "xml": "<switch test='`$tmp.aai.connectivity.relationship-list.relationship[$cridx].related-to`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 701,
    "y": 1682,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "c6ba5a66.793238"
      ]
    ]
  },
  {
    "id": "c6ba5a66.793238",
    "type": "outcome",
    "name": "vpn-binding",
    "xml": "<outcome value='vpn-binding'>\n",
    "comments": "",
    "outputs": 1,
    "x": 913,
    "y": 1683,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "6ed8d899.fdc1a"
      ]
    ]
  },
  {
    "id": "6ed8d899.fdc1a",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 169,
    "y": 1839,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "d9421c0f.7a0898",
        "953702c4.2d79b"
      ]
    ]
  },
  {
    "id": "953702c4.2d79b",
    "type": "set",
    "name": "unset tmp.aai.vpn-binding",
    "xml": "<set>\n<parameter name='tmp.aai.vpn-binding.' value='' />\n",
    "comments": "",
    "x": 404,
    "y": 1826,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "d9421c0f.7a0898",
    "type": "save",
    "name": "get vpn-binding from aai",
    "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"vpn-binding\"\n\t    key=\"vpn-binding.vpn-id = $tmp.aai.connectivity.relationship-list.relationship[$cridx].relationship-data[0].relationship-value\"\n\t\tlocal-only=\"false\" \n\t\tpfx=\"tmp.aai.vpn-binding\" >\n",
    "comments": "",
    "outputs": 1,
    "x": 394,
    "y": 1887,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "329ab1cc.22fb9e",
        "864547d3.a6077",
        "b2aa6219.f09508"
      ]
    ]
  },
  {
    "id": "864547d3.a6077",
    "type": "not-found",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 607.490966796875,
    "y": 1871.5740356445312,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "6b83b223.ee9d94"
      ]
    ]
  },
  {
    "id": "b2aa6219.f09508",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 603,
    "y": 1916,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "4ac70bf0.89675c"
      ]
    ]
  },
  {
    "id": "329ab1cc.22fb9e",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 605,
    "y": 1976,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "f02a177d.26c7"
      ]
    ]
  },
  {
    "id": "6b83b223.ee9d94",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.l3vpn.pe1_id`\" />\n\n",
    "comments": "",
    "x": 770.0625,
    "y": 1870.8597412109375,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "4ac70bf0.89675c",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
    "comments": "",
    "x": 771,
    "y": 1916,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "f02a177d.26c7",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 774,
    "y": 1975,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "fc6eb753.cc314",
        "6f8a0144.f9e8e8"
      ]
    ]
  },
  {
    "id": "ace8d395.16f8f8",
    "type": "set",
    "name": "set sotn_value",
    "xml": "<set>\n<!--<parameter name='eth-service-name' value='`$tmp.aai.connectivityA.connectivity-id`' />-->\n<parameter name='eth-service-name' value='`$tmp.aai.connectivity.etht-svc-name`' />\n<parameter name='slice-id' value='`$vnf-topology-operation-input.service-information.service-instance-id`' />\n<parameter name='provider-id' value='`$tmp.aai.connectivity.access-provider-id`' />\n<parameter name='client-id' value='`$tmp.aai.connectivity.access-client-id`' />\n<parameter name='topology-id' value='`$tmp.aai.connectivity.access-topology-id`' />\n<!--<parameter name='otn-tunnel-name' value='`$tmp.aai.vpn-bindingA.vpn-name`' />-->\n<!--<parameter name='ethernet-end-point-name' value='`$tmp.aai.connectivityA.connectivity-id`' />-->\n<!--<parameter name='index-number' value='0' />-->\n<!--<parameter name='eth-node-id' value='`$tmp.aai.connectivityA.access-node-id`' />-->\n<!--<parameter name='eth-node-tp-id' value='`$tmp.aai.connectivityA.access-ltp-id`' />-->\n<!--<parameter name='CIR' value='`$tmp.aai.vpn-bindingA.route-distinguisher *1000000`' />-->\n<!--<parameter name='EIR' value='`$tmp.aai.vpn-bindingA.route-distinguisher *1000000`' />-->\n<!--<parameter name='cvlan' value='`$tmp.aai.connectivityA.cvlan`' />-->\n",
    "comments": "",
    "x": 173,
    "y": 2474,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "fa159141.96876",
    "type": "execute",
    "name": "execute RestApiCallNode Create ethernet Service without token",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.cll-ethernet-service-loop-protection.templatefile`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainConn.url + '/restconf/data/ietf-eth-tran-service:etht-svc'`\" />\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.restapi.connection-oof-url`\" />-->\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainConn.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainConn.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"patch\"/>\n<parameter name='dirPath' value=\"/opt/onap/sdnc/restconfapi/yang\" />\n<parameter name=\"responsePrefix\" value=\"vpn-result\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n",
    "comments": "",
    "outputs": 1,
    "x": 316,
    "y": 2534,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "192fb1d6.9d578e",
        "7d0ee5a8.eae4dc"
      ]
    ]
  },
  {
    "id": "192fb1d6.9d578e",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 628.5,
    "y": 2511,
    "z": "b60623c5.e2d9e8",
    "wires": [
      []
    ]
  },
  {
    "id": "7d0ee5a8.eae4dc",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 632.5,
    "y": 2551,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "31d10b34.3ac65c"
      ]
    ]
  },
  {
    "id": "7a578c61.6716c4",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create ethernet service rest api\" />\n",
    "comments": "",
    "x": 808.5,
    "y": 2515,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "31d10b34.3ac65c",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "comments": "",
    "outputs": 1,
    "x": 824,
    "y": 2569,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "34d0fee.5345782"
      ]
    ]
  },
  {
    "id": "e5aa9a1b.90043",
    "type": "save",
    "name": "update vpn-binding resource (aka. OTN ) in AAI",
    "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding' \n      key='vpn-binding.vpn-id = $tmp.aai.vpn-binding.vpn-id' >\n<parameter name='vpn-id' value='`$tmp.aai.vpn-binding.vpn-id`' />\n<parameter name='vpn-name' value='`$tmp.aai.vpn-binding.vpn-name`' />\n\n<parameter name='operational-status' value='Activated' />\n",
    "comments": "",
    "outputs": 1,
    "x": 1119.5,
    "y": 2538,
    "z": "b60623c5.e2d9e8",
    "wires": [
      []
    ]
  },
  {
    "id": "dceb8020.64dda",
    "type": "comment",
    "name": "TODO: FIXME",
    "info": "use proper vpn-binding id and connectivity id\n\nAlso, does CCSDK support \"update\" operation for vpn-binding and connectivity?",
    "comments": "",
    "x": 2586.5,
    "y": 1889,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "34d0fee.5345782",
    "type": "save",
    "name": "update connectivity resource in AAI",
    "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='connectivity' \n      key='connectivity.connectivity-id = $tmp.aai.connectivity.connectivity-id'>\n<parameter name='connectivity-id' value='`$tmp.aai.connectivity.connectivity-id`' />\n<parameter name='operational-status' value='Activated' />\n",
    "comments": "",
    "outputs": 1,
    "x": 1081.5,
    "y": 2580,
    "z": "b60623c5.e2d9e8",
    "wires": [
      []
    ]
  },
  {
    "id": "1840e683.b61c39",
    "type": "set",
    "name": "set leafOrRootAccess",
    "xml": "<set>\n<parameter name='`leafOrRootAccess`' value='ietf-eth-tran-types:leaf-access' />\n",
    "comments": "",
    "x": 1946.5,
    "y": 1169,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "ebd04ab8.6f009",
    "type": "set",
    "name": "set leafOrRootAccess",
    "xml": "<set>\n<parameter name='`leafOrRootAccess`' value='ietf-eth-tran-types:root-primary' />\n",
    "comments": "",
    "x": 1947.5,
    "y": 1273,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "9094f518.043e98",
    "type": "save",
    "name": "update vpn-binding A resource (aka. OTN domainA) in AAI",
    "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding' \n      key='vpn-binding.vpn-id = $tmp.aai.vpn-bindingA.vpn-id' >\n<parameter name='vpn-id' value='`$tmp.aai.vpn-bindingA.vpn-id`' />\n<parameter name='vpn-name' value='`$tmp.aai.vpn-bindingA.vpn-name`' />\n\n<parameter name='operational-status' value='Activated' />\n",
    "comments": "",
    "outputs": 1,
    "x": 4241,
    "y": 530,
    "z": "b60623c5.e2d9e8",
    "wires": [
      []
    ]
  },
  {
    "id": "13fd978.b0ce7e9",
    "type": "save",
    "name": "update vpn-binding G resource (aka. OTN domainA) in AAI",
    "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding' \n      key='vpn-binding.vpn-id = $tmp.aai.vpn-bindingG.vpn-id' >\n<parameter name='vpn-id' value='`$tmp.aai.vpn-bindingG.vpn-id`' />\n<parameter name='vpn-name' value='`$tmp.aai.vpn-bindingG.vpn-name`' />\n\n<parameter name='operational-status' value='Activated' />\n",
    "comments": "",
    "outputs": 1,
    "x": 4144,
    "y": 1349,
    "z": "b60623c5.e2d9e8",
    "wires": [
      []
    ]
  },
  {
    "id": "db1559a9.21dcb8",
    "type": "save",
    "name": "update vpn-binding B resource (aka. OTN domainB) in AAI",
    "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding' \n      key='vpn-binding.vpn-id = $tmp.aai.vpn-bindingB.vpn-id' >\n<parameter name='vpn-id' value='`$tmp.aai.vpn-bindingB.vpn-id`' />\n<parameter name='vpn-name' value='`$tmp.aai.vpn-bindingB.vpn-name`' />\n\n<parameter name='operational-status' value='Activated' />\n",
    "comments": "",
    "outputs": 1,
    "x": 3638,
    "y": 2021,
    "z": "b60623c5.e2d9e8",
    "wires": [
      []
    ]
  },
  {
    "id": "93da3cfa.70c248",
    "type": "switchNode",
    "name": "switch connectivity is not already Activated (i.e. is either Created or Modified)",
    "xml": "<switch test=\"`$tmp.aai.connectivity.operational-status != 'Activated' `\">\n",
    "comments": "",
    "outputs": 1,
    "x": 739,
    "y": 829,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "2c44355c.6d9982",
        "16b41754.18b639"
      ]
    ]
  },
  {
    "id": "2c44355c.6d9982",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1102,
    "y": 852,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "58ecddbb.063a6c"
      ]
    ]
  },
  {
    "id": "16b41754.18b639",
    "type": "outcomeFalse",
    "name": "false",
    "xml": "<outcome value='false'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1102,
    "y": 801,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "255e639c.d2ebb4"
      ]
    ]
  },
  {
    "id": "58ecddbb.063a6c",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 1258,
    "y": 850,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "9a61b358.c738d8"
      ]
    ]
  },
  {
    "id": "255e639c.d2ebb4",
    "type": "block",
    "name": "block",
    "xml": "<block>",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1235,
    "y": 802,
    "z": "b60623c5.e2d9e8",
    "wires": [
      []
    ]
  },
  {
    "id": "c0e6872b.6bc578",
    "type": "set",
    "name": "unset tmp.aai.vpn-binding",
    "xml": "<set>\n<parameter name='tmp.aai.vpn-binding.' value=\"\" />\n",
    "comments": "",
    "x": 1995,
    "y": 200,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "64935ddb.b635b4",
    "type": "set",
    "name": "set root-otn-tunnels-list array",
    "xml": "<set>\n<parameter name='`roottunsidx`' value='`$roottunsidx + 1`' />\n",
    "comments": "",
    "x": 3537,
    "y": 2181,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "f54721e.ec69de",
    "type": "set",
    "name": "set leaf-otn-tunnels-list array",
    "xml": "<set>\n<parameter name='`leaftunsidx`' value='`$leaftunsidx + 1`' />\n",
    "comments": "",
    "x": 4127,
    "y": 654,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "9d31ed5b.d2c91",
    "type": "set",
    "name": "set ethernet-srv-end-points-list array",
    "xml": "<set>\n<parameter name='`epidx`' value='`$epidx + 1`' />\n",
    "comments": "",
    "x": 1301,
    "y": 1760,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "7af36070.5c1af",
    "type": "set",
    "name": "set filename",
    "xml": "<set>\n<parameter name='filenameclleths' value=\"`$leafOrRootAccess + $tmp.aai.connectivity.access-node-id`\" />",
    "comments": "",
    "x": 480,
    "y": 1494,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "2d8e3cc1.bb010c",
    "type": "execute",
    "name": "execute printContext",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='printContext' >\n    <parameter name=\"filename\" value=\"`$filenameclleths`\" />\n",
    "comments": "",
    "outputs": 1,
    "x": 511,
    "y": 1534,
    "z": "b60623c5.e2d9e8",
    "wires": [
      []
    ]
  },
  {
    "id": "fc6eb753.cc314",
    "type": "set",
    "name": "set otn-tunnels-name-list array",
    "xml": "<set>\n<parameter name='`otn-tunnels-name-list[$otntunsidx].otn-tunnel-name`' value='`$tmp.aai.vpn-binding.vpn-name`' />\n<parameter name='`otn-tunnels-name-list[$otntunsidx].vpn-id`' value='`$tmp.aai.vpn-binding.vpn-id`' />\n<parameter name='`otn-tunnels-name-list_length`' value='`$otntunsidx + 1`' />\n",
    "comments": "",
    "x": 1059,
    "y": 1942,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "6f8a0144.f9e8e8",
    "type": "set",
    "name": "set otn-tunnels-name-list array",
    "xml": "<set>\n<parameter name='`otntunsidx`' value='`$otntunsidx + 1`' />\n",
    "comments": "",
    "x": 1062,
    "y": 1984,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "1e5bd700.d21b81",
    "type": "set",
    "name": "unset otn-tunnels-name-list array",
    "xml": "<set>\n<parameter name='`otn-tunnels-name-list.`' value='' />\n<parameter name='`otn-tunnels-name-list_length`' value='0' />\n<parameter name='`otntunsidx`' value='0' />\n",
    "comments": "",
    "x": 505,
    "y": 1624,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "144b407f.200e78",
    "type": "set",
    "name": "set filename",
    "xml": "<set>\n<parameter name='filenamecllotns' value=\"`leafrootOTNtunnelnames`\" />",
    "comments": "",
    "x": 260,
    "y": 2003,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "76785af4.e022ac",
    "type": "execute",
    "name": "execute printContext",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='printContext' >\n    <parameter name=\"filename\" value=\"`$filenamecllotns`\" />\n",
    "comments": "",
    "outputs": 1,
    "x": 268,
    "y": 2060,
    "z": "b60623c5.e2d9e8",
    "wires": [
      []
    ]
  },
  {
    "id": "23eb7cf4.f6cfdc",
    "type": "execute",
    "name": "execute split tp-id to get pnf-name",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='split' >\n<parameter name=\"original_string\" value='`$tmp.aai.uni.id`'/>\n<!--<parameter name=\"regex\" value=\"[^-]+$\"/>-->\n<parameter name=\"regex\" value=\"[-]+\"/>\n<parameter name=\"ctx_memory_result_key\" value=\"param-prefix-uni\"/>\n\n",
    "comments": "",
    "outputs": 1,
    "x": 1279,
    "y": 1609,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "779a259e.64832c",
        "277a0a61.75069e"
      ]
    ]
  },
  {
    "id": "277a0a61.75069e",
    "type": "failure",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1502,
    "y": 1564,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "21f0cc68.0dd77c"
      ]
    ]
  },
  {
    "id": "779a259e.64832c",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1504,
    "y": 1628,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "db13af98.99768"
      ]
    ]
  },
  {
    "id": "21f0cc68.0dd77c",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 1667,
    "y": 1561,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "ec997076.0ceb28"
      ]
    ]
  },
  {
    "id": "db13af98.99768",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value=\"An error occured while splitting sna1_route\" />\n",
    "comments": "",
    "x": 1666,
    "y": 1624,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "ec997076.0ceb28",
    "type": "set",
    "name": "set tmp.uni-node-id-short",
    "xml": "<set>\n<parameter name='tmp.uni-node-id-short' value='`$param-prefix-uni[$param-prefix-uni_length -4]`' />\n",
    "comments": "",
    "x": 1887,
    "y": 1575,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "2341ba90.ed99d6",
    "type": "outcome",
    "name": "esr-thirdparty-sdnc",
    "xml": "<outcome value='esr-thirdparty-sdnc'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1432,
    "y": 2300,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "35e4a68.098365a"
      ]
    ]
  },
  {
    "id": "701770f6.4dd0f8",
    "type": "execute",
    "name": "get esr-thirdparty-sdnc",
    "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"esr-thirdparty-sdnc\" \n\t\tkey=\"esr-thirdparty-sdnc.thirdparty-sdnc-id = $tmp.domainConn.esr-thirdparty-id AND \n\t\t     depth = '1'\"\n        pfx='tmp.aai.domainConn.esr-thirdparty-sdnc' local-only='false' >",
    "comments": "",
    "outputs": 1,
    "x": 1817,
    "y": 2313,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "d75e7467.a58a4",
        "74ab773b.95bd78",
        "df0b8ca4.cd7bb8"
      ]
    ]
  },
  {
    "id": "35e4a68.098365a",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 1611,
    "y": 2300,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "fa1aec8.0f5319",
        "701770f6.4dd0f8"
      ]
    ]
  },
  {
    "id": "fa1aec8.0f5319",
    "type": "set",
    "name": "set esr-thirdparty-sdnc domainConn id",
    "xml": "<set>\n<parameter name='tmp.domainConn.esr-thirdparty-id' value=\"`$tmp.aai.source-pnf.relationship-list.relationship[$spvidx].relationship-data[0].relationship-value`\" />\n",
    "comments": "",
    "x": 1847,
    "y": 2261,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "d75e7467.a58a4",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2027,
    "y": 2304,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "1ccfad18.1b3fa3"
      ]
    ]
  },
  {
    "id": "74ab773b.95bd78",
    "type": "not-found",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2019,
    "y": 2359,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "2692af0.8253f52"
      ]
    ]
  },
  {
    "id": "df0b8ca4.cd7bb8",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2024,
    "y": 2416,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "f048da7.b1469a8"
      ]
    ]
  },
  {
    "id": "f048da7.b1469a8",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
    "comments": "",
    "x": 2176,
    "y": 2417,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "2692af0.8253f52",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
    "comments": "",
    "x": 2187,
    "y": 2362,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "1ccfad18.1b3fa3",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 2171.38232421875,
    "y": 2301.6556701660156,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "64610343.e61854"
      ]
    ]
  },
  {
    "id": "64610343.e61854",
    "type": "set",
    "name": "set controller domainConn data",
    "xml": "<set>\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainConn.url' value=\"`$tmp.aai.domainConn.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].service-url`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainConn.user' value=\"`$tmp.aai.domainConn.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].user-name`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainConn.password' value=\"`$tmp.aai.domainConn.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].password`\" />\n\n\n<!--<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >-->\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/restconf/data/ietf-network:networks'`\" />-->\n<!--<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />-->\n<!--<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />-->\n<!--<parameter name=\"format\" value=\"json\"/>-->\n<!--<parameter name=\"httpMethod\" value=\"get\"/>-->\n<!--<parameter name=\"responsePrefix\" value=\"topology\"/>-->\n<!--<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>-->\n<!--<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>-->\n<!--<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>-->\n<!--<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>-->\n",
    "comments": "",
    "x": 2386,
    "y": 2298,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "d3c52589.f54e9",
    "type": "get-resource",
    "name": "get-resource src pnf",
    "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"pnf\" \n\t\tkey=\"pnf.pnf-name = $tmp.pnf-name-forUrl\"\n        pfx='tmp.aai.source-pnf' local-only='false' >\n\n        <!--AND depth = '0'\"-->\n",
    "comments": "",
    "outputs": 1,
    "x": 510,
    "y": 2346,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "f189c3f1.d69a28",
        "4452e7a9.eaf9c8",
        "77af657c.107d34"
      ]
    ]
  },
  {
    "id": "f189c3f1.d69a28",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 705.5001220703125,
    "y": 2298,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "47b3661c.a1e7d8"
      ]
    ]
  },
  {
    "id": "4452e7a9.eaf9c8",
    "type": "not-found",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 697.5001220703125,
    "y": 2353,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "34198ba3.49ea3c"
      ]
    ]
  },
  {
    "id": "47b3661c.a1e7d8",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 849.8824462890625,
    "y": 2297.6556701660156,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "cd5c4879.eeeaf"
      ]
    ]
  },
  {
    "id": "cd5c4879.eeeaf",
    "type": "for",
    "name": "for each relationship",
    "xml": "<for silentFailure='true' index='spvidx' start='0' end='`$tmp.aai.source-pnf.relationship-list.relationship_length`' >\n",
    "comments": "",
    "outputs": 1,
    "x": 1034,
    "y": 2296,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "7bf74b1f.d5837c"
      ]
    ]
  },
  {
    "id": "7bf74b1f.d5837c",
    "type": "switchNode",
    "name": "switch related-to",
    "xml": "<switch test='`$tmp.aai.source-pnf.relationship-list.relationship[$spvidx].related-to`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1229,
    "y": 2296,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "2341ba90.ed99d6"
      ]
    ]
  },
  {
    "id": "77af657c.107d34",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 702.5001220703125,
    "y": 2410,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "6c7ae4ee.17c334"
      ]
    ]
  },
  {
    "id": "6c7ae4ee.17c334",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
    "comments": "",
    "x": 854.5001220703125,
    "y": 2411,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "34198ba3.49ea3c",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
    "comments": "",
    "x": 865.5001220703125,
    "y": 2354,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "303a4e11.243e7a",
    "type": "set",
    "name": "set tmp.pnf-name-forUrl",
    "xml": "<set>\n\n<parameter name='tmp.pnf-name-forUrl' value=\"`'networkId-providerId-' +\n                                                   $tmp.aai.connectivity.access-provider-id + '-clientId-' +\n                                                   $tmp.aai.connectivity.access-client-id + '-topologyId-' +\n                                                   $tmp.aai.connectivity.access-topology-id + '-nodeId-' +\n                                                   $tmp.aai.connectivity.access-node-id`\" />\n",
    "comments": "",
    "x": 500,
    "y": 2258,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "c718737.8cca71",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "comments": "",
    "outputs": 1,
    "x": 245,
    "y": 2389,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "303a4e11.243e7a",
        "d3c52589.f54e9"
      ]
    ]
  },
  {
    "id": "72622933.417d18",
    "type": "comment",
    "name": "Temporary skipping this check - to support multiple instances in one slice",
    "info": "",
    "comments": "",
    "x": 1459.9666748046875,
    "y": 206.88333129882812,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "c3fd03f5.ced1a",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
    "comments": "",
    "x": 662,
    "y": 429,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "c72dabdd.dd1b58",
    "type": "block",
    "name": "block",
    "xml": "<block>",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 221.5,
    "y": 1398,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "a94aa53a.b107d8",
        "c1ad05eb.c84b48",
        "7af36070.5c1af",
        "2d8e3cc1.bb010c",
        "ace8d395.16f8f8",
        "fa159141.96876",
        "1e5bd700.d21b81",
        "144b407f.200e78",
        "76785af4.e022ac",
        "c718737.8cca71",
        "eca312ef.b3f488"
      ]
    ]
  },
  {
    "id": "99b18acf.7ec528",
    "type": "switchNode",
    "name": "switch uni type",
    "xml": "<switch test=\"`$tmp.aai.uni.type`\">\n\n",
    "comments": "",
    "outputs": 1,
    "x": 1252,
    "y": 1236,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "bfa56f6a.14e168",
        "3c1ef869.c0abd8",
        "3b2dd259.d313d6",
        "42d627cc.4d9d98"
      ]
    ]
  },
  {
    "id": "bfa56f6a.14e168",
    "type": "outcome",
    "name": "leaf",
    "xml": "<outcome value='leaf'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1417,
    "y": 1218,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "327e25a1.149b82"
      ]
    ]
  },
  {
    "id": "3c1ef869.c0abd8",
    "type": "outcome",
    "name": "root",
    "xml": "<outcome value='root'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1420,
    "y": 1257,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "bb94632d.8744e"
      ]
    ]
  },
  {
    "id": "42d627cc.4d9d98",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1414,
    "y": 1335,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "aa99ff1e.001ee"
      ]
    ]
  },
  {
    "id": "3b2dd259.d313d6",
    "type": "outcome",
    "name": "secondary-root",
    "xml": "<outcome value='secondary-root'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1437,
    "y": 1298,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "3c1ff952.ce0566"
      ]
    ]
  },
  {
    "id": "8b34828e.2e2fe8",
    "type": "set",
    "name": "unset ethernet-srv-end-points-list",
    "xml": "<set>\n<parameter name='`ethernet-srv-end-points-list.`' value='' />\n<parameter name='`ethernet-srv-end-points-list_length`' value='0' />\n<parameter name='`epidx`' value='0' />",
    "comments": "",
    "x": 1983,
    "y": 1331,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "7c827d8b.b5207c",
    "type": "set",
    "name": "set leafOrRootAccess",
    "xml": "<set>\n<parameter name='`leafOrRootAccess`' value='ietf-eth-tran-types:root-backup' />\n",
    "comments": "",
    "x": 1945,
    "y": 1371,
    "z": "b60623c5.e2d9e8",
    "wires": []
  },
  {
    "id": "aa99ff1e.001ee",
    "type": "block",
    "name": "block",
    "xml": "<block>",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1582,
    "y": 1335,
    "z": "b60623c5.e2d9e8",
    "wires": [
      []
    ]
  },
  {
    "id": "327e25a1.149b82",
    "type": "block",
    "name": "block",
    "xml": "<block>",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1578,
    "y": 1214,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "1840e683.b61c39"
      ]
    ]
  },
  {
    "id": "bb94632d.8744e",
    "type": "block",
    "name": "block",
    "xml": "<block>",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1585,
    "y": 1259,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "ebd04ab8.6f009"
      ]
    ]
  },
  {
    "id": "3c1ff952.ce0566",
    "type": "block",
    "name": "block",
    "xml": "<block>",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1584,
    "y": 1299,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "7c827d8b.b5207c"
      ]
    ]
  },
  {
    "id": "9a61b358.c738d8",
    "type": "switchNode",
    "name": "switch conn type != mdsc",
    "xml": "<switch test=\"`$tmp.aai.connectivity.vpn-type != 'mdsc' `\">\n\n",
    "comments": "",
    "outputs": 1,
    "x": 218.56666564941406,
    "y": 1158.933349609375,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "4c9cf74b.527528"
      ]
    ]
  },
  {
    "id": "4c9cf74b.527528",
    "type": "outcome",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 400.566650390625,
    "y": 1159.933349609375,
    "z": "b60623c5.e2d9e8",
    "wires": [
      [
        "c72dabdd.dd1b58"
      ]
    ]
  },
  {
    "id": "eca312ef.b3f488",
    "type": "set",
    "name": "unset ethernet-srv-end-points-list",
    "xml": "<set>\n<parameter name='`ethernet-srv-end-points-list.`' value='' />\n<parameter name='`ethernet-srv-end-points-list_length`' value='0' />\n<parameter name='`epidx`' value='0' />",
    "comments": "",
    "x": 536.566650390625,
    "y": 1336.9666748046875,
    "z": "b60623c5.e2d9e8",
    "wires": []
  }
]