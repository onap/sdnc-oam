[
    {
        "id": "94ab5931.1ae6d",
        "type": "dgstart",
        "name": "DGSTART",
        "outputs": 1,
        "x": 292.566650390625,
        "y": 59.56666564941406,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "1c26c9e8.6ceaee"
            ]
        ]
    },
    {
        "id": "1c26c9e8.6ceaee",
        "type": "service-logic",
        "name": "GENERIC-RESOURCE-API ${project.version}",
        "module": "GENERIC-RESOURCE-API",
        "version": "${project.version}",
        "comments": "",
        "xml": "<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>",
        "outputs": 1,
        "x": 576.8523406982422,
        "y": 120.8047742843628,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "23f5599a.c9cd86"
            ]
        ]
    },
    {
        "id": "23f5599a.c9cd86",
        "type": "method",
        "name": "method cll-vnf-topology-operation-cll-F1",
        "xml": "<method rpc='cll-vnf-topology-operation-cll-F1' mode='sync'>\n",
        "comments": "",
        "outputs": 1,
        "x": 492.9952392578125,
        "y": 198.5666961669922,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "dc959d18.681ba8"
            ]
        ]
    },
    {
        "id": "dc959d18.681ba8",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 226.8046875,
        "y": 702.2333526611328,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "3133ba0.df70946",
                "a232054c.f7cde",
                "cf7049ac.59d6b8",
                "da9884fe.c1ab2",
                "d00a834c.9393c8",
                "e4a1c30c.a1f11",
                "ed8a3e8e.eba718",
                "5d4c8b88.6ea084"
            ]
        ]
    },
    {
        "id": "3133ba0.df70946",
        "type": "set",
        "name": "set query_param",
        "xml": "<set>\n<parameter name='prop.ethsrvType' value='`$network-route-A`' />\n\n",
        "comments": "",
        "x": 499.566650390625,
        "y": 656.5666656494141,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "a232054c.f7cde",
        "type": "call",
        "name": "call GENERIC-RESOURCE-API:tsli-vnf-topology-operation-get-otn-tunnel-path-from-oof",
        "xml": "<call module='GENERIC-RESOURCE-API' rpc='tsli-vnf-topology-operation-get-otn-tunnel-path-from-oof' mode='sync' >\n\n",
        "comments": "",
        "outputs": 1,
        "x": 720.566650390625,
        "y": 724.5666656494141,
        "z": "ba0dc87e.a3b258",
        "wires": [
            []
        ]
    },
    {
        "id": "cf7049ac.59d6b8",
        "type": "execute",
        "name": "execute printContext",
        "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='printContext' >\n    <parameter name=\"filename\" value=\"`$filenamemm`\" />\n",
        "comments": "",
        "outputs": 1,
        "x": 510.566650390625,
        "y": 770.5666656494141,
        "z": "ba0dc87e.a3b258",
        "wires": [
            []
        ]
    },
    {
        "id": "e4a1c30c.a1f11",
        "type": "call",
        "name": "call GENERIC-RESOURCE-API:cll-vnf-topology-operation-find-maximum-used-tpn",
        "xml": "<call module='GENERIC-RESOURCE-API' rpc='cll-vnf-topology-operation-find-maximum-used-tpn' mode='sync' >\n\n",
        "comments": "",
        "outputs": 1,
        "x": 703.566650390625,
        "y": 834.5666656494141,
        "z": "ba0dc87e.a3b258",
        "wires": [
            []
        ]
    },
    {
        "id": "ed8a3e8e.eba718",
        "type": "for",
        "name": "for vidx..tmp.otninfo_length[]",
        "xml": "<for index='otnidx' start='0' end='`$tmp.otninfo_length`' >",
        "comments": "",
        "outputs": 1,
        "x": 795.566650390625,
        "y": 1213.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "a0634476.d7e6f8"
            ]
        ]
    },
    {
        "id": "a0634476.d7e6f8",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic='true'>",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 1017.5666198730469,
        "y": 1225.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "aaab02fa.9f4d88",
                "c83caaf9.d6f6",
                "a09d3d16.a9628",
                "38b6179d.185d98",
                "6e9dd85.efe07a8",
                "ef30d7fa.1abd9",
                "ba078fb1.cbb95",
                "95800647.4aa41",
                "84e1fc7d.aa5158",
                "4be74bfa.e8a9a4"
            ]
        ]
    },
    {
        "id": "aaab02fa.9f4d88",
        "type": "execute",
        "name": "execute UUID generator for vpn-binding $otnidx",
        "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='generateUUID' >\n<parameter name=\"ctx-destination\" value=\"prop.vpn-binding-otnidx-uuid\"/>\n",
        "comments": "",
        "outputs": 1,
        "x": 1692.566650390625,
        "y": 804.5666656494141,
        "z": "ba0dc87e.a3b258",
        "wires": [
            []
        ]
    },
    {
        "id": "c83caaf9.d6f6",
        "type": "switchNode",
        "name": "switch dstPort == NULL",
        "xml": "<switch test=\"`$tmp.otninfo[$otnidx].dstPort.dst-access-provider-id == ''`\">\n\n",
        "comments": "",
        "outputs": 1,
        "x": 1406.566650390625,
        "y": 894.5666656494141,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "a21a8c5c.c26b18",
                "5ad886dd.89cfc"
            ]
        ]
    },
    {
        "id": "a21a8c5c.c26b18",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1772.566650390625,
        "y": 855.5666656494141,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "492daa68.bf54bc"
            ]
        ]
    },
    {
        "id": "5ad886dd.89cfc",
        "type": "outcomeFalse",
        "name": "false",
        "xml": "<outcome value='false'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1773.566650390625,
        "y": 901.5666656494141,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "5f6a6611.d2602"
            ]
        ]
    },
    {
        "id": "492daa68.bf54bc",
        "type": "set",
        "name": "set access-provider-id and client-id",
        "xml": "<set>\n<parameter name='tmp.access-provider-id' value='`$tmp.otninfo[$otnidx].srcPort.src-access-provider-id`' />\n<parameter name='tmp.access-client-id' value='`$tmp.otninfo[$otnidx].srcPort.src-access-client-id`' />\n<parameter name='tmp.access-topology-id' value='`$tmp.otninfo[$otnidx].srcPort.src-access-topology-id`' />\n<parameter name='tmp.srcdstpnf-id' value='`$tmp.otninfo[$otnidx].srcPort.src-access-node-id`' />\n",
        "comments": "",
        "x": 1986.566650390625,
        "y": 854.5666656494141,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "5f6a6611.d2602",
        "type": "set",
        "name": "set access-provider-id and client-id",
        "xml": "<set>\n<parameter name='tmp.access-provider-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-provider-id`' />\n<parameter name='tmp.access-client-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-client-id`' />\n<parameter name='tmp.access-topology-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-topology-id`' />\n<parameter name='tmp.srcdstpnf-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-node-id`' />\n",
        "comments": "",
        "x": 1984.566650390625,
        "y": 899.5666656494141,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "a09d3d16.a9628",
        "type": "set",
        "name": "set srcdstpnf-name",
        "xml": "<set>\n<parameter name='tmp.srcdstpnf-name' value=\"`'networkId-providerId-' + \n                                             $tmp.access-provider-id + '-clientId-' +\n                                             $tmp.access-client-id + '-topologyId-' + \n                                             $tmp.access-topology-id + '-nodeId-' + \n                                             $tmp.srcdstpnf-id`\" />\n\n",
        "comments": "",
        "x": 1582.566650390625,
        "y": 968.5666656494141,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "38b6179d.185d98",
        "type": "get-resource",
        "name": "get-resource tmp.srcdstpnf-name",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"pnf\" \n\t\tkey=\"pnf.pnf-name = $tmp.srcdstpnf-name\"\n        pfx='tmp.aai.srcdst-pnf' local-only='false' >\n\n        <!--AND depth = '0'\"-->\n",
        "comments": "",
        "outputs": 1,
        "x": 1626.566650390625,
        "y": 1016.5666656494141,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "1e4fefc4.84dea",
                "140ba84b.114188",
                "5ac6d6d0.fa8f3"
            ]
        ]
    },
    {
        "id": "1e4fefc4.84dea",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1839.066650390625,
        "y": 963.5666656494141,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "c513ad5c.67a2a8"
            ]
        ]
    },
    {
        "id": "140ba84b.114188",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1851.066650390625,
        "y": 1013.5666656494141,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "56e61af8.fb0edc"
            ]
        ]
    },
    {
        "id": "5ac6d6d0.fa8f3",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1842.066650390625,
        "y": 1068.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "5b77e98c.bb3518"
            ]
        ]
    },
    {
        "id": "5b77e98c.bb3518",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 1987.066650390625,
        "y": 1067.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "56e61af8.fb0edc",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 1998.066650390625,
        "y": 1010.5666656494141,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "c513ad5c.67a2a8",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 1964.4490966796875,
        "y": 957.2223358154297,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "e866a3e1.053498"
            ]
        ]
    },
    {
        "id": "e866a3e1.053498",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for silentFailure='true' index='spvidx' start='0' end='`$tmp.aai.srcdst-pnf.relationship-list.relationship_length`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 2125.566650390625,
        "y": 971.5666656494141,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "5690d718.48c698"
            ]
        ]
    },
    {
        "id": "5690d718.48c698",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.aai.srcdst-pnf.relationship-list.relationship[$spvidx].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2320.566650390625,
        "y": 971.5666656494141,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "f99896f3.a9973"
            ]
        ]
    },
    {
        "id": "804d49e5.886028",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 2700.566650390625,
        "y": 967.5666656494141,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "ebd7bd5b.40a158",
                "9cbfb486.1d485"
            ]
        ]
    },
    {
        "id": "9cbfb486.1d485",
        "type": "execute",
        "name": "get esr-thirdparty-sdnc",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"esr-thirdparty-sdnc\" \n\t\tkey=\"esr-thirdparty-sdnc.thirdparty-sdnc-id = $tmp.domainG.esr-thirdparty-id AND \n\t\t     depth = '1'\"\n        pfx='tmp.aai.domainG.esr-thirdparty-sdnc' local-only='false' >",
        "comments": "",
        "outputs": 1,
        "x": 2908.566650390625,
        "y": 974.5666656494141,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "eb53f24.9c8df9",
                "b699925f.52e788",
                "177a0a75.4ffe3e"
            ]
        ]
    },
    {
        "id": "ebd7bd5b.40a158",
        "type": "set",
        "name": "set esr-thirdparty-sdnc domainG id",
        "xml": "<set>\n<parameter name='tmp.domainG.esr-thirdparty-id' value=\"`$tmp.aai.srcdst-pnf.relationship-list.relationship[$spvidx].relationship-data[0].relationship-value`\" />\n",
        "comments": "",
        "x": 2938.566650390625,
        "y": 922.5666656494141,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "eb53f24.9c8df9",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3118.566650390625,
        "y": 965.5666656494141,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "664ce225.e11764"
            ]
        ]
    },
    {
        "id": "b699925f.52e788",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3110.566650390625,
        "y": 1020.5666656494141,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "c5f2fad1.bd663"
            ]
        ]
    },
    {
        "id": "177a0a75.4ffe3e",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3115.566650390625,
        "y": 1077.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "f4a026e6.715c"
            ]
        ]
    },
    {
        "id": "f4a026e6.715c",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 3267.566650390625,
        "y": 1078.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "c5f2fad1.bd663",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 3278.566650390625,
        "y": 1023.5666656494141,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "664ce225.e11764",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 3262.948974609375,
        "y": 963.2223358154297,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "a508abe9.f5813"
            ]
        ]
    },
    {
        "id": "f99896f3.a9973",
        "type": "outcome",
        "name": "esr-thirdparty-sdnc",
        "xml": "<outcome value='esr-thirdparty-sdnc'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2523.566650390625,
        "y": 975.5666656494141,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "804d49e5.886028"
            ]
        ]
    },
    {
        "id": "a508abe9.f5813",
        "type": "set",
        "name": "set controller domainA data",
        "xml": "<set>\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainG.url' value=\"`$tmp.aai.domainG.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].service-url`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainG.user' value=\"`$tmp.aai.domainG.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].user-name`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainG.password' value=\"`$tmp.aai.domainG.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].password`\" />\n\n\n<!--<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >-->\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/restconf/data/ietf-network:networks'`\" />-->\n<!--<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />-->\n<!--<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />-->\n<!--<parameter name=\"format\" value=\"json\"/>-->\n<!--<parameter name=\"httpMethod\" value=\"get\"/>-->\n<!--<parameter name=\"responsePrefix\" value=\"topology\"/>-->\n<!--<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>-->\n<!--<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>-->\n<!--<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>-->\n<!--<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>-->\n",
        "comments": "",
        "x": 3477.566650390625,
        "y": 959.5666656494141,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "6e9dd85.efe07a8",
        "type": "switchNode",
        "name": "switch dmnsidx == 0 (domainA)",
        "xml": "<switch test='`$otnidx == 0`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1596.566650390625,
        "y": 1185.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "75774fa2.7a2cf",
                "4436153e.9cd34c"
            ]
        ]
    },
    {
        "id": "75774fa2.7a2cf",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1797.566650390625,
        "y": 1183.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "36577996.f92cc6"
            ]
        ]
    },
    {
        "id": "b48623b8.fdb8a",
        "type": "set",
        "name": "set pce-src-node",
        "xml": "<set>\n<parameter name='tmp.pce-src-node' value='`$tmp.srcdstpnf-name`' />",
        "comments": "",
        "x": 2078.566650390625,
        "y": 1133.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "54c1b7cf.fc463",
        "type": "switchNode",
        "name": "switch dmnsidx == last (domainB)",
        "xml": "<switch test='`$otnidx == $tmp.otninfo_length - 1`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2014.566650390625,
        "y": 1234.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "8183849e.8f8b9",
                "edcb38ad.17a0a8"
            ]
        ]
    },
    {
        "id": "8183849e.8f8b9",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2244.566650390625,
        "y": 1230.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "eb1da6e2.d6cac"
            ]
        ]
    },
    {
        "id": "4436153e.9cd34c",
        "type": "outcomeFalse",
        "name": "false",
        "xml": "<outcome value='false'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1797.566650390625,
        "y": 1232.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "54c1b7cf.fc463"
            ]
        ]
    },
    {
        "id": "edcb38ad.17a0a8",
        "type": "outcomeFalse",
        "name": "false",
        "xml": "<outcome value='false'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2245.566650390625,
        "y": 1276.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "10a3f078.2aa84"
            ]
        ]
    },
    {
        "id": "10a3f078.2aa84",
        "type": "set",
        "name": "set attachment_param domain G",
        "xml": "<set>\n<parameter name='tmp.domainG-src-access-node-id' value='`$tmp.otninfo[$otnidx].srcPort.src-access-node-id`' />\n<parameter name='tmp.domainG-dst-access-node-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-node-id`' />",
        "comments": "",
        "x": 2459.566650390625,
        "y": 1276.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "8c80417d.32f06",
        "type": "set",
        "name": "set attachment_param domain A",
        "xml": "<set>\n<parameter name='tmp.domainG-src-access-node-id' value='`$param-prefix-domainA[$param-prefix-domainA_length -3]`' />\n<parameter name='tmp.domainG-dst-access-node-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-node-id`' />",
        "comments": "",
        "x": 2133.566650390625,
        "y": 1180.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "36577996.f92cc6",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 1921.566650390625,
        "y": 1174.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "8c80417d.32f06"
            ]
        ]
    },
    {
        "id": "eb1da6e2.d6cac",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 2377.566650390625,
        "y": 1206.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "4f91088c.aa2a9"
            ]
        ]
    },
    {
        "id": "90fd9019.34d388",
        "type": "set",
        "name": "set pce-src-node",
        "xml": "<set>\n<parameter name='tmp.pce-dst-node' value='`$tmp.srcdstpnf-name`' />",
        "comments": "",
        "x": 2533.566650390625,
        "y": 1222.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "4f91088c.aa2a9",
        "type": "set",
        "name": "set attachment_param domain B",
        "xml": "<set>\n<parameter name='tmp.domainG-src-access-node-id' value='`$tmp.otninfo[$otnidx].srcPort.src-access-node-id`' />\n<parameter name='tmp.domainG-dst-access-node-id' value='`$param-prefix-domainB[$param-prefix-domainB_length -3]`' />",
        "comments": "",
        "x": 2581.566650390625,
        "y": 1174.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "d00a834c.9393c8",
        "type": "set",
        "name": "unset parameters",
        "xml": "<set>\n<parameter name='domain-A.tunnel-tp-id' value='' />\n<parameter name='domain-A.node-id' value='' />\n<parameter name='domain-A.network-id' value=\"\" />\n<parameter name='domain-A.provider-id' value=\"\" />\n<parameter name='domain-A.client-id' value=\"\" />\n<parameter name='domain-A.te-topo-id' value=\"\" />\n<parameter name='domain-A.network-type' value=\"\" />\n<parameter name='domain-A.ltpId' value=\"\" />\n<parameter name='tmp.domain-A.network-id' value=\"\" />\n<parameter name='tmp.domain-A.ttp-id' value=\"\" />\n<parameter name='network-route-A' value=\"\" />\n<!--<parameter name='domain-A.' value=\"\" />-->\n\n<parameter name='request-id' value='' />\n<parameter name='otn-source-node' value='' />\n<parameter name='otn-dest-node' value='' />\n<parameter name='bw-odu' value=\"\" />\n<parameter name='src-ttp-id' value='' />\n<parameter name='dst-ttp-id' value='' />\n\n<parameter name='domain-B.tunnel-tp-id' value='' />\n<parameter name='domain-B.node-id' value='' />\n<parameter name='domain-B.network-id' value=\"\" />\n<parameter name='domain-B.provider-id' value=\"\" />\n<parameter name='domain-B.client-id' value=\"\" />\n<parameter name='domain-B.te-topo-id' value=\"\" />\n<parameter name='domain-B.network-type' value=\"\" />\n<parameter name='domain-B.ltpId' value=\"\" />\n<parameter name='tmp.domain-B.network-id' value=\"\" />\n<parameter name='tmp.domain-B.ttp-id' value=\"\" />\n<parameter name='network-route-B' value=\"\" />\n<!--<parameter name='domain-B.' value=\"\" />-->\n\n\n\n\n\n",
        "comments": "",
        "x": 468.56658935546875,
        "y": 3827.566909790039,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "da9884fe.c1ab2",
        "type": "set",
        "name": "set srcTtp OTN layer",
        "xml": "<set>\n<!--<parameter name='tmp.srcTtpOtnLayer' value=\"`$tmp.pce-src-node + '-' + -->\n<!--                                             $param-prefix-domainA[$param-prefix-domainA_length -2] + '-' +-->\n<!--                                             $tmp.source.ttp-id`\" />-->\n\n<parameter name='tmp.srcTtpOtnLayer' value=\"`$tmp.pce-src-node`\" />\n\n\n",
        "comments": "",
        "x": 507.566650390625,
        "y": 912.5666656494141,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "ef30d7fa.1abd9",
        "type": "set",
        "name": "set srcTtp+dstTtp pair",
        "xml": "<set>\n<parameter name='tmp.srcTtpdstTtpPair' value=\"`$tmp.otninfo[$otnidx].srcPort.src-tunnel-tp-id + ',' +\n                                               $tmp.otninfo[$otnidx].dstPort.dst-tunnel-tp-id`\" />\n\n\n",
        "comments": "",
        "x": 1572.566650390625,
        "y": 1265.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "95800647.4aa41",
        "type": "call",
        "name": "call GENERIC-RESOURCE-API:cll-vnf-topology-operation-cll-helper-find-connectivity",
        "xml": "<call module='GENERIC-RESOURCE-API' rpc='cll-vnf-topology-operation-cll-helper-find-connectivity' mode='sync' >\n\n",
        "comments": "",
        "outputs": 1,
        "x": 1764.5666198730469,
        "y": 1363.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            []
        ]
    },
    {
        "id": "ba078fb1.cbb95",
        "type": "set",
        "name": "set current-provider-id and current-cvlan-id",
        "xml": "<set>\n<parameter name='tmp.current-provider-id' value='`$tmp.access-provider-id`' />\n<parameter name='tmp.current-cvlan-id' value='`$tmp.aai.network-route-A.logical-interface-id`' />\n\n",
        "comments": "",
        "x": 1636.566650390625,
        "y": 1316.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "84e1fc7d.aa5158",
        "type": "switchNode",
        "name": "switch found-connectivity?",
        "xml": "\n<switch test=\"`$found-connectivity`\">\n\n",
        "comments": "",
        "outputs": 1,
        "x": 1445.566650390625,
        "y": 1517.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "e1b1a2e3.c8a22",
                "a1f3f094.cf6868"
            ]
        ]
    },
    {
        "id": "e1b1a2e3.c8a22",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1731.566650390625,
        "y": 2336.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "877d2c40.229dc8"
            ]
        ]
    },
    {
        "id": "9881a97f.aa45c",
        "type": "comment",
        "name": "call string.contains to check if the cache has srcTtpdstTtpPair",
        "info": "if it had: then no new otn/vpn-binding is needed\n           ==> find the otn. ==>look into the relationships of this connectivity and find the one that has same srcTtp and dstTtp\n           ==> increase the bw\nif not, create a new vpn-binding, attach this vpn-binding into the founded connectivity, and attach it to the middle-man-conn as well.",
        "comments": "",
        "x": 2157.566650390625,
        "y": 2281.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "8313a95b.4655",
        "type": "comment",
        "name": "create a new connectivity - (for dummy connectivity)",
        "info": "(this should not be for LEAF side or ROOT side, otherwise error)\n\ncreate a new vpn-binding (done here)\ncreate a new connectivity (done below)\nadd srcTtpdstTtpPair into the cache in this connectivity\nattach the vpn-binding into the connectivity relationship\nattach this connectivity into the middle man\nattach this connectivity into the service-instance",
        "comments": "",
        "x": 2024.5666198730469,
        "y": 1479.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "298356b2.691352",
        "type": "save",
        "name": "save vpn-binding otnIdx resource (aka. OTN) in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding' \n      key='vpn-binding.vpn-id = $prop.vpn-binding-otnidx-uuid' >\n<parameter name='vpn-id' value='`$prop.vpn-binding-otnidx-uuid`' />\n<parameter name='vpn-name' value='`$prop.otn-tunnel-name`' />\n<!--<parameter name='customer-vpn-id' value='`($idx + 1) * 10`' />-->\n<!--<parameter name='customer-vpn-id' value='`($maxtpn + $gfp)`' />-->\n<parameter name='customer-vpn-id' value='`$newToBeUsedMaxtpn`' />\n<!--<parameter name='access-provider-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-provider-id`' />-->\n<parameter name='access-provider-id' value='`$tmp.access-provider-id`' />\n<!--<parameter name='access-client-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-client-id`' />-->\n<parameter name='access-client-id' value='`$tmp.access-client-id`' />\n<!--<parameter name='access-topology-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-topology-id`' />-->\n<parameter name='access-topology-id' value='`$tmp.access-topology-id`' />\n<!--<parameter name='src-access-node-id' value='`$tmp.otninfo[$otnidx].srcPort.src-access-node-id`' />-->\n<parameter name='src-access-node-id' value='`$tmp.domainG-src-access-node-id`' />\n<parameter name='src-access-ltp-id' value='`$tmp.otninfo[$otnidx].srcPort.src-tunnel-tp-id`' />\n<!--<parameter name='dst-access-node-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-node-id`' />-->\n<parameter name='dst-access-node-id' value='`$tmp.domainG-dst-access-node-id`' />\n<parameter name='dst-access-ltp-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-tunnel-tp-id`' />\n<parameter name='route-distinguisher' value='`$gfp`' />\n<parameter name='operational-status' value='Created' />\n<parameter name='model-customization-id' value='`$vnf-topology-operation-input.service-information.onap-model-information.model-customization-uuid`' />\n<parameter name='model-invariant-id' value='`$vnf-topology-operation-input.service-information.onap-model-information.model-invariant-uuid`' />\n<parameter name='model-version-id' value='`$vnf-topology-operation-input.service-information.onap-model-information.model-uuid`' />\n\n\n<parameter name='vpn-region' value='`$prop.sdncRestApi.thirdpartySdnc.domainG.url`' />\n<parameter name='vpn-description' value='`$prop.sdncRestApi.thirdpartySdnc.domainG.user`' />\n<parameter name='vpn-platform' value='`$prop.sdncRestApi.thirdpartySdnc.domainG.password`' />\n\n<!-- The following line is in lieu of vpn-binding.slice-id (new attribute in latest AAI) -->\n<!--<parameter name='ops-note' value='`$tmp.aai.service-instance.service-instance-id`' />-->\n<parameter name='slice-id' value='`$tmp.aai.service-instance.service-instance-id`' />\n<parameter name='ops-note' value='`$tmp.srcTtpOtnLayer`' />\n\n",
        "comments": "",
        "outputs": 1,
        "x": 2071.566650390625,
        "y": 1529.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "594dfec1.070b58"
            ]
        ]
    },
    {
        "id": "594dfec1.070b58",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2359.566650390625,
        "y": 1530.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "20be2b7.b4b9054"
            ]
        ]
    },
    {
        "id": "20be2b7.b4b9054",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 2543.066650390625,
        "y": 1528.820571899414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            []
        ]
    },
    {
        "id": "48aaf3f8.b9dde4",
        "type": "execute",
        "name": "execute string.contains srcTtpdstTtpPair",
        "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='contains' >\n<parameter name=\"source\" value='`$tmp.the-connectivity.coupling-flag`'/>\n<parameter name=\"target\" value=\"`$tmp.srcTtpdstTtpPair`\"/>\n\n",
        "comments": "",
        "outputs": 1,
        "x": 2145.566650390625,
        "y": 2333.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "5fc5edcc.a33e6c",
                "1c8fc333.3d53cd"
            ]
        ]
    },
    {
        "id": "5fc5edcc.a33e6c",
        "type": "outcomeFalse",
        "name": "false",
        "xml": "<outcome value='false'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2318.566650390625,
        "y": 2181.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            []
        ]
    },
    {
        "id": "1c8fc333.3d53cd",
        "type": "outcomeFalse",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2350.566650390625,
        "y": 2440.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "7733ea37.676d94"
            ]
        ]
    },
    {
        "id": "94ea5f1c.00084",
        "type": "save",
        "name": "save vpn-binding otnIdx resource (aka. OTN) in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding' \n      key='vpn-binding.vpn-id = $prop.vpn-binding-otnidx-uuid' >\n<parameter name='vpn-id' value='`$prop.vpn-binding-otnidx-uuid`' />\n<parameter name='vpn-name' value='`$prop.otn-tunnel-name`' />\n<!--<parameter name='customer-vpn-id' value='`($idx + 1) * 10`' />-->\n<!--<parameter name='customer-vpn-id' value='`($maxtpn + $gfp)`' />-->\n<parameter name='customer-vpn-id' value='`$newToBeUsedMaxtpn`' />\n<!--<parameter name='access-provider-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-provider-id`' />-->\n<parameter name='access-provider-id' value='`$tmp.access-provider-id`' />\n<!--<parameter name='access-client-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-client-id`' />-->\n<parameter name='access-client-id' value='`$tmp.access-client-id`' />\n<!--<parameter name='access-topology-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-topology-id`' />-->\n<parameter name='access-topology-id' value='`$tmp.access-topology-id`' />\n<!--<parameter name='src-access-node-id' value='`$tmp.otninfo[$otnidx].srcPort.src-access-node-id`' />-->\n<parameter name='src-access-node-id' value='`$tmp.domainG-src-access-node-id`' />\n<parameter name='src-access-ltp-id' value='`$tmp.otninfo[$otnidx].srcPort.src-tunnel-tp-id`' />\n<!--<parameter name='dst-access-node-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-node-id`' />-->\n<parameter name='dst-access-node-id' value='`$tmp.domainG-dst-access-node-id`' />\n<parameter name='dst-access-ltp-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-tunnel-tp-id`' />\n<parameter name='route-distinguisher' value='`$gfp`' />\n<parameter name='operational-status' value='Created' />\n<parameter name='model-customization-id' value='`$vnf-topology-operation-input.service-information.onap-model-information.model-customization-uuid`' />\n<parameter name='model-invariant-id' value='`$vnf-topology-operation-input.service-information.onap-model-information.model-invariant-uuid`' />\n<parameter name='model-version-id' value='`$vnf-topology-operation-input.service-information.onap-model-information.model-uuid`' />\n\n\n<parameter name='vpn-region' value='`$prop.sdncRestApi.thirdpartySdnc.domainG.url`' />\n<parameter name='vpn-description' value='`$prop.sdncRestApi.thirdpartySdnc.domainG.user`' />\n<parameter name='vpn-platform' value='`$prop.sdncRestApi.thirdpartySdnc.domainG.password`' />\n\n<!-- The following line is in lieu of vpn-binding.slice-id (new attribute in latest AAI) -->\n<!--<parameter name='ops-note' value='`$tmp.aai.service-instance.service-instance-id`' />-->\n<parameter name='slice-id' value='`$tmp.aai.service-instance.service-instance-id`' />\n<parameter name='ops-note' value='`$tmp.srcTtpOtnLayer`' />\n\n",
        "comments": "",
        "outputs": 1,
        "x": 2757.566650390625,
        "y": 1971.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "ee79eb28.dfce98"
            ]
        ]
    },
    {
        "id": "ee79eb28.dfce98",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3061.566650390625,
        "y": 1968.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "cd827e2b.fca8e"
            ]
        ]
    },
    {
        "id": "cd827e2b.fca8e",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 3212.066650390625,
        "y": 1975.820571899414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            []
        ]
    },
    {
        "id": "6a2d9e1e.0984a",
        "type": "execute",
        "name": "execute UUID generator for connectivity domain otnidx",
        "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='generateUUID' >\n<parameter name=\"ctx-destination\" value=\"uuid.connectivity-otnidx-uuid\"/>\n",
        "comments": "",
        "outputs": 1,
        "x": 2051.566650390625,
        "y": 1584.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            []
        ]
    },
    {
        "id": "6f0be409.bf59b4",
        "type": "save",
        "name": "save connectivity resource in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='connectivity' \n      key='connectivity.connectivity-id = $uuid.connectivity-otnidx-uuid'>\n<parameter name='connectivity-id' value='`$uuid.connectivity-otnidx-uuid`' />\n<!--<parameter name='etht-svc-name' value='`$prop.ethernet-service-name`' />-->\n<parameter name='operational-status' value='Created' />\n<parameter name='access-provider-id' value='`$tmp.access-provider-id`' />\n<!--<parameter name='access-provider-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-provider-id`' />-->\n<!--<parameter name='access-client-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-client-id`' />-->\n<!--<parameter name='access-topology-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-topology-id`' />-->\n<!--<parameter name='access-node-id' value='`$tmp.otninfo[$otnidx].srcPort.src-access-node-id`' />-->\n<!--<parameter name='access-ltp-id' value='``' />-->\n<parameter name='cvlan' value='`$tmp.aai.network-route-A.logical-interface-id`' />\n\n<parameter name='coupling-flag' value='`$srcTtpdstTtpPair`' />\n\n<!--<parameter name='bandwidth-profile-name' value='`$prop.sotn.etht-svc-name`' />-->\n<parameter name='bandwidth-profile-name' value='`$gfp`' />\n<parameter name='vpn-type' value='dummy' />\n<parameter name='cir' value='`$gfp *1000000`' />\n<parameter name='eir' value='`$gfp *1000000`' />\n<!--<parameter name='cbs' value='`$prop.sotn.cbs`' />-->\n<!--<parameter name='ebs' value='`$prop.sotn.ebs`' />-->\n<!--<parameter name='color-aware' value='`$prop.sotn.colorAware`' />-->\n\n<!--<parameter name='etht-svc-name' value='`$prop.sotn.etht-svc-name`' />-->\n<parameter name='model-customization-id' value='`$vnf-topology-operation-input.service-information.onap-model-information.model-customization-uuid`' />\n<parameter name='model-invariant-id' value='`$vnf-topology-operation-input.service-information.onap-model-information.model-invariant-uuid`' />\n<parameter name='model-version-id' value='`$vnf-topology-operation-input.service-information.onap-model-information.model-uuid`' />\n<parameter name='connectivity-selflink' value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'  + $network-topology-operation-input.service-information.service-instance-id  + '/service-data/networks/network/'  + $prop.sotn.network-id  + '/network-data/'` \" />\n",
        "comments": "",
        "outputs": 1,
        "x": 1989.566650390625,
        "y": 1634.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            []
        ]
    },
    {
        "id": "f8e04437.c053b8",
        "type": "save",
        "name": "save middle-man-conn relationship to connectivity-otnidx, in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='connectivity:relationship-list' \n      key='connectivity.connectivity-id = $middle-man-conn.connectivity-id' \n      force=\"true\" pfx=\"tmp.AnAI-data\">\n<parameter name=\"relationship-list.relationship[0].related-to\" value=\"connectivity\" />\n<parameter name=\"relationship-list.relationship[0].related-link\" value=\"`'/network/connectivities/connectivity/' + $uuid.connectivity-otnidx-uuid`\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"connectivity.connectivity-id\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$uuid.connectivity-otnidx-uuid`\" />",
        "comments": "",
        "outputs": 1,
        "x": 2090.566650390625,
        "y": 1679.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            []
        ]
    },
    {
        "id": "83b33842.f7a008",
        "type": "save",
        "name": "save TNNSSI (transport service instance) relationship to connectivity in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='service-instance:relationship-list' \n      key='service-instance.service-instance-id = $vnf-topology-operation-input.service-information.service-instance-id\n         AND customer.global-customer-id = $vnf-topology-operation-input.service-information.global-customer-id \n         AND service-subscription.service-type = $vnf-topology-operation-input.service-information.subscription-service-type' \n      force=\"true\" pfx=\"tmp.AnAI-data\">\n<parameter name=\"relationship-list.relationship[0].related-to\" value=\"connectivity\" />\n<parameter name=\"relationship-list.relationship[0].related-link\" value=\"`'/network/connectivities/connectivity/' + $uuid.connectivity-otnidx-uuid`\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"connectivity.connectivity-id\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$uuid.connectivity-otnidx-uuid`\" />\n\n\n<!--<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='service-instance:relationship-list' -->\n<!--      key='service-instance.service-instance-id = $service-data.service-information.service-instance-id -->\n<!--         AND customer.global-customer-id = $service-data.networks.network[$nidx].network-data.service-information.global-customer-id -->\n<!--         AND service-subscription.service-type = $service-data.networks.network[$nidx].network-data.service-information.subscription-service-type' -->\n<!--      force=\"true\" pfx=\"tmp.AnAI-data\">-->\n<!--<parameter name=\"relationship-list.relationship[0].related-to\" value=\"connectivity\" />-->\n<!--<parameter name=\"relationship-list.relationship[0].related-link\" value=\"`'/network/connectivities/connectivity/' + $prop.sotn.network-id`\" />-->\n<!--<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"connectivity.connectivity-id\" />-->\n<!--<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$prop.sotn.network-id`\" />-->",
        "comments": "",
        "outputs": 1,
        "x": 2126.566650390625,
        "y": 1733.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            []
        ]
    },
    {
        "id": "665710a0.10b6d",
        "type": "save",
        "name": "save connectivity-otnidx relationship to vpn-binding-otnidx, in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding:relationship-list' \n      key='vpn-binding.vpn-id = $prop.vpn-binding-otnidx-uuid' \n      force=\"true\" pfx=\"tmp.AnAI-data\">\n<parameter name=\"relationship-list.relationship[0].related-to\" value=\"connectivity\" />\n<parameter name=\"relationship-list.relationship[0].related-link\" value=\"`'/network/connectivities/connectivity/' + $uuid.connectivity-otnidx-uuid`\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"connectivity.connectivity-id\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$uuid.connectivity-otnidx-uuid`\" />",
        "comments": "",
        "outputs": 1,
        "x": 2094.566650390625,
        "y": 1792.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            []
        ]
    },
    {
        "id": "50815aa.2966624",
        "type": "comment",
        "name": "find middle-man's eth-srv-name",
        "info": "",
        "comments": "",
        "x": 1552.566650390625,
        "y": 1408.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "4be74bfa.e8a9a4",
        "type": "set",
        "name": "set prop.ethernet-service-name",
        "xml": "<set>\n<parameter name='prop.ethernet-service-name' value='`$middle-man-conn.etht-svc-name`' />\n\n",
        "comments": "",
        "x": 1574.566650390625,
        "y": 1452.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "7bee4ebc.b72be8",
        "type": "save",
        "name": "save middle-man-conn relationship to tmp.the-connectivity, in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='connectivity:relationship-list' \n      key='connectivity.connectivity-id = $middle-man-conn.connectivity-id' \n      force=\"true\" pfx=\"tmp.AnAI-data\">\n<parameter name=\"relationship-list.relationship[0].related-to\" value=\"connectivity\" />\n<parameter name=\"relationship-list.relationship[0].related-link\" value=\"`'/network/connectivities/connectivity/' + $tmp.the-connectivity.connectivity-id`\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"connectivity.connectivity-id\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$tmp.the-connectivity.connectivity-id`\" />",
        "comments": "",
        "outputs": 1,
        "x": 2781.566650390625,
        "y": 2188.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            []
        ]
    },
    {
        "id": "2dce7211.24f81e",
        "type": "save",
        "name": "save TNNSSI (transport service instance) relationship to connectivity in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='service-instance:relationship-list' \n      key='service-instance.service-instance-id = $vnf-topology-operation-input.service-information.service-instance-id\n         AND customer.global-customer-id = $vnf-topology-operation-input.service-information.global-customer-id \n         AND service-subscription.service-type = $vnf-topology-operation-input.service-information.subscription-service-type' \n      force=\"true\" pfx=\"tmp.AnAI-data\">\n<parameter name=\"relationship-list.relationship[0].related-to\" value=\"connectivity\" />\n<parameter name=\"relationship-list.relationship[0].related-link\" value=\"`'/network/connectivities/connectivity/' + $uuid.connectivity-otnidx-uuid`\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"connectivity.connectivity-id\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$uuid.connectivity-otnidx-uuid`\" />\n\n\n<!--<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='service-instance:relationship-list' -->\n<!--      key='service-instance.service-instance-id = $service-data.service-information.service-instance-id -->\n<!--         AND customer.global-customer-id = $service-data.networks.network[$nidx].network-data.service-information.global-customer-id -->\n<!--         AND service-subscription.service-type = $service-data.networks.network[$nidx].network-data.service-information.subscription-service-type' -->\n<!--      force=\"true\" pfx=\"tmp.AnAI-data\">-->\n<!--<parameter name=\"relationship-list.relationship[0].related-to\" value=\"connectivity\" />-->\n<!--<parameter name=\"relationship-list.relationship[0].related-link\" value=\"`'/network/connectivities/connectivity/' + $prop.sotn.network-id`\" />-->\n<!--<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"connectivity.connectivity-id\" />-->\n<!--<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$prop.sotn.network-id`\" />-->",
        "comments": "",
        "outputs": 1,
        "x": 2812.566650390625,
        "y": 2227.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            []
        ]
    },
    {
        "id": "90bd55a8.2fdfb",
        "type": "save",
        "name": "save tmp.the-connectivity relationship to vpn-binding-otnidx, in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding:relationship-list' \n      key='vpn-binding.vpn-id = $prop.vpn-binding-otnidx-uuid' \n      force=\"true\" pfx=\"tmp.AnAI-data\">\n<parameter name=\"relationship-list.relationship[0].related-to\" value=\"connectivity\" />\n<parameter name=\"relationship-list.relationship[0].related-link\" value=\"`'/network/connectivities/connectivity/' + $tmp.the-connectivity.connectivity-id`\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"connectivity.connectivity-id\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$tmp.the-connectivity.connectivity-id`\" />",
        "comments": "",
        "outputs": 1,
        "x": 2783.566650390625,
        "y": 2300.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            []
        ]
    },
    {
        "id": "7a94ba19.d3678c",
        "type": "comment",
        "name": "update the founded connectivity to have a new coupling-flag",
        "info": "",
        "comments": "",
        "x": 2753.566650390625,
        "y": 2016.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "1f39716d.08bb37",
        "type": "set",
        "name": "set newFlag",
        "xml": "<set>\n<parameter name='tmp.newFlag' value=\"`$tmp.the-connectivity.coupling-flag + '-' +\n                                               $tmp.srcTtpdstTtpPair`\" />\n\n\n",
        "comments": "",
        "x": 2639.566650390625,
        "y": 2055.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "966d5b58.b138c",
        "type": "save",
        "name": "update connectivity resource in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='connectivity' \n      key='connectivity.connectivity-id = $tmp.the-connectivity.connectivity-id'>\n<parameter name='connectivity-id' value='`$tmp.the-connectivity.connectivity-id`' />\n<parameter name='etht-svc-name' value='`$prop.ethernet-service-name`' />\n<parameter name='operational-status' value='Modified' />\n<parameter name='coupling-flag' value='`$tmp.newFlag`' />\n",
        "comments": "",
        "outputs": 1,
        "x": 2703.566650390625,
        "y": 2100.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            []
        ]
    },
    {
        "id": "3ca218f1.e24728",
        "type": "comment",
        "name": "the following two relationships should have already been there; if not => error",
        "info": "",
        "comments": "",
        "x": 2795.566650390625,
        "y": 2150.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "533f0d90.da6154",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 1781.566650390625,
        "y": 1517.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "298356b2.691352",
                "6a2d9e1e.0984a",
                "6f0be409.bf59b4",
                "f8e04437.c053b8",
                "83b33842.f7a008",
                "665710a0.10b6d"
            ]
        ]
    },
    {
        "id": "a1f3f094.cf6868",
        "type": "outcomeFalse",
        "name": "false",
        "xml": "<outcome value='false'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1643.566650390625,
        "y": 1513.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "533f0d90.da6154"
            ]
        ]
    },
    {
        "id": "877d2c40.229dc8",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic='true'>",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 2441.566650390625,
        "y": 1980.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "94ea5f1c.00084",
                "1f39716d.08bb37",
                "966d5b58.b138c",
                "90bd55a8.2fdfb"
            ]
        ]
    },
    {
        "id": "921c2635.2657",
        "type": "comment",
        "name": "loop through the relationships of this founded connectivity, then",
        "info": "then find the vpn-binding that has same src ttp and dst ttp as this one",
        "comments": "",
        "x": 2446.566650390625,
        "y": 2405.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "2a3dc4da.d825f4",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for silentFailure='true' index='tcridx' start='0' end='`$tmp.the-connectivity.relationship-list.relationship_length`' >\n\n",
        "comments": "",
        "outputs": 1,
        "x": 2788.566650390625,
        "y": 2441.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "736b385a.35da7"
            ]
        ]
    },
    {
        "id": "736b385a.35da7",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.the-connectivity.relationship-list.relationship[$tcridx].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3000.566650390625,
        "y": 2439.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "e66ec218.e79bc"
            ]
        ]
    },
    {
        "id": "e66ec218.e79bc",
        "type": "outcome",
        "name": "vpn-binding",
        "xml": "<outcome value='vpn-binding'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3184.566650390625,
        "y": 2437.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "8c204db5.df1ea"
            ]
        ]
    },
    {
        "id": "8c204db5.df1ea",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 3363.566650390625,
        "y": 2442.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "750b8345.e6107c",
                "b2411873.31b798"
            ]
        ]
    },
    {
        "id": "b2411873.31b798",
        "type": "set",
        "name": "unset tmp.aai.vpn-binding",
        "xml": "<set>\n<parameter name='tmp.aai.vpn-binding.' value='' />\n",
        "comments": "",
        "x": 3580.566650390625,
        "y": 2373.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "750b8345.e6107c",
        "type": "save",
        "name": "get vpn-binding from aai",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"vpn-binding\"\n\t    key=\"vpn-binding.vpn-id = $tmp.the-connectivity.relationship-list.relationship[$tcridx].relationship-data[0].relationship-value\"\n\t\tlocal-only=\"false\" \n\t\tpfx=\"tmp.aai.vpn-binding\" >\n",
        "comments": "",
        "outputs": 1,
        "x": 3573.566650390625,
        "y": 2459.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "bdf485ca.827e58",
                "ed90443b.6fe53",
                "a94ce9b.8c46898"
            ]
        ]
    },
    {
        "id": "ed90443b.6fe53",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3787.0576171875,
        "y": 2444.1407012939453,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "1ae663bf.60e5d4"
            ]
        ]
    },
    {
        "id": "1ae663bf.60e5d4",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.l3vpn.pe1_id`\" />\n\n",
        "comments": "",
        "x": 3949.629150390625,
        "y": 2443.4264068603516,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "4b566804.b29878",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
        "comments": "",
        "x": 3950.566650390625,
        "y": 2488.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "a94ce9b.8c46898",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3782.566650390625,
        "y": 2488.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "4b566804.b29878"
            ]
        ]
    },
    {
        "id": "bdf485ca.827e58",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3784.566650390625,
        "y": 2548.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "e92643e6.dea4d"
            ]
        ]
    },
    {
        "id": "e92643e6.dea4d",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 3953.566650390625,
        "y": 2547.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "8f8a5cb3.af8a3"
            ]
        ]
    },
    {
        "id": "7733ea37.676d94",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 2577.566650390625,
        "y": 2439.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "2a3dc4da.d825f4",
                "9b2ffd1b.3a96e",
                "6fbcac88.0e9a54"
            ]
        ]
    },
    {
        "id": "8f8a5cb3.af8a3",
        "type": "switchNode",
        "name": "switch srcTtp",
        "xml": "<switch test='`$tmp.aai.vpn-binding.src-access-ltp-id == $tmp.otninfo[$otnidx].srcPort.src-tunnel-tp-id`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4152.566650390625,
        "y": 2548.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "bc9f47cc.0b96"
            ]
        ]
    },
    {
        "id": "bc9f47cc.0b96",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4315.566650390625,
        "y": 2546.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "566fa06e.e1e238"
            ]
        ]
    },
    {
        "id": "566fa06e.e1e238",
        "type": "switchNode",
        "name": "switch dstTtp",
        "xml": "<switch test='`$tmp.aai.vpn-binding.dst-access-ltp-id == $tmp.otninfo[$otnidx].dstPort.dst-tunnel-tp-id`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4496.566650390625,
        "y": 2546.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "f4daf0bd.af9d9"
            ]
        ]
    },
    {
        "id": "f4daf0bd.af9d9",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4659.566650390625,
        "y": 2544.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "c0c49b50.2a7748"
            ]
        ]
    },
    {
        "id": "562992d6.b870dc",
        "type": "set",
        "name": "set tmp.the-vpn-binding",
        "xml": "<set>\n<parameter name='tmp.the-vpn-binding.' value='`$tmp.aai.vpn-binding.`' />\n",
        "comments": "",
        "x": 5016.566650390625,
        "y": 2551.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "c0c49b50.2a7748",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 4798.566650390625,
        "y": 2543.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "562992d6.b870dc",
                "10659fb.a744fe"
            ]
        ]
    },
    {
        "id": "10659fb.a744fe",
        "type": "break",
        "name": "break",
        "xml": "<break>\n",
        "comments": "",
        "x": 4962.566650390625,
        "y": 2595.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "9b2ffd1b.3a96e",
        "type": "set",
        "name": "unset tmp.the-vpn-binding",
        "xml": "<set>\n<parameter name='tmp.the-vpn-binding.' value='' />\n",
        "comments": "",
        "x": 2798.566650390625,
        "y": 2402.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "9d592730.4455b8",
        "type": "comment",
        "name": "increase the bw of the-vpn-binding and change status to modified",
        "info": "increase the bw of the-vpn-binding\nchange status to modified\n",
        "comments": "",
        "x": 2887.566650390625,
        "y": 2576.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "6fbcac88.0e9a54",
        "type": "save",
        "name": "update vpn-binding otnIdx resource (aka. OTN) in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding' \n      key='vpn-binding.vpn-id = $tmp.the-vpn-binding.vpn-id' >\n<parameter name='vpn-id' value='`$tmp.the-vpn-binding.vpn-id`' />\n<!--<parameter name='vpn-name' value='`$prop.otn-tunnel-name`' />-->\n<!--<parameter name='customer-vpn-id' value='`($maxtpn + $gfp)`' />-->\n<parameter name='customer-vpn-id' value='`($tmp.the-vpn-binding.customer-vpn-id + $gfp)`' />\n\n<parameter name='route-distinguisher' value='`$gfp`' />\n<parameter name='operational-status' value='Modified' />\n\n\n",
        "comments": "",
        "outputs": 1,
        "x": 2857.566650390625,
        "y": 2636.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            []
        ]
    },
    {
        "id": "5d4c8b88.6ea084",
        "type": "switchNode",
        "name": "switch otninfoProtect exists",
        "xml": "<switch test=\"`$tmp.otninfoProtect_length > 0`\">\n\n",
        "comments": "",
        "outputs": 1,
        "x": 623.6832885742188,
        "y": 2502.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "b304b119.fc6c6"
            ]
        ]
    },
    {
        "id": "b304b119.fc6c6",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 844.6832885742188,
        "y": 2503.566665649414,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "929a93b0.fb26e"
            ]
        ]
    },
    {
        "id": "1365d05a.43ccb8",
        "type": "for",
        "name": "for vidx..tmp.otninfoProtect_length[]",
        "xml": "<for index='otnidx' start='0' end='`$tmp.otninfoProtect_length`' >",
        "comments": "",
        "outputs": 1,
        "x": 660.2333374023438,
        "y": 3284.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "d491584d.33cd28"
            ]
        ]
    },
    {
        "id": "d491584d.33cd28",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic='true'>",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 920.2333068847656,
        "y": 3277.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "252a570f.f396c8",
                "f0403523.cecec",
                "53ad6d75.3e9854",
                "61d4cb78.58331c",
                "d81f3e39.a99398",
                "57f2e473.517f54",
                "c1b2a740.d37fa",
                "34621460.796344",
                "5ed2002c.80ebf8",
                "6dfdf88f.4bb6c"
            ]
        ]
    },
    {
        "id": "f0403523.cecec",
        "type": "switchNode",
        "name": "switch dstPort == NULL",
        "xml": "<switch test=\"`$tmp.otninfoProtect[$otnidx].dstPort.dst-access-provider-id == ''`\">\n\n",
        "comments": "",
        "outputs": 1,
        "x": 1309.2333374023438,
        "y": 2946.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "a19e39b9.f8da1",
                "f567fdff.bdc4a8"
            ]
        ]
    },
    {
        "id": "f567fdff.bdc4a8",
        "type": "outcomeFalse",
        "name": "false",
        "xml": "<outcome value='false'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1676.2333374023438,
        "y": 2953.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "4918f2b6.cf40ac"
            ]
        ]
    },
    {
        "id": "4918f2b6.cf40ac",
        "type": "set",
        "name": "set access-provider-id and client-id",
        "xml": "<set>\n<parameter name='tmp.access-provider-id' value='`$tmp.otninfoProtect[$otnidx].dstPort.dst-access-provider-id`' />\n<parameter name='tmp.access-client-id' value='`$tmp.otninfoProtect[$otnidx].dstPort.dst-access-client-id`' />\n<parameter name='tmp.access-topology-id' value='`$tmp.otninfoProtect[$otnidx].dstPort.dst-access-topology-id`' />\n<parameter name='tmp.srcdstpnf-id' value='`$tmp.otninfoProtect[$otnidx].dstPort.dst-access-node-id`' />\n",
        "comments": "",
        "x": 1887.2333374023438,
        "y": 2951.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "53ad6d75.3e9854",
        "type": "set",
        "name": "set srcdstpnf-name",
        "xml": "<set>\n<parameter name='tmp.srcdstpnf-name' value=\"`'networkId-providerId-' + \n                                             $tmp.access-provider-id + '-clientId-' +\n                                             $tmp.access-client-id + '-topologyId-' + \n                                             $tmp.access-topology-id + '-nodeId-' + \n                                             $tmp.srcdstpnf-id`\" />\n\n",
        "comments": "",
        "x": 1485.2333374023438,
        "y": 3020.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "61d4cb78.58331c",
        "type": "get-resource",
        "name": "get-resource tmp.srcdstpnf-name",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"pnf\" \n\t\tkey=\"pnf.pnf-name = $tmp.srcdstpnf-name\"\n        pfx='tmp.aai.srcdst-pnf' local-only='false' >\n\n        <!--AND depth = '0'\"-->\n",
        "comments": "",
        "outputs": 1,
        "x": 1529.2333374023438,
        "y": 3068.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "c8e35acd.0cd338",
                "1a3bc3e9.de0b6c",
                "d9c66705.f174c8"
            ]
        ]
    },
    {
        "id": "c8e35acd.0cd338",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1741.7333374023438,
        "y": 3015.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "b0542ad9.f9bdf8"
            ]
        ]
    },
    {
        "id": "1a3bc3e9.de0b6c",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1753.7333374023438,
        "y": 3065.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "6126bc5c.e48684"
            ]
        ]
    },
    {
        "id": "d9c66705.f174c8",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1744.7333374023438,
        "y": 3120.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "bc3263f3.ac82e"
            ]
        ]
    },
    {
        "id": "bc3263f3.ac82e",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 1889.7333374023438,
        "y": 3119.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "6126bc5c.e48684",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 1900.7333374023438,
        "y": 3062.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "b0542ad9.f9bdf8",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 1867.1157836914062,
        "y": 3009.1222381591797,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "fcdf9d8b.4643d"
            ]
        ]
    },
    {
        "id": "fcdf9d8b.4643d",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for silentFailure='true' index='spvidx' start='0' end='`$tmp.aai.srcdst-pnf.relationship-list.relationship_length`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 2028.2333374023438,
        "y": 3023.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "d8f6f412.7d192"
            ]
        ]
    },
    {
        "id": "d8f6f412.7d192",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.aai.srcdst-pnf.relationship-list.relationship[$spvidx].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2223.2333374023438,
        "y": 3023.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "513cd183.70a36"
            ]
        ]
    },
    {
        "id": "16c3d135.367537",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 2603.2333374023438,
        "y": 3019.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "8f09a3ce.bb8bc8",
                "42328e66.9a179"
            ]
        ]
    },
    {
        "id": "42328e66.9a179",
        "type": "execute",
        "name": "get esr-thirdparty-sdnc",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"esr-thirdparty-sdnc\" \n\t\tkey=\"esr-thirdparty-sdnc.thirdparty-sdnc-id = $tmp.domainG.esr-thirdparty-id AND \n\t\t     depth = '1'\"\n        pfx='tmp.aai.domainG.esr-thirdparty-sdnc' local-only='false' >",
        "comments": "",
        "outputs": 1,
        "x": 2811.2333374023438,
        "y": 3026.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "2a95e8b.71c7818",
                "8cd4441d.84eb48",
                "2f9a0731.3058d8"
            ]
        ]
    },
    {
        "id": "8f09a3ce.bb8bc8",
        "type": "set",
        "name": "set esr-thirdparty-sdnc domainG id",
        "xml": "<set>\n<parameter name='tmp.domainG.esr-thirdparty-id' value=\"`$tmp.aai.srcdst-pnf.relationship-list.relationship[$spvidx].relationship-data[0].relationship-value`\" />\n",
        "comments": "",
        "x": 2841.2333374023438,
        "y": 2974.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "2a95e8b.71c7818",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3021.2333374023438,
        "y": 3017.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "bb0632bc.6bdea8"
            ]
        ]
    },
    {
        "id": "8cd4441d.84eb48",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3013.2333374023438,
        "y": 3072.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "fee906e6.a31e28"
            ]
        ]
    },
    {
        "id": "2f9a0731.3058d8",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3018.2333374023438,
        "y": 3129.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "b7732316.bbeb1"
            ]
        ]
    },
    {
        "id": "b7732316.bbeb1",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 3170.2333374023438,
        "y": 3130.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "fee906e6.a31e28",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 3181.2333374023438,
        "y": 3075.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "bb0632bc.6bdea8",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 3165.6156616210938,
        "y": 3015.1222381591797,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "f496005b.73025"
            ]
        ]
    },
    {
        "id": "513cd183.70a36",
        "type": "outcome",
        "name": "esr-thirdparty-sdnc",
        "xml": "<outcome value='esr-thirdparty-sdnc'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2426.2333374023438,
        "y": 3027.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "16c3d135.367537"
            ]
        ]
    },
    {
        "id": "f496005b.73025",
        "type": "set",
        "name": "set controller domainA data",
        "xml": "<set>\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainG.url' value=\"`$tmp.aai.domainG.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].service-url`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainG.user' value=\"`$tmp.aai.domainG.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].user-name`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainG.password' value=\"`$tmp.aai.domainG.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].password`\" />\n\n\n<!--<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >-->\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/restconf/data/ietf-network:networks'`\" />-->\n<!--<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />-->\n<!--<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />-->\n<!--<parameter name=\"format\" value=\"json\"/>-->\n<!--<parameter name=\"httpMethod\" value=\"get\"/>-->\n<!--<parameter name=\"responsePrefix\" value=\"topology\"/>-->\n<!--<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>-->\n<!--<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>-->\n<!--<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>-->\n<!--<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>-->\n",
        "comments": "",
        "x": 3380.2333374023438,
        "y": 3011.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "d81f3e39.a99398",
        "type": "switchNode",
        "name": "switch dmnsidx == 0 (domainA)",
        "xml": "<switch test='`$otnidx == 0`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1499.2333374023438,
        "y": 3237.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "f53e378b.14151",
                "e638c491.631368"
            ]
        ]
    },
    {
        "id": "f53e378b.14151",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1700.2333374023438,
        "y": 3235.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "7fd6322b.5362bc"
            ]
        ]
    },
    {
        "id": "f8356e69.4561c",
        "type": "set",
        "name": "set pce-src-node",
        "xml": "<set>\n<parameter name='tmp.pce-src-node' value='`$tmp.srcdstpnf-name`' />",
        "comments": "",
        "x": 1981.2333374023438,
        "y": 3185.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "4191bf2c.16bd58",
        "type": "switchNode",
        "name": "switch dmnsidx == last (domainC)",
        "xml": "<switch test='`$otnidx == $tmp.otninfoProtect_length - 1`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1917.2333374023438,
        "y": 3286.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "93d13951.14dd18",
                "fa75dc08.2eaf8"
            ]
        ]
    },
    {
        "id": "93d13951.14dd18",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2147.2333374023438,
        "y": 3282.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "8d4bef0b.6a0fe8"
            ]
        ]
    },
    {
        "id": "e638c491.631368",
        "type": "outcomeFalse",
        "name": "false",
        "xml": "<outcome value='false'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1700.2333374023438,
        "y": 3284.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "4191bf2c.16bd58"
            ]
        ]
    },
    {
        "id": "fa75dc08.2eaf8",
        "type": "outcomeFalse",
        "name": "false",
        "xml": "<outcome value='false'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2148.2333374023438,
        "y": 3328.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "5bb88da7.4d8694"
            ]
        ]
    },
    {
        "id": "5bb88da7.4d8694",
        "type": "set",
        "name": "set attachment_param domain G",
        "xml": "<set>\n<parameter name='tmp.domainG-src-access-node-id' value='`$tmp.otninfoProtect[$otnidx].srcPort.src-access-node-id`' />\n<parameter name='tmp.domainG-dst-access-node-id' value='`$tmp.otninfoProtect[$otnidx].dstPort.dst-access-node-id`' />",
        "comments": "",
        "x": 2362.2333374023438,
        "y": 3328.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "6729c928.c3b6c",
        "type": "set",
        "name": "set attachment_param domain A",
        "xml": "<set>\n<parameter name='tmp.domainG-src-access-node-id' value='`$param-prefix-domainA[$param-prefix-domainA_length -3]`' />\n<parameter name='tmp.domainG-dst-access-node-id' value='`$tmp.otninfoProtect[$otnidx].dstPort.dst-access-node-id`' />",
        "comments": "",
        "x": 2036.2333374023438,
        "y": 3232.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "7fd6322b.5362bc",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 1824.2333374023438,
        "y": 3226.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "6729c928.c3b6c"
            ]
        ]
    },
    {
        "id": "8d4bef0b.6a0fe8",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 2280.2333374023438,
        "y": 3258.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "e3feca80.0e5828"
            ]
        ]
    },
    {
        "id": "e95f7eb5.2af0b8",
        "type": "set",
        "name": "set pce-src-node",
        "xml": "<set>\n<parameter name='tmp.pce-dst-node' value='`$tmp.srcdstpnf-name`' />",
        "comments": "",
        "x": 2436.2333374023438,
        "y": 3274.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "e3feca80.0e5828",
        "type": "set",
        "name": "set attachment_param domain C",
        "xml": "<set>\n<parameter name='tmp.domainG-src-access-node-id' value='`$tmp.otninfoProtect[$otnidx].srcPort.src-access-node-id`' />\n<parameter name='tmp.domainG-dst-access-node-id' value='`$param-prefix-domainC[$param-prefix-domainC_length -3]`' />",
        "comments": "",
        "x": 2484.2333374023438,
        "y": 3226.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "57f2e473.517f54",
        "type": "set",
        "name": "set srcTtp+dstTtp pair",
        "xml": "<set>\n<parameter name='tmp.srcTtpdstTtpPair' value=\"`$tmp.otninfoProtect[$otnidx].srcPort.src-tunnel-tp-id + ',' +\n                                               $tmp.otninfootninfoProtect.dstPort.dst-tunnel-tp-id`\" />\n\n\n",
        "comments": "",
        "x": 1475.2333374023438,
        "y": 3317.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "34621460.796344",
        "type": "call",
        "name": "call GENERIC-RESOURCE-API:cll-vnf-topology-operation-cll-helper-find-connectivity",
        "xml": "<call module='GENERIC-RESOURCE-API' rpc='cll-vnf-topology-operation-cll-helper-find-connectivity' mode='sync' >\n\n",
        "comments": "",
        "outputs": 1,
        "x": 1667.2333068847656,
        "y": 3415.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            []
        ]
    },
    {
        "id": "c1b2a740.d37fa",
        "type": "set",
        "name": "set current-provider-id and current-cvlan-id",
        "xml": "<set>\n<parameter name='tmp.current-provider-id' value='`$tmp.access-provider-id`' />\n<parameter name='tmp.current-cvlan-id' value='`$tmp.aai.network-route-A.logical-interface-id`' />\n\n",
        "comments": "",
        "x": 1539.2333374023438,
        "y": 3368.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "5ed2002c.80ebf8",
        "type": "switchNode",
        "name": "switch found-connectivity?",
        "xml": "\n<switch test=\"`$found-connectivity`\">\n\n",
        "comments": "",
        "outputs": 1,
        "x": 1348.2333374023438,
        "y": 3569.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "3ba1da7b.60657e",
                "5bde363c.523c48"
            ]
        ]
    },
    {
        "id": "3ba1da7b.60657e",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1634.2333374023438,
        "y": 4388.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "c5f8d573.741818"
            ]
        ]
    },
    {
        "id": "cfba9c01.06834",
        "type": "comment",
        "name": "call string.contains to check if the cache has srcTtpdstTtpPair",
        "info": "if it had: then no new otn/vpn-binding is needed\n           ==> find the otn. ==>look into the relationships of this connectivity and find the one that has same srcTtp and dstTtp\n           ==> increase the bw\nif not, create a new vpn-binding, attach this vpn-binding into the founded connectivity, and attach it to the middle-man-conn as well.",
        "comments": "",
        "x": 2060.2333374023438,
        "y": 4333.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "d5ee8376.6d7b3",
        "type": "comment",
        "name": "create a new connectivity - (for dummy connectivity)",
        "info": "(this should not be for LEAF side or ROOT side, otherwise error)\n\ncreate a new vpn-binding (done here)\ncreate a new connectivity (done below)\nadd srcTtpdstTtpPair into the cache in this connectivity\nattach the vpn-binding into the connectivity relationship\nattach this connectivity into the middle man\nattach this connectivity into the service-instance",
        "comments": "",
        "x": 1927.2333068847656,
        "y": 3531.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "7d7a6dc.ff5ab14",
        "type": "save",
        "name": "save vpn-binding otnIdx resource (aka. OTN) in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding' \n      key='vpn-binding.vpn-id = $prop.vpn-binding-otnidx-uuid' >\n<parameter name='vpn-id' value='`$prop.vpn-binding-otnidx-uuid`' />\n<parameter name='vpn-name' value=\"`$prop.otn-tunnel-name + '-protection'`\" />\n<!--<parameter name='customer-vpn-id' value='`($idx + 1) * 10`' />-->\n<!--<parameter name='customer-vpn-id' value='`($maxtpn + $gfp)`' />-->\n<parameter name='customer-vpn-id' value='`$newToBeUsedMaxtpn`' />\n<!--<parameter name='access-provider-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-provider-id`' />-->\n<parameter name='access-provider-id' value='`$tmp.access-provider-id`' />\n<!--<parameter name='access-client-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-client-id`' />-->\n<parameter name='access-client-id' value='`$tmp.access-client-id`' />\n<!--<parameter name='access-topology-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-topology-id`' />-->\n<parameter name='access-topology-id' value='`$tmp.access-topology-id`' />\n<!--<parameter name='src-access-node-id' value='`$tmp.otninfo[$otnidx].srcPort.src-access-node-id`' />-->\n<parameter name='src-access-node-id' value='`$tmp.domainG-src-access-node-id`' />\n<parameter name='src-access-ltp-id' value='`$tmp.otninfoProtect[$otnidx].srcPort.src-tunnel-tp-id`' />\n<!--<parameter name='dst-access-node-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-node-id`' />-->\n<parameter name='dst-access-node-id' value='`$tmp.domainG-dst-access-node-id`' />\n<parameter name='dst-access-ltp-id' value='`$tmp.otninfoProtect[$otnidx].dstPort.dst-tunnel-tp-id`' />\n<parameter name='route-distinguisher' value='`$gfp`' />\n<parameter name='operational-status' value='Created' />\n<parameter name='model-customization-id' value='`$vnf-topology-operation-input.service-information.onap-model-information.model-customization-uuid`' />\n<parameter name='model-invariant-id' value='`$vnf-topology-operation-input.service-information.onap-model-information.model-invariant-uuid`' />\n<parameter name='model-version-id' value='`$vnf-topology-operation-input.service-information.onap-model-information.model-uuid`' />\n\n\n<parameter name='vpn-region' value='`$prop.sdncRestApi.thirdpartySdnc.domainG.url`' />\n<parameter name='vpn-description' value='`$prop.sdncRestApi.thirdpartySdnc.domainG.user`' />\n<parameter name='vpn-platform' value='`$prop.sdncRestApi.thirdpartySdnc.domainG.password`' />\n\n<!-- The following line is in lieu of vpn-binding.slice-id (new attribute in latest AAI) -->\n<!--<parameter name='ops-note' value='`$tmp.aai.service-instance.service-instance-id`' />-->\n<parameter name='slice-id' value='`$tmp.aai.service-instance.service-instance-id`' />\n<parameter name='ops-note' value='`$tmp.srcTtpOtnLayer`' />\n\n",
        "comments": "",
        "outputs": 1,
        "x": 1974.2333374023438,
        "y": 3581.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "770ec83d.f5f698"
            ]
        ]
    },
    {
        "id": "770ec83d.f5f698",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2262.2333374023438,
        "y": 3582.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "1ea6c507.8eb3c3"
            ]
        ]
    },
    {
        "id": "1ea6c507.8eb3c3",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 2445.7333374023438,
        "y": 3580.720474243164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            []
        ]
    },
    {
        "id": "4b1e068c.b603",
        "type": "execute",
        "name": "execute string.contains srcTtpdstTtpPair",
        "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='contains' >\n<parameter name=\"source\" value='`$tmp.the-connectivity.coupling-flag`'/>\n<parameter name=\"target\" value=\"`$tmp.srcTtpdstTtpPair`\"/>\n\n",
        "comments": "",
        "outputs": 1,
        "x": 2048.2333374023438,
        "y": 4385.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "fa23bfea.633fa",
                "5640420c.c8d724"
            ]
        ]
    },
    {
        "id": "fa23bfea.633fa",
        "type": "outcomeFalse",
        "name": "false",
        "xml": "<outcome value='false'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2221.2333374023438,
        "y": 4233.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            []
        ]
    },
    {
        "id": "5640420c.c8d724",
        "type": "outcomeFalse",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2253.2333374023438,
        "y": 4492.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "745b8702.06258"
            ]
        ]
    },
    {
        "id": "566a0421.e07abc",
        "type": "save",
        "name": "save vpn-binding otnIdx resource (aka. OTN) in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding' \n      key='vpn-binding.vpn-id = $prop.vpn-binding-otnidx-uuid' >\n<parameter name='vpn-id' value='`$prop.vpn-binding-otnidx-uuid`' />\n<parameter name='vpn-name' value=\"`$prop.otn-tunnel-name + '-protection'`\" />\n<!--<parameter name='customer-vpn-id' value='`($idx + 1) * 10`' />-->\n<!--<parameter name='customer-vpn-id' value='`($maxtpn + $gfp)`' />-->\n<parameter name='customer-vpn-id' value='`$newToBeUsedMaxtpn`' />\n<!--<parameter name='access-provider-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-provider-id`' />-->\n<parameter name='access-provider-id' value='`$tmp.access-provider-id`' />\n<!--<parameter name='access-client-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-client-id`' />-->\n<parameter name='access-client-id' value='`$tmp.access-client-id`' />\n<!--<parameter name='access-topology-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-topology-id`' />-->\n<parameter name='access-topology-id' value='`$tmp.access-topology-id`' />\n<!--<parameter name='src-access-node-id' value='`$tmp.otninfo[$otnidx].srcPort.src-access-node-id`' />-->\n<parameter name='src-access-node-id' value='`$tmp.domainG-src-access-node-id`' />\n<parameter name='src-access-ltp-id' value='`$tmp.otninfoProtect[$otnidx].srcPort.src-tunnel-tp-id`' />\n<!--<parameter name='dst-access-node-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-node-id`' />-->\n<parameter name='dst-access-node-id' value='`$tmp.domainG-dst-access-node-id`' />\n<parameter name='dst-access-ltp-id' value='`$tmp.otninfoProtect[$otnidx].dstPort.dst-tunnel-tp-id`' />\n<parameter name='route-distinguisher' value='`$gfp`' />\n<parameter name='operational-status' value='Created' />\n<parameter name='model-customization-id' value='`$vnf-topology-operation-input.service-information.onap-model-information.model-customization-uuid`' />\n<parameter name='model-invariant-id' value='`$vnf-topology-operation-input.service-information.onap-model-information.model-invariant-uuid`' />\n<parameter name='model-version-id' value='`$vnf-topology-operation-input.service-information.onap-model-information.model-uuid`' />\n\n\n<parameter name='vpn-region' value='`$prop.sdncRestApi.thirdpartySdnc.domainG.url`' />\n<parameter name='vpn-description' value='`$prop.sdncRestApi.thirdpartySdnc.domainG.user`' />\n<parameter name='vpn-platform' value='`$prop.sdncRestApi.thirdpartySdnc.domainG.password`' />\n\n<!-- The following line is in lieu of vpn-binding.slice-id (new attribute in latest AAI) -->\n<!--<parameter name='ops-note' value='`$tmp.aai.service-instance.service-instance-id`' />-->\n<parameter name='slice-id' value='`$tmp.aai.service-instance.service-instance-id`' />\n<parameter name='ops-note' value='`$tmp.srcTtpOtnLayer`' />\n\n",
        "comments": "",
        "outputs": 1,
        "x": 2660.2333374023438,
        "y": 4023.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "e7e1a1af.83dc9"
            ]
        ]
    },
    {
        "id": "e7e1a1af.83dc9",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2964.2333374023438,
        "y": 4020.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "9e39afad.724988"
            ]
        ]
    },
    {
        "id": "9e39afad.724988",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 3114.7333374023438,
        "y": 4027.720474243164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            []
        ]
    },
    {
        "id": "5fd9a93f.71f3e",
        "type": "execute",
        "name": "execute UUID generator for connectivity domain otnidx",
        "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='generateUUID' >\n<parameter name=\"ctx-destination\" value=\"uuid.connectivity-otnidx-uuid\"/>\n",
        "comments": "",
        "outputs": 1,
        "x": 1954.2333374023438,
        "y": 3636.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            []
        ]
    },
    {
        "id": "e99e1220.c8d158",
        "type": "save",
        "name": "save connectivity resource in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='connectivity' \n      key='connectivity.connectivity-id = $uuid.connectivity-otnidx-uuid'>\n<parameter name='connectivity-id' value='`$uuid.connectivity-otnidx-uuid`' />\n<!--<parameter name='etht-svc-name' value='`$prop.ethernet-service-name`' />-->\n<parameter name='operational-status' value='Created' />\n<parameter name='access-provider-id' value='`$tmp.access-provider-id`' />\n<!--<parameter name='access-provider-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-provider-id`' />-->\n<!--<parameter name='access-client-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-client-id`' />-->\n<!--<parameter name='access-topology-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-topology-id`' />-->\n<!--<parameter name='access-node-id' value='`$tmp.otninfo[$otnidx].srcPort.src-access-node-id`' />-->\n<!--<parameter name='access-ltp-id' value='``' />-->\n<parameter name='cvlan' value='`$tmp.aai.network-route-A.logical-interface-id`' />\n\n<parameter name='coupling-flag' value='`$srcTtpdstTtpPair`' />\n\n<!--<parameter name='bandwidth-profile-name' value='`$prop.sotn.etht-svc-name`' />-->\n<parameter name='bandwidth-profile-name' value='`$gfp`' />\n<parameter name='vpn-type' value='dummy' />\n<parameter name='cir' value='`$gfp *1000000`' />\n<parameter name='eir' value='`$gfp *1000000`' />\n<!--<parameter name='cbs' value='`$prop.sotn.cbs`' />-->\n<!--<parameter name='ebs' value='`$prop.sotn.ebs`' />-->\n<!--<parameter name='color-aware' value='`$prop.sotn.colorAware`' />-->\n\n<!--<parameter name='etht-svc-name' value='`$prop.sotn.etht-svc-name`' />-->\n<parameter name='model-customization-id' value='`$vnf-topology-operation-input.service-information.onap-model-information.model-customization-uuid`' />\n<parameter name='model-invariant-id' value='`$vnf-topology-operation-input.service-information.onap-model-information.model-invariant-uuid`' />\n<parameter name='model-version-id' value='`$vnf-topology-operation-input.service-information.onap-model-information.model-uuid`' />\n<parameter name='connectivity-selflink' value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'  + $network-topology-operation-input.service-information.service-instance-id  + '/service-data/networks/network/'  + $prop.sotn.network-id  + '/network-data/'` \" />\n",
        "comments": "",
        "outputs": 1,
        "x": 1892.2333374023438,
        "y": 3686.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            []
        ]
    },
    {
        "id": "e74eb1dd.b1cce",
        "type": "save",
        "name": "save middle-man-conn relationship to connectivity-otnidx, in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='connectivity:relationship-list' \n      key='connectivity.connectivity-id = $middle-man-conn.connectivity-id' \n      force=\"true\" pfx=\"tmp.AnAI-data\">\n<parameter name=\"relationship-list.relationship[0].related-to\" value=\"connectivity\" />\n<parameter name=\"relationship-list.relationship[0].related-link\" value=\"`'/network/connectivities/connectivity/' + $uuid.connectivity-otnidx-uuid`\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"connectivity.connectivity-id\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$uuid.connectivity-otnidx-uuid`\" />",
        "comments": "",
        "outputs": 1,
        "x": 1993.2333374023438,
        "y": 3731.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            []
        ]
    },
    {
        "id": "d069cfb2.559918",
        "type": "save",
        "name": "save TNNSSI (transport service instance) relationship to connectivity in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='service-instance:relationship-list' \n      key='service-instance.service-instance-id = $vnf-topology-operation-input.service-information.service-instance-id\n         AND customer.global-customer-id = $vnf-topology-operation-input.service-information.global-customer-id \n         AND service-subscription.service-type = $vnf-topology-operation-input.service-information.subscription-service-type' \n      force=\"true\" pfx=\"tmp.AnAI-data\">\n<parameter name=\"relationship-list.relationship[0].related-to\" value=\"connectivity\" />\n<parameter name=\"relationship-list.relationship[0].related-link\" value=\"`'/network/connectivities/connectivity/' + $uuid.connectivity-otnidx-uuid`\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"connectivity.connectivity-id\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$uuid.connectivity-otnidx-uuid`\" />\n\n\n<!--<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='service-instance:relationship-list' -->\n<!--      key='service-instance.service-instance-id = $service-data.service-information.service-instance-id -->\n<!--         AND customer.global-customer-id = $service-data.networks.network[$nidx].network-data.service-information.global-customer-id -->\n<!--         AND service-subscription.service-type = $service-data.networks.network[$nidx].network-data.service-information.subscription-service-type' -->\n<!--      force=\"true\" pfx=\"tmp.AnAI-data\">-->\n<!--<parameter name=\"relationship-list.relationship[0].related-to\" value=\"connectivity\" />-->\n<!--<parameter name=\"relationship-list.relationship[0].related-link\" value=\"`'/network/connectivities/connectivity/' + $prop.sotn.network-id`\" />-->\n<!--<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"connectivity.connectivity-id\" />-->\n<!--<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$prop.sotn.network-id`\" />-->",
        "comments": "",
        "outputs": 1,
        "x": 2029.2333374023438,
        "y": 3785.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            []
        ]
    },
    {
        "id": "db7724b7.c0b95",
        "type": "save",
        "name": "save connectivity-otnidx relationship to vpn-binding-otnidx, in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding:relationship-list' \n      key='vpn-binding.vpn-id = $prop.vpn-binding-otnidx-uuid' \n      force=\"true\" pfx=\"tmp.AnAI-data\">\n<parameter name=\"relationship-list.relationship[0].related-to\" value=\"connectivity\" />\n<parameter name=\"relationship-list.relationship[0].related-link\" value=\"`'/network/connectivities/connectivity/' + $uuid.connectivity-otnidx-uuid`\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"connectivity.connectivity-id\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$uuid.connectivity-otnidx-uuid`\" />",
        "comments": "",
        "outputs": 1,
        "x": 1997.2333374023438,
        "y": 3844.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            []
        ]
    },
    {
        "id": "dccc268f.14582",
        "type": "comment",
        "name": "find middle-man's eth-srv-name",
        "info": "",
        "comments": "",
        "x": 1455.2333374023438,
        "y": 3460.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "6dfdf88f.4bb6c",
        "type": "set",
        "name": "set prop.ethernet-service-name",
        "xml": "<set>\n<parameter name='prop.ethernet-service-name' value='`$middle-man-conn.etht-svc-name`' />\n\n",
        "comments": "",
        "x": 1477.2333374023438,
        "y": 3504.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "e9be22f5.c3b77",
        "type": "save",
        "name": "save middle-man-conn relationship to tmp.the-connectivity, in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='connectivity:relationship-list' \n      key='connectivity.connectivity-id = $middle-man-conn.connectivity-id' \n      force=\"true\" pfx=\"tmp.AnAI-data\">\n<parameter name=\"relationship-list.relationship[0].related-to\" value=\"connectivity\" />\n<parameter name=\"relationship-list.relationship[0].related-link\" value=\"`'/network/connectivities/connectivity/' + $tmp.the-connectivity.connectivity-id`\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"connectivity.connectivity-id\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$tmp.the-connectivity.connectivity-id`\" />",
        "comments": "",
        "outputs": 1,
        "x": 2684.2333374023438,
        "y": 4240.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            []
        ]
    },
    {
        "id": "e3ac7685.f8539",
        "type": "save",
        "name": "save TNNSSI (transport service instance) relationship to connectivity in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='service-instance:relationship-list' \n      key='service-instance.service-instance-id = $vnf-topology-operation-input.service-information.service-instance-id\n         AND customer.global-customer-id = $vnf-topology-operation-input.service-information.global-customer-id \n         AND service-subscription.service-type = $vnf-topology-operation-input.service-information.subscription-service-type' \n      force=\"true\" pfx=\"tmp.AnAI-data\">\n<parameter name=\"relationship-list.relationship[0].related-to\" value=\"connectivity\" />\n<parameter name=\"relationship-list.relationship[0].related-link\" value=\"`'/network/connectivities/connectivity/' + $uuid.connectivity-otnidx-uuid`\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"connectivity.connectivity-id\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$uuid.connectivity-otnidx-uuid`\" />\n\n\n<!--<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='service-instance:relationship-list' -->\n<!--      key='service-instance.service-instance-id = $service-data.service-information.service-instance-id -->\n<!--         AND customer.global-customer-id = $service-data.networks.network[$nidx].network-data.service-information.global-customer-id -->\n<!--         AND service-subscription.service-type = $service-data.networks.network[$nidx].network-data.service-information.subscription-service-type' -->\n<!--      force=\"true\" pfx=\"tmp.AnAI-data\">-->\n<!--<parameter name=\"relationship-list.relationship[0].related-to\" value=\"connectivity\" />-->\n<!--<parameter name=\"relationship-list.relationship[0].related-link\" value=\"`'/network/connectivities/connectivity/' + $prop.sotn.network-id`\" />-->\n<!--<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"connectivity.connectivity-id\" />-->\n<!--<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$prop.sotn.network-id`\" />-->",
        "comments": "",
        "outputs": 1,
        "x": 2715.2333374023438,
        "y": 4279.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            []
        ]
    },
    {
        "id": "8511409f.51bd2",
        "type": "save",
        "name": "save tmp.the-connectivity relationship to vpn-binding-otnidx, in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding:relationship-list' \n      key='vpn-binding.vpn-id = $prop.vpn-binding-otnidx-uuid' \n      force=\"true\" pfx=\"tmp.AnAI-data\">\n<parameter name=\"relationship-list.relationship[0].related-to\" value=\"connectivity\" />\n<parameter name=\"relationship-list.relationship[0].related-link\" value=\"`'/network/connectivities/connectivity/' + $tmp.the-connectivity.connectivity-id`\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"connectivity.connectivity-id\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$tmp.the-connectivity.connectivity-id`\" />",
        "comments": "",
        "outputs": 1,
        "x": 2686.2333374023438,
        "y": 4352.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            []
        ]
    },
    {
        "id": "65db0af6.94eaf4",
        "type": "comment",
        "name": "update the founded connectivity to have a new coupling-flag",
        "info": "",
        "comments": "",
        "x": 2656.2333374023438,
        "y": 4068.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "537df036.3150f",
        "type": "set",
        "name": "set newFlag",
        "xml": "<set>\n<parameter name='tmp.newFlag' value=\"`$tmp.the-connectivity.coupling-flag + '-' +\n                                               $tmp.srcTtpdstTtpPair`\" />\n\n\n",
        "comments": "",
        "x": 2542.2333374023438,
        "y": 4107.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "73887d45.2afa44",
        "type": "save",
        "name": "update connectivity resource in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='connectivity' \n      key='connectivity.connectivity-id = $tmp.the-connectivity.connectivity-id'>\n<parameter name='connectivity-id' value='`$tmp.the-connectivity.connectivity-id`' />\n<parameter name='etht-svc-name' value='`$prop.ethernet-service-name`' />\n<parameter name='operational-status' value='Modified' />\n<parameter name='coupling-flag' value='`$tmp.newFlag`' />\n",
        "comments": "",
        "outputs": 1,
        "x": 2606.2333374023438,
        "y": 4152.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            []
        ]
    },
    {
        "id": "442047ec.b76048",
        "type": "comment",
        "name": "the following two relationships should have already been there; if not => error",
        "info": "",
        "comments": "",
        "x": 2698.2333374023438,
        "y": 4202.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "a6868862.e0d7a8",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 1684.2333374023438,
        "y": 3569.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "7d7a6dc.ff5ab14",
                "5fd9a93f.71f3e",
                "e99e1220.c8d158",
                "e74eb1dd.b1cce",
                "d069cfb2.559918",
                "db7724b7.c0b95"
            ]
        ]
    },
    {
        "id": "5bde363c.523c48",
        "type": "outcomeFalse",
        "name": "false",
        "xml": "<outcome value='false'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1546.2333374023438,
        "y": 3565.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "a6868862.e0d7a8"
            ]
        ]
    },
    {
        "id": "c5f8d573.741818",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic='true'>",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 2344.2333374023438,
        "y": 4032.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "566a0421.e07abc",
                "537df036.3150f",
                "73887d45.2afa44",
                "8511409f.51bd2"
            ]
        ]
    },
    {
        "id": "8b5f6b52.3288",
        "type": "comment",
        "name": "loop through the relationships of this founded connectivity, then",
        "info": "then find the vpn-binding that has same src ttp and dst ttp as this one",
        "comments": "",
        "x": 2349.2333374023438,
        "y": 4457.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "1a02430.b289b3d",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for silentFailure='true' index='tcridx' start='0' end='`$tmp.the-connectivity.relationship-list.relationship_length`' >\n\n",
        "comments": "",
        "outputs": 1,
        "x": 2691.2333374023438,
        "y": 4493.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "cd907dba.e4d3c8"
            ]
        ]
    },
    {
        "id": "cd907dba.e4d3c8",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.the-connectivity.relationship-list.relationship[$tcridx].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2903.2333374023438,
        "y": 4491.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "20ed8870.8c9e9"
            ]
        ]
    },
    {
        "id": "20ed8870.8c9e9",
        "type": "outcome",
        "name": "vpn-binding",
        "xml": "<outcome value='vpn-binding'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3087.2333374023438,
        "y": 4489.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "3940766f.dd75d2"
            ]
        ]
    },
    {
        "id": "3940766f.dd75d2",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 3266.2333374023438,
        "y": 4494.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "de8d19cf.e0eb38",
                "501e7414.822a34"
            ]
        ]
    },
    {
        "id": "501e7414.822a34",
        "type": "set",
        "name": "unset tmp.aai.vpn-binding",
        "xml": "<set>\n<parameter name='tmp.aai.vpn-binding.' value='' />\n",
        "comments": "",
        "x": 3483.2333374023438,
        "y": 4425.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "de8d19cf.e0eb38",
        "type": "save",
        "name": "get vpn-binding from aai",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"vpn-binding\"\n\t    key=\"vpn-binding.vpn-id = $tmp.the-connectivity.relationship-list.relationship[$tcridx].relationship-data[0].relationship-value\"\n\t\tlocal-only=\"false\" \n\t\tpfx=\"tmp.aai.vpn-binding\" >\n",
        "comments": "",
        "outputs": 1,
        "x": 3476.2333374023438,
        "y": 4511.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "fabce7f.821b298",
                "84c19fc0.ef7ad8",
                "d8007fa7.e96748"
            ]
        ]
    },
    {
        "id": "84c19fc0.ef7ad8",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3689.7243041992188,
        "y": 4496.040603637695,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "ab7f4c85.a03338"
            ]
        ]
    },
    {
        "id": "ab7f4c85.a03338",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.l3vpn.pe1_id`\" />\n\n",
        "comments": "",
        "x": 3852.2958374023438,
        "y": 4495.326309204102,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "c7bb2a00.8d6e3",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
        "comments": "",
        "x": 3853.2333374023438,
        "y": 4540.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "d8007fa7.e96748",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3685.2333374023438,
        "y": 4540.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "c7bb2a00.8d6e3"
            ]
        ]
    },
    {
        "id": "fabce7f.821b298",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3687.2333374023438,
        "y": 4600.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "44bdcb57.5d1c04"
            ]
        ]
    },
    {
        "id": "44bdcb57.5d1c04",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 3856.2333374023438,
        "y": 4599.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "ab8a9481.ed1188"
            ]
        ]
    },
    {
        "id": "745b8702.06258",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 2480.2333374023438,
        "y": 4491.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "1a02430.b289b3d",
                "b7b42ab.e3d1558",
                "e37b8cbd.aee6b8"
            ]
        ]
    },
    {
        "id": "ab8a9481.ed1188",
        "type": "switchNode",
        "name": "switch srcTtp",
        "xml": "<switch test='`$tmp.aai.vpn-binding.src-access-ltp-id == $tmp.otninfoProtect[$otnidx].srcPort.src-tunnel-tp-id`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4055.2333374023438,
        "y": 4600.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "b7cd5564.ed6c"
            ]
        ]
    },
    {
        "id": "b7cd5564.ed6c",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4218.233337402344,
        "y": 4598.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "ccabadec.a87d08"
            ]
        ]
    },
    {
        "id": "ccabadec.a87d08",
        "type": "switchNode",
        "name": "switch dstTtp",
        "xml": "<switch test='`$tmp.aai.vpn-binding.dst-access-ltp-id == $tmp.otninfoProtect[$otnidx].dstPort.dst-tunnel-tp-id`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4399.233337402344,
        "y": 4598.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "61252d2.f400154"
            ]
        ]
    },
    {
        "id": "61252d2.f400154",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4562.233337402344,
        "y": 4596.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "c33d2a30.0a34e8"
            ]
        ]
    },
    {
        "id": "73039273.69e874",
        "type": "set",
        "name": "set tmp.the-vpn-binding",
        "xml": "<set>\n<parameter name='tmp.the-vpn-binding.' value='`$tmp.aai.vpn-binding.`' />\n",
        "comments": "",
        "x": 4919.233337402344,
        "y": 4603.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "c33d2a30.0a34e8",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 4701.233337402344,
        "y": 4595.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "73039273.69e874",
                "9503d547.7a1c98"
            ]
        ]
    },
    {
        "id": "9503d547.7a1c98",
        "type": "break",
        "name": "break",
        "xml": "<break>\n",
        "comments": "",
        "x": 4865.233337402344,
        "y": 4647.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "b7b42ab.e3d1558",
        "type": "set",
        "name": "unset tmp.the-vpn-binding",
        "xml": "<set>\n<parameter name='tmp.the-vpn-binding.' value='' />\n",
        "comments": "",
        "x": 2701.2333374023438,
        "y": 4454.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "d737e9cc.f602b8",
        "type": "comment",
        "name": "increase the bw of the-vpn-binding and change status to modified",
        "info": "increase the bw of the-vpn-binding\nchange status to modified\n",
        "comments": "",
        "x": 2790.2333374023438,
        "y": 4628.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "e37b8cbd.aee6b8",
        "type": "save",
        "name": "update vpn-binding otnIdx resource (aka. OTN) in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding' \n      key='vpn-binding.vpn-id = $tmp.the-vpn-binding.vpn-id' >\n<parameter name='vpn-id' value='`$tmp.the-vpn-binding.vpn-id`' />\n<!--<parameter name='vpn-name' value='`$prop.otn-tunnel-name`' />-->\n<!--<parameter name='customer-vpn-id' value='`($maxtpn + $gfp)`' />-->\n<parameter name='customer-vpn-id' value='`($tmp.the-vpn-binding.customer-vpn-id + $gfp)`' />\n\n<parameter name='route-distinguisher' value='`$gfp`' />\n<parameter name='operational-status' value='Modified' />\n\n\n",
        "comments": "",
        "outputs": 1,
        "x": 2760.2333374023438,
        "y": 4688.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            []
        ]
    },
    {
        "id": "252a570f.f396c8",
        "type": "execute",
        "name": "execute UUID generator for vpn-binding $otnidx",
        "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='generateUUID' >\n<parameter name=\"ctx-destination\" value=\"prop.vpn-binding-otnidx-uuid\"/>\n",
        "comments": "",
        "outputs": 1,
        "x": 1595.2333374023438,
        "y": 2856.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            []
        ]
    },
    {
        "id": "a19e39b9.f8da1",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1675.2333374023438,
        "y": 2907.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "f653960c.909178"
            ]
        ]
    },
    {
        "id": "f653960c.909178",
        "type": "set",
        "name": "set access-provider-id and client-id",
        "xml": "<set>\n<parameter name='tmp.access-provider-id' value='`$tmp.otninfoProtect[$otnidx].srcPort.src-access-provider-id`' />\n<parameter name='tmp.access-client-id' value='`$tmp.otninfoProtect[$otnidx].srcPort.src-access-client-id`' />\n<parameter name='tmp.access-topology-id' value='`$tmp.otninfoProtect[$otnidx].srcPort.src-access-topology-id`' />\n<parameter name='tmp.srcdstpnf-id' value='`$tmp.otninfoProtect[$otnidx].srcPort.src-access-node-id`' />\n",
        "comments": "",
        "x": 1889.2333374023438,
        "y": 2906.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "8f4a3300.fba8d8",
        "type": "set",
        "name": "unset parameters",
        "xml": "<set>\n<parameter name='tmp.srcdstpnf-name' value='' />\n<parameter name='prop.vpn-binding-otnidx-uuid' value='' />\n<parameter name='tmp.access-provider-id' value='' />\n<parameter name='tmp.access-client-id' value='' />\n<parameter name='tmp.access-topology-id' value='' />\n<parameter name='tmp.srcdstpnf-id' value='' />\n<parameter name='tmp.aai.srcdst-pnf.' value='' />\n<parameter name='tmp.domainG.esr-thirdparty-id' value='' />\n<parameter name='tmp.aai.domainG.esr-thirdparty-sdnc.' value='' />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainG.url' value='' />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainG.user' value='' />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainG.password' value='' />\n<parameter name='tmp.srcTtpdstTtpPair' value='' />\n\n\n",
        "comments": "",
        "x": 1255.1332397460938,
        "y": 2491.466567993164,
        "z": "ba0dc87e.a3b258",
        "wires": []
    },
    {
        "id": "929a93b0.fb26e",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic='true'>",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 1029.7666625976562,
        "y": 2507.699966430664,
        "z": "ba0dc87e.a3b258",
        "wires": [
            [
                "8f4a3300.fba8d8",
                "1365d05a.43ccb8"
            ]
        ]
    }
]