[
    {
        "id": "2b7da8b.17ed9d8",
        "type": "dgstart",
        "name": "DGSTART",
        "outputs": 1,
        "x": 248,
        "y": 45,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "970691bb.ddc15"
            ]
        ]
    },
    {
        "id": "970691bb.ddc15",
        "type": "service-logic",
        "name": "GENERIC-RESOURCE-API ${project.version}",
        "module": "GENERIC-RESOURCE-API",
        "version": "${project.version}",
        "comments": "",
        "xml": "<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>",
        "outputs": 1,
        "x": 532.2856903076172,
        "y": 106.23810863494873,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "60aef583.9235ac"
            ]
        ]
    },
    {
        "id": "60aef583.9235ac",
        "type": "method",
        "name": "method cll-vnf-topology-operation-cll-F1",
        "xml": "<method rpc='cll-vnf-topology-operation-cll-F1' mode='sync'>\n",
        "comments": "",
        "outputs": 1,
        "x": 448.4285888671875,
        "y": 184.00003051757812,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "aea204d6.6a791"
            ]
        ]
    },
    {
        "id": "aea204d6.6a791",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 182.238037109375,
        "y": 687.6666870117188,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "8d663f65.8f74e8",
                "8c3bad0a.2ae1e",
                "7334fea3.c843f",
                "322c901e.38e458",
                "363053e.3c7802c",
                "6a3e2f90.eef6e",
                "65e8fb60.0959f4",
                "af2be5de.84caa8"
            ]
        ]
    },
    {
        "id": "8d663f65.8f74e8",
        "type": "set",
        "name": "set query_param",
        "xml": "<set>\n<parameter name='prop.ethsrvType' value='`$network-route-A`' />\n\n",
        "comments": "",
        "x": 455,
        "y": 642,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "8c3bad0a.2ae1e",
        "type": "call",
        "name": "call GENERIC-RESOURCE-API:tsli-vnf-topology-operation-get-otn-tunnel-path-from-oof",
        "xml": "<call module='GENERIC-RESOURCE-API' rpc='tsli-vnf-topology-operation-get-otn-tunnel-path-from-oof' mode='sync' >\n\n",
        "comments": "",
        "outputs": 1,
        "x": 676,
        "y": 710,
        "z": "ab59e982.86c81",
        "wires": [
            []
        ]
    },
    {
        "id": "7334fea3.c843f",
        "type": "execute",
        "name": "execute printContext",
        "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='printContext' >\n    <parameter name=\"filename\" value=\"`$filenamemm`\" />\n",
        "comments": "",
        "outputs": 1,
        "x": 466,
        "y": 756,
        "z": "ab59e982.86c81",
        "wires": [
            []
        ]
    },
    {
        "id": "6a3e2f90.eef6e",
        "type": "call",
        "name": "call GENERIC-RESOURCE-API:cll-vnf-topology-operation-find-maximum-used-tpn",
        "xml": "<call module='GENERIC-RESOURCE-API' rpc='cll-vnf-topology-operation-find-maximum-used-tpn' mode='sync' >\n\n",
        "comments": "",
        "outputs": 1,
        "x": 659,
        "y": 820,
        "z": "ab59e982.86c81",
        "wires": [
            []
        ]
    },
    {
        "id": "65e8fb60.0959f4",
        "type": "for",
        "name": "for vidx..tmp.otninfo_length[]",
        "xml": "<for index='otnidx' start='0' end='`$tmp.otninfo_length`' >",
        "comments": "",
        "outputs": 1,
        "x": 751,
        "y": 1199,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "c2ebc420.8ee88"
            ]
        ]
    },
    {
        "id": "c2ebc420.8ee88",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic='true'>",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 972.9999694824219,
        "y": 1211,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "2cc97555.3fad02",
                "78caef7b.ab95f8",
                "9c05f571.1eb168",
                "eda8e4ad.92ee8",
                "a27c8181.cf517",
                "e500131.d3db37",
                "b4245913.ae7bb",
                "ac5e1496.5bc93",
                "6299b58a.3a41b4",
                "6cd61101.45105"
            ]
        ]
    },
    {
        "id": "2cc97555.3fad02",
        "type": "execute",
        "name": "execute UUID generator for vpn-binding $otnidx",
        "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='generateUUID' >\n<parameter name=\"ctx-destination\" value=\"prop.vpn-binding-otnidx-uuid\"/>\n",
        "comments": "",
        "outputs": 1,
        "x": 1648,
        "y": 790,
        "z": "ab59e982.86c81",
        "wires": [
            []
        ]
    },
    {
        "id": "78caef7b.ab95f8",
        "type": "switchNode",
        "name": "switch dstPort == NULL",
        "xml": "<switch test=\"`$tmp.otninfo[$otnidx].dstPort.dst-access-provider-id == ''`\">\n\n",
        "comments": "",
        "outputs": 1,
        "x": 1362,
        "y": 880,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "b4cf3f6b.7b5288",
                "f7c5eac6.57b338"
            ]
        ]
    },
    {
        "id": "b4cf3f6b.7b5288",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1728,
        "y": 841,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "7ef1427a.0fd4ac"
            ]
        ]
    },
    {
        "id": "f7c5eac6.57b338",
        "type": "outcomeFalse",
        "name": "false",
        "xml": "<outcome value='false'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1729,
        "y": 887,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "26ca350f.1d9a8a"
            ]
        ]
    },
    {
        "id": "7ef1427a.0fd4ac",
        "type": "set",
        "name": "set access-provider-id and client-id",
        "xml": "<set>\n<parameter name='tmp.access-provider-id' value='`$tmp.otninfo[$otnidx].srcPort.src-access-provider-id`' />\n<parameter name='tmp.access-client-id' value='`$tmp.otninfo[$otnidx].srcPort.src-access-client-id`' />\n<parameter name='tmp.access-topology-id' value='`$tmp.otninfo[$otnidx].srcPort.src-access-topology-id`' />\n<parameter name='tmp.srcdstpnf-id' value='`$tmp.otninfo[$otnidx].srcPort.src-access-node-id`' />\n",
        "comments": "",
        "x": 1942,
        "y": 840,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "26ca350f.1d9a8a",
        "type": "set",
        "name": "set access-provider-id and client-id",
        "xml": "<set>\n<parameter name='tmp.access-provider-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-provider-id`' />\n<parameter name='tmp.access-client-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-client-id`' />\n<parameter name='tmp.access-topology-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-topology-id`' />\n<parameter name='tmp.srcdstpnf-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-node-id`' />\n",
        "comments": "",
        "x": 1940,
        "y": 885,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "9c05f571.1eb168",
        "type": "set",
        "name": "set srcdstpnf-name",
        "xml": "<set>\n<parameter name='tmp.srcdstpnf-name' value=\"`'networkId-providerId-' + \n                                             $tmp.access-provider-id + '-clientId-' +\n                                             $tmp.access-client-id + '-topologyId-' + \n                                             $tmp.access-topology-id + '-nodeId-' + \n                                             $tmp.srcdstpnf-id`\" />\n\n",
        "comments": "",
        "x": 1538,
        "y": 954,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "eda8e4ad.92ee8",
        "type": "get-resource",
        "name": "get-resource tmp.srcdstpnf-name",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"pnf\" \n\t\tkey=\"pnf.pnf-name = $tmp.srcdstpnf-name\"\n        pfx='tmp.aai.srcdst-pnf' local-only='false' >\n\n        <!--AND depth = '0'\"-->\n",
        "comments": "",
        "outputs": 1,
        "x": 1582,
        "y": 1002,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "79ecfb4e.255ea4",
                "441f51df.f58208",
                "204f27c3.a07c18"
            ]
        ]
    },
    {
        "id": "79ecfb4e.255ea4",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1794.5,
        "y": 949,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "eac32b1e.ec64f"
            ]
        ]
    },
    {
        "id": "441f51df.f58208",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1806.5,
        "y": 999,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "4a1b3b6f.aa547c"
            ]
        ]
    },
    {
        "id": "204f27c3.a07c18",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1797.5,
        "y": 1054,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "afa61155.e3e4f"
            ]
        ]
    },
    {
        "id": "afa61155.e3e4f",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 1942.5,
        "y": 1053,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "4a1b3b6f.aa547c",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 1953.5,
        "y": 996,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "eac32b1e.ec64f",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 1919.8824462890625,
        "y": 942.6556701660156,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "3c0a3138.bdd26e"
            ]
        ]
    },
    {
        "id": "3c0a3138.bdd26e",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for silentFailure='true' index='spvidx' start='0' end='`$tmp.aai.srcdst-pnf.relationship-list.relationship_length`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 2081,
        "y": 957,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "e187685d.0e36b8"
            ]
        ]
    },
    {
        "id": "e187685d.0e36b8",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.aai.srcdst-pnf.relationship-list.relationship[$spvidx].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2276,
        "y": 957,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "124aeba.98fab14"
            ]
        ]
    },
    {
        "id": "48b536ea.5f9248",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 2656,
        "y": 953,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "c8495fb1.c63f38",
                "9a0b489a.f82b3"
            ]
        ]
    },
    {
        "id": "9a0b489a.f82b3",
        "type": "execute",
        "name": "get esr-thirdparty-sdnc",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"esr-thirdparty-sdnc\" \n\t\tkey=\"esr-thirdparty-sdnc.thirdparty-sdnc-id = $tmp.domainG.esr-thirdparty-id AND \n\t\t     depth = '1'\"\n        pfx='tmp.aai.domainG.esr-thirdparty-sdnc' local-only='false' >",
        "comments": "",
        "outputs": 1,
        "x": 2864,
        "y": 960,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "ff325fba.81a3f",
                "5e11cb23.ea8384",
                "435ef02b.e0a51"
            ]
        ]
    },
    {
        "id": "c8495fb1.c63f38",
        "type": "set",
        "name": "set esr-thirdparty-sdnc domainG id",
        "xml": "<set>\n<parameter name='tmp.domainG.esr-thirdparty-id' value=\"`$tmp.aai.srcdst-pnf.relationship-list.relationship[$spvidx].relationship-data[0].relationship-value`\" />\n",
        "comments": "",
        "x": 2894,
        "y": 908,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "ff325fba.81a3f",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3074,
        "y": 951,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "3437139a.bfdd9c"
            ]
        ]
    },
    {
        "id": "5e11cb23.ea8384",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3066,
        "y": 1006,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "db1340d4.287d2"
            ]
        ]
    },
    {
        "id": "435ef02b.e0a51",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3071,
        "y": 1063,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "c8c2b440.36c658"
            ]
        ]
    },
    {
        "id": "c8c2b440.36c658",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 3223,
        "y": 1064,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "db1340d4.287d2",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 3234,
        "y": 1009,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "3437139a.bfdd9c",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 3218.38232421875,
        "y": 948.6556701660156,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "e7684b.19d5f7b8"
            ]
        ]
    },
    {
        "id": "124aeba.98fab14",
        "type": "outcome",
        "name": "esr-thirdparty-sdnc",
        "xml": "<outcome value='esr-thirdparty-sdnc'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2479,
        "y": 961,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "48b536ea.5f9248"
            ]
        ]
    },
    {
        "id": "e7684b.19d5f7b8",
        "type": "set",
        "name": "set controller domainA data",
        "xml": "<set>\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainG.url' value=\"`$tmp.aai.domainG.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].service-url`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainG.user' value=\"`$tmp.aai.domainG.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].user-name`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainG.password' value=\"`$tmp.aai.domainG.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].password`\" />\n\n\n<!--<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >-->\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/restconf/data/ietf-network:networks'`\" />-->\n<!--<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />-->\n<!--<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />-->\n<!--<parameter name=\"format\" value=\"json\"/>-->\n<!--<parameter name=\"httpMethod\" value=\"get\"/>-->\n<!--<parameter name=\"responsePrefix\" value=\"topology\"/>-->\n<!--<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>-->\n<!--<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>-->\n<!--<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>-->\n<!--<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>-->\n",
        "comments": "",
        "x": 3433,
        "y": 945,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "a27c8181.cf517",
        "type": "switchNode",
        "name": "switch dmnsidx == 0 (domainA)",
        "xml": "<switch test='`$otnidx == 0`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1552,
        "y": 1171,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "55f451b.c21bcb",
                "148790b5.591b8f"
            ]
        ]
    },
    {
        "id": "55f451b.c21bcb",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1753,
        "y": 1169,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "190bbee0.fdc3a1"
            ]
        ]
    },
    {
        "id": "a4ef5898.fcc6d8",
        "type": "set",
        "name": "set pce-src-node",
        "xml": "<set>\n<parameter name='tmp.pce-src-node' value='`$tmp.srcdstpnf-name`' />",
        "comments": "",
        "x": 2034,
        "y": 1119,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "82a35f7.532ff2",
        "type": "switchNode",
        "name": "switch dmnsidx == last (domainB)",
        "xml": "<switch test='`$otnidx == $tmp.otninfo_length - 1`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1970,
        "y": 1220,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "151d6bac.6b36ac",
                "e7ce23ad.f63438"
            ]
        ]
    },
    {
        "id": "151d6bac.6b36ac",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2200,
        "y": 1216,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "1bd30175.73854f"
            ]
        ]
    },
    {
        "id": "148790b5.591b8f",
        "type": "outcomeFalse",
        "name": "false",
        "xml": "<outcome value='false'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1753,
        "y": 1218,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "82a35f7.532ff2"
            ]
        ]
    },
    {
        "id": "e7ce23ad.f63438",
        "type": "outcomeFalse",
        "name": "false",
        "xml": "<outcome value='false'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2201,
        "y": 1262,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "3d6b9433.a347bc"
            ]
        ]
    },
    {
        "id": "3d6b9433.a347bc",
        "type": "set",
        "name": "set attachment_param domain G",
        "xml": "<set>\n<parameter name='tmp.domainG-src-access-node-id' value='`$tmp.otninfo[$otnidx].srcPort.src-access-node-id`' />\n<parameter name='tmp.domainG-dst-access-node-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-node-id`' />",
        "comments": "",
        "x": 2415,
        "y": 1262,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "308a9211.a77236",
        "type": "set",
        "name": "set attachment_param domain A",
        "xml": "<set>\n<parameter name='tmp.domainG-src-access-node-id' value='`$param-prefix-domainA[$param-prefix-domainA_length -3]`' />\n<parameter name='tmp.domainG-dst-access-node-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-node-id`' />",
        "comments": "",
        "x": 2089,
        "y": 1166,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "190bbee0.fdc3a1",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 1877,
        "y": 1160,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "308a9211.a77236"
            ]
        ]
    },
    {
        "id": "1bd30175.73854f",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 2333,
        "y": 1192,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "9e7d0c9c.28922"
            ]
        ]
    },
    {
        "id": "9261980e.04515",
        "type": "set",
        "name": "set pce-src-node",
        "xml": "<set>\n<parameter name='tmp.pce-dst-node' value='`$tmp.srcdstpnf-name`' />",
        "comments": "",
        "x": 2489,
        "y": 1208,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "9e7d0c9c.28922",
        "type": "set",
        "name": "set attachment_param domain B",
        "xml": "<set>\n<parameter name='tmp.domainG-src-access-node-id' value='`$tmp.otninfo[$otnidx].srcPort.src-access-node-id`' />\n<parameter name='tmp.domainG-dst-access-node-id' value='`$param-prefix-domainB[$param-prefix-domainB_length -3]`' />",
        "comments": "",
        "x": 2537,
        "y": 1160,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "363053e.3c7802c",
        "type": "set",
        "name": "unset parameters",
        "xml": "<set>\n<parameter name='domain-A.tunnel-tp-id' value='' />\n<parameter name='domain-A.node-id' value='' />\n<parameter name='domain-A.network-id' value=\"\" />\n<parameter name='domain-A.provider-id' value=\"\" />\n<parameter name='domain-A.client-id' value=\"\" />\n<parameter name='domain-A.te-topo-id' value=\"\" />\n<parameter name='domain-A.network-type' value=\"\" />\n<parameter name='domain-A.ltpId' value=\"\" />\n<parameter name='tmp.domain-A.network-id' value=\"\" />\n<parameter name='tmp.domain-A.ttp-id' value=\"\" />\n<parameter name='network-route-A' value=\"\" />\n<!--<parameter name='domain-A.' value=\"\" />-->\n\n<parameter name='request-id' value='' />\n<parameter name='otn-source-node' value='' />\n<parameter name='otn-dest-node' value='' />\n<parameter name='bw-odu' value=\"\" />\n<parameter name='src-ttp-id' value='' />\n<parameter name='dst-ttp-id' value='' />\n\n<parameter name='domain-B.tunnel-tp-id' value='' />\n<parameter name='domain-B.node-id' value='' />\n<parameter name='domain-B.network-id' value=\"\" />\n<parameter name='domain-B.provider-id' value=\"\" />\n<parameter name='domain-B.client-id' value=\"\" />\n<parameter name='domain-B.te-topo-id' value=\"\" />\n<parameter name='domain-B.network-type' value=\"\" />\n<parameter name='domain-B.ltpId' value=\"\" />\n<parameter name='tmp.domain-B.network-id' value=\"\" />\n<parameter name='tmp.domain-B.ttp-id' value=\"\" />\n<parameter name='network-route-B' value=\"\" />\n<!--<parameter name='domain-B.' value=\"\" />-->\n\n\n\n\n\n",
        "comments": "",
        "x": 423.99993896484375,
        "y": 3813.000244140625,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "322c901e.38e458",
        "type": "set",
        "name": "set srcTtp OTN layer",
        "xml": "<set>\n<!--<parameter name='tmp.srcTtpOtnLayer' value=\"`$tmp.pce-src-node + '-' + -->\n<!--                                             $param-prefix-domainA[$param-prefix-domainA_length -2] + '-' +-->\n<!--                                             $tmp.source.ttp-id`\" />-->\n\n<parameter name='tmp.srcTtpOtnLayer' value=\"`$tmp.pce-src-node`\" />\n\n\n",
        "comments": "",
        "x": 463,
        "y": 898,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "e500131.d3db37",
        "type": "set",
        "name": "set srcTtp+dstTtp pair",
        "xml": "<set>\n<parameter name='tmp.srcTtpdstTtpPair' value=\"`$tmp.otninfo[$otnidx].srcPort.src-tunnel-tp-id + ',' +\n                                               $tmp.otninfo[$otnidx].dstPort.dst-tunnel-tp-id`\" />\n\n\n",
        "comments": "",
        "x": 1528,
        "y": 1251,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "ac5e1496.5bc93",
        "type": "call",
        "name": "call GENERIC-RESOURCE-API:cll-vnf-topology-operation-cll-helper-find-connectivity",
        "xml": "<call module='GENERIC-RESOURCE-API' rpc='cll-vnf-topology-operation-cll-helper-find-connectivity' mode='sync' >\n\n",
        "comments": "",
        "outputs": 1,
        "x": 1719.9999694824219,
        "y": 1349,
        "z": "ab59e982.86c81",
        "wires": [
            []
        ]
    },
    {
        "id": "b4245913.ae7bb",
        "type": "set",
        "name": "set current-provider-id and current-cvlan-id",
        "xml": "<set>\n<parameter name='tmp.current-provider-id' value='`$tmp.access-provider-id`' />\n<parameter name='tmp.current-cvlan-id' value='`$tmp.aai.network-route-A.logical-interface-id`' />\n\n",
        "comments": "",
        "x": 1592,
        "y": 1302,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "6299b58a.3a41b4",
        "type": "switchNode",
        "name": "switch found-connectivity?",
        "xml": "\n<switch test=\"`$found-connectivity`\">\n\n",
        "comments": "",
        "outputs": 1,
        "x": 1401,
        "y": 1503,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "2ae1d3e2.c44d5c",
                "7342444f.5f3ea4"
            ]
        ]
    },
    {
        "id": "2ae1d3e2.c44d5c",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1687,
        "y": 2322,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "27e9b59e.2795c2"
            ]
        ]
    },
    {
        "id": "8ba690d8.c6505",
        "type": "comment",
        "name": "call string.contains to check if the cache has srcTtpdstTtpPair",
        "info": "if it had: then no new otn/vpn-binding is needed\n           ==> find the otn. ==>look into the relationships of this connectivity and find the one that has same srcTtp and dstTtp\n           ==> increase the bw\nif not, create a new vpn-binding, attach this vpn-binding into the founded connectivity, and attach it to the middle-man-conn as well.",
        "comments": "",
        "x": 2113,
        "y": 2267,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "6f1cf403.6bf7dc",
        "type": "comment",
        "name": "create a new connectivity - (for dummy connectivity)",
        "info": "(this should not be for LEAF side or ROOT side, otherwise error)\n\ncreate a new vpn-binding (done here)\ncreate a new connectivity (done below)\nadd srcTtpdstTtpPair into the cache in this connectivity\nattach the vpn-binding into the connectivity relationship\nattach this connectivity into the middle man\nattach this connectivity into the service-instance",
        "comments": "",
        "x": 1979.9999694824219,
        "y": 1465,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "570cc158.1e1d08",
        "type": "save",
        "name": "save vpn-binding otnIdx resource (aka. OTN) in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding' \n      key='vpn-binding.vpn-id = $prop.vpn-binding-otnidx-uuid' >\n<parameter name='vpn-id' value='`$prop.vpn-binding-otnidx-uuid`' />\n<parameter name='vpn-name' value='`$prop.otn-tunnel-name`' />\n<!--<parameter name='customer-vpn-id' value='`($idx + 1) * 10`' />-->\n<!--<parameter name='customer-vpn-id' value='`($maxtpn + $gfp)`' />-->\n<parameter name='customer-vpn-id' value='`$newToBeUsedMaxtpn`' />\n<!--<parameter name='access-provider-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-provider-id`' />-->\n<parameter name='access-provider-id' value='`$tmp.access-provider-id`' />\n<!--<parameter name='access-client-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-client-id`' />-->\n<parameter name='access-client-id' value='`$tmp.access-client-id`' />\n<!--<parameter name='access-topology-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-topology-id`' />-->\n<parameter name='access-topology-id' value='`$tmp.access-topology-id`' />\n<!--<parameter name='src-access-node-id' value='`$tmp.otninfo[$otnidx].srcPort.src-access-node-id`' />-->\n<parameter name='src-access-node-id' value='`$tmp.domainG-src-access-node-id`' />\n<parameter name='src-access-ltp-id' value='`$tmp.otninfo[$otnidx].srcPort.src-tunnel-tp-id`' />\n<!--<parameter name='dst-access-node-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-node-id`' />-->\n<parameter name='dst-access-node-id' value='`$tmp.domainG-dst-access-node-id`' />\n<parameter name='dst-access-ltp-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-tunnel-tp-id`' />\n<parameter name='route-distinguisher' value='`$gfp`' />\n<parameter name='operational-status' value='Created' />\n<parameter name='model-customization-id' value='`$network-topology-operation-input.network-information.onap-model-information.model-customization-uuid`' />\n<parameter name='model-invariant-id' value='`$network-topology-operation-input.network-information.onap-model-information.model-invariant-uuid`' />\n<parameter name='model-version-id' value='`$network-topology-operation-input.network-information.onap-model-information.model-uuid`' />\n\n\n<parameter name='vpn-region' value='`$prop.sdncRestApi.thirdpartySdnc.domainG.url`' />\n<parameter name='vpn-description' value='`$prop.sdncRestApi.thirdpartySdnc.domainG.user`' />\n<parameter name='vpn-platform' value='`$prop.sdncRestApi.thirdpartySdnc.domainG.password`' />\n\n<!-- The following line is in lieu of vpn-binding.slice-id (new attribute in latest AAI) -->\n<!--<parameter name='ops-note' value='`$tmp.aai.service-instance.service-instance-id`' />-->\n<parameter name='slice-id' value='`$tmp.aai.service-instance.service-instance-id`' />\n<parameter name='ops-note' value='`$tmp.srcTtpOtnLayer`' />\n\n",
        "comments": "",
        "outputs": 1,
        "x": 2027,
        "y": 1515,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "e9e323ca.2e498"
            ]
        ]
    },
    {
        "id": "e9e323ca.2e498",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2315,
        "y": 1516,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "f5fef51a.3d04f8"
            ]
        ]
    },
    {
        "id": "f5fef51a.3d04f8",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 2498.5,
        "y": 1514.25390625,
        "z": "ab59e982.86c81",
        "wires": [
            []
        ]
    },
    {
        "id": "12f528da.eadc7f",
        "type": "execute",
        "name": "execute string.contains srcTtpdstTtpPair",
        "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='contains' >\n<parameter name=\"source\" value='`$tmp.the-connectivity.coupling-flag`'/>\n<parameter name=\"target\" value=\"`$tmp.srcTtpdstTtpPair`\"/>\n\n",
        "comments": "",
        "outputs": 1,
        "x": 2101,
        "y": 2319,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "8dd1e788.b5dd4",
                "6a3cb15d.6fc0f8"
            ]
        ]
    },
    {
        "id": "8dd1e788.b5dd4",
        "type": "outcomeFalse",
        "name": "false",
        "xml": "<outcome value='false'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2274,
        "y": 2167,
        "z": "ab59e982.86c81",
        "wires": [
            []
        ]
    },
    {
        "id": "6a3cb15d.6fc0f8",
        "type": "outcomeFalse",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2306,
        "y": 2426,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "7ecab95b.cd5a18"
            ]
        ]
    },
    {
        "id": "82bc647c.2cf778",
        "type": "save",
        "name": "save vpn-binding otnIdx resource (aka. OTN) in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding' \n      key='vpn-binding.vpn-id = $prop.vpn-binding-otnidx-uuid' >\n<parameter name='vpn-id' value='`$prop.vpn-binding-otnidx-uuid`' />\n<parameter name='vpn-name' value='`$prop.otn-tunnel-name`' />\n<!--<parameter name='customer-vpn-id' value='`($idx + 1) * 10`' />-->\n<!--<parameter name='customer-vpn-id' value='`($maxtpn + $gfp)`' />-->\n<parameter name='customer-vpn-id' value='`$newToBeUsedMaxtpn`' />\n<!--<parameter name='access-provider-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-provider-id`' />-->\n<parameter name='access-provider-id' value='`$tmp.access-provider-id`' />\n<!--<parameter name='access-client-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-client-id`' />-->\n<parameter name='access-client-id' value='`$tmp.access-client-id`' />\n<!--<parameter name='access-topology-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-topology-id`' />-->\n<parameter name='access-topology-id' value='`$tmp.access-topology-id`' />\n<!--<parameter name='src-access-node-id' value='`$tmp.otninfo[$otnidx].srcPort.src-access-node-id`' />-->\n<parameter name='src-access-node-id' value='`$tmp.domainG-src-access-node-id`' />\n<parameter name='src-access-ltp-id' value='`$tmp.otninfo[$otnidx].srcPort.src-tunnel-tp-id`' />\n<!--<parameter name='dst-access-node-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-node-id`' />-->\n<parameter name='dst-access-node-id' value='`$tmp.domainG-dst-access-node-id`' />\n<parameter name='dst-access-ltp-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-tunnel-tp-id`' />\n<parameter name='route-distinguisher' value='`$gfp`' />\n<parameter name='operational-status' value='Created' />\n<parameter name='model-customization-id' value='`$network-topology-operation-input.network-information.onap-model-information.model-customization-uuid`' />\n<parameter name='model-invariant-id' value='`$network-topology-operation-input.network-information.onap-model-information.model-invariant-uuid`' />\n<parameter name='model-version-id' value='`$network-topology-operation-input.network-information.onap-model-information.model-uuid`' />\n\n\n<parameter name='vpn-region' value='`$prop.sdncRestApi.thirdpartySdnc.domainG.url`' />\n<parameter name='vpn-description' value='`$prop.sdncRestApi.thirdpartySdnc.domainG.user`' />\n<parameter name='vpn-platform' value='`$prop.sdncRestApi.thirdpartySdnc.domainG.password`' />\n\n<!-- The following line is in lieu of vpn-binding.slice-id (new attribute in latest AAI) -->\n<!--<parameter name='ops-note' value='`$tmp.aai.service-instance.service-instance-id`' />-->\n<parameter name='slice-id' value='`$tmp.aai.service-instance.service-instance-id`' />\n<parameter name='ops-note' value='`$tmp.srcTtpOtnLayer`' />\n\n",
        "comments": "",
        "outputs": 1,
        "x": 2713,
        "y": 1957,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "6754cf0f.d24068"
            ]
        ]
    },
    {
        "id": "6754cf0f.d24068",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3017,
        "y": 1954,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "a854224c.98a058"
            ]
        ]
    },
    {
        "id": "a854224c.98a058",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 3167.5,
        "y": 1961.25390625,
        "z": "ab59e982.86c81",
        "wires": [
            []
        ]
    },
    {
        "id": "87b5ce3b.8ef938",
        "type": "execute",
        "name": "execute UUID generator for connectivity domain otnidx",
        "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='generateUUID' >\n<parameter name=\"ctx-destination\" value=\"uuid.connectivity-otnidx-uuid\"/>\n",
        "comments": "",
        "outputs": 1,
        "x": 2007,
        "y": 1570,
        "z": "ab59e982.86c81",
        "wires": [
            []
        ]
    },
    {
        "id": "6a69c0c.0beb14",
        "type": "save",
        "name": "save connectivity resource in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='connectivity' \n      key='connectivity.connectivity-id = $uuid.connectivity-otnidx-uuid'>\n<parameter name='connectivity-id' value='`$uuid.connectivity-otnidx-uuid`' />\n<!--<parameter name='etht-svc-name' value='`$prop.ethernet-service-name`' />-->\n<parameter name='operational-status' value='Created' />\n<parameter name='access-provider-id' value='`$tmp.access-provider-id`' />\n<!--<parameter name='access-provider-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-provider-id`' />-->\n<!--<parameter name='access-client-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-client-id`' />-->\n<!--<parameter name='access-topology-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-topology-id`' />-->\n<!--<parameter name='access-node-id' value='`$tmp.otninfo[$otnidx].srcPort.src-access-node-id`' />-->\n<!--<parameter name='access-ltp-id' value='``' />-->\n<parameter name='cvlan' value='`$tmp.aai.network-route-A.logical-interface-id`' />\n\n<parameter name='coupling-flag' value='`$srcTtpdstTtpPair`' />\n\n<!--<parameter name='bandwidth-profile-name' value='`$prop.sotn.etht-svc-name`' />-->\n<parameter name='bandwidth-profile-name' value='`$gfp`' />\n<parameter name='vpn-type' value='dummy' />\n<parameter name='cir' value='`$gfp *1000000`' />\n<parameter name='eir' value='`$gfp *1000000`' />\n<!--<parameter name='cbs' value='`$prop.sotn.cbs`' />-->\n<!--<parameter name='ebs' value='`$prop.sotn.ebs`' />-->\n<!--<parameter name='color-aware' value='`$prop.sotn.colorAware`' />-->\n\n<!--<parameter name='etht-svc-name' value='`$prop.sotn.etht-svc-name`' />-->\n<parameter name='model-customization-id' value='`$network-topology-operation-input.network-information.onap-model-information.model-customization-uuid`' />\n<parameter name='model-invariant-id' value='`$network-topology-operation-input.network-information.onap-model-information.model-invariant-uuid`' />\n<parameter name='model-version-id' value='`$network-topology-operation-input.network-information.onap-model-information.model-uuid`' />\n<parameter name='connectivity-selflink' value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'  + $network-topology-operation-input.service-information.service-instance-id  + '/service-data/networks/network/'  + $prop.sotn.network-id  + '/network-data/'` \" />\n",
        "comments": "",
        "outputs": 1,
        "x": 1945,
        "y": 1620,
        "z": "ab59e982.86c81",
        "wires": [
            []
        ]
    },
    {
        "id": "a4e3ab7a.498dc8",
        "type": "save",
        "name": "save middle-man-conn relationship to connectivity-otnidx, in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='connectivity:relationship-list' \n      key='connectivity.connectivity-id = $middle-man-conn.connectivity-id' \n      force=\"true\" pfx=\"tmp.AnAI-data\">\n<parameter name=\"relationship-list.relationship[0].related-to\" value=\"connectivity\" />\n<parameter name=\"relationship-list.relationship[0].related-link\" value=\"`'/network/connectivities/connectivity/' + $uuid.connectivity-otnidx-uuid`\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"connectivity.connectivity-id\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$uuid.connectivity-otnidx-uuid`\" />",
        "comments": "",
        "outputs": 1,
        "x": 2046,
        "y": 1665,
        "z": "ab59e982.86c81",
        "wires": [
            []
        ]
    },
    {
        "id": "909dac00.1cdf4",
        "type": "save",
        "name": "save TNNSSI (transport service instance) relationship to connectivity in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='service-instance:relationship-list' \n      key='service-instance.service-instance-id = $vnf-topology-operation-input.service-information.service-instance-id\n         AND customer.global-customer-id = $vnf-topology-operation-input.service-information.global-customer-id \n         AND service-subscription.service-type = $vnf-topology-operation-input.service-information.subscription-service-type' \n      force=\"true\" pfx=\"tmp.AnAI-data\">\n<parameter name=\"relationship-list.relationship[0].related-to\" value=\"connectivity\" />\n<parameter name=\"relationship-list.relationship[0].related-link\" value=\"`'/network/connectivities/connectivity/' + $uuid.connectivity-otnidx-uuid`\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"connectivity.connectivity-id\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$uuid.connectivity-otnidx-uuid`\" />\n\n\n<!--<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='service-instance:relationship-list' -->\n<!--      key='service-instance.service-instance-id = $service-data.service-information.service-instance-id -->\n<!--         AND customer.global-customer-id = $service-data.networks.network[$nidx].network-data.service-information.global-customer-id -->\n<!--         AND service-subscription.service-type = $service-data.networks.network[$nidx].network-data.service-information.subscription-service-type' -->\n<!--      force=\"true\" pfx=\"tmp.AnAI-data\">-->\n<!--<parameter name=\"relationship-list.relationship[0].related-to\" value=\"connectivity\" />-->\n<!--<parameter name=\"relationship-list.relationship[0].related-link\" value=\"`'/network/connectivities/connectivity/' + $prop.sotn.network-id`\" />-->\n<!--<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"connectivity.connectivity-id\" />-->\n<!--<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$prop.sotn.network-id`\" />-->",
        "comments": "",
        "outputs": 1,
        "x": 2082,
        "y": 1719,
        "z": "ab59e982.86c81",
        "wires": [
            []
        ]
    },
    {
        "id": "30650806.4cf508",
        "type": "save",
        "name": "save connectivity-otnidx relationship to vpn-binding-otnidx, in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding:relationship-list' \n      key='vpn-binding.vpn-id = $prop.vpn-binding-otnidx-uuid' \n      force=\"true\" pfx=\"tmp.AnAI-data\">\n<parameter name=\"relationship-list.relationship[0].related-to\" value=\"connectivity\" />\n<parameter name=\"relationship-list.relationship[0].related-link\" value=\"`'/network/connectivities/connectivity/' + $uuid.connectivity-otnidx-uuid`\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"connectivity.connectivity-id\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$uuid.connectivity-otnidx-uuid`\" />",
        "comments": "",
        "outputs": 1,
        "x": 2050,
        "y": 1778,
        "z": "ab59e982.86c81",
        "wires": [
            []
        ]
    },
    {
        "id": "a06d70ba.206bf",
        "type": "comment",
        "name": "find middle-man's eth-srv-name",
        "info": "",
        "comments": "",
        "x": 1508,
        "y": 1394,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "6cd61101.45105",
        "type": "set",
        "name": "set prop.ethernet-service-name",
        "xml": "<set>\n<parameter name='prop.ethernet-service-name' value='`$middle-man-conn.etht-svc-name`' />\n\n",
        "comments": "",
        "x": 1530,
        "y": 1438,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "78936cec.4008d4",
        "type": "save",
        "name": "save middle-man-conn relationship to tmp.the-connectivity, in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='connectivity:relationship-list' \n      key='connectivity.connectivity-id = $middle-man-conn.connectivity-id' \n      force=\"true\" pfx=\"tmp.AnAI-data\">\n<parameter name=\"relationship-list.relationship[0].related-to\" value=\"connectivity\" />\n<parameter name=\"relationship-list.relationship[0].related-link\" value=\"`'/network/connectivities/connectivity/' + $tmp.the-connectivity.connectivity-id`\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"connectivity.connectivity-id\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$tmp.the-connectivity.connectivity-id`\" />",
        "comments": "",
        "outputs": 1,
        "x": 2737,
        "y": 2174,
        "z": "ab59e982.86c81",
        "wires": [
            []
        ]
    },
    {
        "id": "8c815ed6.372fa",
        "type": "save",
        "name": "save TNNSSI (transport service instance) relationship to connectivity in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='service-instance:relationship-list' \n      key='service-instance.service-instance-id = $vnf-topology-operation-input.service-information.service-instance-id\n         AND customer.global-customer-id = $vnf-topology-operation-input.service-information.global-customer-id \n         AND service-subscription.service-type = $vnf-topology-operation-input.service-information.subscription-service-type' \n      force=\"true\" pfx=\"tmp.AnAI-data\">\n<parameter name=\"relationship-list.relationship[0].related-to\" value=\"connectivity\" />\n<parameter name=\"relationship-list.relationship[0].related-link\" value=\"`'/network/connectivities/connectivity/' + $uuid.connectivity-otnidx-uuid`\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"connectivity.connectivity-id\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$uuid.connectivity-otnidx-uuid`\" />\n\n\n<!--<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='service-instance:relationship-list' -->\n<!--      key='service-instance.service-instance-id = $service-data.service-information.service-instance-id -->\n<!--         AND customer.global-customer-id = $service-data.networks.network[$nidx].network-data.service-information.global-customer-id -->\n<!--         AND service-subscription.service-type = $service-data.networks.network[$nidx].network-data.service-information.subscription-service-type' -->\n<!--      force=\"true\" pfx=\"tmp.AnAI-data\">-->\n<!--<parameter name=\"relationship-list.relationship[0].related-to\" value=\"connectivity\" />-->\n<!--<parameter name=\"relationship-list.relationship[0].related-link\" value=\"`'/network/connectivities/connectivity/' + $prop.sotn.network-id`\" />-->\n<!--<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"connectivity.connectivity-id\" />-->\n<!--<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$prop.sotn.network-id`\" />-->",
        "comments": "",
        "outputs": 1,
        "x": 2768,
        "y": 2213,
        "z": "ab59e982.86c81",
        "wires": [
            []
        ]
    },
    {
        "id": "add6fed7.67e35",
        "type": "save",
        "name": "save tmp.the-connectivity relationship to vpn-binding-otnidx, in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding:relationship-list' \n      key='vpn-binding.vpn-id = $prop.vpn-binding-otnidx-uuid' \n      force=\"true\" pfx=\"tmp.AnAI-data\">\n<parameter name=\"relationship-list.relationship[0].related-to\" value=\"connectivity\" />\n<parameter name=\"relationship-list.relationship[0].related-link\" value=\"`'/network/connectivities/connectivity/' + $tmp.the-connectivity.connectivity-id`\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"connectivity.connectivity-id\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$tmp.the-connectivity.connectivity-id`\" />",
        "comments": "",
        "outputs": 1,
        "x": 2739,
        "y": 2286,
        "z": "ab59e982.86c81",
        "wires": [
            []
        ]
    },
    {
        "id": "8ad8acf7.e8e67",
        "type": "comment",
        "name": "update the founded connectivity to have a new coupling-flag",
        "info": "",
        "comments": "",
        "x": 2709,
        "y": 2002,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "8ca2b693.c50608",
        "type": "set",
        "name": "set newFlag",
        "xml": "<set>\n<parameter name='tmp.newFlag' value=\"`$tmp.the-connectivity.coupling-flag + '-' +\n                                               $tmp.srcTtpdstTtpPair`\" />\n\n\n",
        "comments": "",
        "x": 2595,
        "y": 2041,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "9f51b095.94fd08",
        "type": "save",
        "name": "update connectivity resource in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='connectivity' \n      key='connectivity.connectivity-id = $tmp.the-connectivity.connectivity-id'>\n<parameter name='connectivity-id' value='`$tmp.the-connectivity.connectivity-id`' />\n<parameter name='etht-svc-name' value='`$prop.ethernet-service-name`' />\n<parameter name='operational-status' value='Modified' />\n<parameter name='coupling-flag' value='`$tmp.newFlag`' />\n",
        "comments": "",
        "outputs": 1,
        "x": 2659,
        "y": 2086,
        "z": "ab59e982.86c81",
        "wires": [
            []
        ]
    },
    {
        "id": "58d04196.f5778",
        "type": "comment",
        "name": "the following two relationships should have already been there; if not => error",
        "info": "",
        "comments": "",
        "x": 2751,
        "y": 2136,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "832e8c75.f85478",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 1737,
        "y": 1503,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "570cc158.1e1d08",
                "87b5ce3b.8ef938",
                "6a69c0c.0beb14",
                "a4e3ab7a.498dc8",
                "909dac00.1cdf4",
                "30650806.4cf508"
            ]
        ]
    },
    {
        "id": "7342444f.5f3ea4",
        "type": "outcomeFalse",
        "name": "false",
        "xml": "<outcome value='false'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1599,
        "y": 1499,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "832e8c75.f85478"
            ]
        ]
    },
    {
        "id": "27e9b59e.2795c2",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic='true'>",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 2397,
        "y": 1966,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "82bc647c.2cf778",
                "8ca2b693.c50608",
                "9f51b095.94fd08",
                "add6fed7.67e35"
            ]
        ]
    },
    {
        "id": "ddcfbda0.672cc",
        "type": "comment",
        "name": "loop through the relationships of this founded connectivity, then",
        "info": "then find the vpn-binding that has same src ttp and dst ttp as this one",
        "comments": "",
        "x": 2402,
        "y": 2391,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "86c04fbf.f3fdf8",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for silentFailure='true' index='tcridx' start='0' end='`$tmp.the-connectivity.relationship-list.relationship_length`' >\n\n",
        "comments": "",
        "outputs": 1,
        "x": 2744,
        "y": 2427,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "d9d55075.06cb88"
            ]
        ]
    },
    {
        "id": "d9d55075.06cb88",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.the-connectivity.relationship-list.relationship[$tcridx].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2956,
        "y": 2425,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "b5809f3c.79c17"
            ]
        ]
    },
    {
        "id": "b5809f3c.79c17",
        "type": "outcome",
        "name": "vpn-binding",
        "xml": "<outcome value='vpn-binding'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3140,
        "y": 2423,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "17f341d4.56b9ee"
            ]
        ]
    },
    {
        "id": "17f341d4.56b9ee",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 3319,
        "y": 2428,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "77bff99b.403968",
                "813820e1.d9db2"
            ]
        ]
    },
    {
        "id": "813820e1.d9db2",
        "type": "set",
        "name": "unset tmp.aai.vpn-binding",
        "xml": "<set>\n<parameter name='tmp.aai.vpn-binding.' value='' />\n",
        "comments": "",
        "x": 3536,
        "y": 2359,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "77bff99b.403968",
        "type": "save",
        "name": "get vpn-binding from aai",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"vpn-binding\"\n\t    key=\"vpn-binding.vpn-id = $tmp.the-connectivity.relationship-list.relationship[$tcridx].relationship-data[0].relationship-value\"\n\t\tlocal-only=\"false\" \n\t\tpfx=\"tmp.aai.vpn-binding\" >\n",
        "comments": "",
        "outputs": 1,
        "x": 3529,
        "y": 2445,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "574e7a35.7acb64",
                "72ff429d.0f84dc",
                "d88724e6.b16bd8"
            ]
        ]
    },
    {
        "id": "72ff429d.0f84dc",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3742.490966796875,
        "y": 2429.5740356445312,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "47df6bef.c00ec4"
            ]
        ]
    },
    {
        "id": "47df6bef.c00ec4",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.l3vpn.pe1_id`\" />\n\n",
        "comments": "",
        "x": 3905.0625,
        "y": 2428.8597412109375,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "25a6a90d.740966",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
        "comments": "",
        "x": 3906,
        "y": 2474,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "d88724e6.b16bd8",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3738,
        "y": 2474,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "25a6a90d.740966"
            ]
        ]
    },
    {
        "id": "574e7a35.7acb64",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3740,
        "y": 2534,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "fafaf735.33502"
            ]
        ]
    },
    {
        "id": "fafaf735.33502",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 3909,
        "y": 2533,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "dbd3b6f8.ffc688"
            ]
        ]
    },
    {
        "id": "7ecab95b.cd5a18",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 2533,
        "y": 2425,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "86c04fbf.f3fdf8",
                "3d93e24d.201056",
                "18210d7a.52f32b"
            ]
        ]
    },
    {
        "id": "dbd3b6f8.ffc688",
        "type": "switchNode",
        "name": "switch srcTtp",
        "xml": "<switch test='`$tmp.aai.vpn-binding.src-access-ltp-id == $tmp.otninfo[$otnidx].srcPort.src-tunnel-tp-id`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4108,
        "y": 2534,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "f13865e2.850a98"
            ]
        ]
    },
    {
        "id": "f13865e2.850a98",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4271,
        "y": 2532,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "9cbb1279.26e6c"
            ]
        ]
    },
    {
        "id": "9cbb1279.26e6c",
        "type": "switchNode",
        "name": "switch dstTtp",
        "xml": "<switch test='`$tmp.aai.vpn-binding.dst-access-ltp-id == $tmp.otninfo[$otnidx].dstPort.dst-tunnel-tp-id`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4452,
        "y": 2532,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "9f041833.a96178"
            ]
        ]
    },
    {
        "id": "9f041833.a96178",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4615,
        "y": 2530,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "7a99f43e.47072c"
            ]
        ]
    },
    {
        "id": "3d307538.ff5302",
        "type": "set",
        "name": "set tmp.the-vpn-binding",
        "xml": "<set>\n<parameter name='tmp.the-vpn-binding.' value='`$tmp.aai.vpn-binding.`' />\n",
        "comments": "",
        "x": 4972,
        "y": 2537,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "7a99f43e.47072c",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 4754,
        "y": 2529,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "3d307538.ff5302",
                "9c163e19.5e2778"
            ]
        ]
    },
    {
        "id": "9c163e19.5e2778",
        "type": "break",
        "name": "break",
        "xml": "<break>\n",
        "comments": "",
        "x": 4918,
        "y": 2581,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "3d93e24d.201056",
        "type": "set",
        "name": "unset tmp.the-vpn-binding",
        "xml": "<set>\n<parameter name='tmp.the-vpn-binding.' value='' />\n",
        "comments": "",
        "x": 2754,
        "y": 2388,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "ad919177.04496",
        "type": "comment",
        "name": "increase the bw of the-vpn-binding and change status to modified",
        "info": "increase the bw of the-vpn-binding\nchange status to modified\n",
        "comments": "",
        "x": 2843,
        "y": 2562,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "18210d7a.52f32b",
        "type": "save",
        "name": "update vpn-binding otnIdx resource (aka. OTN) in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding' \n      key='vpn-binding.vpn-id = $tmp.the-vpn-binding.vpn-id' >\n<parameter name='vpn-id' value='`$tmp.the-vpn-binding.vpn-id`' />\n<!--<parameter name='vpn-name' value='`$prop.otn-tunnel-name`' />-->\n<!--<parameter name='customer-vpn-id' value='`($maxtpn + $gfp)`' />-->\n<parameter name='customer-vpn-id' value='`($tmp.the-vpn-binding.customer-vpn-id + $gfp)`' />\n\n<parameter name='route-distinguisher' value='`$gfp`' />\n<parameter name='operational-status' value='Modified' />\n\n\n",
        "comments": "",
        "outputs": 1,
        "x": 2813,
        "y": 2622,
        "z": "ab59e982.86c81",
        "wires": [
            []
        ]
    },
    {
        "id": "af2be5de.84caa8",
        "type": "switchNode",
        "name": "switch otninfoProtect exists",
        "xml": "<switch test=\"`$tmp.otninfoProtect_length > 0`\">\n\n",
        "comments": "",
        "outputs": 1,
        "x": 579.1166381835938,
        "y": 2488,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "bdb88dff.a2cfc8"
            ]
        ]
    },
    {
        "id": "bdb88dff.a2cfc8",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 800.1166381835938,
        "y": 2489,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "62f58207.69b144"
            ]
        ]
    },
    {
        "id": "4da32200.1a505",
        "type": "for",
        "name": "for vidx..tmp.otninfoProtect_length[]",
        "xml": "<for index='otnidx' start='0' end='`$tmp.otninfoProtect_length`' >",
        "comments": "",
        "outputs": 1,
        "x": 615.6666870117188,
        "y": 3269.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "78d123a7.ebdd04"
            ]
        ]
    },
    {
        "id": "78d123a7.ebdd04",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic='true'>",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 875.6666564941406,
        "y": 3262.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "655b0cf9.434f14",
                "2cbd342f.008e4c",
                "af443653.16e2a",
                "b4328c41.7c5e68",
                "54752c5a.7588d4",
                "88c79ac5.392298",
                "f442f477.1b9ac",
                "1b1a37df.8ffb38",
                "40d5cce.138f1b4",
                "17ca39fd.1576de"
            ]
        ]
    },
    {
        "id": "2cbd342f.008e4c",
        "type": "switchNode",
        "name": "switch dstPort == NULL",
        "xml": "<switch test=\"`$tmp.otninfoProtect[$otnidx].dstPort.dst-access-provider-id == ''`\">\n\n",
        "comments": "",
        "outputs": 1,
        "x": 1264.6666870117188,
        "y": 2931.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "390f0f63.f5713",
                "a481fb54.252848"
            ]
        ]
    },
    {
        "id": "a481fb54.252848",
        "type": "outcomeFalse",
        "name": "false",
        "xml": "<outcome value='false'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1631.6666870117188,
        "y": 2938.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "accd9965.551cc"
            ]
        ]
    },
    {
        "id": "accd9965.551cc",
        "type": "set",
        "name": "set access-provider-id and client-id",
        "xml": "<set>\n<parameter name='tmp.access-provider-id' value='`$tmp.otninfoProtect[$otnidx].dstPort.dst-access-provider-id`' />\n<parameter name='tmp.access-client-id' value='`$tmp.otninfoProtect[$otnidx].dstPort.dst-access-client-id`' />\n<parameter name='tmp.access-topology-id' value='`$tmp.otninfoProtect[$otnidx].dstPort.dst-access-topology-id`' />\n<parameter name='tmp.srcdstpnf-id' value='`$tmp.otninfoProtect[$otnidx].dstPort.dst-access-node-id`' />\n",
        "comments": "",
        "x": 1842.6666870117188,
        "y": 2936.89990234375,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "af443653.16e2a",
        "type": "set",
        "name": "set srcdstpnf-name",
        "xml": "<set>\n<parameter name='tmp.srcdstpnf-name' value=\"`'networkId-providerId-' + \n                                             $tmp.access-provider-id + '-clientId-' +\n                                             $tmp.access-client-id + '-topologyId-' + \n                                             $tmp.access-topology-id + '-nodeId-' + \n                                             $tmp.srcdstpnf-id`\" />\n\n",
        "comments": "",
        "x": 1440.6666870117188,
        "y": 3005.89990234375,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "b4328c41.7c5e68",
        "type": "get-resource",
        "name": "get-resource tmp.srcdstpnf-name",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"pnf\" \n\t\tkey=\"pnf.pnf-name = $tmp.srcdstpnf-name\"\n        pfx='tmp.aai.srcdst-pnf' local-only='false' >\n\n        <!--AND depth = '0'\"-->\n",
        "comments": "",
        "outputs": 1,
        "x": 1484.6666870117188,
        "y": 3053.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "2ab1cad2.cc8df6",
                "95061116.66953",
                "d118596c.c8a1b"
            ]
        ]
    },
    {
        "id": "2ab1cad2.cc8df6",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1697.1666870117188,
        "y": 3000.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "9a46b094.250a1"
            ]
        ]
    },
    {
        "id": "95061116.66953",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1709.1666870117188,
        "y": 3050.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "a8bbbf3c.490288"
            ]
        ]
    },
    {
        "id": "d118596c.c8a1b",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1700.1666870117188,
        "y": 3105.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "c4cf4a50.357dd"
            ]
        ]
    },
    {
        "id": "c4cf4a50.357dd",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 1845.1666870117188,
        "y": 3104.89990234375,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "a8bbbf3c.490288",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 1856.1666870117188,
        "y": 3047.89990234375,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "9a46b094.250a1",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 1822.5491333007812,
        "y": 2994.5555725097656,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "8c15c7c0.68b978"
            ]
        ]
    },
    {
        "id": "8c15c7c0.68b978",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for silentFailure='true' index='spvidx' start='0' end='`$tmp.aai.srcdst-pnf.relationship-list.relationship_length`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 1983.6666870117188,
        "y": 3008.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "a8c602fe.1de83"
            ]
        ]
    },
    {
        "id": "a8c602fe.1de83",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.aai.srcdst-pnf.relationship-list.relationship[$spvidx].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2178.6666870117188,
        "y": 3008.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "92605acf.b6eae"
            ]
        ]
    },
    {
        "id": "3d5fc5da.8209c2",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 2558.6666870117188,
        "y": 3004.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "f1e62050.aa9b48",
                "142adcaa.53768b"
            ]
        ]
    },
    {
        "id": "142adcaa.53768b",
        "type": "execute",
        "name": "get esr-thirdparty-sdnc",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"esr-thirdparty-sdnc\" \n\t\tkey=\"esr-thirdparty-sdnc.thirdparty-sdnc-id = $tmp.domainG.esr-thirdparty-id AND \n\t\t     depth = '1'\"\n        pfx='tmp.aai.domainG.esr-thirdparty-sdnc' local-only='false' >",
        "comments": "",
        "outputs": 1,
        "x": 2766.6666870117188,
        "y": 3011.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "b0f57546.a572f8",
                "f4d8ee18.503d6",
                "6cf185fa.032e7c"
            ]
        ]
    },
    {
        "id": "f1e62050.aa9b48",
        "type": "set",
        "name": "set esr-thirdparty-sdnc domainG id",
        "xml": "<set>\n<parameter name='tmp.domainG.esr-thirdparty-id' value=\"`$tmp.aai.srcdst-pnf.relationship-list.relationship[$spvidx].relationship-data[0].relationship-value`\" />\n",
        "comments": "",
        "x": 2796.6666870117188,
        "y": 2959.89990234375,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "b0f57546.a572f8",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2976.6666870117188,
        "y": 3002.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "8af042ca.abce2"
            ]
        ]
    },
    {
        "id": "f4d8ee18.503d6",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2968.6666870117188,
        "y": 3057.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "14e1063f.bcaa12"
            ]
        ]
    },
    {
        "id": "6cf185fa.032e7c",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2973.6666870117188,
        "y": 3114.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "88d269ff.2a4e78"
            ]
        ]
    },
    {
        "id": "88d269ff.2a4e78",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 3125.6666870117188,
        "y": 3115.89990234375,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "14e1063f.bcaa12",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 3136.6666870117188,
        "y": 3060.89990234375,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "8af042ca.abce2",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 3121.0490112304688,
        "y": 3000.5555725097656,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "6ee06c7f.e87634"
            ]
        ]
    },
    {
        "id": "92605acf.b6eae",
        "type": "outcome",
        "name": "esr-thirdparty-sdnc",
        "xml": "<outcome value='esr-thirdparty-sdnc'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2381.6666870117188,
        "y": 3012.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "3d5fc5da.8209c2"
            ]
        ]
    },
    {
        "id": "6ee06c7f.e87634",
        "type": "set",
        "name": "set controller domainA data",
        "xml": "<set>\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainG.url' value=\"`$tmp.aai.domainG.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].service-url`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainG.user' value=\"`$tmp.aai.domainG.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].user-name`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainG.password' value=\"`$tmp.aai.domainG.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].password`\" />\n\n\n<!--<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >-->\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/restconf/data/ietf-network:networks'`\" />-->\n<!--<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />-->\n<!--<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />-->\n<!--<parameter name=\"format\" value=\"json\"/>-->\n<!--<parameter name=\"httpMethod\" value=\"get\"/>-->\n<!--<parameter name=\"responsePrefix\" value=\"topology\"/>-->\n<!--<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>-->\n<!--<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>-->\n<!--<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>-->\n<!--<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>-->\n",
        "comments": "",
        "x": 3335.6666870117188,
        "y": 2996.89990234375,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "54752c5a.7588d4",
        "type": "switchNode",
        "name": "switch dmnsidx == 0 (domainA)",
        "xml": "<switch test='`$otnidx == 0`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1454.6666870117188,
        "y": 3222.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "a23826d9.6cbf8",
                "ca79965c.c43c5"
            ]
        ]
    },
    {
        "id": "a23826d9.6cbf8",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1655.6666870117188,
        "y": 3220.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "1188399c.8e417e"
            ]
        ]
    },
    {
        "id": "5f0d00e5.7b1628",
        "type": "set",
        "name": "set pce-src-node",
        "xml": "<set>\n<parameter name='tmp.pce-src-node' value='`$tmp.srcdstpnf-name`' />",
        "comments": "",
        "x": 1936.6666870117188,
        "y": 3170.89990234375,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "f4e7389.48dcac8",
        "type": "switchNode",
        "name": "switch dmnsidx == last (domainC)",
        "xml": "<switch test='`$otnidx == $tmp.otninfoProtect_length - 1`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1872.6666870117188,
        "y": 3271.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "1eeda518.bbd863",
                "25bb7e68.eed552"
            ]
        ]
    },
    {
        "id": "1eeda518.bbd863",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2102.6666870117188,
        "y": 3267.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "19cc5bd6.d13bb4"
            ]
        ]
    },
    {
        "id": "ca79965c.c43c5",
        "type": "outcomeFalse",
        "name": "false",
        "xml": "<outcome value='false'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1655.6666870117188,
        "y": 3269.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "f4e7389.48dcac8"
            ]
        ]
    },
    {
        "id": "25bb7e68.eed552",
        "type": "outcomeFalse",
        "name": "false",
        "xml": "<outcome value='false'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2103.6666870117188,
        "y": 3313.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "ff457a93.22142"
            ]
        ]
    },
    {
        "id": "ff457a93.22142",
        "type": "set",
        "name": "set attachment_param domain G",
        "xml": "<set>\n<parameter name='tmp.domainG-src-access-node-id' value='`$tmp.otninfoProtect[$otnidx].srcPort.src-access-node-id`' />\n<parameter name='tmp.domainG-dst-access-node-id' value='`$tmp.otninfoProtect[$otnidx].dstPort.dst-access-node-id`' />",
        "comments": "",
        "x": 2317.6666870117188,
        "y": 3313.89990234375,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "a5bfc25b.24a798",
        "type": "set",
        "name": "set attachment_param domain A",
        "xml": "<set>\n<parameter name='tmp.domainG-src-access-node-id' value='`$param-prefix-domainA[$param-prefix-domainA_length -3]`' />\n<parameter name='tmp.domainG-dst-access-node-id' value='`$tmp.otninfoProtect[$otnidx].dstPort.dst-access-node-id`' />",
        "comments": "",
        "x": 1991.6666870117188,
        "y": 3217.89990234375,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "1188399c.8e417e",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 1779.6666870117188,
        "y": 3211.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "a5bfc25b.24a798"
            ]
        ]
    },
    {
        "id": "19cc5bd6.d13bb4",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 2235.6666870117188,
        "y": 3243.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "ecfd7b03.8cb46"
            ]
        ]
    },
    {
        "id": "f9df9d2f.f6b57",
        "type": "set",
        "name": "set pce-src-node",
        "xml": "<set>\n<parameter name='tmp.pce-dst-node' value='`$tmp.srcdstpnf-name`' />",
        "comments": "",
        "x": 2391.6666870117188,
        "y": 3259.89990234375,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "ecfd7b03.8cb46",
        "type": "set",
        "name": "set attachment_param domain C",
        "xml": "<set>\n<parameter name='tmp.domainG-src-access-node-id' value='`$tmp.otninfoProtect[$otnidx].srcPort.src-access-node-id`' />\n<parameter name='tmp.domainG-dst-access-node-id' value='`$param-prefix-domainC[$param-prefix-domainC_length -3]`' />",
        "comments": "",
        "x": 2439.6666870117188,
        "y": 3211.89990234375,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "88c79ac5.392298",
        "type": "set",
        "name": "set srcTtp+dstTtp pair",
        "xml": "<set>\n<parameter name='tmp.srcTtpdstTtpPair' value=\"`$tmp.otninfoProtect[$otnidx].srcPort.src-tunnel-tp-id + ',' +\n                                               $tmp.otninfootninfoProtect.dstPort.dst-tunnel-tp-id`\" />\n\n\n",
        "comments": "",
        "x": 1430.6666870117188,
        "y": 3302.89990234375,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "1b1a37df.8ffb38",
        "type": "call",
        "name": "call GENERIC-RESOURCE-API:cll-vnf-topology-operation-cll-helper-find-connectivity",
        "xml": "<call module='GENERIC-RESOURCE-API' rpc='cll-vnf-topology-operation-cll-helper-find-connectivity' mode='sync' >\n\n",
        "comments": "",
        "outputs": 1,
        "x": 1622.6666564941406,
        "y": 3400.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            []
        ]
    },
    {
        "id": "f442f477.1b9ac",
        "type": "set",
        "name": "set current-provider-id and current-cvlan-id",
        "xml": "<set>\n<parameter name='tmp.current-provider-id' value='`$tmp.access-provider-id`' />\n<parameter name='tmp.current-cvlan-id' value='`$tmp.aai.network-route-A.logical-interface-id`' />\n\n",
        "comments": "",
        "x": 1494.6666870117188,
        "y": 3353.89990234375,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "40d5cce.138f1b4",
        "type": "switchNode",
        "name": "switch found-connectivity?",
        "xml": "\n<switch test=\"`$found-connectivity`\">\n\n",
        "comments": "",
        "outputs": 1,
        "x": 1303.6666870117188,
        "y": 3554.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "e841833f.a5b018",
                "1d9dc789.fabfa"
            ]
        ]
    },
    {
        "id": "e841833f.a5b018",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1589.6666870117188,
        "y": 4373.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "5f9745ba.8cabdc"
            ]
        ]
    },
    {
        "id": "40e5d82c.0988c",
        "type": "comment",
        "name": "call string.contains to check if the cache has srcTtpdstTtpPair",
        "info": "if it had: then no new otn/vpn-binding is needed\n           ==> find the otn. ==>look into the relationships of this connectivity and find the one that has same srcTtp and dstTtp\n           ==> increase the bw\nif not, create a new vpn-binding, attach this vpn-binding into the founded connectivity, and attach it to the middle-man-conn as well.",
        "comments": "",
        "x": 2015.6666870117188,
        "y": 4318.89990234375,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "37b719a7.3177d6",
        "type": "comment",
        "name": "create a new connectivity - (for dummy connectivity)",
        "info": "(this should not be for LEAF side or ROOT side, otherwise error)\n\ncreate a new vpn-binding (done here)\ncreate a new connectivity (done below)\nadd srcTtpdstTtpPair into the cache in this connectivity\nattach the vpn-binding into the connectivity relationship\nattach this connectivity into the middle man\nattach this connectivity into the service-instance",
        "comments": "",
        "x": 1882.6666564941406,
        "y": 3516.89990234375,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "f0f8f4ff.e42fa",
        "type": "save",
        "name": "save vpn-binding otnIdx resource (aka. OTN) in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding' \n      key='vpn-binding.vpn-id = $prop.vpn-binding-otnidx-uuid' >\n<parameter name='vpn-id' value='`$prop.vpn-binding-otnidx-uuid`' />\n<parameter name='vpn-name' value=\"`$prop.otn-tunnel-name + '-protection'`\" />\n<!--<parameter name='customer-vpn-id' value='`($idx + 1) * 10`' />-->\n<!--<parameter name='customer-vpn-id' value='`($maxtpn + $gfp)`' />-->\n<parameter name='customer-vpn-id' value='`$newToBeUsedMaxtpn`' />\n<!--<parameter name='access-provider-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-provider-id`' />-->\n<parameter name='access-provider-id' value='`$tmp.access-provider-id`' />\n<!--<parameter name='access-client-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-client-id`' />-->\n<parameter name='access-client-id' value='`$tmp.access-client-id`' />\n<!--<parameter name='access-topology-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-topology-id`' />-->\n<parameter name='access-topology-id' value='`$tmp.access-topology-id`' />\n<!--<parameter name='src-access-node-id' value='`$tmp.otninfo[$otnidx].srcPort.src-access-node-id`' />-->\n<parameter name='src-access-node-id' value='`$tmp.domainG-src-access-node-id`' />\n<parameter name='src-access-ltp-id' value='`$tmp.otninfoProtect[$otnidx].srcPort.src-tunnel-tp-id`' />\n<!--<parameter name='dst-access-node-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-node-id`' />-->\n<parameter name='dst-access-node-id' value='`$tmp.domainG-dst-access-node-id`' />\n<parameter name='dst-access-ltp-id' value='`$tmp.otninfoProtect[$otnidx].dstPort.dst-tunnel-tp-id`' />\n<parameter name='route-distinguisher' value='`$gfp`' />\n<parameter name='operational-status' value='Created' />\n<parameter name='model-customization-id' value='`$network-topology-operation-input.network-information.onap-model-information.model-customization-uuid`' />\n<parameter name='model-invariant-id' value='`$network-topology-operation-input.network-information.onap-model-information.model-invariant-uuid`' />\n<parameter name='model-version-id' value='`$network-topology-operation-input.network-information.onap-model-information.model-uuid`' />\n\n\n<parameter name='vpn-region' value='`$prop.sdncRestApi.thirdpartySdnc.domainG.url`' />\n<parameter name='vpn-description' value='`$prop.sdncRestApi.thirdpartySdnc.domainG.user`' />\n<parameter name='vpn-platform' value='`$prop.sdncRestApi.thirdpartySdnc.domainG.password`' />\n\n<!-- The following line is in lieu of vpn-binding.slice-id (new attribute in latest AAI) -->\n<!--<parameter name='ops-note' value='`$tmp.aai.service-instance.service-instance-id`' />-->\n<parameter name='slice-id' value='`$tmp.aai.service-instance.service-instance-id`' />\n<parameter name='ops-note' value='`$tmp.srcTtpOtnLayer`' />\n\n",
        "comments": "",
        "outputs": 1,
        "x": 1929.6666870117188,
        "y": 3566.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "37e8875.87c3378"
            ]
        ]
    },
    {
        "id": "37e8875.87c3378",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2217.6666870117188,
        "y": 3567.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "90a3277d.c4bfc"
            ]
        ]
    },
    {
        "id": "90a3277d.c4bfc",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 2401.1666870117188,
        "y": 3566.15380859375,
        "z": "ab59e982.86c81",
        "wires": [
            []
        ]
    },
    {
        "id": "4b046e56.9a1b9",
        "type": "execute",
        "name": "execute string.contains srcTtpdstTtpPair",
        "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='contains' >\n<parameter name=\"source\" value='`$tmp.the-connectivity.coupling-flag`'/>\n<parameter name=\"target\" value=\"`$tmp.srcTtpdstTtpPair`\"/>\n\n",
        "comments": "",
        "outputs": 1,
        "x": 2003.6666870117188,
        "y": 4370.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "779ce37e.93a47c",
                "f1f0cfe.10d413"
            ]
        ]
    },
    {
        "id": "779ce37e.93a47c",
        "type": "outcomeFalse",
        "name": "false",
        "xml": "<outcome value='false'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2176.6666870117188,
        "y": 4218.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            []
        ]
    },
    {
        "id": "f1f0cfe.10d413",
        "type": "outcomeFalse",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2208.6666870117188,
        "y": 4477.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "9f0cdaa9.449a9"
            ]
        ]
    },
    {
        "id": "58dad5a1.4283d4",
        "type": "save",
        "name": "save vpn-binding otnIdx resource (aka. OTN) in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding' \n      key='vpn-binding.vpn-id = $prop.vpn-binding-otnidx-uuid' >\n<parameter name='vpn-id' value='`$prop.vpn-binding-otnidx-uuid`' />\n<parameter name='vpn-name' value=\"`$prop.otn-tunnel-name + '-protection'`\" />\n<!--<parameter name='customer-vpn-id' value='`($idx + 1) * 10`' />-->\n<!--<parameter name='customer-vpn-id' value='`($maxtpn + $gfp)`' />-->\n<parameter name='customer-vpn-id' value='`$newToBeUsedMaxtpn`' />\n<!--<parameter name='access-provider-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-provider-id`' />-->\n<parameter name='access-provider-id' value='`$tmp.access-provider-id`' />\n<!--<parameter name='access-client-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-client-id`' />-->\n<parameter name='access-client-id' value='`$tmp.access-client-id`' />\n<!--<parameter name='access-topology-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-topology-id`' />-->\n<parameter name='access-topology-id' value='`$tmp.access-topology-id`' />\n<!--<parameter name='src-access-node-id' value='`$tmp.otninfo[$otnidx].srcPort.src-access-node-id`' />-->\n<parameter name='src-access-node-id' value='`$tmp.domainG-src-access-node-id`' />\n<parameter name='src-access-ltp-id' value='`$tmp.otninfoProtect[$otnidx].srcPort.src-tunnel-tp-id`' />\n<!--<parameter name='dst-access-node-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-node-id`' />-->\n<parameter name='dst-access-node-id' value='`$tmp.domainG-dst-access-node-id`' />\n<parameter name='dst-access-ltp-id' value='`$tmp.otninfoProtect[$otnidx].dstPort.dst-tunnel-tp-id`' />\n<parameter name='route-distinguisher' value='`$gfp`' />\n<parameter name='operational-status' value='Created' />\n<parameter name='model-customization-id' value='`$network-topology-operation-input.network-information.onap-model-information.model-customization-uuid`' />\n<parameter name='model-invariant-id' value='`$network-topology-operation-input.network-information.onap-model-information.model-invariant-uuid`' />\n<parameter name='model-version-id' value='`$network-topology-operation-input.network-information.onap-model-information.model-uuid`' />\n\n\n<parameter name='vpn-region' value='`$prop.sdncRestApi.thirdpartySdnc.domainG.url`' />\n<parameter name='vpn-description' value='`$prop.sdncRestApi.thirdpartySdnc.domainG.user`' />\n<parameter name='vpn-platform' value='`$prop.sdncRestApi.thirdpartySdnc.domainG.password`' />\n\n<!-- The following line is in lieu of vpn-binding.slice-id (new attribute in latest AAI) -->\n<!--<parameter name='ops-note' value='`$tmp.aai.service-instance.service-instance-id`' />-->\n<parameter name='slice-id' value='`$tmp.aai.service-instance.service-instance-id`' />\n<parameter name='ops-note' value='`$tmp.srcTtpOtnLayer`' />\n\n",
        "comments": "",
        "outputs": 1,
        "x": 2615.6666870117188,
        "y": 4008.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "ca0562a9.f9dfa"
            ]
        ]
    },
    {
        "id": "ca0562a9.f9dfa",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2919.6666870117188,
        "y": 4005.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "21917e0f.61cb02"
            ]
        ]
    },
    {
        "id": "21917e0f.61cb02",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 3070.1666870117188,
        "y": 4013.15380859375,
        "z": "ab59e982.86c81",
        "wires": [
            []
        ]
    },
    {
        "id": "c456d560.e56b4",
        "type": "execute",
        "name": "execute UUID generator for connectivity domain otnidx",
        "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='generateUUID' >\n<parameter name=\"ctx-destination\" value=\"uuid.connectivity-otnidx-uuid\"/>\n",
        "comments": "",
        "outputs": 1,
        "x": 1909.6666870117188,
        "y": 3621.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            []
        ]
    },
    {
        "id": "1c6b3c2b.a8cfe4",
        "type": "save",
        "name": "save connectivity resource in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='connectivity' \n      key='connectivity.connectivity-id = $uuid.connectivity-otnidx-uuid'>\n<parameter name='connectivity-id' value='`$uuid.connectivity-otnidx-uuid`' />\n<!--<parameter name='etht-svc-name' value='`$prop.ethernet-service-name`' />-->\n<parameter name='operational-status' value='Created' />\n<parameter name='access-provider-id' value='`$tmp.access-provider-id`' />\n<!--<parameter name='access-provider-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-provider-id`' />-->\n<!--<parameter name='access-client-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-client-id`' />-->\n<!--<parameter name='access-topology-id' value='`$tmp.otninfo[$otnidx].dstPort.dst-access-topology-id`' />-->\n<!--<parameter name='access-node-id' value='`$tmp.otninfo[$otnidx].srcPort.src-access-node-id`' />-->\n<!--<parameter name='access-ltp-id' value='``' />-->\n<parameter name='cvlan' value='`$tmp.aai.network-route-A.logical-interface-id`' />\n\n<parameter name='coupling-flag' value='`$srcTtpdstTtpPair`' />\n\n<!--<parameter name='bandwidth-profile-name' value='`$prop.sotn.etht-svc-name`' />-->\n<parameter name='bandwidth-profile-name' value='`$gfp`' />\n<parameter name='vpn-type' value='dummy' />\n<parameter name='cir' value='`$gfp *1000000`' />\n<parameter name='eir' value='`$gfp *1000000`' />\n<!--<parameter name='cbs' value='`$prop.sotn.cbs`' />-->\n<!--<parameter name='ebs' value='`$prop.sotn.ebs`' />-->\n<!--<parameter name='color-aware' value='`$prop.sotn.colorAware`' />-->\n\n<!--<parameter name='etht-svc-name' value='`$prop.sotn.etht-svc-name`' />-->\n<parameter name='model-customization-id' value='`$network-topology-operation-input.network-information.onap-model-information.model-customization-uuid`' />\n<parameter name='model-invariant-id' value='`$network-topology-operation-input.network-information.onap-model-information.model-invariant-uuid`' />\n<parameter name='model-version-id' value='`$network-topology-operation-input.network-information.onap-model-information.model-uuid`' />\n<parameter name='connectivity-selflink' value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'  + $network-topology-operation-input.service-information.service-instance-id  + '/service-data/networks/network/'  + $prop.sotn.network-id  + '/network-data/'` \" />\n",
        "comments": "",
        "outputs": 1,
        "x": 1847.6666870117188,
        "y": 3671.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            []
        ]
    },
    {
        "id": "883e63bc.f1bf9",
        "type": "save",
        "name": "save middle-man-conn relationship to connectivity-otnidx, in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='connectivity:relationship-list' \n      key='connectivity.connectivity-id = $middle-man-conn.connectivity-id' \n      force=\"true\" pfx=\"tmp.AnAI-data\">\n<parameter name=\"relationship-list.relationship[0].related-to\" value=\"connectivity\" />\n<parameter name=\"relationship-list.relationship[0].related-link\" value=\"`'/network/connectivities/connectivity/' + $uuid.connectivity-otnidx-uuid`\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"connectivity.connectivity-id\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$uuid.connectivity-otnidx-uuid`\" />",
        "comments": "",
        "outputs": 1,
        "x": 1948.6666870117188,
        "y": 3716.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            []
        ]
    },
    {
        "id": "67b90a5f.a2bde4",
        "type": "save",
        "name": "save TNNSSI (transport service instance) relationship to connectivity in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='service-instance:relationship-list' \n      key='service-instance.service-instance-id = $vnf-topology-operation-input.service-information.service-instance-id\n         AND customer.global-customer-id = $vnf-topology-operation-input.service-information.global-customer-id \n         AND service-subscription.service-type = $vnf-topology-operation-input.service-information.subscription-service-type' \n      force=\"true\" pfx=\"tmp.AnAI-data\">\n<parameter name=\"relationship-list.relationship[0].related-to\" value=\"connectivity\" />\n<parameter name=\"relationship-list.relationship[0].related-link\" value=\"`'/network/connectivities/connectivity/' + $uuid.connectivity-otnidx-uuid`\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"connectivity.connectivity-id\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$uuid.connectivity-otnidx-uuid`\" />\n\n\n<!--<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='service-instance:relationship-list' -->\n<!--      key='service-instance.service-instance-id = $service-data.service-information.service-instance-id -->\n<!--         AND customer.global-customer-id = $service-data.networks.network[$nidx].network-data.service-information.global-customer-id -->\n<!--         AND service-subscription.service-type = $service-data.networks.network[$nidx].network-data.service-information.subscription-service-type' -->\n<!--      force=\"true\" pfx=\"tmp.AnAI-data\">-->\n<!--<parameter name=\"relationship-list.relationship[0].related-to\" value=\"connectivity\" />-->\n<!--<parameter name=\"relationship-list.relationship[0].related-link\" value=\"`'/network/connectivities/connectivity/' + $prop.sotn.network-id`\" />-->\n<!--<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"connectivity.connectivity-id\" />-->\n<!--<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$prop.sotn.network-id`\" />-->",
        "comments": "",
        "outputs": 1,
        "x": 1984.6666870117188,
        "y": 3770.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            []
        ]
    },
    {
        "id": "44633bde.4c2f24",
        "type": "save",
        "name": "save connectivity-otnidx relationship to vpn-binding-otnidx, in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding:relationship-list' \n      key='vpn-binding.vpn-id = $prop.vpn-binding-otnidx-uuid' \n      force=\"true\" pfx=\"tmp.AnAI-data\">\n<parameter name=\"relationship-list.relationship[0].related-to\" value=\"connectivity\" />\n<parameter name=\"relationship-list.relationship[0].related-link\" value=\"`'/network/connectivities/connectivity/' + $uuid.connectivity-otnidx-uuid`\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"connectivity.connectivity-id\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$uuid.connectivity-otnidx-uuid`\" />",
        "comments": "",
        "outputs": 1,
        "x": 1952.6666870117188,
        "y": 3829.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            []
        ]
    },
    {
        "id": "ad055e93.cbffc8",
        "type": "comment",
        "name": "find middle-man's eth-srv-name",
        "info": "",
        "comments": "",
        "x": 1410.6666870117188,
        "y": 3445.89990234375,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "17ca39fd.1576de",
        "type": "set",
        "name": "set prop.ethernet-service-name",
        "xml": "<set>\n<parameter name='prop.ethernet-service-name' value='`$middle-man-conn.etht-svc-name`' />\n\n",
        "comments": "",
        "x": 1432.6666870117188,
        "y": 3489.89990234375,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "91cb3623.bfa508",
        "type": "save",
        "name": "save middle-man-conn relationship to tmp.the-connectivity, in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='connectivity:relationship-list' \n      key='connectivity.connectivity-id = $middle-man-conn.connectivity-id' \n      force=\"true\" pfx=\"tmp.AnAI-data\">\n<parameter name=\"relationship-list.relationship[0].related-to\" value=\"connectivity\" />\n<parameter name=\"relationship-list.relationship[0].related-link\" value=\"`'/network/connectivities/connectivity/' + $tmp.the-connectivity.connectivity-id`\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"connectivity.connectivity-id\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$tmp.the-connectivity.connectivity-id`\" />",
        "comments": "",
        "outputs": 1,
        "x": 2639.6666870117188,
        "y": 4225.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            []
        ]
    },
    {
        "id": "749face3.2a032c",
        "type": "save",
        "name": "save TNNSSI (transport service instance) relationship to connectivity in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='service-instance:relationship-list' \n      key='service-instance.service-instance-id = $vnf-topology-operation-input.service-information.service-instance-id\n         AND customer.global-customer-id = $vnf-topology-operation-input.service-information.global-customer-id \n         AND service-subscription.service-type = $vnf-topology-operation-input.service-information.subscription-service-type' \n      force=\"true\" pfx=\"tmp.AnAI-data\">\n<parameter name=\"relationship-list.relationship[0].related-to\" value=\"connectivity\" />\n<parameter name=\"relationship-list.relationship[0].related-link\" value=\"`'/network/connectivities/connectivity/' + $uuid.connectivity-otnidx-uuid`\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"connectivity.connectivity-id\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$uuid.connectivity-otnidx-uuid`\" />\n\n\n<!--<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='service-instance:relationship-list' -->\n<!--      key='service-instance.service-instance-id = $service-data.service-information.service-instance-id -->\n<!--         AND customer.global-customer-id = $service-data.networks.network[$nidx].network-data.service-information.global-customer-id -->\n<!--         AND service-subscription.service-type = $service-data.networks.network[$nidx].network-data.service-information.subscription-service-type' -->\n<!--      force=\"true\" pfx=\"tmp.AnAI-data\">-->\n<!--<parameter name=\"relationship-list.relationship[0].related-to\" value=\"connectivity\" />-->\n<!--<parameter name=\"relationship-list.relationship[0].related-link\" value=\"`'/network/connectivities/connectivity/' + $prop.sotn.network-id`\" />-->\n<!--<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"connectivity.connectivity-id\" />-->\n<!--<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$prop.sotn.network-id`\" />-->",
        "comments": "",
        "outputs": 1,
        "x": 2670.6666870117188,
        "y": 4264.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            []
        ]
    },
    {
        "id": "d1e29877.e2638",
        "type": "save",
        "name": "save tmp.the-connectivity relationship to vpn-binding-otnidx, in AAI",
        "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding:relationship-list' \n      key='vpn-binding.vpn-id = $prop.vpn-binding-otnidx-uuid' \n      force=\"true\" pfx=\"tmp.AnAI-data\">\n<parameter name=\"relationship-list.relationship[0].related-to\" value=\"connectivity\" />\n<parameter name=\"relationship-list.relationship[0].related-link\" value=\"`'/network/connectivities/connectivity/' + $tmp.the-connectivity.connectivity-id`\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-key\" value=\"connectivity.connectivity-id\" />\n<parameter name=\"relationship-list.relationship[0].relationship-data[0].relationship-value\" value=\"`$tmp.the-connectivity.connectivity-id`\" />",
        "comments": "",
        "outputs": 1,
        "x": 2641.6666870117188,
        "y": 4337.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            []
        ]
    },
    {
        "id": "ca553073.a3999",
        "type": "comment",
        "name": "update the founded connectivity to have a new coupling-flag",
        "info": "",
        "comments": "",
        "x": 2611.6666870117188,
        "y": 4053.89990234375,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "30b58e5f.9a5412",
        "type": "set",
        "name": "set newFlag",
        "xml": "<set>\n<parameter name='tmp.newFlag' value=\"`$tmp.the-connectivity.coupling-flag + '-' +\n                                               $tmp.srcTtpdstTtpPair`\" />\n\n\n",
        "comments": "",
        "x": 2497.6666870117188,
        "y": 4092.89990234375,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "b32f2c11.a0cbd",
        "type": "save",
        "name": "update connectivity resource in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='connectivity' \n      key='connectivity.connectivity-id = $tmp.the-connectivity.connectivity-id'>\n<parameter name='connectivity-id' value='`$tmp.the-connectivity.connectivity-id`' />\n<parameter name='etht-svc-name' value='`$prop.ethernet-service-name`' />\n<parameter name='operational-status' value='Modified' />\n<parameter name='coupling-flag' value='`$tmp.newFlag`' />\n",
        "comments": "",
        "outputs": 1,
        "x": 2561.6666870117188,
        "y": 4137.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            []
        ]
    },
    {
        "id": "b26dba6c.6455b",
        "type": "comment",
        "name": "the following two relationships should have already been there; if not => error",
        "info": "",
        "comments": "",
        "x": 2653.6666870117188,
        "y": 4187.89990234375,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "f615578d.11ca3",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 1639.6666870117188,
        "y": 3554.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "f0f8f4ff.e42fa",
                "c456d560.e56b4",
                "1c6b3c2b.a8cfe4",
                "883e63bc.f1bf9",
                "67b90a5f.a2bde4",
                "44633bde.4c2f24"
            ]
        ]
    },
    {
        "id": "1d9dc789.fabfa",
        "type": "outcomeFalse",
        "name": "false",
        "xml": "<outcome value='false'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1501.6666870117188,
        "y": 3550.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "f615578d.11ca3"
            ]
        ]
    },
    {
        "id": "5f9745ba.8cabdc",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic='true'>",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 2299.6666870117188,
        "y": 4017.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "58dad5a1.4283d4",
                "30b58e5f.9a5412",
                "b32f2c11.a0cbd",
                "d1e29877.e2638"
            ]
        ]
    },
    {
        "id": "fe407594.64cba8",
        "type": "comment",
        "name": "loop through the relationships of this founded connectivity, then",
        "info": "then find the vpn-binding that has same src ttp and dst ttp as this one",
        "comments": "",
        "x": 2304.6666870117188,
        "y": 4442.89990234375,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "c41409e5.b5d3c",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for silentFailure='true' index='tcridx' start='0' end='`$tmp.the-connectivity.relationship-list.relationship_length`' >\n\n",
        "comments": "",
        "outputs": 1,
        "x": 2646.6666870117188,
        "y": 4478.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "edec3f37.241e6"
            ]
        ]
    },
    {
        "id": "edec3f37.241e6",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.the-connectivity.relationship-list.relationship[$tcridx].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2858.6666870117188,
        "y": 4476.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "1919beb6.7cb971"
            ]
        ]
    },
    {
        "id": "1919beb6.7cb971",
        "type": "outcome",
        "name": "vpn-binding",
        "xml": "<outcome value='vpn-binding'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3042.6666870117188,
        "y": 4474.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "df4bf19a.978d2"
            ]
        ]
    },
    {
        "id": "df4bf19a.978d2",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 3221.6666870117188,
        "y": 4479.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "89ff485c.8db648",
                "2bf1f71c.a919d"
            ]
        ]
    },
    {
        "id": "2bf1f71c.a919d",
        "type": "set",
        "name": "unset tmp.aai.vpn-binding",
        "xml": "<set>\n<parameter name='tmp.aai.vpn-binding.' value='' />\n",
        "comments": "",
        "x": 3438.6666870117188,
        "y": 4410.89990234375,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "89ff485c.8db648",
        "type": "save",
        "name": "get vpn-binding from aai",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"vpn-binding\"\n\t    key=\"vpn-binding.vpn-id = $tmp.the-connectivity.relationship-list.relationship[$tcridx].relationship-data[0].relationship-value\"\n\t\tlocal-only=\"false\" \n\t\tpfx=\"tmp.aai.vpn-binding\" >\n",
        "comments": "",
        "outputs": 1,
        "x": 3431.6666870117188,
        "y": 4496.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "5ee5ca48.dc9864",
                "e1c034fb.99a648",
                "c5ac5c6f.6f9258"
            ]
        ]
    },
    {
        "id": "e1c034fb.99a648",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3645.1576538085938,
        "y": 4481.473937988281,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "6e271c06.d0d73c"
            ]
        ]
    },
    {
        "id": "6e271c06.d0d73c",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.l3vpn.pe1_id`\" />\n\n",
        "comments": "",
        "x": 3807.7291870117188,
        "y": 4480.7596435546875,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "38e2891f.3394ee",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
        "comments": "",
        "x": 3808.6666870117188,
        "y": 4525.89990234375,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "c5ac5c6f.6f9258",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3640.6666870117188,
        "y": 4525.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "38e2891f.3394ee"
            ]
        ]
    },
    {
        "id": "5ee5ca48.dc9864",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3642.6666870117188,
        "y": 4585.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "e13c4300.ac87f"
            ]
        ]
    },
    {
        "id": "e13c4300.ac87f",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 3811.6666870117188,
        "y": 4584.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "3fedffc1.068a9"
            ]
        ]
    },
    {
        "id": "9f0cdaa9.449a9",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 2435.6666870117188,
        "y": 4476.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "c41409e5.b5d3c",
                "ef03524f.322ab",
                "a41cf4f1.35b988"
            ]
        ]
    },
    {
        "id": "3fedffc1.068a9",
        "type": "switchNode",
        "name": "switch srcTtp",
        "xml": "<switch test='`$tmp.aai.vpn-binding.src-access-ltp-id == $tmp.otninfoProtect[$otnidx].srcPort.src-tunnel-tp-id`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4010.6666870117188,
        "y": 4585.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "46797ae5.8f5fdc"
            ]
        ]
    },
    {
        "id": "46797ae5.8f5fdc",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4173.666687011719,
        "y": 4583.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "26801daf.757d4a"
            ]
        ]
    },
    {
        "id": "26801daf.757d4a",
        "type": "switchNode",
        "name": "switch dstTtp",
        "xml": "<switch test='`$tmp.aai.vpn-binding.dst-access-ltp-id == $tmp.otninfoProtect[$otnidx].dstPort.dst-tunnel-tp-id`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4354.666687011719,
        "y": 4583.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "4ecd0d28.02b6dc"
            ]
        ]
    },
    {
        "id": "4ecd0d28.02b6dc",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4517.666687011719,
        "y": 4581.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "2b446601.7eb632"
            ]
        ]
    },
    {
        "id": "efbe91c3.9535c8",
        "type": "set",
        "name": "set tmp.the-vpn-binding",
        "xml": "<set>\n<parameter name='tmp.the-vpn-binding.' value='`$tmp.aai.vpn-binding.`' />\n",
        "comments": "",
        "x": 4874.666687011719,
        "y": 4588.89990234375,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "2b446601.7eb632",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 4656.666687011719,
        "y": 4580.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "efbe91c3.9535c8",
                "1b35126e.c915be"
            ]
        ]
    },
    {
        "id": "1b35126e.c915be",
        "type": "break",
        "name": "break",
        "xml": "<break>\n",
        "comments": "",
        "x": 4820.666687011719,
        "y": 4632.89990234375,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "ef03524f.322ab",
        "type": "set",
        "name": "unset tmp.the-vpn-binding",
        "xml": "<set>\n<parameter name='tmp.the-vpn-binding.' value='' />\n",
        "comments": "",
        "x": 2656.6666870117188,
        "y": 4439.89990234375,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "bb2c64f6.a88498",
        "type": "comment",
        "name": "increase the bw of the-vpn-binding and change status to modified",
        "info": "increase the bw of the-vpn-binding\nchange status to modified\n",
        "comments": "",
        "x": 2745.6666870117188,
        "y": 4613.89990234375,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "a41cf4f1.35b988",
        "type": "save",
        "name": "update vpn-binding otnIdx resource (aka. OTN) in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding' \n      key='vpn-binding.vpn-id = $tmp.the-vpn-binding.vpn-id' >\n<parameter name='vpn-id' value='`$tmp.the-vpn-binding.vpn-id`' />\n<!--<parameter name='vpn-name' value='`$prop.otn-tunnel-name`' />-->\n<!--<parameter name='customer-vpn-id' value='`($maxtpn + $gfp)`' />-->\n<parameter name='customer-vpn-id' value='`($tmp.the-vpn-binding.customer-vpn-id + $gfp)`' />\n\n<parameter name='route-distinguisher' value='`$gfp`' />\n<parameter name='operational-status' value='Modified' />\n\n\n",
        "comments": "",
        "outputs": 1,
        "x": 2715.6666870117188,
        "y": 4673.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            []
        ]
    },
    {
        "id": "655b0cf9.434f14",
        "type": "execute",
        "name": "execute UUID generator for vpn-binding $otnidx",
        "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='generateUUID' >\n<parameter name=\"ctx-destination\" value=\"prop.vpn-binding-otnidx-uuid\"/>\n",
        "comments": "",
        "outputs": 1,
        "x": 1550.6666870117188,
        "y": 2841.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            []
        ]
    },
    {
        "id": "390f0f63.f5713",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1630.6666870117188,
        "y": 2892.89990234375,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "46e17225.a2db0c"
            ]
        ]
    },
    {
        "id": "46e17225.a2db0c",
        "type": "set",
        "name": "set access-provider-id and client-id",
        "xml": "<set>\n<parameter name='tmp.access-provider-id' value='`$tmp.otninfoProtect[$otnidx].srcPort.src-access-provider-id`' />\n<parameter name='tmp.access-client-id' value='`$tmp.otninfoProtect[$otnidx].srcPort.src-access-client-id`' />\n<parameter name='tmp.access-topology-id' value='`$tmp.otninfoProtect[$otnidx].srcPort.src-access-topology-id`' />\n<parameter name='tmp.srcdstpnf-id' value='`$tmp.otninfoProtect[$otnidx].srcPort.src-access-node-id`' />\n",
        "comments": "",
        "x": 1844.6666870117188,
        "y": 2891.89990234375,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "2286c595.dee83a",
        "type": "set",
        "name": "unset parameters",
        "xml": "<set>\n<parameter name='tmp.srcdstpnf-name' value='' />\n<parameter name='prop.vpn-binding-otnidx-uuid' value='' />\n<parameter name='tmp.access-provider-id' value='' />\n<parameter name='tmp.access-client-id' value='' />\n<parameter name='tmp.access-topology-id' value='' />\n<parameter name='tmp.srcdstpnf-id' value='' />\n<parameter name='tmp.aai.srcdst-pnf.' value='' />\n<parameter name='tmp.domainG.esr-thirdparty-id' value='' />\n<parameter name='tmp.aai.domainG.esr-thirdparty-sdnc.' value='' />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainG.url' value='' />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainG.user' value='' />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainG.password' value='' />\n<parameter name='tmp.srcTtpdstTtpPair' value='' />\n\n\n",
        "comments": "",
        "x": 1210.5665893554688,
        "y": 2476.89990234375,
        "z": "ab59e982.86c81",
        "wires": []
    },
    {
        "id": "62f58207.69b144",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic='true'>",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 985.2000122070312,
        "y": 2493.13330078125,
        "z": "ab59e982.86c81",
        "wires": [
            [
                "2286c595.dee83a",
                "4da32200.1a505"
            ]
        ]
    }
]