[
    {
        "id": "d35e2da9.70a7e",
        "type": "save",
        "name": "get all-vpn-bindings from aai",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"vpn-bindings\"\n\t    key=\"selflink = 'https://aai.onap:8443/aai/v24/network/vpn-bindings\"\n\t\tlocal-only=\"false\" \n\t\tpfx=\"tmp.aai.all-vpn-bindings\" >\n",
        "comments": "",
        "outputs": 1,
        "x": 372,
        "y": 306,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "88d19ab1.10b18",
                "8fd12759.af6e18",
                "50405d21.7eae84"
            ]
        ]
    },
    {
        "id": "88d19ab1.10b18",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 560,
        "y": 319,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "d472199a.beff9"
            ]
        ]
    },
    {
        "id": "8fd12759.af6e18",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 567.4909362792969,
        "y": 361.57403564453125,
        "z": "5a4cb919.dfff38",
        "wires": [
            []
        ]
    },
    {
        "id": "50405d21.7eae84",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 558,
        "y": 408,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "6b1a691d.f6617"
            ]
        ]
    },
    {
        "id": "d472199a.beff9",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 733,
        "y": 317,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "f306805a.38d6f8"
            ]
        ]
    },
    {
        "id": "f306805a.38d6f8",
        "type": "for",
        "name": "for vpnidx in all-vpn-bindings",
        "xml": "<for index='vpnbidx' start='0' end='`$tmp.aai.all-vpn-bindings.vpn-binding_length`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 962,
        "y": 318,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "4a920666.d84d68"
            ]
        ]
    },
    {
        "id": "4a920666.d84d68",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic='true'>",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 1177,
        "y": 319,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "fc848cba.fc33d8"
            ]
        ]
    },
    {
        "id": "841ae1dd.49d178",
        "type": "switchNode",
        "name": "switch vpnuuid is for this slice",
        "xml": "<!--<switch test=\"`$tmp.slicevpnuuids[$tmp.aai.all-vpn-bindings.vpn-binding[$vpnbidx].vpn-id] != '' `\">-->\n\n<!-- Replace vpn-type with slice-id (a new attribbute in the latest AAI) -->\n<switch test=\"`$tmp.aai.all-vpn-bindings.vpn-binding[$vpnbidx].slice-id == $tmp.aai.service-instance.service-instance-id `\">\n\n",
        "comments": "",
        "outputs": 1,
        "x": 1431,
        "y": 241,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "98ef6cc.4725e9",
                "ab42fe03.c49e3"
            ]
        ]
    },
    {
        "id": "98ef6cc.4725e9",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1648,
        "y": 220,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "fc848cba.fc33d8"
            ]
        ]
    },
    {
        "id": "ab42fe03.c49e3",
        "type": "outcomeFalse",
        "name": "false",
        "xml": "<outcome value='false'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1648,
        "y": 269,
        "z": "5a4cb919.dfff38",
        "wires": [
            []
        ]
    },
    {
        "id": "fc848cba.fc33d8",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic='true'>",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 1832,
        "y": 306,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "53692e4a.48cde",
                "957d0d12.f7d338",
                "1f9b767f.d670b2"
            ]
        ]
    },
    {
        "id": "524dbe59.8ef8f",
        "type": "dgstart",
        "name": "DGSTART",
        "outputs": 1,
        "x": 191,
        "y": 47,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "320667fa.12a2c"
            ]
        ]
    },
    {
        "id": "320667fa.12a2c",
        "type": "service-logic",
        "name": "GENERIC-RESOURCE-API ${project.version}",
        "module": "GENERIC-RESOURCE-API",
        "version": "${project.version}",
        "comments": "",
        "xml": "<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>",
        "outputs": 1,
        "x": 475.2856903076172,
        "y": 108.23810863494873,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "aa006c98.f12b58"
            ]
        ]
    },
    {
        "id": "aa006c98.f12b58",
        "type": "method",
        "name": "method cll-vnf-topology-operation-cll-F1-Activate",
        "xml": "<method rpc='cll-vnf-topology-operation-cll-F1-Activate' mode='sync'>\n",
        "comments": "",
        "outputs": 1,
        "x": 481.42860412597656,
        "y": 193.00003051757812,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "72fe4a66.39584c"
            ]
        ]
    },
    {
        "id": "72fe4a66.39584c",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 791.238037109375,
        "y": 184.66668701171875,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "d35e2da9.70a7e",
                "cce8745e.b515b8",
                "706cb78c.da92b",
                "88772a4.9b58658",
                "4ace150.4554dec"
            ]
        ]
    },
    {
        "id": "53692e4a.48cde",
        "type": "set",
        "name": "set tmp.aai.vpn-binding",
        "xml": "<set>\n<parameter name='tmp.aai.vpn-binding.' value=\"`$tmp.aai.all-vpn-bindings.vpn-binding[$vpnbidx].`\" />\n",
        "comments": "",
        "x": 2049,
        "y": 244,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "123fcc82.b79ae3",
        "type": "set",
        "name": "set attachment_param for OTN A",
        "xml": "<set>\n<parameter name='src-node-id' value='`$tmp.aai.vpn-bindingA.src-access-node-id`' />\n<parameter name='dst-node-id' value='`$tmp.aai.vpn-bindingA.dst-access-node-id`' />\n<!--<parameter name='dst-tpn-id' value='1' />-->\n<parameter name='dst-tpn-id' value='`$tmp.aai.vpn-bindingA.customer-vpn-id`' />\n<parameter name='dst-ttp-id' value='`$tmp.aai.vpn-bindingA.dst-access-ltp-id`' />\n<parameter name='slice-instance-id' value='`$tmp.aai.service-instance.service-instance-id`' />\n<parameter name='otn-tunnel-name-src-domain' value='`$tmp.aai.vpn-bindingA.vpn-name`' />\n<parameter name='client-id' value='`$tmp.aai.vpn-bindingA.access-client-id`' />\n<parameter name='provider-id' value='`$tmp.aai.vpn-bindingA.access-provider-id`' />\n<parameter name='topology-id' value='`$tmp.aai.vpn-bindingA.access-topology-id`' />\n",
        "comments": "",
        "x": 4218,
        "y": 130,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "e308a3a2.af826",
        "type": "execute",
        "name": "execute RestApiCallNode Create OTN tunnel with token",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.cll-otn-src-domain-creation.templatefile`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainA.url + '/restconf/data/ietf-te:te'`\" />\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainA.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainA.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"patch\"/>\n<parameter name=\"responsePrefix\" value=\"otn-oof\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n<parameter name='customHttpHeaders' value=\"`'X-ACCESS-TOKEN=' + $prop.sdncRestApi.token_id`\" />",
        "comments": "",
        "outputs": 1,
        "x": 4299,
        "y": 445,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "fedd6b9.d7f3318",
                "39581c20.edb614"
            ]
        ]
    },
    {
        "id": "fedd6b9.d7f3318",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4608.5,
        "y": 414,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "c49081cf.377c78"
            ]
        ]
    },
    {
        "id": "39581c20.edb614",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4613.5,
        "y": 479,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "9c0572a4.3a997"
            ]
        ]
    },
    {
        "id": "c49081cf.377c78",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create OTN tunnel rest api\" />\n",
        "comments": "",
        "x": 4784.5,
        "y": 414,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "9c0572a4.3a997",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 4780,
        "y": 479,
        "z": "5a4cb919.dfff38",
        "wires": [
            []
        ]
    },
    {
        "id": "2d297001.689a7",
        "type": "set",
        "name": "set sotn_value",
        "xml": "<set>\n<!--<parameter name='eth-service-name' value='`$tmp.aai.connectivityA.connectivity-id`' />-->\n<parameter name='eth-service-name' value='`$tmp.aai.connectivityA.etht-svc-name`' />\n<parameter name='slice-id' value='`$vnf-topology-operation-input.service-information.service-instance-id`' />\n<parameter name='provider-id' value='`$tmp.aai.connectivityA.access-provider-id`' />\n<parameter name='client-id' value='`$tmp.aai.connectivityA.access-client-id`' />\n<parameter name='topology-id' value='`$tmp.aai.connectivityA.access-topology-id`' />\n<parameter name='otn-tunnel-name' value='`$tmp.aai.vpn-bindingA.vpn-name`' />\n<parameter name='ethernet-end-point-name' value='`$tmp.aai.connectivityA.connectivity-id`' />\n<parameter name='index-number' value='0' />\n<parameter name='eth-node-id' value='`$tmp.aai.connectivityA.access-node-id`' />\n<parameter name='eth-node-tp-id' value='`$tmp.aai.connectivityA.access-ltp-id`' />\n<parameter name='CIR' value='`$tmp.aai.vpn-bindingA.route-distinguisher *1000000`' />\n<parameter name='EIR' value='`$tmp.aai.vpn-bindingA.route-distinguisher *1000000`' />\n<parameter name='cvlan' value='`$tmp.aai.connectivityA.cvlan`' />\n",
        "comments": "",
        "x": 4163.5,
        "y": 699,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "54d9bbcc.0d0bac",
        "type": "execute",
        "name": "execute RestApiCallNode Create ethernet Service without token",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.ts-ethernet-service.templatefile`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainA.url + '/restconf/data/ietf-eth-tran-service:etht-svc'`\" />\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.restapi.connection-oof-url`\" />-->\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainA.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainA.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"patch\"/>\n<parameter name='dirPath' value=\"/opt/onap/sdnc/restconfapi/yang\" />\n<parameter name=\"responsePrefix\" value=\"vpn-result\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n",
        "comments": "",
        "outputs": 1,
        "x": 4317.5,
        "y": 747,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "2ade786d.c09b28",
                "f17ad5b3.0ef818"
            ]
        ]
    },
    {
        "id": "2ade786d.c09b28",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4663,
        "y": 728,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "72718fb4.e15e78"
            ]
        ]
    },
    {
        "id": "f17ad5b3.0ef818",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4667,
        "y": 768,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "98b1fdb0.a42648"
            ]
        ]
    },
    {
        "id": "72718fb4.e15e78",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create ethernet service rest api\" />\n",
        "comments": "",
        "x": 4821,
        "y": 728,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "98b1fdb0.a42648",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 4824.5,
        "y": 768,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "fe12ce9.6a53ab",
                "4eba4c2.fda54b4"
            ]
        ]
    },
    {
        "id": "fe12ce9.6a53ab",
        "type": "save",
        "name": "update vpn-binding A resource (aka. OTN domainA) in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding' \n      key='vpn-binding.vpn-id = $tmp.aai.vpn-bindingA.vpn-id' >\n<parameter name='vpn-id' value='`$tmp.aai.vpn-bindingA.vpn-id`' />\n<parameter name='vpn-name' value='`$tmp.aai.vpn-bindingA.vpn-name`' />\n\n<parameter name='operational-status' value='Activated' />\n",
        "comments": "",
        "outputs": 1,
        "x": 5155,
        "y": 733,
        "z": "5a4cb919.dfff38",
        "wires": [
            []
        ]
    },
    {
        "id": "9e233ee4.5c90e",
        "type": "comment",
        "name": "TODO: FIXME",
        "info": "use proper vpn-binding id and connectivity id\n\nAlso, does CCSDK support \"update\" operation for vpn-binding and connectivity?",
        "comments": "",
        "x": 5019,
        "y": 692,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "4eba4c2.fda54b4",
        "type": "save",
        "name": "update connectivity resource in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='connectivity' \n      key='connectivity.connectivity-id = $tmp.aai.connectivityA.connectivity-id'>\n<parameter name='connectivity-id' value='`$tmp.aai.connectivityA.connectivity-id`' />\n<parameter name='operational-status' value='Activated' />\n",
        "comments": "",
        "outputs": 1,
        "x": 5082,
        "y": 779,
        "z": "5a4cb919.dfff38",
        "wires": [
            []
        ]
    },
    {
        "id": "fbd17573.b91cd8",
        "type": "set",
        "name": "set pnf-name",
        "xml": "<set>\n<parameter name='tmp.src.domainA.pnf-name' value=\"`'networkId-providerId-' +\n                                                   $tmp.aai.vpn-bindingA.access-provider-id + '-clientId-' +\n                                                   $tmp.aai.vpn-bindingA.access-client-id + '-topologyId-' +\n                                                   $tmp.aai.vpn-bindingA.access-topology-id + '-nodeId-' +\n                                                   $tmp.aai.vpn-bindingA.src-access-node-id`\" />\n",
        "comments": "",
        "x": 4156,
        "y": 178,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "985dbb20.1c3b78",
        "type": "get-resource",
        "name": "get-resource src pnf",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"pnf\" \n\t\tkey=\"pnf.pnf-name = $tmp.src.domainA.pnf-name\"\n        pfx='tmp.aai.source-pnf' local-only='false' >\n\n        <!--AND depth = '0'\"-->\n",
        "comments": "",
        "outputs": 1,
        "x": 4182,
        "y": 295,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "544c4f89.eba52",
                "eb873b5e.d10b8",
                "d8377d86.76164"
            ]
        ]
    },
    {
        "id": "544c4f89.eba52",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4377.5001220703125,
        "y": 247,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "cd232c91.ed7d5"
            ]
        ]
    },
    {
        "id": "eb873b5e.d10b8",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4369.5001220703125,
        "y": 302,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "7e7e18a4.ea2a98"
            ]
        ]
    },
    {
        "id": "cd232c91.ed7d5",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 4521.8824462890625,
        "y": 246.65567016601562,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "d5d46c3b.524dc8"
            ]
        ]
    },
    {
        "id": "4c85ec99.26bac4",
        "type": "outcome",
        "name": "esr-thirdparty-sdnc",
        "xml": "<outcome value='esr-thirdparty-sdnc'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5104,
        "y": 249,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "490c8cc0.c71134"
            ]
        ]
    },
    {
        "id": "d5d46c3b.524dc8",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for silentFailure='true' index='spvidx' start='0' end='`$tmp.aai.source-pnf.relationship-list.relationship_length`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 4706,
        "y": 245,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "cc43f2ea.19847"
            ]
        ]
    },
    {
        "id": "cc43f2ea.19847",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.aai.source-pnf.relationship-list.relationship[$spvidx].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4901,
        "y": 245,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "4c85ec99.26bac4"
            ]
        ]
    },
    {
        "id": "d8377d86.76164",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4374.5001220703125,
        "y": 359,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "9cf617d3.aee3a8"
            ]
        ]
    },
    {
        "id": "9cf617d3.aee3a8",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 4526.5001220703125,
        "y": 360,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "7e7e18a4.ea2a98",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 4537.5001220703125,
        "y": 303,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "f42e9c90.ae58f",
        "type": "execute",
        "name": "get esr-thirdparty-sdnc",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"esr-thirdparty-sdnc\" \n\t\tkey=\"esr-thirdparty-sdnc.thirdparty-sdnc-id = $tmp.domainA.esr-thirdparty-id AND \n\t\t     depth = '1'\"\n        pfx='tmp.aai.domainA.esr-thirdparty-sdnc' local-only='false' >",
        "comments": "",
        "outputs": 1,
        "x": 5489,
        "y": 262,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "f404a9ca.fbce2",
                "3fd1ebaf.c62a54",
                "66a3972e.71bfa8"
            ]
        ]
    },
    {
        "id": "490c8cc0.c71134",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 5283,
        "y": 249,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "9ce5b4b0.4bb188",
                "f42e9c90.ae58f"
            ]
        ]
    },
    {
        "id": "9ce5b4b0.4bb188",
        "type": "set",
        "name": "set esr-thirdparty-sdnc domainA id",
        "xml": "<set>\n<parameter name='tmp.domainA.esr-thirdparty-id' value=\"`$tmp.aai.source-pnf.relationship-list.relationship[$spvidx].relationship-data[0].relationship-value`\" />\n",
        "comments": "",
        "x": 5519,
        "y": 210,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "f404a9ca.fbce2",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5699,
        "y": 253,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "3597c274.50637e"
            ]
        ]
    },
    {
        "id": "3fd1ebaf.c62a54",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5691,
        "y": 308,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "ff90e84e.43d4b8"
            ]
        ]
    },
    {
        "id": "66a3972e.71bfa8",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5696,
        "y": 365,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "ff823793.36814"
            ]
        ]
    },
    {
        "id": "ff823793.36814",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 5848,
        "y": 366,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "ff90e84e.43d4b8",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 5859,
        "y": 311,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "3597c274.50637e",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 5843.38232421875,
        "y": 250.65567016601562,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "d39e28b5.1aec5"
            ]
        ]
    },
    {
        "id": "d39e28b5.1aec5",
        "type": "set",
        "name": "set controller domainA data",
        "xml": "<set>\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainA.url' value=\"`$tmp.aai.domainA.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].service-url`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainA.user' value=\"`$tmp.aai.domainA.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].user-name`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainA.password' value=\"`$tmp.aai.domainA.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].password`\" />\n\n\n<!--<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >-->\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/restconf/data/ietf-network:networks'`\" />-->\n<!--<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />-->\n<!--<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />-->\n<!--<parameter name=\"format\" value=\"json\"/>-->\n<!--<parameter name=\"httpMethod\" value=\"get\"/>-->\n<!--<parameter name=\"responsePrefix\" value=\"topology\"/>-->\n<!--<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>-->\n<!--<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>-->\n<!--<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>-->\n<!--<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>-->\n",
        "comments": "",
        "x": 6058,
        "y": 247,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "139f2f1e.8fa159",
        "type": "set",
        "name": "set attachment_param for OTN B",
        "xml": "<set>\n<parameter name='src-node-id' value='`$tmp.aai.vpn-bindingB.src-access-node-id`' />\n<parameter name='dst-node-id' value='`$tmp.aai.vpn-bindingB.dst-access-node-id`' />\n<!--<parameter name='src-tpn-id' value='1' />-->\n<parameter name='src-tpn-id' value='`$tmp.aai.vpn-bindingB.customer-vpn-id`' />\n<parameter name='src-ttp-id' value='`$tmp.aai.vpn-bindingB.src-access-ltp-id`' />\n<parameter name='slice-instance-id' value='`$tmp.aai.service-instance.service-instance-id`' />\n<parameter name='otn-tunnel-name-dst-domain' value='`$tmp.aai.vpn-bindingB.vpn-name`' />\n<parameter name='client-id' value='`$tmp.aai.vpn-bindingB.access-client-id`' />\n<parameter name='provider-id' value='`$tmp.aai.vpn-bindingB.access-provider-id`' />\n<parameter name='topology-id' value='`$tmp.aai.vpn-bindingB.access-topology-id`' />\n",
        "comments": "",
        "x": 3625,
        "y": 1587,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "18d2c2bc.05fd85",
        "type": "execute",
        "name": "execute RestApiCallNode Create OTN tunnel with token",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.cll-otn-dst-domain-creation.templatefile`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainB.url + '/restconf/data/ietf-te:te'`\" />\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainB.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainB.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"patch\"/>\n<parameter name=\"responsePrefix\" value=\"otn-oof\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n<parameter name='customHttpHeaders' value=\"`'X-ACCESS-TOKEN=' + $prop.sdncRestApi.token_id`\" />",
        "comments": "",
        "outputs": 1,
        "x": 3688,
        "y": 1916,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "8895fa29.bf8e3",
                "23c7c635.fd4722"
            ]
        ]
    },
    {
        "id": "8895fa29.bf8e3",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3983.5,
        "y": 1883,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "500b5538.e88684"
            ]
        ]
    },
    {
        "id": "23c7c635.fd4722",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3988.5,
        "y": 1948,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "909dfd67.2300d8"
            ]
        ]
    },
    {
        "id": "500b5538.e88684",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create OTN tunnel rest api\" />\n",
        "comments": "",
        "x": 4151.5,
        "y": 1883,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "909dfd67.2300d8",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 4162,
        "y": 1948,
        "z": "5a4cb919.dfff38",
        "wires": [
            []
        ]
    },
    {
        "id": "a49aeabe.b5ff8",
        "type": "set",
        "name": "set pnf-name",
        "xml": "<set>\n<parameter name='tmp.dst.domainB.pnf-name' value=\"`'networkId-providerId-' +\n                                                   $tmp.aai.vpn-bindingB.access-provider-id + '-clientId-' +\n                                                   $tmp.aai.vpn-bindingB.access-client-id + '-topologyId-' +\n                                                   $tmp.aai.vpn-bindingB.access-topology-id + '-nodeId-' +\n                                                   $tmp.aai.vpn-bindingB.dst-access-node-id`\" />\n",
        "comments": "",
        "x": 3564,
        "y": 1644,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "642d00da.b53c68",
        "type": "get-resource",
        "name": "get-resource dst pnf",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"pnf\" \n\t\tkey=\"pnf.pnf-name = $tmp.dst.domainB.pnf-name\"\n        pfx='tmp.aai.destination-pnf' local-only='false' >\n\n        <!--AND depth = '0'\"-->\n",
        "comments": "",
        "outputs": 1,
        "x": 3584,
        "y": 1741,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "1e5d6803.78b7d8",
                "84307ec5.09a8d",
                "b468d4fc.bc9c8"
            ]
        ]
    },
    {
        "id": "1e5d6803.78b7d8",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3786.5001220703125,
        "y": 1694,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "683b34d0.c1df64"
            ]
        ]
    },
    {
        "id": "84307ec5.09a8d",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3778.5001220703125,
        "y": 1749,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "72cad52e.cb1d74"
            ]
        ]
    },
    {
        "id": "683b34d0.c1df64",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 3930.8824462890625,
        "y": 1691.6556701660156,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "8511cae6.cbf588"
            ]
        ]
    },
    {
        "id": "8511cae6.cbf588",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for silentFailure='true' index='dpvidx' start='0' end='`$tmp.aai.destination-pnf.relationship-list.relationship_length`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 4115,
        "y": 1706,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "82496ff9.234ee"
            ]
        ]
    },
    {
        "id": "b468d4fc.bc9c8",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3783.5001220703125,
        "y": 1806,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "a6137ce1.b3b5c"
            ]
        ]
    },
    {
        "id": "a6137ce1.b3b5c",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 3935.5001220703125,
        "y": 1807,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "72cad52e.cb1d74",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 3946.5001220703125,
        "y": 1752,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "7b4a137a.364fcc",
        "type": "outcome",
        "name": "esr-thirdparty-sdnc",
        "xml": "<outcome value='esr-thirdparty-sdnc'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4513,
        "y": 1710,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "37fe69a9.07064e"
            ]
        ]
    },
    {
        "id": "82496ff9.234ee",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.aai.destination-pnf.relationship-list.relationship[$dpvidx].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4310,
        "y": 1706,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "7b4a137a.364fcc"
            ]
        ]
    },
    {
        "id": "4bdd9e57.a5e13",
        "type": "execute",
        "name": "get esr-thirdparty-sdnc",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"esr-thirdparty-sdnc\" \n\t\tkey=\"esr-thirdparty-sdnc.thirdparty-sdnc-id = $tmp.domainB.esr-thirdparty-id AND \n\t\t     depth = '1'\"\n        pfx='tmp.aai.domainB.esr-thirdparty-sdnc' local-only='false' >",
        "comments": "",
        "outputs": 1,
        "x": 4898,
        "y": 1709,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "8afff046.26af98",
                "5118b1e.53f805",
                "5a800db8.063d6c"
            ]
        ]
    },
    {
        "id": "37fe69a9.07064e",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 4690,
        "y": 1702,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "d299743b.8f6b68",
                "4bdd9e57.a5e13"
            ]
        ]
    },
    {
        "id": "d299743b.8f6b68",
        "type": "set",
        "name": "set esr-thirdparty-sdnc domainB id",
        "xml": "<set>\n<parameter name='tmp.domainB.esr-thirdparty-id' value=\"`$tmp.aai.destination-pnf.relationship-list.relationship[$dpvidx].relationship-data[0].relationship-value`\" />\n",
        "comments": "",
        "x": 4928,
        "y": 1657,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "2523ddf0.8e1c8a",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 5257,
        "y": 1813,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "6f850c0f.e212ac",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 5268,
        "y": 1758,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "546ca846.269108",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 5252.38232421875,
        "y": 1697.6556701660156,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "fac7ab27.77dda8"
            ]
        ]
    },
    {
        "id": "fac7ab27.77dda8",
        "type": "set",
        "name": "set controller domainB data",
        "xml": "<set>\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainB.url' value=\"`$tmp.aai.domainB.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].service-url`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainB.user' value=\"`$tmp.aai.domainB.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].user-name`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainB.password' value=\"`$tmp.aai.domainB.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].password`\" />\n\n\n<!--<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >-->\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/restconf/data/ietf-network:networks'`\" />-->\n<!--<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />-->\n<!--<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />-->\n<!--<parameter name=\"format\" value=\"json\"/>-->\n<!--<parameter name=\"httpMethod\" value=\"get\"/>-->\n<!--<parameter name=\"responsePrefix\" value=\"topology\"/>-->\n<!--<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>-->\n<!--<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>-->\n<!--<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>-->\n<!--<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>-->\n",
        "comments": "",
        "x": 5467,
        "y": 1694,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "8afff046.26af98",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5108,
        "y": 1700,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "546ca846.269108"
            ]
        ]
    },
    {
        "id": "5118b1e.53f805",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5100,
        "y": 1755,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "6f850c0f.e212ac"
            ]
        ]
    },
    {
        "id": "5a800db8.063d6c",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5105,
        "y": 1812,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "2523ddf0.8e1c8a"
            ]
        ]
    },
    {
        "id": "a1edca3.1a62bb8",
        "type": "switchNode",
        "name": "switch vpn-binding has dst-access-ltp",
        "xml": "<switch test='`$tmp.aai.vpn-binding.dst-access-ltp-id`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3139,
        "y": 658,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "d4bdeded.3ef248",
                "eead64c.0115918"
            ]
        ]
    },
    {
        "id": "d4bdeded.3ef248",
        "type": "outcome",
        "name": "Null",
        "xml": "<outcome value=''>\n",
        "comments": "",
        "outputs": 1,
        "x": 3353,
        "y": 695,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "614a0644.b0e3e"
            ]
        ]
    },
    {
        "id": "eead64c.0115918",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3355,
        "y": 633,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "295e16ce.878c6a"
            ]
        ]
    },
    {
        "id": "614a0644.b0e3e",
        "type": "switchNode",
        "name": "switch vpn-binding has src-access-ltp",
        "xml": "<switch test='`$tmp.aai.vpn-binding.src-access-ltp-id`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2933,
        "y": 1938,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "75bfd38b.356f64",
                "f4c4b096.a3ce2"
            ]
        ]
    },
    {
        "id": "75bfd38b.356f64",
        "type": "outcome",
        "name": "Null",
        "xml": "<outcome value=''>\n",
        "comments": "",
        "outputs": 1,
        "x": 3186,
        "y": 1972,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "b0597a28.514d3"
            ]
        ]
    },
    {
        "id": "f4c4b096.a3ce2",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3186,
        "y": 1916,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "64045150.224658"
            ]
        ]
    },
    {
        "id": "b0597a28.514d3",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
        "comments": "",
        "x": 3337,
        "y": 1972,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "cf5b963d.2b5a08",
        "type": "set",
        "name": "set vpn-bindingA and connectivityA",
        "xml": "<set>\n<parameter name='tmp.aai.vpn-bindingA.' value=\"`$tmp.aai.vpn-binding.`\" />\n<parameter name='tmp.aai.connectivityA.' value=\"`$tmp.aai.connectivity.`\" />\n",
        "comments": "",
        "x": 4213,
        "y": 70,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "4badfb31.b82c1c",
        "type": "set",
        "name": "set vpn-bindingB and connectivityB",
        "xml": "<set>\n<parameter name='tmp.aai.vpn-bindingB.' value=\"`$tmp.aai.vpn-binding.`\" />\n<parameter name='tmp.aai.connectivityB.' value=\"`$tmp.aai.connectivity.`\" />\n\n",
        "comments": "",
        "x": 3621,
        "y": 1529,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "552020c2.f01db",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 3904,
        "y": 327,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "cf5b963d.2b5a08",
                "123fcc82.b79ae3",
                "fbd17573.b91cd8",
                "985dbb20.1c3b78",
                "e308a3a2.af826",
                "ec3b4a19.7f5ee",
                "881b2d7a.c4e888",
                "1a392cd7.238923"
            ]
        ]
    },
    {
        "id": "64045150.224658",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 3337,
        "y": 1915,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "4badfb31.b82c1c",
                "139f2f1e.8fa159",
                "a49aeabe.b5ff8",
                "642d00da.b53c68",
                "18d2c2bc.05fd85",
                "724930a5.f44628",
                "98331ea2.d141f",
                "f84de17e.e8ea08"
            ]
        ]
    },
    {
        "id": "ed40d4d6.135678",
        "type": "set",
        "name": "set sotn_value",
        "xml": "<set>\n<!--<parameter name='eth-service-name' value='`$tmp.aai.connectivityB.connectivity-id`' />-->\n<parameter name='eth-service-name' value='`$tmp.aai.connectivityB.etht-svc-name`' />\n<parameter name='slice-id' value='`$vnf-topology-operation-input.service-information.service-instance-id`' />\n<parameter name='provider-id' value='`$tmp.aai.connectivityB.access-provider-id`' />\n<parameter name='client-id' value='`$tmp.aai.connectivityB.access-client-id`' />\n<parameter name='topology-id' value='`$tmp.aai.connectivityB.access-topology-id`' />\n<parameter name='otn-tunnel-name' value='`$tmp.aai.vpn-bindingB.vpn-name`' />\n<parameter name='ethernet-end-point-name' value='`$tmp.aai.connectivityB.connectivity-id`' />\n<parameter name='index-number' value='0' />\n<parameter name='eth-node-id' value='`$tmp.aai.connectivityB.access-node-id`' />\n<parameter name='eth-node-tp-id' value='`$tmp.aai.connectivityB.access-ltp-id`' />\n<parameter name='CIR' value='`$tmp.aai.vpn-bindingB.route-distinguisher *1000000`' />\n<parameter name='EIR' value='`$tmp.aai.vpn-bindingB.route-distinguisher *1000000`' />\n<parameter name='cvlan' value='`$tmp.aai.connectivityB.cvlan`' />\n\n",
        "comments": "",
        "x": 3575,
        "y": 2214,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "b71c97.3dad8368",
        "type": "execute",
        "name": "execute RestApiCallNode Create ethernet Service without token",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.ts-ethernet-service.templatefile`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainB.url + '/restconf/data/ietf-eth-tran-service:etht-svc'`\" />\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.restapi.connection-oof-url`\" />-->\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainB.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainB.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"patch\"/>\n<parameter name='dirPath' value=\"/opt/onap/sdnc/restconfapi/yang\" />\n<parameter name=\"responsePrefix\" value=\"vpn-result\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n",
        "comments": "",
        "outputs": 1,
        "x": 3729,
        "y": 2262,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "aa1d9a65.d56ee",
                "ce785491.f82258"
            ]
        ]
    },
    {
        "id": "aa1d9a65.d56ee",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4074.5,
        "y": 2243,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "d8df230a.b47018"
            ]
        ]
    },
    {
        "id": "ce785491.f82258",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4078.5,
        "y": 2283,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "d2d57048.de12f"
            ]
        ]
    },
    {
        "id": "d8df230a.b47018",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create ethernet service rest api\" />\n",
        "comments": "",
        "x": 4232.5,
        "y": 2243,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "d2d57048.de12f",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 4236,
        "y": 2283,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "703675c3.1d187c",
                "6a8e2764.0748e8"
            ]
        ]
    },
    {
        "id": "703675c3.1d187c",
        "type": "save",
        "name": "update vpn-binding B resource (aka. OTN domainB) in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding' \n      key='vpn-binding.vpn-id = $tmp.aai.vpn-bindingB.vpn-id' >\n<parameter name='vpn-id' value='`$tmp.aai.vpn-bindingB.vpn-id`' />\n<parameter name='vpn-name' value='`$tmp.aai.vpn-bindingB.vpn-name`' />\n\n<parameter name='operational-status' value='Activated' />\n",
        "comments": "",
        "outputs": 1,
        "x": 4576,
        "y": 2282,
        "z": "5a4cb919.dfff38",
        "wires": [
            []
        ]
    },
    {
        "id": "b9adfc7b.f1d908",
        "type": "comment",
        "name": "TODO: FIXME",
        "info": "use proper vpn-binding id and connectivity\n\nAlso, does CCSDK support \"update\" operation for vpn-binding and connectivity?",
        "comments": "",
        "x": 4434,
        "y": 2240,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "6a8e2764.0748e8",
        "type": "save",
        "name": "update connectivity resource in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='connectivity' \n      key='connectivity.connectivity-id = $tmp.aai.connectivityB.connectivity-id'>\n<parameter name='connectivity-id' value='`$tmp.aai.connectivityB.connectivity-id`' />\n<parameter name='operational-status' value='Activated' />\n",
        "comments": "",
        "outputs": 1,
        "x": 4505,
        "y": 2331,
        "z": "5a4cb919.dfff38",
        "wires": [
            []
        ]
    },
    {
        "id": "641093d5.a73774",
        "type": "set",
        "name": "set attachment_param (gfp-n) for OTN",
        "xml": "<set>\n<parameter name='gfp-n' value='`$tmp.aai.vpn-binding.route-distinguisher`' />\n",
        "comments": "",
        "x": 3130,
        "y": 598,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "29b91b19.d2edf4",
        "type": "comment",
        "name": "only dst ttp exists. No src",
        "info": "",
        "comments": "",
        "x": 3725,
        "y": 284,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "df88a98e.3b797",
        "type": "comment",
        "name": "only src ttp exists. No dst",
        "info": "",
        "comments": "",
        "x": 3282,
        "y": 1862,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "295e16ce.878c6a",
        "type": "switchNode",
        "name": "switch vpn-binding has src-access-ltp",
        "xml": "<switch test='`$tmp.aai.vpn-binding.src-access-ltp-id`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3461,
        "y": 446,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "fdfbdf68.ace01",
                "8f7ef737.3d4208"
            ]
        ]
    },
    {
        "id": "8f7ef737.3d4208",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3703,
        "y": 1035,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "d545d977.39f008"
            ]
        ]
    },
    {
        "id": "fdfbdf68.ace01",
        "type": "outcome",
        "name": "Null",
        "xml": "<outcome value=''>\n",
        "comments": "",
        "outputs": 1,
        "x": 3697,
        "y": 326,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "552020c2.f01db"
            ]
        ]
    },
    {
        "id": "d545d977.39f008",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 3861,
        "y": 1034,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "127c7c35.f5600c",
                "aa22b9fb.8c00d",
                "7a8bb8ff.a3807",
                "b6e4b7cd.3aab58",
                "9befe6d.bfbfb18",
                "61ff745d.2cf8b4"
            ]
        ]
    },
    {
        "id": "aa22b9fb.8c00d",
        "type": "set",
        "name": "set attachment_param for OTN G",
        "xml": "<set>\n<parameter name='src-node-id' value='`$tmp.aai.vpn-bindingG.src-access-node-id`' />\n<parameter name='dst-node-id' value='`$tmp.aai.vpn-bindingG.dst-access-node-id`' />\n<!--<parameter name='dst-tpn-id' value='1' />-->\n<parameter name='src-tpn-id' value='`$tmp.aai.vpn-bindingG.customer-vpn-id`' />\n<parameter name='dst-tpn-id' value='`$tmp.aai.vpn-bindingG.customer-vpn-id`' />\n<parameter name='src-ttp-id' value='`$tmp.aai.vpn-bindingG.src-access-ltp-id`' />\n<parameter name='dst-ttp-id' value='`$tmp.aai.vpn-bindingG.dst-access-ltp-id`' />\n<parameter name='slice-instance-id' value='`$tmp.aai.service-instance.service-instance-id`' />\n<parameter name='otn-tunnel-name-domainG' value='`$tmp.aai.vpn-bindingG.vpn-name`' />\n<parameter name='client-id' value='`$tmp.aai.vpn-bindingG.access-client-id`' />\n<parameter name='provider-id' value='`$tmp.aai.vpn-bindingG.access-provider-id`' />\n<parameter name='topology-id' value='`$tmp.aai.vpn-bindingG.access-topology-id`' />\n",
        "comments": "",
        "x": 4125,
        "y": 917,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "9befe6d.bfbfb18",
        "type": "execute",
        "name": "execute RestApiCallNode Create OTN tunnel with token",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.cll-otn-domainG-creation.templatefile`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainG.url + '/restconf/data/ietf-te:te'`\" />\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainG.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainG.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"patch\"/>\n<parameter name=\"responsePrefix\" value=\"otn-oof\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n<parameter name='customHttpHeaders' value=\"`'X-ACCESS-TOKEN=' + $prop.sdncRestApi.token_id`\" />",
        "comments": "",
        "outputs": 1,
        "x": 4206,
        "y": 1232,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "602f32f4.cac7b4",
                "1d093526.32224b"
            ]
        ]
    },
    {
        "id": "602f32f4.cac7b4",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4515.5,
        "y": 1201,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "4513cd6b.369634"
            ]
        ]
    },
    {
        "id": "1d093526.32224b",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4520.5,
        "y": 1266,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "7640c8ac.188fc8"
            ]
        ]
    },
    {
        "id": "4513cd6b.369634",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create OTN tunnel rest api\" />\n",
        "comments": "",
        "x": 4691.5,
        "y": 1201,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "7640c8ac.188fc8",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 4687,
        "y": 1266,
        "z": "5a4cb919.dfff38",
        "wires": [
            []
        ]
    },
    {
        "id": "7a8bb8ff.a3807",
        "type": "set",
        "name": "set pnf-name",
        "xml": "<set>\n<parameter name='tmp.domainG.pnf-name' value=\"`'networkId-providerId-' +\n                                                   $tmp.aai.vpn-bindingG.access-provider-id + '-clientId-' +\n                                                   $tmp.aai.vpn-bindingG.access-client-id + '-topologyId-' +\n                                                   $tmp.aai.vpn-bindingG.access-topology-id + '-nodeId-' +\n                                                   $tmp.aai.vpn-bindingG.src-access-node-id`\" />\n",
        "comments": "",
        "x": 4063,
        "y": 965,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "b6e4b7cd.3aab58",
        "type": "get-resource",
        "name": "get-resource src pnf",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"pnf\" \n\t\tkey=\"pnf.pnf-name = $tmp.domainG.pnf-name\"\n        pfx='tmp.aai.domainG-pnf' local-only='false' >\n\n        <!--AND depth = '0'\"-->\n",
        "comments": "",
        "outputs": 1,
        "x": 4089,
        "y": 1082,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "bc604696.f19bf",
                "6b2ab2eb.e94cac",
                "158e3d74.81687b"
            ]
        ]
    },
    {
        "id": "bc604696.f19bf",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4284.5001220703125,
        "y": 1034,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "fbbae41a.6bb8"
            ]
        ]
    },
    {
        "id": "6b2ab2eb.e94cac",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4276.5001220703125,
        "y": 1089,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "5e10560f.7f2a6"
            ]
        ]
    },
    {
        "id": "fbbae41a.6bb8",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 4428.8824462890625,
        "y": 1033.6556701660156,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "4ab90ec7.0f8a1"
            ]
        ]
    },
    {
        "id": "4ab90ec7.0f8a1",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for silentFailure='true' index='spvidx' start='0' end='`$tmp.aai.domainG-pnf.relationship-list.relationship_length`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 4613,
        "y": 1032,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "3bb025b6.92298a"
            ]
        ]
    },
    {
        "id": "3bb025b6.92298a",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.aai.domainG-pnf.relationship-list.relationship[$spvidx].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4808,
        "y": 1032,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "ce204654.d589e8"
            ]
        ]
    },
    {
        "id": "158e3d74.81687b",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4281.5001220703125,
        "y": 1146,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "cfe04507.17faa"
            ]
        ]
    },
    {
        "id": "cfe04507.17faa",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 4433.5001220703125,
        "y": 1147,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "5e10560f.7f2a6",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 4444.5001220703125,
        "y": 1090,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "127c7c35.f5600c",
        "type": "set",
        "name": "set vpn-bindingG and connectivityG",
        "xml": "<set>\n<parameter name='tmp.aai.vpn-bindingG.' value=\"`$tmp.aai.vpn-binding.`\" />\n<parameter name='tmp.aai.connectivityG.' value=\"`$tmp.aai.connectivity.`\" />\n",
        "comments": "",
        "x": 4120,
        "y": 857,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "ce204654.d589e8",
        "type": "outcome",
        "name": "esr-thirdparty-sdnc",
        "xml": "<outcome value='esr-thirdparty-sdnc'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5011,
        "y": 1036,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "fea8f5c8.b664d8"
            ]
        ]
    },
    {
        "id": "17936311.45c0f5",
        "type": "execute",
        "name": "get esr-thirdparty-sdnc",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"esr-thirdparty-sdnc\" \n\t\tkey=\"esr-thirdparty-sdnc.thirdparty-sdnc-id = $tmp.domainG.esr-thirdparty-id AND \n\t\t     depth = '1'\"\n        pfx='tmp.aai.domainG.esr-thirdparty-sdnc' local-only='false' >",
        "comments": "",
        "outputs": 1,
        "x": 5396,
        "y": 1049,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "bda3b861.07af08",
                "8ce8739f.28fc08",
                "8098fa71.4cbf3"
            ]
        ]
    },
    {
        "id": "fea8f5c8.b664d8",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 5190,
        "y": 1036,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "619520a0.18d9e",
                "17936311.45c0f5"
            ]
        ]
    },
    {
        "id": "619520a0.18d9e",
        "type": "set",
        "name": "set esr-thirdparty-sdnc domainG id",
        "xml": "<set>\n<parameter name='tmp.domainG.esr-thirdparty-id' value=\"`$tmp.aai.domainG-pnf.relationship-list.relationship[$spvidx].relationship-data[0].relationship-value`\" />\n",
        "comments": "",
        "x": 5426,
        "y": 997,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "bda3b861.07af08",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5606,
        "y": 1040,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "3c9ad3f5.e5e4a4"
            ]
        ]
    },
    {
        "id": "8ce8739f.28fc08",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5598,
        "y": 1095,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "ec86cd9f.a15968"
            ]
        ]
    },
    {
        "id": "8098fa71.4cbf3",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5603,
        "y": 1152,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "244270ad.8dfe1"
            ]
        ]
    },
    {
        "id": "244270ad.8dfe1",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 5755,
        "y": 1153,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "ec86cd9f.a15968",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 5766,
        "y": 1098,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "3c9ad3f5.e5e4a4",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 5750.38232421875,
        "y": 1037.6556701660156,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "2068f2a1.5ec866"
            ]
        ]
    },
    {
        "id": "2068f2a1.5ec866",
        "type": "set",
        "name": "set controller domainG data",
        "xml": "<set>\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainG.url' value=\"`$tmp.aai.domainG.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].service-url`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainG.user' value=\"`$tmp.aai.domainG.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].user-name`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainG.password' value=\"`$tmp.aai.domainG.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].password`\" />\n\n\n<!--<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >-->\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/restconf/data/ietf-network:networks'`\" />-->\n<!--<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />-->\n<!--<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />-->\n<!--<parameter name=\"format\" value=\"json\"/>-->\n<!--<parameter name=\"httpMethod\" value=\"get\"/>-->\n<!--<parameter name=\"responsePrefix\" value=\"topology\"/>-->\n<!--<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>-->\n<!--<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>-->\n<!--<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>-->\n<!--<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>-->\n",
        "comments": "",
        "x": 5965,
        "y": 1034,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "e69cbe2a.82be58",
        "type": "comment",
        "name": "both src and dst exist",
        "info": "",
        "comments": "",
        "x": 3739,
        "y": 975,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "957d0d12.f7d338",
        "type": "switchNode",
        "name": "switch vpn-binding is not already Activated (i.e. is either Created or Modified)",
        "xml": "<switch test=\"`$tmp.aai.vpn-binding.operational-status != 'Activated' `\">\n",
        "comments": "",
        "outputs": 1,
        "x": 2301,
        "y": 702,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "7969493f.6a54d",
                "9a6050c4.300548"
            ]
        ]
    },
    {
        "id": "9a6050c4.300548",
        "type": "outcomeFalse",
        "name": "false",
        "xml": "<outcome value='false'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2708,
        "y": 720,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "66cd0943.de62f"
            ]
        ]
    },
    {
        "id": "7969493f.6a54d",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2708,
        "y": 665,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "7c5fc999.6b62c"
            ]
        ]
    },
    {
        "id": "7c5fc999.6b62c",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 2864,
        "y": 663,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "641093d5.a73774",
                "a1edca3.1a62bb8"
            ]
        ]
    },
    {
        "id": "66cd0943.de62f",
        "type": "block",
        "name": "block",
        "xml": "<block>",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 2841,
        "y": 721,
        "z": "5a4cb919.dfff38",
        "wires": [
            []
        ]
    },
    {
        "id": "cce8745e.b515b8",
        "type": "set",
        "name": "unset tmp.aai.all-vpn-bindings",
        "xml": "<set>\n<parameter name='tmp.aai.all-vpn-bindings.' value=\"\" />\n",
        "comments": "",
        "x": 1018,
        "y": 137,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "48ad099a.c16688",
        "type": "comment",
        "name": "CLL new",
        "info": "construct two array structures like these:\n\n${otn-tunnels-name-list[${1}].otn-tunnel-name}\n\n----------------\n${ethernet-srv-end-points-list[${1}].ethernet-end-point-name}\n${ethernet-srv-end-points-list[${1}].index-number},\n${ethernet-srv-end-points-list[${1}].eth-node-id},\n${ethernet-srv-end-points-list[${1}].eth-node-tp-id},\n${ethernet-srv-end-points-list[${1}].leafOrRootAccess}\n${ethernet-srv-end-points-list[${1}].cvlan}\n${ethernet-srv-end-points-list[${1}].CIR}\n${ethernet-srv-end-points-list[${1}].EIR}",
        "comments": "",
        "x": 4135,
        "y": 555,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "ec3b4a19.7f5ee",
        "type": "set",
        "name": "set leaf-otn-tunnels-list array",
        "xml": "<set>\n<parameter name='`leaf-tunnels-list[$leaftunsidx].tunnel-name`' value='`$tmp.aai.vpn-binding.vpn-name`' />\n<parameter name='`leaf-tunnels-list[$leaftunsidx].vpn-id`' value='`$tmp.aai.vpn-binding.vpn-id`' />\n<parameter name='`leaf-tunnels-list_length`' value='`$leaftunsidx + 1`' />\n",
        "comments": "",
        "x": 4195,
        "y": 594,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "706cb78c.da92b",
        "type": "set",
        "name": "unset leaf-otn-tunnels-list array",
        "xml": "<set>\n<parameter name='`leaf-tunnels-list.`' value='' />\n<parameter name='`leaf-tunnels-list_length`' value='0' />\n<parameter name='`leaftunsidx`' value='0' />\n",
        "comments": "",
        "x": 1011,
        "y": 45,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "9a38eb9e.71f4d8",
        "type": "comment",
        "name": "CLL new",
        "info": "construct two array structures like these:\n\n${otn-tunnels-name-list[${1}].otn-tunnel-name}\n\n----------------\n${ethernet-srv-end-points-list[${1}].ethernet-end-point-name}\n${ethernet-srv-end-points-list[${1}].index-number},\n${ethernet-srv-end-points-list[${1}].eth-node-id},\n${ethernet-srv-end-points-list[${1}].eth-node-tp-id},\n${ethernet-srv-end-points-list[${1}].leafOrRootAccess}\n${ethernet-srv-end-points-list[${1}].cvlan}\n${ethernet-srv-end-points-list[${1}].CIR}\n${ethernet-srv-end-points-list[${1}].EIR}",
        "comments": "",
        "x": 3547,
        "y": 2071,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "724930a5.f44628",
        "type": "set",
        "name": "set root-otn-tunnels-list array",
        "xml": "<set>\n<parameter name='`root-tunnels-list[$roottunsidx].tunnel-name`' value='`$tmp.aai.vpn-binding.vpn-name`' />\n<parameter name='`root-tunnels-list[$roottunsidx].vpn-id`' value='`$tmp.aai.vpn-binding.vpn-id`' />\n<parameter name='`root-tunnels-list_length`' value='`$roottunsidx + 1`' />\n",
        "comments": "",
        "x": 3603,
        "y": 2120,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "2a414bdc.2311dc",
        "type": "set",
        "name": "unset root-otn-tunnels-list array",
        "xml": "<set>\n<parameter name='`root-tunnels-list.`' value='' />\n<parameter name='`root-tunnels-list_length`' value='0' />\n<parameter name='`roottunsidx`' value='0' />\n",
        "comments": "",
        "x": 1011,
        "y": 84,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "88772a4.9b58658",
        "type": "execute",
        "name": "execute properties",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.prop.PropertiesNode' method='readProperties' >\n    <parameter name='fileName' value='%SDNC_CONFIG_DIR%/generic-resource-api-dg.properties' />\n    <parameter name='contextPrefix' value='prop' />",
        "comments": "",
        "outputs": 1,
        "x": 1042,
        "y": 185,
        "z": "5a4cb919.dfff38",
        "wires": [
            []
        ]
    },
    {
        "id": "4ace150.4554dec",
        "type": "save",
        "name": "get service-instance from aai",
        "xml": "<!--<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" -->\n<!--\tresource=\"service-instance\"-->\n<!--\tkey='service-instance.service-instance-id = $service-data.vnfs.vnf[$tmp.vidx].vnf-data.service-information.service-instance-id-->\n<!--         AND customer.global-customer-id = $service-data.vnfs.vnf[$tmp.vidx].vnf-data.service-information.global-customer-id -->\n<!--         AND service-subscription.service-type = $service-data.vnfs.vnf[$tmp.vidx].vnf-data.service-information.subscription-service-type'-->\n<!--\tlocal-only=\"false\"-->\n<!--\tforce=\"true\" pfx=\"tmp.aai.service-instance\">-->\n\n<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"service-instance\"\n\tkey='service-instance.service-instance-id = $vnf-topology-operation-input.service-information.service-instance-id\n         AND customer.global-customer-id = $vnf-topology-operation-input.service-information.global-customer-id \n         AND service-subscription.service-type = $vnf-topology-operation-input.service-information.subscription-service-type'\n\tlocal-only=\"false\"\n\tforce=\"true\" pfx=\"tmp.aai.service-instance\">\n\n\n<!--$vnf-topology-operation-input.service-information.service-instance-id-->",
        "comments": "",
        "outputs": 1,
        "x": 252,
        "y": 660,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "ce4ab0d3.b836a",
                "9dbee6c6.1a60a",
                "290803ec.65c94c"
            ]
        ]
    },
    {
        "id": "ce4ab0d3.b836a",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 471,
        "y": 598,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "280015e3.c315e2"
            ]
        ]
    },
    {
        "id": "9dbee6c6.1a60a",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 480.490966796875,
        "y": 640.5740356445312,
        "z": "5a4cb919.dfff38",
        "wires": [
            []
        ]
    },
    {
        "id": "290803ec.65c94c",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 469,
        "y": 687,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "f842cdf9.29a79"
            ]
        ]
    },
    {
        "id": "280015e3.c315e2",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for index='rel-index' start='0' end='`$tmp.aai.service-instance.relationship-list.relationship_length`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 668,
        "y": 594,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "cd508bdd.302a88"
            ]
        ]
    },
    {
        "id": "f842cdf9.29a79",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
        "comments": "",
        "x": 638,
        "y": 688,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "cd508bdd.302a88",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.aai.service-instance.relationship-list.relationship[$rel-index].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 891.33349609375,
        "y": 593.9999389648438,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "d4df8e14.56fc08"
            ]
        ]
    },
    {
        "id": "d4df8e14.56fc08",
        "type": "outcome",
        "name": "connectivity",
        "xml": "<outcome value='connectivity'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1092.0001335144043,
        "y": 595.000020980835,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "b67eb6e5.58b31"
            ]
        ]
    },
    {
        "id": "b67eb6e5.58b31",
        "type": "save",
        "name": "get connectivity from aai",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"connectivity\"\n\t    key=\"connectivity.connectivity-id = $tmp.aai.service-instance.relationship-list.relationship[$rel-index].relationship-data[0].relationship-value\"\n\t\tlocal-only=\"false\" \n\t\tpfx=\"tmp.aai.connectivity\" >\n",
        "comments": "",
        "outputs": 1,
        "x": 222,
        "y": 857,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "eb910f68.8a5408",
                "a6536ba8.c4e148",
                "6d1288a7.3722b8"
            ]
        ]
    },
    {
        "id": "eb910f68.8a5408",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 430,
        "y": 821,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "6687da8.fb06ca4"
            ]
        ]
    },
    {
        "id": "a6536ba8.c4e148",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 430.490966796875,
        "y": 866.5740356445312,
        "z": "5a4cb919.dfff38",
        "wires": [
            []
        ]
    },
    {
        "id": "6d1288a7.3722b8",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 428,
        "y": 910,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "a3e6b31.4b2495"
            ]
        ]
    },
    {
        "id": "a3e6b31.4b2495",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
        "comments": "",
        "x": 597,
        "y": 911,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "64de189c.ea0ca",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for silentFailure='true' index='cridx' start='0' end='`$tmp.aai.connectivity.relationship-list.relationship_length`' >\n\n",
        "comments": "",
        "outputs": 1,
        "x": 569,
        "y": 1405,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "f09d5f3a.90b09"
            ]
        ]
    },
    {
        "id": "f09d5f3a.90b09",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.aai.connectivity.relationship-list.relationship[$cridx].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 772,
        "y": 1417,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "be069a3d.2f258"
            ]
        ]
    },
    {
        "id": "be069a3d.2f258",
        "type": "outcome",
        "name": "UNI",
        "xml": "<outcome value='uni'>\n",
        "comments": "",
        "outputs": 1,
        "x": 938,
        "y": 1414,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "b33327bf.cf44b8"
            ]
        ]
    },
    {
        "id": "b33327bf.cf44b8",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 1099,
        "y": 1411,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "9b6250ff.75cf18",
                "6e8e9c3e.00f634",
                "db16830a.f6a5",
                "611e4d54.277574",
                "c0f4e533.035be8",
                "ee82569c.a25768"
            ]
        ]
    },
    {
        "id": "6e8e9c3e.00f634",
        "type": "set",
        "name": "unset tmp.aai.uni",
        "xml": "<set>\n<parameter name='tmp.aai.uni.' value='' />\n",
        "comments": "",
        "x": 1305,
        "y": 1010.9999389648438,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "9b6250ff.75cf18",
        "type": "save",
        "name": "get uni from aai",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"uni\"\n\t    key=\"uni.id = $tmp.aai.connectivity.relationship-list.relationship[$cridx].relationship-data[0].relationship-value\"\n\t\tlocal-only=\"false\" \n\t\tpfx=\"tmp.aai.uni\" >\n",
        "comments": "",
        "outputs": 1,
        "x": 1302,
        "y": 1055.9999389648438,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "1b290eb5.e974c9",
                "b84573d.a8be19",
                "ef2334eb.3c1b68"
            ]
        ]
    },
    {
        "id": "b84573d.a8be19",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1497.490966796875,
        "y": 1029.5739135742188,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "45bb14a8.1a7924"
            ]
        ]
    },
    {
        "id": "ef2334eb.3c1b68",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1493,
        "y": 1073.9998779296875,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "cd1f6950.fef1f"
            ]
        ]
    },
    {
        "id": "45bb14a8.1a7924",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.l3vpn.pe1_id`\" />\n\n",
        "comments": "",
        "x": 1660.0625,
        "y": 1028.859619140625,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "cd1f6950.fef1f",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
        "comments": "",
        "x": 1661,
        "y": 1073.9998779296875,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "cd4af41f.be1a78",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 1663,
        "y": 1120.9998779296875,
        "z": "5a4cb919.dfff38",
        "wires": [
            []
        ]
    },
    {
        "id": "1b290eb5.e974c9",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1494,
        "y": 1120.9998779296875,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "cd4af41f.be1a78"
            ]
        ]
    },
    {
        "id": "60f7024f.a382fc",
        "type": "comment",
        "name": "CLL new",
        "info": "construct two array structures like these:\n\n${otn-tunnels-name-list[${1}].otn-tunnel-name}\n\n----------------\n${ethernet-srv-end-points-list[${1}].ethernet-end-point-name}\n${ethernet-srv-end-points-list[${1}].index-number},\n${ethernet-srv-end-points-list[${1}].eth-node-id},\n${ethernet-srv-end-points-list[${1}].eth-node-tp-id},\n${ethernet-srv-end-points-list[${1}].leafOrRootAccess}\n${ethernet-srv-end-points-list[${1}].cvlan}\n${ethernet-srv-end-points-list[${1}].CIR}\n${ethernet-srv-end-points-list[${1}].EIR}",
        "comments": "",
        "x": 1276,
        "y": 1642,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "db16830a.f6a5",
        "type": "set",
        "name": "set ethernet-srv-end-points-list array",
        "xml": "<set>\n<!--<parameter name='`ethernet-srv-end-points-list[$epidx].ethernet-end-point-name`' value='`$tmp.aai.connectivity.connectivity-id`' />-->\n<parameter name='`ethernet-srv-end-points-list[$epidx].ethernet-end-point-name`' value='`$tmp.aai.uni.id`' />\n<parameter name='`ethernet-srv-end-points-list[$epidx].index-number`' value='0' />\n<parameter name='`ethernet-srv-end-points-list[$epidx].eth-node-id`' value='`$tmp.uni-node-id-short`' />\n<parameter name='`ethernet-srv-end-points-list[$epidx].eth-node-tp-id`' value='`$tmp.aai.uni.tp-id`' />\n<parameter name='`ethernet-srv-end-points-list[$epidx].leafOrRootAccess`' value='`$leafOrRootAccess`' />\n<parameter name='`ethernet-srv-end-points-list[$epidx].cvlan`' value='`$tmp.aai.connectivity.cvlan`' />\n<parameter name='`ethernet-srv-end-points-list[$epidx].CIR`' value='`$tmp.aai.uni.data-source * 1000000`' />\n<parameter name='`ethernet-srv-end-points-list[$epidx].EIR`' value='`$tmp.aai.uni.data-source * 1000000`' />\n\n<parameter name='`ethernet-srv-end-points-list_length`' value='`$epidx + 1`' />\n",
        "comments": "",
        "x": 1367,
        "y": 1696,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "1989ebd9.8b76bc",
        "type": "set",
        "name": "unset ethernet-srv-end-points-list",
        "xml": "<set>\n<parameter name='`ethernet-srv-end-points-list.`' value='' />\n<parameter name='`ethernet-srv-end-points-list_length`' value='0' />\n<parameter name='`epidx`' value='0' />",
        "comments": "",
        "x": 2043.5,
        "y": 1109,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "9da50ff.0241af",
        "type": "set",
        "name": "unset ethernet-srv-end-points-list",
        "xml": "<set>\n<parameter name='`ethernet-srv-end-points-list.`' value='' />\n<parameter name='`ethernet-srv-end-points-list_length`' value='0' />\n<parameter name='`epidx`' value='0' />",
        "comments": "",
        "x": 2048.5,
        "y": 1211,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "eda2f0f7.d8fb38",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for silentFailure='true' index='cridx' start='0' end='`$tmp.aai.connectivity.relationship-list.relationship_length`' >\n\n",
        "comments": "",
        "outputs": 1,
        "x": 532,
        "y": 1661,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "62852429.1f30ac"
            ]
        ]
    },
    {
        "id": "62852429.1f30ac",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.aai.connectivity.relationship-list.relationship[$cridx].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 764,
        "y": 1660,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "ede4a749.9f1af8"
            ]
        ]
    },
    {
        "id": "ede4a749.9f1af8",
        "type": "outcome",
        "name": "vpn-binding",
        "xml": "<outcome value='vpn-binding'>\n",
        "comments": "",
        "outputs": 1,
        "x": 976,
        "y": 1661,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "b699a292.eb6f88"
            ]
        ]
    },
    {
        "id": "b699a292.eb6f88",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 232,
        "y": 1817,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "13d7e483.3188fb",
                "74bc3a8f.9628d4"
            ]
        ]
    },
    {
        "id": "74bc3a8f.9628d4",
        "type": "set",
        "name": "unset tmp.aai.vpn-binding",
        "xml": "<set>\n<parameter name='tmp.aai.vpn-binding.' value='' />\n",
        "comments": "",
        "x": 467,
        "y": 1804,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "13d7e483.3188fb",
        "type": "save",
        "name": "get vpn-binding from aai",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"vpn-binding\"\n\t    key=\"vpn-binding.vpn-id = $tmp.aai.connectivity.relationship-list.relationship[$cridx].relationship-data[0].relationship-value\"\n\t\tlocal-only=\"false\" \n\t\tpfx=\"tmp.aai.vpn-binding\" >\n",
        "comments": "",
        "outputs": 1,
        "x": 457,
        "y": 1865,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "bcef8cd9.e20998",
                "764e27eb.b5496",
                "21958602.3fa0ea"
            ]
        ]
    },
    {
        "id": "764e27eb.b5496",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 670.490966796875,
        "y": 1849.5740356445312,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "9c812de2.87639"
            ]
        ]
    },
    {
        "id": "21958602.3fa0ea",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 666,
        "y": 1894,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "2915d3a6.63730c"
            ]
        ]
    },
    {
        "id": "bcef8cd9.e20998",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 668,
        "y": 1954,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "bb26f0d0.bc6288"
            ]
        ]
    },
    {
        "id": "9c812de2.87639",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.l3vpn.pe1_id`\" />\n\n",
        "comments": "",
        "x": 833.0625,
        "y": 1848.8597412109375,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "2915d3a6.63730c",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
        "comments": "",
        "x": 834,
        "y": 1894,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "bb26f0d0.bc6288",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 837,
        "y": 1953,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "e8fb0469.22a408",
                "b503b0ba.b1ff6"
            ]
        ]
    },
    {
        "id": "445d8bb1.6c470c",
        "type": "set",
        "name": "set sotn_value",
        "xml": "<set>\n<!--<parameter name='eth-service-name' value='`$tmp.aai.connectivityA.connectivity-id`' />-->\n<parameter name='eth-service-name' value='`$tmp.aai.connectivity.etht-svc-name`' />\n<parameter name='slice-id' value='`$vnf-topology-operation-input.service-information.service-instance-id`' />\n<parameter name='provider-id' value='`$tmp.aai.connectivity.access-provider-id`' />\n<parameter name='client-id' value='`$tmp.aai.connectivity.access-client-id`' />\n<parameter name='topology-id' value='`$tmp.aai.connectivity.access-topology-id`' />\n<!--<parameter name='otn-tunnel-name' value='`$tmp.aai.vpn-bindingA.vpn-name`' />-->\n<!--<parameter name='ethernet-end-point-name' value='`$tmp.aai.connectivityA.connectivity-id`' />-->\n<!--<parameter name='index-number' value='0' />-->\n<!--<parameter name='eth-node-id' value='`$tmp.aai.connectivityA.access-node-id`' />-->\n<!--<parameter name='eth-node-tp-id' value='`$tmp.aai.connectivityA.access-ltp-id`' />-->\n<!--<parameter name='CIR' value='`$tmp.aai.vpn-bindingA.route-distinguisher *1000000`' />-->\n<!--<parameter name='EIR' value='`$tmp.aai.vpn-bindingA.route-distinguisher *1000000`' />-->\n<!--<parameter name='cvlan' value='`$tmp.aai.connectivityA.cvlan`' />-->\n",
        "comments": "",
        "x": 236,
        "y": 2452,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "925823e9.1c4a4",
        "type": "execute",
        "name": "execute RestApiCallNode Create ethernet Service without token",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.cll-ethernet-service-loop.templatefile`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainConn.url + '/restconf/data/ietf-eth-tran-service:etht-svc'`\" />\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.restapi.connection-oof-url`\" />-->\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainConn.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainConn.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"patch\"/>\n<parameter name='dirPath' value=\"/opt/onap/sdnc/restconfapi/yang\" />\n<parameter name=\"responsePrefix\" value=\"vpn-result\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n",
        "comments": "",
        "outputs": 1,
        "x": 379,
        "y": 2512,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "345842a4.88ef2e",
                "a4dc32a8.6620d8"
            ]
        ]
    },
    {
        "id": "345842a4.88ef2e",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 691.5,
        "y": 2489,
        "z": "5a4cb919.dfff38",
        "wires": [
            []
        ]
    },
    {
        "id": "a4dc32a8.6620d8",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 695.5,
        "y": 2529,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "d1fda3bb.92b0e"
            ]
        ]
    },
    {
        "id": "cde1b667.7c4d6",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create ethernet service rest api\" />\n",
        "comments": "",
        "x": 871.5,
        "y": 2493,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "d1fda3bb.92b0e",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 887,
        "y": 2547,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "a9ee92c3.93f6e8"
            ]
        ]
    },
    {
        "id": "459839ba.ae33c",
        "type": "save",
        "name": "update vpn-binding resource (aka. OTN ) in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding' \n      key='vpn-binding.vpn-id = $tmp.aai.vpn-binding.vpn-id' >\n<parameter name='vpn-id' value='`$tmp.aai.vpn-binding.vpn-id`' />\n<parameter name='vpn-name' value='`$tmp.aai.vpn-binding.vpn-name`' />\n\n<parameter name='operational-status' value='Activated' />\n",
        "comments": "",
        "outputs": 1,
        "x": 1182.5,
        "y": 2516,
        "z": "5a4cb919.dfff38",
        "wires": [
            []
        ]
    },
    {
        "id": "120147ed.79206",
        "type": "comment",
        "name": "TODO: FIXME",
        "info": "use proper vpn-binding id and connectivity id\n\nAlso, does CCSDK support \"update\" operation for vpn-binding and connectivity?",
        "comments": "",
        "x": 2649.5,
        "y": 1867,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "a9ee92c3.93f6e8",
        "type": "save",
        "name": "update connectivity resource in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='connectivity' \n      key='connectivity.connectivity-id = $tmp.aai.connectivity.connectivity-id'>\n<parameter name='connectivity-id' value='`$tmp.aai.connectivity.connectivity-id`' />\n<parameter name='operational-status' value='Activated' />\n",
        "comments": "",
        "outputs": 1,
        "x": 1144.5,
        "y": 2558,
        "z": "5a4cb919.dfff38",
        "wires": [
            []
        ]
    },
    {
        "id": "9d25e547.75567",
        "type": "set",
        "name": "set leafOrRootAccess",
        "xml": "<set>\n<parameter name='`leafOrRootAccess`' value='ietf-eth-tran-types:leaf-access' />\n",
        "comments": "",
        "x": 2009.5,
        "y": 1147,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "52a255e0.e77dec",
        "type": "set",
        "name": "set leafOrRootAccess",
        "xml": "<set>\n<parameter name='`leafOrRootAccess`' value='ietf-eth-tran-types:root-primary' />\n",
        "comments": "",
        "x": 2010.5,
        "y": 1251,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "881b2d7a.c4e888",
        "type": "save",
        "name": "update vpn-binding A resource (aka. OTN domainA) in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding' \n      key='vpn-binding.vpn-id = $tmp.aai.vpn-bindingA.vpn-id' >\n<parameter name='vpn-id' value='`$tmp.aai.vpn-bindingA.vpn-id`' />\n<parameter name='vpn-name' value='`$tmp.aai.vpn-bindingA.vpn-name`' />\n\n<parameter name='operational-status' value='Activated' />\n",
        "comments": "",
        "outputs": 1,
        "x": 4304,
        "y": 508,
        "z": "5a4cb919.dfff38",
        "wires": [
            []
        ]
    },
    {
        "id": "61ff745d.2cf8b4",
        "type": "save",
        "name": "update vpn-binding G resource (aka. OTN domainA) in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding' \n      key='vpn-binding.vpn-id = $tmp.aai.vpn-bindingG.vpn-id' >\n<parameter name='vpn-id' value='`$tmp.aai.vpn-bindingG.vpn-id`' />\n<parameter name='vpn-name' value='`$tmp.aai.vpn-bindingG.vpn-name`' />\n\n<parameter name='operational-status' value='Activated' />\n",
        "comments": "",
        "outputs": 1,
        "x": 4207,
        "y": 1327,
        "z": "5a4cb919.dfff38",
        "wires": [
            []
        ]
    },
    {
        "id": "98331ea2.d141f",
        "type": "save",
        "name": "update vpn-binding B resource (aka. OTN domainB) in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding' \n      key='vpn-binding.vpn-id = $tmp.aai.vpn-bindingB.vpn-id' >\n<parameter name='vpn-id' value='`$tmp.aai.vpn-bindingB.vpn-id`' />\n<parameter name='vpn-name' value='`$tmp.aai.vpn-bindingB.vpn-name`' />\n\n<parameter name='operational-status' value='Activated' />\n",
        "comments": "",
        "outputs": 1,
        "x": 3701,
        "y": 1999,
        "z": "5a4cb919.dfff38",
        "wires": [
            []
        ]
    },
    {
        "id": "6687da8.fb06ca4",
        "type": "switchNode",
        "name": "switch connectivity is not already Activated (i.e. is either Created or Modified)",
        "xml": "<switch test=\"`$tmp.aai.connectivity.operational-status != 'Activated' `\">\n",
        "comments": "",
        "outputs": 1,
        "x": 802,
        "y": 807,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "11a4a5f5.385f32",
                "192499d2.667f1e"
            ]
        ]
    },
    {
        "id": "11a4a5f5.385f32",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1165,
        "y": 830,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "1fc9c5be.8fac2a"
            ]
        ]
    },
    {
        "id": "192499d2.667f1e",
        "type": "outcomeFalse",
        "name": "false",
        "xml": "<outcome value='false'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1165,
        "y": 779,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "5fe8520c.50e664"
            ]
        ]
    },
    {
        "id": "1fc9c5be.8fac2a",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 1321,
        "y": 828,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "a46faf22.6dbda8"
            ]
        ]
    },
    {
        "id": "5fe8520c.50e664",
        "type": "block",
        "name": "block",
        "xml": "<block>",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 1298,
        "y": 780,
        "z": "5a4cb919.dfff38",
        "wires": [
            []
        ]
    },
    {
        "id": "1f9b767f.d670b2",
        "type": "set",
        "name": "unset tmp.aai.vpn-binding",
        "xml": "<set>\n<parameter name='tmp.aai.vpn-binding.' value=\"\" />\n",
        "comments": "",
        "x": 2058,
        "y": 178,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "f84de17e.e8ea08",
        "type": "set",
        "name": "set root-otn-tunnels-list array",
        "xml": "<set>\n<parameter name='`roottunsidx`' value='`$roottunsidx + 1`' />\n",
        "comments": "",
        "x": 3600,
        "y": 2159,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "1a392cd7.238923",
        "type": "set",
        "name": "set leaf-otn-tunnels-list array",
        "xml": "<set>\n<parameter name='`leaftunsidx`' value='`$leaftunsidx + 1`' />\n",
        "comments": "",
        "x": 4190,
        "y": 632,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "611e4d54.277574",
        "type": "set",
        "name": "set ethernet-srv-end-points-list array",
        "xml": "<set>\n<parameter name='`epidx`' value='`$epidx + 1`' />\n",
        "comments": "",
        "x": 1364,
        "y": 1738,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "dc7d7df9.afb81",
        "type": "set",
        "name": "set filename",
        "xml": "<set>\n<parameter name='filenameclleths' value=\"`$leafOrRootAccess + $tmp.aai.connectivity.access-node-id`\" />",
        "comments": "",
        "x": 543,
        "y": 1472,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "c70f6326.e297a",
        "type": "execute",
        "name": "execute printContext",
        "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='printContext' >\n    <parameter name=\"filename\" value=\"`$filenameclleths`\" />\n",
        "comments": "",
        "outputs": 1,
        "x": 574,
        "y": 1512,
        "z": "5a4cb919.dfff38",
        "wires": [
            []
        ]
    },
    {
        "id": "e8fb0469.22a408",
        "type": "set",
        "name": "set otn-tunnels-name-list array",
        "xml": "<set>\n<parameter name='`otn-tunnels-name-list[$otntunsidx].otn-tunnel-name`' value='`$tmp.aai.vpn-binding.vpn-name`' />\n<parameter name='`otn-tunnels-name-list[$otntunsidx].vpn-id`' value='`$tmp.aai.vpn-binding.vpn-id`' />\n<parameter name='`otn-tunnels-name-list_length`' value='`$otntunsidx + 1`' />\n",
        "comments": "",
        "x": 1122,
        "y": 1920,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "b503b0ba.b1ff6",
        "type": "set",
        "name": "set otn-tunnels-name-list array",
        "xml": "<set>\n<parameter name='`otntunsidx`' value='`$otntunsidx + 1`' />\n",
        "comments": "",
        "x": 1125,
        "y": 1962,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "f7d70d92.8a17d",
        "type": "set",
        "name": "unset otn-tunnels-name-list array",
        "xml": "<set>\n<parameter name='`otn-tunnels-name-list.`' value='' />\n<parameter name='`otn-tunnels-name-list_length`' value='0' />\n<parameter name='`otntunsidx`' value='0' />\n",
        "comments": "",
        "x": 568,
        "y": 1602,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "93ecab9f.5bb27",
        "type": "set",
        "name": "set filename",
        "xml": "<set>\n<parameter name='filenamecllotns' value=\"`leafrootOTNtunnelnames`\" />",
        "comments": "",
        "x": 323,
        "y": 1981,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "e1bf516d.80132",
        "type": "execute",
        "name": "execute printContext",
        "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='printContext' >\n    <parameter name=\"filename\" value=\"`$filenamecllotns`\" />\n",
        "comments": "",
        "outputs": 1,
        "x": 331,
        "y": 2038,
        "z": "5a4cb919.dfff38",
        "wires": [
            []
        ]
    },
    {
        "id": "c0f4e533.035be8",
        "type": "execute",
        "name": "execute split tp-id to get pnf-name",
        "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='split' >\n<parameter name=\"original_string\" value='`$tmp.aai.uni.id`'/>\n<!--<parameter name=\"regex\" value=\"[^-]+$\"/>-->\n<parameter name=\"regex\" value=\"[-]+\"/>\n<parameter name=\"ctx_memory_result_key\" value=\"param-prefix-uni\"/>\n\n",
        "comments": "",
        "outputs": 1,
        "x": 1342,
        "y": 1587,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "ff9a5641.69fda",
                "a44c9ce4.5d2008"
            ]
        ]
    },
    {
        "id": "a44c9ce4.5d2008",
        "type": "failure",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1565,
        "y": 1542,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "eaca171f.944a48"
            ]
        ]
    },
    {
        "id": "ff9a5641.69fda",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1567,
        "y": 1606,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "93d69fa.52d496"
            ]
        ]
    },
    {
        "id": "eaca171f.944a48",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 1730,
        "y": 1539,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "b0447236.92d3b"
            ]
        ]
    },
    {
        "id": "93d69fa.52d496",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value=\"An error occured while splitting sna1_route\" />\n",
        "comments": "",
        "x": 1729,
        "y": 1602,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "b0447236.92d3b",
        "type": "set",
        "name": "set tmp.uni-node-id-short",
        "xml": "<set>\n<parameter name='tmp.uni-node-id-short' value='`$param-prefix-uni[$param-prefix-uni_length -4]`' />\n",
        "comments": "",
        "x": 1950,
        "y": 1553,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "ab15b7a9.bc6bc8",
        "type": "outcome",
        "name": "esr-thirdparty-sdnc",
        "xml": "<outcome value='esr-thirdparty-sdnc'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1495,
        "y": 2278,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "be2440af.c20c98"
            ]
        ]
    },
    {
        "id": "1405448e.40f263",
        "type": "execute",
        "name": "get esr-thirdparty-sdnc",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"esr-thirdparty-sdnc\" \n\t\tkey=\"esr-thirdparty-sdnc.thirdparty-sdnc-id = $tmp.domainConn.esr-thirdparty-id AND \n\t\t     depth = '1'\"\n        pfx='tmp.aai.domainConn.esr-thirdparty-sdnc' local-only='false' >",
        "comments": "",
        "outputs": 1,
        "x": 1880,
        "y": 2291,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "facba133.b01618",
                "36457cd.f85a104",
                "a0c24437.cf174"
            ]
        ]
    },
    {
        "id": "be2440af.c20c98",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 1674,
        "y": 2278,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "eec40e11.9fdab",
                "1405448e.40f263"
            ]
        ]
    },
    {
        "id": "eec40e11.9fdab",
        "type": "set",
        "name": "set esr-thirdparty-sdnc domainConn id",
        "xml": "<set>\n<parameter name='tmp.domainConn.esr-thirdparty-id' value=\"`$tmp.aai.source-pnf.relationship-list.relationship[$spvidx].relationship-data[0].relationship-value`\" />\n",
        "comments": "",
        "x": 1910,
        "y": 2239,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "facba133.b01618",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2090,
        "y": 2282,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "926a046d.eed228"
            ]
        ]
    },
    {
        "id": "36457cd.f85a104",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2082,
        "y": 2337,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "6ca22053.c9fba8"
            ]
        ]
    },
    {
        "id": "a0c24437.cf174",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2087,
        "y": 2394,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "f91dd017.676d7"
            ]
        ]
    },
    {
        "id": "f91dd017.676d7",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 2239,
        "y": 2395,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "6ca22053.c9fba8",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 2250,
        "y": 2340,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "926a046d.eed228",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 2234.38232421875,
        "y": 2279.6556701660156,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "1e25e04f.ee7df"
            ]
        ]
    },
    {
        "id": "1e25e04f.ee7df",
        "type": "set",
        "name": "set controller domainConn data",
        "xml": "<set>\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainConn.url' value=\"`$tmp.aai.domainConn.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].service-url`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainConn.user' value=\"`$tmp.aai.domainConn.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].user-name`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainConn.password' value=\"`$tmp.aai.domainConn.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].password`\" />\n\n\n<!--<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >-->\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/restconf/data/ietf-network:networks'`\" />-->\n<!--<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />-->\n<!--<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />-->\n<!--<parameter name=\"format\" value=\"json\"/>-->\n<!--<parameter name=\"httpMethod\" value=\"get\"/>-->\n<!--<parameter name=\"responsePrefix\" value=\"topology\"/>-->\n<!--<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>-->\n<!--<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>-->\n<!--<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>-->\n<!--<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>-->\n",
        "comments": "",
        "x": 2449,
        "y": 2276,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "46842cb8.91c5bc",
        "type": "get-resource",
        "name": "get-resource src pnf",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"pnf\" \n\t\tkey=\"pnf.pnf-name = $tmp.pnf-name-forUrl\"\n        pfx='tmp.aai.source-pnf' local-only='false' >\n\n        <!--AND depth = '0'\"-->\n",
        "comments": "",
        "outputs": 1,
        "x": 573,
        "y": 2324,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "80e94eed.70f82",
                "e1101309.b00428",
                "6cefa506.12a2dc"
            ]
        ]
    },
    {
        "id": "80e94eed.70f82",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 768.5001220703125,
        "y": 2276,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "a961cabf.5d77d8"
            ]
        ]
    },
    {
        "id": "e1101309.b00428",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 760.5001220703125,
        "y": 2331,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "cfce6a08.8d1818"
            ]
        ]
    },
    {
        "id": "a961cabf.5d77d8",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 912.8824462890625,
        "y": 2275.6556701660156,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "41f5578e.096c08"
            ]
        ]
    },
    {
        "id": "41f5578e.096c08",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for silentFailure='true' index='spvidx' start='0' end='`$tmp.aai.source-pnf.relationship-list.relationship_length`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 1097,
        "y": 2274,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "78702bad.3695f4"
            ]
        ]
    },
    {
        "id": "78702bad.3695f4",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.aai.source-pnf.relationship-list.relationship[$spvidx].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1292,
        "y": 2274,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "ab15b7a9.bc6bc8"
            ]
        ]
    },
    {
        "id": "6cefa506.12a2dc",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 765.5001220703125,
        "y": 2388,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "bbb236e9.1d475"
            ]
        ]
    },
    {
        "id": "bbb236e9.1d475",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 917.5001220703125,
        "y": 2389,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "cfce6a08.8d1818",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 928.5001220703125,
        "y": 2332,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "fd11a034.71ffe8",
        "type": "set",
        "name": "set tmp.pnf-name-forUrl",
        "xml": "<set>\n\n<parameter name='tmp.pnf-name-forUrl' value=\"`'networkId-providerId-' +\n                                                   $tmp.aai.connectivity.access-provider-id + '-clientId-' +\n                                                   $tmp.aai.connectivity.access-client-id + '-topologyId-' +\n                                                   $tmp.aai.connectivity.access-topology-id + '-nodeId-' +\n                                                   $tmp.aai.connectivity.access-node-id`\" />\n",
        "comments": "",
        "x": 563,
        "y": 2236,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "2ab715a0.ab46a2",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 308,
        "y": 2367,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "fd11a034.71ffe8",
                "46842cb8.91c5bc"
            ]
        ]
    },
    {
        "id": "c68339b5.636678",
        "type": "comment",
        "name": "Temporary skipping this check - to support multiple instances in one slice",
        "info": "",
        "comments": "",
        "x": 1522.9666748046875,
        "y": 184.88333129882812,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "6b1a691d.f6617",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
        "comments": "",
        "x": 725,
        "y": 407,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "a46faf22.6dbda8",
        "type": "block",
        "name": "block",
        "xml": "<block>",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 284.5,
        "y": 1376,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "64de189c.ea0ca",
                "eda2f0f7.d8fb38",
                "dc7d7df9.afb81",
                "c70f6326.e297a",
                "445d8bb1.6c470c",
                "925823e9.1c4a4",
                "f7d70d92.8a17d",
                "93ecab9f.5bb27",
                "e1bf516d.80132",
                "2ab715a0.ab46a2"
            ]
        ]
    },
    {
        "id": "ee82569c.a25768",
        "type": "switchNode",
        "name": "switch uni type",
        "xml": "<switch test=\"`$tmp.aai.uni.type`\">\n\n",
        "comments": "",
        "outputs": 1,
        "x": 1315,
        "y": 1214,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "ef11d348.e67b18",
                "db4eac49.9ee78",
                "ccd7386e.438c4",
                "8a1e26c1.925918"
            ]
        ]
    },
    {
        "id": "ef11d348.e67b18",
        "type": "outcome",
        "name": "leaf",
        "xml": "<outcome value='leaf'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1480,
        "y": 1196,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "1989ebd9.8b76bc",
                "9d25e547.75567"
            ]
        ]
    },
    {
        "id": "db4eac49.9ee78",
        "type": "outcome",
        "name": "root",
        "xml": "<outcome value='root'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1483,
        "y": 1235,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "9da50ff.0241af",
                "52a255e0.e77dec"
            ]
        ]
    },
    {
        "id": "8a1e26c1.925918",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1477,
        "y": 1313,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "af3eb285.34bda8"
            ]
        ]
    },
    {
        "id": "ccd7386e.438c4",
        "type": "outcome",
        "name": "root-secondary",
        "xml": "<outcome value='root-secondary'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1500,
        "y": 1276,
        "z": "5a4cb919.dfff38",
        "wires": [
            [
                "8dd3ee03.704618",
                "3acf3b0f.3b0184"
            ]
        ]
    },
    {
        "id": "8dd3ee03.704618",
        "type": "set",
        "name": "unset ethernet-srv-end-points-list",
        "xml": "<set>\n<parameter name='`ethernet-srv-end-points-list.`' value='' />\n<parameter name='`ethernet-srv-end-points-list_length`' value='0' />\n<parameter name='`epidx`' value='0' />",
        "comments": "",
        "x": 2046,
        "y": 1309,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "3acf3b0f.3b0184",
        "type": "set",
        "name": "set leafOrRootAccess",
        "xml": "<set>\n<parameter name='`leafOrRootAccess`' value='ietf-eth-tran-types:root-secondary' />\n",
        "comments": "",
        "x": 2008,
        "y": 1349,
        "z": "5a4cb919.dfff38",
        "wires": []
    },
    {
        "id": "af3eb285.34bda8",
        "type": "block",
        "name": "block",
        "xml": "<block>",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 1629,
        "y": 1334,
        "z": "5a4cb919.dfff38",
        "wires": [
            []
        ]
    }
]