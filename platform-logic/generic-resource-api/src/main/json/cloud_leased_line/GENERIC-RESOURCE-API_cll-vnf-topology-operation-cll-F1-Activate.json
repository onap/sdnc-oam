[
    {
        "id": "4a53e986.e1345",
        "type": "save",
        "name": "get all-vpn-bindings from aai",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"vpn-bindings\"\n\t    key=\"selflink = 'https://aai.onap:8443/aai/v24/network/vpn-bindings\"\n\t\tlocal-only=\"false\" \n\t\tpfx=\"tmp.aai.all-vpn-bindings\" >\n",
        "comments": "",
        "outputs": 1,
        "x": 401.8833312988281,
        "y": 341,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "bee28b81.87faf8",
                "2e0d3206.b3958e",
                "2caa6605.779652"
            ]
        ]
    },
    {
        "id": "bee28b81.87faf8",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 589.8833312988281,
        "y": 354,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "db2a2eb9.c4729"
            ]
        ]
    },
    {
        "id": "2e0d3206.b3958e",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 597.374267578125,
        "y": 396.57403564453125,
        "z": "db287b1f.2984a8",
        "wires": [
            []
        ]
    },
    {
        "id": "2caa6605.779652",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 587.8833312988281,
        "y": 443,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "9a0e1ef7.428b9"
            ]
        ]
    },
    {
        "id": "db2a2eb9.c4729",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 762.8833312988281,
        "y": 352,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "b1233538.ceab4"
            ]
        ]
    },
    {
        "id": "b1233538.ceab4",
        "type": "for",
        "name": "for vpnidx in all-vpn-bindings",
        "xml": "<for index='vpnbidx' start='0' end='`$tmp.aai.all-vpn-bindings.vpn-binding_length`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 991.8833312988281,
        "y": 353,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "f68da0c8.dc2638"
            ]
        ]
    },
    {
        "id": "f68da0c8.dc2638",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic='true'>",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 1206.8833312988281,
        "y": 354,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "947d4965.a799f8"
            ]
        ]
    },
    {
        "id": "ab775a4c.a509d",
        "type": "switchNode",
        "name": "switch vpnuuid is for this slice",
        "xml": "<!--<switch test=\"`$tmp.slicevpnuuids[$tmp.aai.all-vpn-bindings.vpn-binding[$vpnbidx].vpn-id] != '' `\">-->\n\n<!-- Replace vpn-type with slice-id (a new attribbute in the latest AAI) -->\n<switch test=\"`$tmp.aai.all-vpn-bindings.vpn-binding[$vpnbidx].slice-id == $tmp.aai.service-instance.service-instance-id `\">\n\n",
        "comments": "",
        "outputs": 1,
        "x": 1460.8833312988281,
        "y": 276,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "1ae0d7f3.280b18",
                "b7c135fb.7fc808"
            ]
        ]
    },
    {
        "id": "1ae0d7f3.280b18",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1677.8833312988281,
        "y": 255,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "947d4965.a799f8"
            ]
        ]
    },
    {
        "id": "b7c135fb.7fc808",
        "type": "outcomeFalse",
        "name": "false",
        "xml": "<outcome value='false'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1677.8833312988281,
        "y": 304,
        "z": "db287b1f.2984a8",
        "wires": [
            []
        ]
    },
    {
        "id": "947d4965.a799f8",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic='true'>",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 1861.8833312988281,
        "y": 341,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "7307d136.f98668",
                "d6d93ab.df041c8",
                "ed4d0298.cdb578"
            ]
        ]
    },
    {
        "id": "d12da893.5808e",
        "type": "dgstart",
        "name": "DGSTART",
        "outputs": 1,
        "x": 220.88333129882812,
        "y": 82,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "ba22940.68974f"
            ]
        ]
    },
    {
        "id": "ba22940.68974f",
        "type": "service-logic",
        "name": "GENERIC-RESOURCE-API ${project.version}",
        "module": "GENERIC-RESOURCE-API",
        "version": "${project.version}",
        "comments": "",
        "xml": "<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>",
        "outputs": 1,
        "x": 505.1690216064453,
        "y": 143.23810863494873,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "f0aeb23e.8f1f7"
            ]
        ]
    },
    {
        "id": "f0aeb23e.8f1f7",
        "type": "method",
        "name": "method cll-vnf-topology-operation-cll-F1-Activate",
        "xml": "<method rpc='cll-vnf-topology-operation-cll-F1-Activate' mode='sync'>\n",
        "comments": "",
        "outputs": 1,
        "x": 511.3119354248047,
        "y": 228.00003051757812,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "849eab75.e48858"
            ]
        ]
    },
    {
        "id": "849eab75.e48858",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 821.1213684082031,
        "y": 219.66668701171875,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "4a53e986.e1345",
                "9dad0003.283738",
                "47e937a3.3ee608",
                "fa83bc41.1d8b08",
                "39b1b2.d055464e"
            ]
        ]
    },
    {
        "id": "7307d136.f98668",
        "type": "set",
        "name": "set tmp.aai.vpn-binding",
        "xml": "<set>\n<parameter name='tmp.aai.vpn-binding.' value=\"`$tmp.aai.all-vpn-bindings.vpn-binding[$vpnbidx].`\" />\n",
        "comments": "",
        "x": 2078.883331298828,
        "y": 279,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "5be24b21.11ebc4",
        "type": "set",
        "name": "set attachment_param for OTN A",
        "xml": "<set>\n<parameter name='src-node-id' value='`$tmp.aai.vpn-bindingA.src-access-node-id`' />\n<parameter name='dst-node-id' value='`$tmp.aai.vpn-bindingA.dst-access-node-id`' />\n<!--<parameter name='dst-tpn-id' value='1' />-->\n<parameter name='dst-tpn-id' value='`$tmp.aai.vpn-bindingA.customer-vpn-id`' />\n<parameter name='dst-ttp-id' value='`$tmp.aai.vpn-bindingA.dst-access-ltp-id`' />\n<parameter name='slice-instance-id' value='`$tmp.aai.service-instance.service-instance-id`' />\n<parameter name='otn-tunnel-name-src-domain' value='`$tmp.aai.vpn-bindingA.vpn-name`' />\n<parameter name='client-id' value='`$tmp.aai.vpn-bindingA.access-client-id`' />\n<parameter name='provider-id' value='`$tmp.aai.vpn-bindingA.access-provider-id`' />\n<parameter name='topology-id' value='`$tmp.aai.vpn-bindingA.access-topology-id`' />\n",
        "comments": "",
        "x": 4247.883331298828,
        "y": 165,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "66c2f1fa.df4e",
        "type": "execute",
        "name": "execute RestApiCallNode Create OTN tunnel with token",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.cll-otn-src-domain-creation.templatefile`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainA.url + '/restconf/data/ietf-te:te'`\" />\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainA.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainA.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"patch\"/>\n<parameter name=\"responsePrefix\" value=\"otn-oof\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n<parameter name='customHttpHeaders' value=\"`'X-ACCESS-TOKEN=' + $prop.sdncRestApi.token_id`\" />",
        "comments": "",
        "outputs": 1,
        "x": 4328.883331298828,
        "y": 480,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "78ae8a16.bcde6c",
                "163e60b5.f624ef"
            ]
        ]
    },
    {
        "id": "78ae8a16.bcde6c",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4638.383331298828,
        "y": 449,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "a86780cc.869ba"
            ]
        ]
    },
    {
        "id": "163e60b5.f624ef",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4643.383331298828,
        "y": 514,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "496a02d9.361154"
            ]
        ]
    },
    {
        "id": "a86780cc.869ba",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create OTN tunnel rest api\" />\n",
        "comments": "",
        "x": 4814.383331298828,
        "y": 449,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "496a02d9.361154",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 4809.883331298828,
        "y": 514,
        "z": "db287b1f.2984a8",
        "wires": [
            []
        ]
    },
    {
        "id": "4c8b1659.abc1b",
        "type": "set",
        "name": "set sotn_value",
        "xml": "<set>\n<!--<parameter name='eth-service-name' value='`$tmp.aai.connectivityA.connectivity-id`' />-->\n<parameter name='eth-service-name' value='`$tmp.aai.connectivityA.etht-svc-name`' />\n<parameter name='slice-id' value='`$vnf-topology-operation-input.service-information.service-instance-id`' />\n<parameter name='provider-id' value='`$tmp.aai.connectivityA.access-provider-id`' />\n<parameter name='client-id' value='`$tmp.aai.connectivityA.access-client-id`' />\n<parameter name='topology-id' value='`$tmp.aai.connectivityA.access-topology-id`' />\n<parameter name='otn-tunnel-name' value='`$tmp.aai.vpn-bindingA.vpn-name`' />\n<parameter name='ethernet-end-point-name' value='`$tmp.aai.connectivityA.connectivity-id`' />\n<parameter name='index-number' value='0' />\n<parameter name='eth-node-id' value='`$tmp.aai.connectivityA.access-node-id`' />\n<parameter name='eth-node-tp-id' value='`$tmp.aai.connectivityA.access-ltp-id`' />\n<parameter name='CIR' value='`$tmp.aai.vpn-bindingA.route-distinguisher *1000000`' />\n<parameter name='EIR' value='`$tmp.aai.vpn-bindingA.route-distinguisher *1000000`' />\n<parameter name='cvlan' value='`$tmp.aai.connectivityA.cvlan`' />\n",
        "comments": "",
        "x": 4193.383331298828,
        "y": 734,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "902cb9fb.0d496",
        "type": "execute",
        "name": "execute RestApiCallNode Create ethernet Service without token",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.ts-ethernet-service.templatefile`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainA.url + '/restconf/data/ietf-eth-tran-service:etht-svc'`\" />\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.restapi.connection-oof-url`\" />-->\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainA.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainA.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"patch\"/>\n<parameter name='dirPath' value=\"/opt/onap/sdnc/restconfapi/yang\" />\n<parameter name=\"responsePrefix\" value=\"vpn-result\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n",
        "comments": "",
        "outputs": 1,
        "x": 4347.383331298828,
        "y": 782,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "f961065e.0e576",
                "6ca1f611.56dee"
            ]
        ]
    },
    {
        "id": "f961065e.0e576",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4692.883331298828,
        "y": 763,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "6296fab8.967dac"
            ]
        ]
    },
    {
        "id": "6ca1f611.56dee",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4696.883331298828,
        "y": 803,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "ef7067c4.7ea328"
            ]
        ]
    },
    {
        "id": "6296fab8.967dac",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create ethernet service rest api\" />\n",
        "comments": "",
        "x": 4850.883331298828,
        "y": 763,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "ef7067c4.7ea328",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 4854.383331298828,
        "y": 803,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "ee477ca2.a65568",
                "5e527e99.1f4728"
            ]
        ]
    },
    {
        "id": "ee477ca2.a65568",
        "type": "save",
        "name": "update vpn-binding A resource (aka. OTN domainA) in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding' \n      key='vpn-binding.vpn-id = $tmp.aai.vpn-bindingA.vpn-id' >\n<parameter name='vpn-id' value='`$tmp.aai.vpn-bindingA.vpn-id`' />\n<parameter name='vpn-name' value='`$tmp.aai.vpn-bindingA.vpn-name`' />\n\n<parameter name='operational-status' value='Activated' />\n",
        "comments": "",
        "outputs": 1,
        "x": 5184.883331298828,
        "y": 768,
        "z": "db287b1f.2984a8",
        "wires": [
            []
        ]
    },
    {
        "id": "f9d5afb7.0291b",
        "type": "comment",
        "name": "TODO: FIXME",
        "info": "use proper vpn-binding id and connectivity id\n\nAlso, does CCSDK support \"update\" operation for vpn-binding and connectivity?",
        "comments": "",
        "x": 5048.883331298828,
        "y": 727,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "5e527e99.1f4728",
        "type": "save",
        "name": "update connectivity resource in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='connectivity' \n      key='connectivity.connectivity-id = $tmp.aai.connectivityA.connectivity-id'>\n<parameter name='connectivity-id' value='`$tmp.aai.connectivityA.connectivity-id`' />\n<parameter name='operational-status' value='Activated' />\n",
        "comments": "",
        "outputs": 1,
        "x": 5111.883331298828,
        "y": 814,
        "z": "db287b1f.2984a8",
        "wires": [
            []
        ]
    },
    {
        "id": "48c30a65.f0f584",
        "type": "set",
        "name": "set pnf-name",
        "xml": "<set>\n<parameter name='tmp.src.domainA.pnf-name' value=\"`'networkId-providerId-' +\n                                                   $tmp.aai.vpn-bindingA.access-provider-id + '-clientId-' +\n                                                   $tmp.aai.vpn-bindingA.access-client-id + '-topologyId-' +\n                                                   $tmp.aai.vpn-bindingA.access-topology-id + '-nodeId-' +\n                                                   $tmp.aai.vpn-bindingA.src-access-node-id`\" />\n",
        "comments": "",
        "x": 4185.883331298828,
        "y": 213,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "bc523ecb.f956a8",
        "type": "get-resource",
        "name": "get-resource src pnf",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"pnf\" \n\t\tkey=\"pnf.pnf-name = $tmp.src.domainA.pnf-name\"\n        pfx='tmp.aai.source-pnf' local-only='false' >\n\n        <!--AND depth = '0'\"-->\n",
        "comments": "",
        "outputs": 1,
        "x": 4211.883331298828,
        "y": 330,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "a72840b5.dc70e",
                "54e4a8de.9445f8",
                "4012660e.b55b2"
            ]
        ]
    },
    {
        "id": "a72840b5.dc70e",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4407.383453369141,
        "y": 282,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "9d071aa.9c29c68"
            ]
        ]
    },
    {
        "id": "54e4a8de.9445f8",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4399.383453369141,
        "y": 337,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "3662c50c.d754d2"
            ]
        ]
    },
    {
        "id": "9d071aa.9c29c68",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 4551.765777587891,
        "y": 281.6556701660156,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "c1155c42.4dc2e8"
            ]
        ]
    },
    {
        "id": "a3b68f87.0c3248",
        "type": "outcome",
        "name": "esr-thirdparty-sdnc",
        "xml": "<outcome value='esr-thirdparty-sdnc'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5133.883331298828,
        "y": 284,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "e6d1f56a.1147f8"
            ]
        ]
    },
    {
        "id": "c1155c42.4dc2e8",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for silentFailure='true' index='spvidx' start='0' end='`$tmp.aai.source-pnf.relationship-list.relationship_length`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 4735.883331298828,
        "y": 280,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "e3565ab9.0a825"
            ]
        ]
    },
    {
        "id": "e3565ab9.0a825",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.aai.source-pnf.relationship-list.relationship[$spvidx].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4930.883331298828,
        "y": 280,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "a3b68f87.0c3248"
            ]
        ]
    },
    {
        "id": "4012660e.b55b2",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4404.383453369141,
        "y": 394,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "7e9c03d8.c41c7c"
            ]
        ]
    },
    {
        "id": "7e9c03d8.c41c7c",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 4556.383453369141,
        "y": 395,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "3662c50c.d754d2",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 4567.383453369141,
        "y": 338,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "99fa8e6f.e803d8",
        "type": "execute",
        "name": "get esr-thirdparty-sdnc",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"esr-thirdparty-sdnc\" \n\t\tkey=\"esr-thirdparty-sdnc.thirdparty-sdnc-id = $tmp.domainA.esr-thirdparty-id AND \n\t\t     depth = '1'\"\n        pfx='tmp.aai.domainA.esr-thirdparty-sdnc' local-only='false' >",
        "comments": "",
        "outputs": 1,
        "x": 5518.883331298828,
        "y": 297,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "a38e0436.5aedc",
                "80f6747e.265c78",
                "c370b7ba.84a26"
            ]
        ]
    },
    {
        "id": "e6d1f56a.1147f8",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 5312.883331298828,
        "y": 284,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "4599703a.c42f3",
                "99fa8e6f.e803d8"
            ]
        ]
    },
    {
        "id": "4599703a.c42f3",
        "type": "set",
        "name": "set esr-thirdparty-sdnc domainA id",
        "xml": "<set>\n<parameter name='tmp.domainA.esr-thirdparty-id' value=\"`$tmp.aai.source-pnf.relationship-list.relationship[$spvidx].relationship-data[0].relationship-value`\" />\n",
        "comments": "",
        "x": 5548.883331298828,
        "y": 245,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "a38e0436.5aedc",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5728.883331298828,
        "y": 288,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "8c88cbf0.e09b1"
            ]
        ]
    },
    {
        "id": "80f6747e.265c78",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5720.883331298828,
        "y": 343,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "e2be9acb.77d62"
            ]
        ]
    },
    {
        "id": "c370b7ba.84a26",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5725.883331298828,
        "y": 400,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "856ee89c.2898"
            ]
        ]
    },
    {
        "id": "856ee89c.2898",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 5877.883331298828,
        "y": 401,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "e2be9acb.77d62",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 5888.883331298828,
        "y": 346,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "8c88cbf0.e09b1",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 5873.265655517578,
        "y": 285.6556701660156,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "a4a57efc.888ff8"
            ]
        ]
    },
    {
        "id": "a4a57efc.888ff8",
        "type": "set",
        "name": "set controller domainA data",
        "xml": "<set>\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainA.url' value=\"`$tmp.aai.domainA.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].service-url`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainA.user' value=\"`$tmp.aai.domainA.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].user-name`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainA.password' value=\"`$tmp.aai.domainA.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].password`\" />\n\n\n<!--<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >-->\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/restconf/data/ietf-network:networks'`\" />-->\n<!--<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />-->\n<!--<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />-->\n<!--<parameter name=\"format\" value=\"json\"/>-->\n<!--<parameter name=\"httpMethod\" value=\"get\"/>-->\n<!--<parameter name=\"responsePrefix\" value=\"topology\"/>-->\n<!--<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>-->\n<!--<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>-->\n<!--<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>-->\n<!--<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>-->\n",
        "comments": "",
        "x": 6087.883331298828,
        "y": 282,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "172d91c5.a78676",
        "type": "set",
        "name": "set attachment_param for OTN B",
        "xml": "<set>\n<parameter name='src-node-id' value='`$tmp.aai.vpn-bindingB.src-access-node-id`' />\n<parameter name='dst-node-id' value='`$tmp.aai.vpn-bindingB.dst-access-node-id`' />\n<!--<parameter name='src-tpn-id' value='1' />-->\n<parameter name='src-tpn-id' value='`$tmp.aai.vpn-bindingB.customer-vpn-id`' />\n<parameter name='src-ttp-id' value='`$tmp.aai.vpn-bindingB.src-access-ltp-id`' />\n<parameter name='slice-instance-id' value='`$tmp.aai.service-instance.service-instance-id`' />\n<parameter name='otn-tunnel-name-dst-domain' value='`$tmp.aai.vpn-bindingB.vpn-name`' />\n<parameter name='client-id' value='`$tmp.aai.vpn-bindingB.access-client-id`' />\n<parameter name='provider-id' value='`$tmp.aai.vpn-bindingB.access-provider-id`' />\n<parameter name='topology-id' value='`$tmp.aai.vpn-bindingB.access-topology-id`' />\n",
        "comments": "",
        "x": 3654.883331298828,
        "y": 1622,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "f13d198f.d5c79",
        "type": "execute",
        "name": "execute RestApiCallNode Create OTN tunnel with token",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.cll-otn-dst-domain-creation.templatefile`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainB.url + '/restconf/data/ietf-te:te'`\" />\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainB.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainB.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"patch\"/>\n<parameter name=\"responsePrefix\" value=\"otn-oof\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n<parameter name='customHttpHeaders' value=\"`'X-ACCESS-TOKEN=' + $prop.sdncRestApi.token_id`\" />",
        "comments": "",
        "outputs": 1,
        "x": 3717.883331298828,
        "y": 1951,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "3640aede.8913a2",
                "f1b1c8d.9945bb8"
            ]
        ]
    },
    {
        "id": "3640aede.8913a2",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4013.383331298828,
        "y": 1918,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "4b0d0deb.6577e4"
            ]
        ]
    },
    {
        "id": "f1b1c8d.9945bb8",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4018.383331298828,
        "y": 1983,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "5da14040.cb50b8"
            ]
        ]
    },
    {
        "id": "4b0d0deb.6577e4",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create OTN tunnel rest api\" />\n",
        "comments": "",
        "x": 4181.383331298828,
        "y": 1918,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "5da14040.cb50b8",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 4191.883331298828,
        "y": 1983,
        "z": "db287b1f.2984a8",
        "wires": [
            []
        ]
    },
    {
        "id": "1e50105a.a8b96",
        "type": "set",
        "name": "set pnf-name",
        "xml": "<set>\n<parameter name='tmp.dst.domainB.pnf-name' value=\"`'networkId-providerId-' +\n                                                   $tmp.aai.vpn-bindingB.access-provider-id + '-clientId-' +\n                                                   $tmp.aai.vpn-bindingB.access-client-id + '-topologyId-' +\n                                                   $tmp.aai.vpn-bindingB.access-topology-id + '-nodeId-' +\n                                                   $tmp.aai.vpn-bindingB.dst-access-node-id`\" />\n",
        "comments": "",
        "x": 3593.883331298828,
        "y": 1679,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "dfe45c65.d48f6",
        "type": "get-resource",
        "name": "get-resource dst pnf",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"pnf\" \n\t\tkey=\"pnf.pnf-name = $tmp.dst.domainB.pnf-name\"\n        pfx='tmp.aai.destination-pnf' local-only='false' >\n\n        <!--AND depth = '0'\"-->\n",
        "comments": "",
        "outputs": 1,
        "x": 3613.883331298828,
        "y": 1776,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "56d2f84a.b524e8",
                "43f5b436.ace8b4",
                "a9c884c3.3b2c18"
            ]
        ]
    },
    {
        "id": "56d2f84a.b524e8",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3816.3834533691406,
        "y": 1729,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "10cf7345.17615d"
            ]
        ]
    },
    {
        "id": "43f5b436.ace8b4",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3808.3834533691406,
        "y": 1784,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "40e41e98.b2ab3"
            ]
        ]
    },
    {
        "id": "10cf7345.17615d",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 3960.7657775878906,
        "y": 1726.6556701660156,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "69889215.886b4c"
            ]
        ]
    },
    {
        "id": "69889215.886b4c",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for silentFailure='true' index='dpvidx' start='0' end='`$tmp.aai.destination-pnf.relationship-list.relationship_length`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 4144.883331298828,
        "y": 1741,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "3c1ff953.79a23e"
            ]
        ]
    },
    {
        "id": "a9c884c3.3b2c18",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3813.3834533691406,
        "y": 1841,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "8ab7ecfb.f03ee"
            ]
        ]
    },
    {
        "id": "8ab7ecfb.f03ee",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 3965.3834533691406,
        "y": 1842,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "40e41e98.b2ab3",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 3976.3834533691406,
        "y": 1787,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "37ef2104.1e9d5e",
        "type": "outcome",
        "name": "esr-thirdparty-sdnc",
        "xml": "<outcome value='esr-thirdparty-sdnc'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4542.883331298828,
        "y": 1745,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "901dac81.52118"
            ]
        ]
    },
    {
        "id": "3c1ff953.79a23e",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.aai.destination-pnf.relationship-list.relationship[$dpvidx].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4339.883331298828,
        "y": 1741,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "37ef2104.1e9d5e"
            ]
        ]
    },
    {
        "id": "86b8c4cb.c3747",
        "type": "execute",
        "name": "get esr-thirdparty-sdnc",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"esr-thirdparty-sdnc\" \n\t\tkey=\"esr-thirdparty-sdnc.thirdparty-sdnc-id = $tmp.domainB.esr-thirdparty-id AND \n\t\t     depth = '1'\"\n        pfx='tmp.aai.domainB.esr-thirdparty-sdnc' local-only='false' >",
        "comments": "",
        "outputs": 1,
        "x": 4927.883331298828,
        "y": 1744,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "b5f45931.a1805",
                "34bcb3b6.e69b1c",
                "d4cc1381.862c48"
            ]
        ]
    },
    {
        "id": "901dac81.52118",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 4719.883331298828,
        "y": 1737,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "81cd4229.29ba8",
                "86b8c4cb.c3747"
            ]
        ]
    },
    {
        "id": "81cd4229.29ba8",
        "type": "set",
        "name": "set esr-thirdparty-sdnc domainB id",
        "xml": "<set>\n<parameter name='tmp.domainB.esr-thirdparty-id' value=\"`$tmp.aai.destination-pnf.relationship-list.relationship[$dpvidx].relationship-data[0].relationship-value`\" />\n",
        "comments": "",
        "x": 4957.883331298828,
        "y": 1692,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "a6f965e8.0bb248",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 5286.883331298828,
        "y": 1848,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "3b503e2a.8c5dd2",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 5297.883331298828,
        "y": 1793,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "a84f2510.1ebf08",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 5282.265655517578,
        "y": 1732.6556701660156,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "f83738f1.e5e14"
            ]
        ]
    },
    {
        "id": "f83738f1.e5e14",
        "type": "set",
        "name": "set controller domainB data",
        "xml": "<set>\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainB.url' value=\"`$tmp.aai.domainB.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].service-url`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainB.user' value=\"`$tmp.aai.domainB.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].user-name`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainB.password' value=\"`$tmp.aai.domainB.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].password`\" />\n\n\n<!--<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >-->\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/restconf/data/ietf-network:networks'`\" />-->\n<!--<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />-->\n<!--<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />-->\n<!--<parameter name=\"format\" value=\"json\"/>-->\n<!--<parameter name=\"httpMethod\" value=\"get\"/>-->\n<!--<parameter name=\"responsePrefix\" value=\"topology\"/>-->\n<!--<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>-->\n<!--<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>-->\n<!--<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>-->\n<!--<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>-->\n",
        "comments": "",
        "x": 5496.883331298828,
        "y": 1729,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "b5f45931.a1805",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5137.883331298828,
        "y": 1735,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "a84f2510.1ebf08"
            ]
        ]
    },
    {
        "id": "34bcb3b6.e69b1c",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5129.883331298828,
        "y": 1790,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "3b503e2a.8c5dd2"
            ]
        ]
    },
    {
        "id": "d4cc1381.862c48",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5134.883331298828,
        "y": 1847,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "a6f965e8.0bb248"
            ]
        ]
    },
    {
        "id": "4a95df1.67c3fa",
        "type": "switchNode",
        "name": "switch vpn-binding has dst-access-ltp",
        "xml": "<switch test='`$tmp.aai.vpn-binding.dst-access-ltp-id`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3168.883331298828,
        "y": 693,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "60b8b463.e4925c",
                "5e23be29.1eb6a"
            ]
        ]
    },
    {
        "id": "60b8b463.e4925c",
        "type": "outcome",
        "name": "Null",
        "xml": "<outcome value=''>\n",
        "comments": "",
        "outputs": 1,
        "x": 3382.883331298828,
        "y": 730,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "4d4203c4.4fd81c"
            ]
        ]
    },
    {
        "id": "5e23be29.1eb6a",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3384.883331298828,
        "y": 668,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "402d5674.bb5698"
            ]
        ]
    },
    {
        "id": "4d4203c4.4fd81c",
        "type": "switchNode",
        "name": "switch vpn-binding has src-access-ltp",
        "xml": "<switch test='`$tmp.aai.vpn-binding.src-access-ltp-id`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2962.883331298828,
        "y": 1973,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "4155de88.54a1f",
                "11e38b5d.85c715"
            ]
        ]
    },
    {
        "id": "4155de88.54a1f",
        "type": "outcome",
        "name": "Null",
        "xml": "<outcome value=''>\n",
        "comments": "",
        "outputs": 1,
        "x": 3215.883331298828,
        "y": 2007,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "97b4f973.8f85a8"
            ]
        ]
    },
    {
        "id": "11e38b5d.85c715",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3215.883331298828,
        "y": 1951,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "4bdf7725.9cef3"
            ]
        ]
    },
    {
        "id": "97b4f973.8f85a8",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
        "comments": "",
        "x": 3366.883331298828,
        "y": 2007,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "15e2350c.3f989b",
        "type": "set",
        "name": "set vpn-bindingA and connectivityA",
        "xml": "<set>\n<parameter name='tmp.aai.vpn-bindingA.' value=\"`$tmp.aai.vpn-binding.`\" />\n<parameter name='tmp.aai.connectivityA.' value=\"`$tmp.aai.connectivity.`\" />\n",
        "comments": "",
        "x": 4242.883331298828,
        "y": 105,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "22f55219.d9af6e",
        "type": "set",
        "name": "set vpn-bindingB and connectivityB",
        "xml": "<set>\n<parameter name='tmp.aai.vpn-bindingB.' value=\"`$tmp.aai.vpn-binding.`\" />\n<parameter name='tmp.aai.connectivityB.' value=\"`$tmp.aai.connectivity.`\" />\n\n",
        "comments": "",
        "x": 3650.883331298828,
        "y": 1564,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "9157e39e.50973",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 3933.883331298828,
        "y": 362,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "15e2350c.3f989b",
                "5be24b21.11ebc4",
                "48c30a65.f0f584",
                "bc523ecb.f956a8",
                "66c2f1fa.df4e",
                "738a4fa7.5a68d",
                "9521e4ca.a61af",
                "224f4283.917d26"
            ]
        ]
    },
    {
        "id": "4bdf7725.9cef3",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 3366.883331298828,
        "y": 1950,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "22f55219.d9af6e",
                "172d91c5.a78676",
                "1e50105a.a8b96",
                "dfe45c65.d48f6",
                "f13d198f.d5c79",
                "78f084cb.41e754",
                "e35a6c95.6b3d6",
                "1ced8517.ce35e3"
            ]
        ]
    },
    {
        "id": "e7e7eca7.931088",
        "type": "set",
        "name": "set sotn_value",
        "xml": "<set>\n<!--<parameter name='eth-service-name' value='`$tmp.aai.connectivityB.connectivity-id`' />-->\n<parameter name='eth-service-name' value='`$tmp.aai.connectivityB.etht-svc-name`' />\n<parameter name='slice-id' value='`$vnf-topology-operation-input.service-information.service-instance-id`' />\n<parameter name='provider-id' value='`$tmp.aai.connectivityB.access-provider-id`' />\n<parameter name='client-id' value='`$tmp.aai.connectivityB.access-client-id`' />\n<parameter name='topology-id' value='`$tmp.aai.connectivityB.access-topology-id`' />\n<parameter name='otn-tunnel-name' value='`$tmp.aai.vpn-bindingB.vpn-name`' />\n<parameter name='ethernet-end-point-name' value='`$tmp.aai.connectivityB.connectivity-id`' />\n<parameter name='index-number' value='0' />\n<parameter name='eth-node-id' value='`$tmp.aai.connectivityB.access-node-id`' />\n<parameter name='eth-node-tp-id' value='`$tmp.aai.connectivityB.access-ltp-id`' />\n<parameter name='CIR' value='`$tmp.aai.vpn-bindingB.route-distinguisher *1000000`' />\n<parameter name='EIR' value='`$tmp.aai.vpn-bindingB.route-distinguisher *1000000`' />\n<parameter name='cvlan' value='`$tmp.aai.connectivityB.cvlan`' />\n\n",
        "comments": "",
        "x": 3604.883331298828,
        "y": 2249,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "5544b67f.df3238",
        "type": "execute",
        "name": "execute RestApiCallNode Create ethernet Service without token",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.ts-ethernet-service.templatefile`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainB.url + '/restconf/data/ietf-eth-tran-service:etht-svc'`\" />\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.restapi.connection-oof-url`\" />-->\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainB.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainB.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"patch\"/>\n<parameter name='dirPath' value=\"/opt/onap/sdnc/restconfapi/yang\" />\n<parameter name=\"responsePrefix\" value=\"vpn-result\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n",
        "comments": "",
        "outputs": 1,
        "x": 3758.883331298828,
        "y": 2297,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "b36c5e4.a4b982",
                "75e03418.7b0a3c"
            ]
        ]
    },
    {
        "id": "b36c5e4.a4b982",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4104.383331298828,
        "y": 2278,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "996a2de3.86ff68"
            ]
        ]
    },
    {
        "id": "75e03418.7b0a3c",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4108.383331298828,
        "y": 2318,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "1787d971.8d0d67"
            ]
        ]
    },
    {
        "id": "996a2de3.86ff68",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create ethernet service rest api\" />\n",
        "comments": "",
        "x": 4262.383331298828,
        "y": 2278,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "1787d971.8d0d67",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 4265.883331298828,
        "y": 2318,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "79bbcc28.d4fd3c",
                "137b8fb9.4aaa78"
            ]
        ]
    },
    {
        "id": "79bbcc28.d4fd3c",
        "type": "save",
        "name": "update vpn-binding B resource (aka. OTN domainB) in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding' \n      key='vpn-binding.vpn-id = $tmp.aai.vpn-bindingB.vpn-id' >\n<parameter name='vpn-id' value='`$tmp.aai.vpn-bindingB.vpn-id`' />\n<parameter name='vpn-name' value='`$tmp.aai.vpn-bindingB.vpn-name`' />\n\n<parameter name='operational-status' value='Activated' />\n",
        "comments": "",
        "outputs": 1,
        "x": 4605.883331298828,
        "y": 2317,
        "z": "db287b1f.2984a8",
        "wires": [
            []
        ]
    },
    {
        "id": "9aab71de.3f671",
        "type": "comment",
        "name": "TODO: FIXME",
        "info": "use proper vpn-binding id and connectivity\n\nAlso, does CCSDK support \"update\" operation for vpn-binding and connectivity?",
        "comments": "",
        "x": 4463.883331298828,
        "y": 2275,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "137b8fb9.4aaa78",
        "type": "save",
        "name": "update connectivity resource in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='connectivity' \n      key='connectivity.connectivity-id = $tmp.aai.connectivityB.connectivity-id'>\n<parameter name='connectivity-id' value='`$tmp.aai.connectivityB.connectivity-id`' />\n<parameter name='operational-status' value='Activated' />\n",
        "comments": "",
        "outputs": 1,
        "x": 4534.883331298828,
        "y": 2366,
        "z": "db287b1f.2984a8",
        "wires": [
            []
        ]
    },
    {
        "id": "e7a16254.b52678",
        "type": "set",
        "name": "set attachment_param (gfp-n) for OTN",
        "xml": "<set>\n<parameter name='gfp-n' value='`$tmp.aai.vpn-binding.route-distinguisher`' />\n",
        "comments": "",
        "x": 3159.883331298828,
        "y": 633,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "b98d7c04.aadb6",
        "type": "comment",
        "name": "only dst ttp exists. No src",
        "info": "",
        "comments": "",
        "x": 3754.883331298828,
        "y": 319,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "f9466402.70d608",
        "type": "comment",
        "name": "only src ttp exists. No dst",
        "info": "",
        "comments": "",
        "x": 3311.883331298828,
        "y": 1897,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "402d5674.bb5698",
        "type": "switchNode",
        "name": "switch vpn-binding has src-access-ltp",
        "xml": "<switch test='`$tmp.aai.vpn-binding.src-access-ltp-id`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3490.883331298828,
        "y": 481,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "40174504.12275c",
                "483f6800.997ef8"
            ]
        ]
    },
    {
        "id": "483f6800.997ef8",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3732.883331298828,
        "y": 1070,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "f91cd9b2.b4ebc8"
            ]
        ]
    },
    {
        "id": "40174504.12275c",
        "type": "outcome",
        "name": "Null",
        "xml": "<outcome value=''>\n",
        "comments": "",
        "outputs": 1,
        "x": 3726.883331298828,
        "y": 361,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "9157e39e.50973"
            ]
        ]
    },
    {
        "id": "f91cd9b2.b4ebc8",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 3890.883331298828,
        "y": 1069,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "e0a89dfb.b97bd8",
                "356efc92.1be0c4",
                "b98c51bd.b1df7",
                "c9386596.fb5188",
                "99a335d9.47dc9",
                "1d1e23b2.17cb04"
            ]
        ]
    },
    {
        "id": "356efc92.1be0c4",
        "type": "set",
        "name": "set attachment_param for OTN G",
        "xml": "<set>\n<parameter name='src-node-id' value='`$tmp.aai.vpn-bindingG.src-access-node-id`' />\n<parameter name='dst-node-id' value='`$tmp.aai.vpn-bindingG.dst-access-node-id`' />\n<!--<parameter name='dst-tpn-id' value='1' />-->\n<parameter name='src-tpn-id' value='`$tmp.aai.vpn-bindingG.customer-vpn-id`' />\n<parameter name='dst-tpn-id' value='`$tmp.aai.vpn-bindingG.customer-vpn-id`' />\n<parameter name='src-ttp-id' value='`$tmp.aai.vpn-bindingG.src-access-ltp-id`' />\n<parameter name='dst-ttp-id' value='`$tmp.aai.vpn-bindingG.dst-access-ltp-id`' />\n<parameter name='slice-instance-id' value='`$tmp.aai.service-instance.service-instance-id`' />\n<parameter name='otn-tunnel-name-domainG' value='`$tmp.aai.vpn-bindingG.vpn-name`' />\n<parameter name='client-id' value='`$tmp.aai.vpn-bindingG.access-client-id`' />\n<parameter name='provider-id' value='`$tmp.aai.vpn-bindingG.access-provider-id`' />\n<parameter name='topology-id' value='`$tmp.aai.vpn-bindingG.access-topology-id`' />\n",
        "comments": "",
        "x": 4154.883331298828,
        "y": 952,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "99a335d9.47dc9",
        "type": "execute",
        "name": "execute RestApiCallNode Create OTN tunnel with token",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.cll-otn-domainG-creation.templatefile`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainG.url + '/restconf/data/ietf-te:te'`\" />\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainG.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainG.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"patch\"/>\n<parameter name=\"responsePrefix\" value=\"otn-oof\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n<parameter name='customHttpHeaders' value=\"`'X-ACCESS-TOKEN=' + $prop.sdncRestApi.token_id`\" />",
        "comments": "",
        "outputs": 1,
        "x": 4235.883331298828,
        "y": 1267,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "2ae3d84f.15cb3",
                "a0cd8374.ae65d8"
            ]
        ]
    },
    {
        "id": "2ae3d84f.15cb3",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4545.383331298828,
        "y": 1236,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "d03fdf1c.3b45d"
            ]
        ]
    },
    {
        "id": "a0cd8374.ae65d8",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4550.383331298828,
        "y": 1301,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "f8c3fa12.5c834"
            ]
        ]
    },
    {
        "id": "d03fdf1c.3b45d",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create OTN tunnel rest api\" />\n",
        "comments": "",
        "x": 4721.383331298828,
        "y": 1236,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "f8c3fa12.5c834",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 4716.883331298828,
        "y": 1301,
        "z": "db287b1f.2984a8",
        "wires": [
            []
        ]
    },
    {
        "id": "b98c51bd.b1df7",
        "type": "set",
        "name": "set pnf-name",
        "xml": "<set>\n<parameter name='tmp.domainG.pnf-name' value=\"`'networkId-providerId-' +\n                                                   $tmp.aai.vpn-bindingG.access-provider-id + '-clientId-' +\n                                                   $tmp.aai.vpn-bindingG.access-client-id + '-topologyId-' +\n                                                   $tmp.aai.vpn-bindingG.access-topology-id + '-nodeId-' +\n                                                   $tmp.aai.vpn-bindingG.src-access-node-id`\" />\n",
        "comments": "",
        "x": 4092.883331298828,
        "y": 1000,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "c9386596.fb5188",
        "type": "get-resource",
        "name": "get-resource src pnf",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"pnf\" \n\t\tkey=\"pnf.pnf-name = $tmp.domainG.pnf-name\"\n        pfx='tmp.aai.domainG-pnf' local-only='false' >\n\n        <!--AND depth = '0'\"-->\n",
        "comments": "",
        "outputs": 1,
        "x": 4118.883331298828,
        "y": 1117,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "312e9154.f9dbd6",
                "38e6d39b.3fc964",
                "d52b1c1f.8a6ca8"
            ]
        ]
    },
    {
        "id": "312e9154.f9dbd6",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4314.383453369141,
        "y": 1069,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "6d3eafaf.02fb48"
            ]
        ]
    },
    {
        "id": "38e6d39b.3fc964",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4306.383453369141,
        "y": 1124,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "3519bfd5.fa4b3"
            ]
        ]
    },
    {
        "id": "6d3eafaf.02fb48",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 4458.765777587891,
        "y": 1068.6556701660156,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "6a66b1f9.955598"
            ]
        ]
    },
    {
        "id": "6a66b1f9.955598",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for silentFailure='true' index='spvidx' start='0' end='`$tmp.aai.domainG-pnf.relationship-list.relationship_length`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 4642.883331298828,
        "y": 1067,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "43b05855.517cf"
            ]
        ]
    },
    {
        "id": "43b05855.517cf",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.aai.domainG-pnf.relationship-list.relationship[$spvidx].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4837.883331298828,
        "y": 1067,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "c21a24cd.dd2528"
            ]
        ]
    },
    {
        "id": "d52b1c1f.8a6ca8",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 4311.383453369141,
        "y": 1181,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "db81dd24.8006b"
            ]
        ]
    },
    {
        "id": "db81dd24.8006b",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 4463.383453369141,
        "y": 1182,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "3519bfd5.fa4b3",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 4474.383453369141,
        "y": 1125,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "e0a89dfb.b97bd8",
        "type": "set",
        "name": "set vpn-bindingG and connectivityG",
        "xml": "<set>\n<parameter name='tmp.aai.vpn-bindingG.' value=\"`$tmp.aai.vpn-binding.`\" />\n<parameter name='tmp.aai.connectivityG.' value=\"`$tmp.aai.connectivity.`\" />\n",
        "comments": "",
        "x": 4149.883331298828,
        "y": 892,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "c21a24cd.dd2528",
        "type": "outcome",
        "name": "esr-thirdparty-sdnc",
        "xml": "<outcome value='esr-thirdparty-sdnc'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5040.883331298828,
        "y": 1071,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "f7c609f5.0c2d28"
            ]
        ]
    },
    {
        "id": "dff3e5ec.9273",
        "type": "execute",
        "name": "get esr-thirdparty-sdnc",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"esr-thirdparty-sdnc\" \n\t\tkey=\"esr-thirdparty-sdnc.thirdparty-sdnc-id = $tmp.domainG.esr-thirdparty-id AND \n\t\t     depth = '1'\"\n        pfx='tmp.aai.domainG.esr-thirdparty-sdnc' local-only='false' >",
        "comments": "",
        "outputs": 1,
        "x": 5425.883331298828,
        "y": 1084,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "2769bc77.6b9fa4",
                "7925966f.3df658",
                "161a4207.178c96"
            ]
        ]
    },
    {
        "id": "f7c609f5.0c2d28",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 5219.883331298828,
        "y": 1071,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "3634d6f2.f94292",
                "dff3e5ec.9273"
            ]
        ]
    },
    {
        "id": "3634d6f2.f94292",
        "type": "set",
        "name": "set esr-thirdparty-sdnc domainG id",
        "xml": "<set>\n<parameter name='tmp.domainG.esr-thirdparty-id' value=\"`$tmp.aai.domainG-pnf.relationship-list.relationship[$spvidx].relationship-data[0].relationship-value`\" />\n",
        "comments": "",
        "x": 5455.883331298828,
        "y": 1032,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "2769bc77.6b9fa4",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5635.883331298828,
        "y": 1075,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "8b0e2b2b.7a21d"
            ]
        ]
    },
    {
        "id": "7925966f.3df658",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5627.883331298828,
        "y": 1130,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "b9107d6e.7c0358"
            ]
        ]
    },
    {
        "id": "161a4207.178c96",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 5632.883331298828,
        "y": 1187,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "d5598bab.3dfb58"
            ]
        ]
    },
    {
        "id": "d5598bab.3dfb58",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 5784.883331298828,
        "y": 1188,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "b9107d6e.7c0358",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 5795.883331298828,
        "y": 1133,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "8b0e2b2b.7a21d",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 5780.265655517578,
        "y": 1072.6556701660156,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "f80d31a9.31f3d"
            ]
        ]
    },
    {
        "id": "f80d31a9.31f3d",
        "type": "set",
        "name": "set controller domainG data",
        "xml": "<set>\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainG.url' value=\"`$tmp.aai.domainG.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].service-url`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainG.user' value=\"`$tmp.aai.domainG.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].user-name`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainG.password' value=\"`$tmp.aai.domainG.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].password`\" />\n\n\n<!--<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >-->\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/restconf/data/ietf-network:networks'`\" />-->\n<!--<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />-->\n<!--<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />-->\n<!--<parameter name=\"format\" value=\"json\"/>-->\n<!--<parameter name=\"httpMethod\" value=\"get\"/>-->\n<!--<parameter name=\"responsePrefix\" value=\"topology\"/>-->\n<!--<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>-->\n<!--<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>-->\n<!--<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>-->\n<!--<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>-->\n",
        "comments": "",
        "x": 5994.883331298828,
        "y": 1069,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "d718b282.287ca",
        "type": "comment",
        "name": "both src and dst exist",
        "info": "",
        "comments": "",
        "x": 3768.883331298828,
        "y": 1010,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "d6d93ab.df041c8",
        "type": "switchNode",
        "name": "switch vpn-binding is not already Activated (i.e. is either Created or Modified)",
        "xml": "<switch test=\"`$tmp.aai.vpn-binding.operational-status != 'Activated' `\">\n",
        "comments": "",
        "outputs": 1,
        "x": 2330.883331298828,
        "y": 737,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "7d753f63.af1d7",
                "7719dbd9.957fc4"
            ]
        ]
    },
    {
        "id": "7719dbd9.957fc4",
        "type": "outcomeFalse",
        "name": "false",
        "xml": "<outcome value='false'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2737.883331298828,
        "y": 755,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "2b5dce30.392f92"
            ]
        ]
    },
    {
        "id": "7d753f63.af1d7",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2737.883331298828,
        "y": 700,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "155f7f13.57fce1"
            ]
        ]
    },
    {
        "id": "155f7f13.57fce1",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 2893.883331298828,
        "y": 698,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "e7a16254.b52678",
                "4a95df1.67c3fa"
            ]
        ]
    },
    {
        "id": "2b5dce30.392f92",
        "type": "block",
        "name": "block",
        "xml": "<block>",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 2870.883331298828,
        "y": 756,
        "z": "db287b1f.2984a8",
        "wires": [
            []
        ]
    },
    {
        "id": "9dad0003.283738",
        "type": "set",
        "name": "unset tmp.aai.all-vpn-bindings",
        "xml": "<set>\n<parameter name='tmp.aai.all-vpn-bindings.' value=\"\" />\n",
        "comments": "",
        "x": 1047.8833312988281,
        "y": 172,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "a6d3cb9.27687b8",
        "type": "comment",
        "name": "CLL new",
        "info": "construct two array structures like these:\n\n${otn-tunnels-name-list[${1}].otn-tunnel-name}\n\n----------------\n${ethernet-srv-end-points-list[${1}].ethernet-end-point-name}\n${ethernet-srv-end-points-list[${1}].index-number},\n${ethernet-srv-end-points-list[${1}].eth-node-id},\n${ethernet-srv-end-points-list[${1}].eth-node-tp-id},\n${ethernet-srv-end-points-list[${1}].leafOrRootAccess}\n${ethernet-srv-end-points-list[${1}].cvlan}\n${ethernet-srv-end-points-list[${1}].CIR}\n${ethernet-srv-end-points-list[${1}].EIR}",
        "comments": "",
        "x": 4164.883331298828,
        "y": 590,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "738a4fa7.5a68d",
        "type": "set",
        "name": "set leaf-otn-tunnels-list array",
        "xml": "<set>\n<parameter name='`leaf-tunnels-list[$leaftunsidx].tunnel-name`' value='`$tmp.aai.vpn-binding.vpn-name`' />\n<parameter name='`leaf-tunnels-list[$leaftunsidx].vpn-id`' value='`$tmp.aai.vpn-binding.vpn-id`' />\n<parameter name='`leaf-tunnels-list_length`' value='`$leaftunsidx + 1`' />\n",
        "comments": "",
        "x": 4224.883331298828,
        "y": 629,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "47e937a3.3ee608",
        "type": "set",
        "name": "unset leaf-otn-tunnels-list array",
        "xml": "<set>\n<parameter name='`leaf-tunnels-list.`' value='' />\n<parameter name='`leaf-tunnels-list_length`' value='0' />\n<parameter name='`leaftunsidx`' value='0' />\n",
        "comments": "",
        "x": 1040.8833312988281,
        "y": 80,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "6f67cdff.5c5554",
        "type": "comment",
        "name": "CLL new",
        "info": "construct two array structures like these:\n\n${otn-tunnels-name-list[${1}].otn-tunnel-name}\n\n----------------\n${ethernet-srv-end-points-list[${1}].ethernet-end-point-name}\n${ethernet-srv-end-points-list[${1}].index-number},\n${ethernet-srv-end-points-list[${1}].eth-node-id},\n${ethernet-srv-end-points-list[${1}].eth-node-tp-id},\n${ethernet-srv-end-points-list[${1}].leafOrRootAccess}\n${ethernet-srv-end-points-list[${1}].cvlan}\n${ethernet-srv-end-points-list[${1}].CIR}\n${ethernet-srv-end-points-list[${1}].EIR}",
        "comments": "",
        "x": 3576.883331298828,
        "y": 2106,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "78f084cb.41e754",
        "type": "set",
        "name": "set root-otn-tunnels-list array",
        "xml": "<set>\n<parameter name='`root-tunnels-list[$roottunsidx].tunnel-name`' value='`$tmp.aai.vpn-binding.vpn-name`' />\n<parameter name='`root-tunnels-list[$roottunsidx].vpn-id`' value='`$tmp.aai.vpn-binding.vpn-id`' />\n<parameter name='`root-tunnels-list_length`' value='`$roottunsidx + 1`' />\n",
        "comments": "",
        "x": 3632.883331298828,
        "y": 2155,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "912dde6.9b60fa",
        "type": "set",
        "name": "unset root-otn-tunnels-list array",
        "xml": "<set>\n<parameter name='`root-tunnels-list.`' value='' />\n<parameter name='`root-tunnels-list_length`' value='0' />\n<parameter name='`roottunsidx`' value='0' />\n",
        "comments": "",
        "x": 1040.8833312988281,
        "y": 119,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "fa83bc41.1d8b08",
        "type": "execute",
        "name": "execute properties",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.prop.PropertiesNode' method='readProperties' >\n    <parameter name='fileName' value='%SDNC_CONFIG_DIR%/generic-resource-api-dg.properties' />\n    <parameter name='contextPrefix' value='prop' />",
        "comments": "",
        "outputs": 1,
        "x": 1071.8833312988281,
        "y": 220,
        "z": "db287b1f.2984a8",
        "wires": [
            []
        ]
    },
    {
        "id": "39b1b2.d055464e",
        "type": "save",
        "name": "get service-instance from aai",
        "xml": "<!--<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" -->\n<!--\tresource=\"service-instance\"-->\n<!--\tkey='service-instance.service-instance-id = $service-data.vnfs.vnf[$tmp.vidx].vnf-data.service-information.service-instance-id-->\n<!--         AND customer.global-customer-id = $service-data.vnfs.vnf[$tmp.vidx].vnf-data.service-information.global-customer-id -->\n<!--         AND service-subscription.service-type = $service-data.vnfs.vnf[$tmp.vidx].vnf-data.service-information.subscription-service-type'-->\n<!--\tlocal-only=\"false\"-->\n<!--\tforce=\"true\" pfx=\"tmp.aai.service-instance\">-->\n\n<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"service-instance\"\n\tkey='service-instance.service-instance-id = $vnf-topology-operation-input.service-information.service-instance-id\n         AND customer.global-customer-id = $vnf-topology-operation-input.service-information.global-customer-id \n         AND service-subscription.service-type = $vnf-topology-operation-input.service-information.subscription-service-type'\n\tlocal-only=\"false\"\n\tforce=\"true\" pfx=\"tmp.aai.service-instance\">\n\n\n<!--$vnf-topology-operation-input.service-information.service-instance-id-->",
        "comments": "",
        "outputs": 1,
        "x": 281.8833312988281,
        "y": 695,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "e70c3582.89ad08",
                "3aeaa08a.574a",
                "1322af3c.bc6319"
            ]
        ]
    },
    {
        "id": "e70c3582.89ad08",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 500.8833312988281,
        "y": 633,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "9c476365.2b909"
            ]
        ]
    },
    {
        "id": "3aeaa08a.574a",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 510.3742980957031,
        "y": 675.5740356445312,
        "z": "db287b1f.2984a8",
        "wires": [
            []
        ]
    },
    {
        "id": "1322af3c.bc6319",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 498.8833312988281,
        "y": 722,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "23db95da.1941e2"
            ]
        ]
    },
    {
        "id": "9c476365.2b909",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for index='rel-index' start='0' end='`$tmp.aai.service-instance.relationship-list.relationship_length`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 697.8833312988281,
        "y": 629,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "1a5a20de.60b4cf"
            ]
        ]
    },
    {
        "id": "23db95da.1941e2",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
        "comments": "",
        "x": 667.8833312988281,
        "y": 723,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "1a5a20de.60b4cf",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.aai.service-instance.relationship-list.relationship[$rel-index].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 921.2168273925781,
        "y": 628.9999389648438,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "59a859e2.c48ca8"
            ]
        ]
    },
    {
        "id": "59a859e2.c48ca8",
        "type": "outcome",
        "name": "connectivity",
        "xml": "<outcome value='connectivity'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1121.8834648132324,
        "y": 630.000020980835,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "ae28be96.a81b18"
            ]
        ]
    },
    {
        "id": "ae28be96.a81b18",
        "type": "save",
        "name": "get connectivity from aai",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"connectivity\"\n\t    key=\"connectivity.connectivity-id = $tmp.aai.service-instance.relationship-list.relationship[$rel-index].relationship-data[0].relationship-value\"\n\t\tlocal-only=\"false\" \n\t\tpfx=\"tmp.aai.connectivity\" >\n",
        "comments": "",
        "outputs": 1,
        "x": 251.88333129882812,
        "y": 892,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "4595d435.587aa4",
                "60a8c3ff.237aec",
                "18e77ed.3460901"
            ]
        ]
    },
    {
        "id": "4595d435.587aa4",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 459.8833312988281,
        "y": 856,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "9c5806bb.83c05"
            ]
        ]
    },
    {
        "id": "60a8c3ff.237aec",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 460.3742980957031,
        "y": 901.5740356445312,
        "z": "db287b1f.2984a8",
        "wires": [
            []
        ]
    },
    {
        "id": "18e77ed.3460901",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 457.8833312988281,
        "y": 945,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "a170b783.101ed"
            ]
        ]
    },
    {
        "id": "a170b783.101ed",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
        "comments": "",
        "x": 626.8833312988281,
        "y": 946,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "aaf101ae.84a298",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for silentFailure='true' index='cridx' start='0' end='`$tmp.aai.connectivity.relationship-list.relationship_length`' >\n\n",
        "comments": "",
        "outputs": 1,
        "x": 598.8833312988281,
        "y": 1440,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "48f75925.f13078"
            ]
        ]
    },
    {
        "id": "48f75925.f13078",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.aai.connectivity.relationship-list.relationship[$cridx].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 801.8833312988281,
        "y": 1452,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "dc596581.8a224"
            ]
        ]
    },
    {
        "id": "dc596581.8a224",
        "type": "outcome",
        "name": "UNI",
        "xml": "<outcome value='uni'>\n",
        "comments": "",
        "outputs": 1,
        "x": 967.8833312988281,
        "y": 1449,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "63611a55.44e3fc"
            ]
        ]
    },
    {
        "id": "63611a55.44e3fc",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 1128.8833312988281,
        "y": 1446,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "155181d9.def56e",
                "450c0202.9562fc",
                "e522d7e8.f0b6d",
                "b85bac18.623698",
                "d97c4e37.51bad8"
            ]
        ]
    },
    {
        "id": "450c0202.9562fc",
        "type": "set",
        "name": "unset tmp.aai.uni",
        "xml": "<set>\n<parameter name='tmp.aai.uni.' value='' />\n",
        "comments": "",
        "x": 1332.8833312988281,
        "y": 1404,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "155181d9.def56e",
        "type": "save",
        "name": "get uni from aai",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"uni\"\n\t    key=\"uni.id = $tmp.aai.connectivity.relationship-list.relationship[$cridx].relationship-data[0].relationship-value\"\n\t\tlocal-only=\"false\" \n\t\tpfx=\"tmp.aai.uni\" >\n",
        "comments": "",
        "outputs": 1,
        "x": 1329.8833312988281,
        "y": 1449,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "c73d859f.d40f2",
                "cdecbb41.644898",
                "ca040aae.e9fa08"
            ]
        ]
    },
    {
        "id": "cdecbb41.644898",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1525.3742980957031,
        "y": 1422.573974609375,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "dcd0fdd9.1c84f"
            ]
        ]
    },
    {
        "id": "ca040aae.e9fa08",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1520.8833312988281,
        "y": 1466.9999389648438,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "7c23dd25.00653c"
            ]
        ]
    },
    {
        "id": "dcd0fdd9.1c84f",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.l3vpn.pe1_id`\" />\n\n",
        "comments": "",
        "x": 1687.9458312988281,
        "y": 1421.8596801757812,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "7c23dd25.00653c",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
        "comments": "",
        "x": 1688.8833312988281,
        "y": 1466.9999389648438,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "c84187cf.6e6008",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 1690.8833312988281,
        "y": 1513.9999389648438,
        "z": "db287b1f.2984a8",
        "wires": [
            []
        ]
    },
    {
        "id": "c73d859f.d40f2",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1521.8833312988281,
        "y": 1513.9999389648438,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "c84187cf.6e6008"
            ]
        ]
    },
    {
        "id": "a7f36b9f.f75b88",
        "type": "switchNode",
        "name": "switch conn type",
        "xml": "<switch test=\"`$tmp.aai.connectivity.vpn-type`\">\n\n",
        "comments": "",
        "outputs": 1,
        "x": 211.38333129882812,
        "y": 1111,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "b58d5b5e.9a197",
                "5c723a86.22c16c",
                "fb40210e.8c5be8"
            ]
        ]
    },
    {
        "id": "ce504b34.d68ac8",
        "type": "block",
        "name": "block",
        "xml": "<block>",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 322.3833312988281,
        "y": 1467,
        "z": "db287b1f.2984a8",
        "wires": [
            []
        ]
    },
    {
        "id": "b58d5b5e.9a197",
        "type": "outcome",
        "name": "leaf",
        "xml": "<outcome value='leaf'>\n",
        "comments": "",
        "outputs": 1,
        "x": 197.38333129882812,
        "y": 1357,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "67ff853e.386644"
            ]
        ]
    },
    {
        "id": "5c723a86.22c16c",
        "type": "outcome",
        "name": "root",
        "xml": "<outcome value='root'>\n",
        "comments": "",
        "outputs": 1,
        "x": 198.38333129882812,
        "y": 1415,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "402699af.4c591"
            ]
        ]
    },
    {
        "id": "fb40210e.8c5be8",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 200.38333129882812,
        "y": 1469,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "ce504b34.d68ac8"
            ]
        ]
    },
    {
        "id": "5d006f15.710a08",
        "type": "comment",
        "name": "CLL new",
        "info": "construct two array structures like these:\n\n${otn-tunnels-name-list[${1}].otn-tunnel-name}\n\n----------------\n${ethernet-srv-end-points-list[${1}].ethernet-end-point-name}\n${ethernet-srv-end-points-list[${1}].index-number},\n${ethernet-srv-end-points-list[${1}].eth-node-id},\n${ethernet-srv-end-points-list[${1}].eth-node-tp-id},\n${ethernet-srv-end-points-list[${1}].leafOrRootAccess}\n${ethernet-srv-end-points-list[${1}].cvlan}\n${ethernet-srv-end-points-list[${1}].CIR}\n${ethernet-srv-end-points-list[${1}].EIR}",
        "comments": "",
        "x": 1305.8833312988281,
        "y": 1677,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "e522d7e8.f0b6d",
        "type": "set",
        "name": "set ethernet-srv-end-points-list array",
        "xml": "<set>\n<!--<parameter name='`ethernet-srv-end-points-list[$epidx].ethernet-end-point-name`' value='`$tmp.aai.connectivity.connectivity-id`' />-->\n<parameter name='`ethernet-srv-end-points-list[$epidx].ethernet-end-point-name`' value='`$tmp.aai.uni.id`' />\n<parameter name='`ethernet-srv-end-points-list[$epidx].index-number`' value='0' />\n<parameter name='`ethernet-srv-end-points-list[$epidx].eth-node-id`' value='`$tmp.uni-node-id-short`' />\n<parameter name='`ethernet-srv-end-points-list[$epidx].eth-node-tp-id`' value='`$tmp.aai.uni.tp-id`' />\n<parameter name='`ethernet-srv-end-points-list[$epidx].leafOrRootAccess`' value='`$leafOrRootAccess`' />\n<parameter name='`ethernet-srv-end-points-list[$epidx].cvlan`' value='`$tmp.aai.connectivity.cvlan`' />\n<parameter name='`ethernet-srv-end-points-list[$epidx].CIR`' value='`$tmp.aai.uni.data-source * 1000000`' />\n<parameter name='`ethernet-srv-end-points-list[$epidx].EIR`' value='`$tmp.aai.uni.data-source * 1000000`' />\n\n<parameter name='`ethernet-srv-end-points-list_length`' value='`$epidx + 1`' />\n",
        "comments": "",
        "x": 1396.8833312988281,
        "y": 1731,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "402699af.4c591",
        "type": "block",
        "name": "block",
        "xml": "<block>",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 314.3833312988281,
        "y": 1411,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "784b1e5c.92c77",
                "aaf101ae.84a298",
                "dfffb0d0.b2d2d",
                "3502903c.982ab",
                "5524ecac.5cf47c",
                "a12bd239.f8368",
                "f8f2651c.3a035",
                "f84d6f72.692148",
                "5d1396ed.19b6f8",
                "1b4871a6.1cd8a6",
                "48083140.e99758",
                "d94511cd.5d63f"
            ]
        ]
    },
    {
        "id": "67ff853e.386644",
        "type": "block",
        "name": "block",
        "xml": "<block>",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 326.3833312988281,
        "y": 1348,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "aaf101ae.84a298",
                "80e8f9a6.45b808",
                "70ed09af.22122",
                "3502903c.982ab",
                "5524ecac.5cf47c",
                "a12bd239.f8368",
                "f8f2651c.3a035",
                "f84d6f72.692148",
                "5d1396ed.19b6f8",
                "1b4871a6.1cd8a6",
                "48083140.e99758",
                "d94511cd.5d63f"
            ]
        ]
    },
    {
        "id": "80e8f9a6.45b808",
        "type": "set",
        "name": "unset ethernet-srv-end-points-list",
        "xml": "<set>\n<parameter name='`ethernet-srv-end-points-list.`' value='' />\n<parameter name='`ethernet-srv-end-points-list_length`' value='0' />\n<parameter name='`epidx`' value='0' />",
        "comments": "",
        "x": 618.3833312988281,
        "y": 1233,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "784b1e5c.92c77",
        "type": "set",
        "name": "unset ethernet-srv-end-points-list",
        "xml": "<set>\n<parameter name='`ethernet-srv-end-points-list.`' value='' />\n<parameter name='`ethernet-srv-end-points-list_length`' value='0' />\n<parameter name='`epidx`' value='0' />",
        "comments": "",
        "x": 635.3833312988281,
        "y": 1327,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "3502903c.982ab",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for silentFailure='true' index='cridx' start='0' end='`$tmp.aai.connectivity.relationship-list.relationship_length`' >\n\n",
        "comments": "",
        "outputs": 1,
        "x": 561.8833312988281,
        "y": 1696,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "2dc7d020.0f01c8"
            ]
        ]
    },
    {
        "id": "2dc7d020.0f01c8",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.aai.connectivity.relationship-list.relationship[$cridx].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 793.8833312988281,
        "y": 1695,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "9a9b2fc1.cfc378"
            ]
        ]
    },
    {
        "id": "9a9b2fc1.cfc378",
        "type": "outcome",
        "name": "vpn-binding",
        "xml": "<outcome value='vpn-binding'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1005.8833312988281,
        "y": 1696,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "3ee84e3e.71c9c2"
            ]
        ]
    },
    {
        "id": "3ee84e3e.71c9c2",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 261.8833312988281,
        "y": 1852,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "a6f3ac42.8fbf28",
                "c5253df7.0ed11"
            ]
        ]
    },
    {
        "id": "c5253df7.0ed11",
        "type": "set",
        "name": "unset tmp.aai.vpn-binding",
        "xml": "<set>\n<parameter name='tmp.aai.vpn-binding.' value='' />\n",
        "comments": "",
        "x": 496.8833312988281,
        "y": 1839,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "a6f3ac42.8fbf28",
        "type": "save",
        "name": "get vpn-binding from aai",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"vpn-binding\"\n\t    key=\"vpn-binding.vpn-id = $tmp.aai.connectivity.relationship-list.relationship[$cridx].relationship-data[0].relationship-value\"\n\t\tlocal-only=\"false\" \n\t\tpfx=\"tmp.aai.vpn-binding\" >\n",
        "comments": "",
        "outputs": 1,
        "x": 486.8833312988281,
        "y": 1900,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "b27c66fe.f461f8",
                "d86a808d.b5d38",
                "51be47ba.06369"
            ]
        ]
    },
    {
        "id": "d86a808d.b5d38",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 700.3742980957031,
        "y": 1884.5740356445312,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "40ccd27e.7bf8ec"
            ]
        ]
    },
    {
        "id": "51be47ba.06369",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 695.8833312988281,
        "y": 1929,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "10ad75eb.cd3092"
            ]
        ]
    },
    {
        "id": "b27c66fe.f461f8",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 697.8833312988281,
        "y": 1989,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "f72f31f7.42e17"
            ]
        ]
    },
    {
        "id": "40ccd27e.7bf8ec",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.l3vpn.pe1_id`\" />\n\n",
        "comments": "",
        "x": 862.9458312988281,
        "y": 1883.8597412109375,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "10ad75eb.cd3092",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
        "comments": "",
        "x": 863.8833312988281,
        "y": 1929,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "f72f31f7.42e17",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 866.8833312988281,
        "y": 1988,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "c01095c8.c5a848",
                "1e0b480.37d7ab8"
            ]
        ]
    },
    {
        "id": "f8f2651c.3a035",
        "type": "set",
        "name": "set sotn_value",
        "xml": "<set>\n<!--<parameter name='eth-service-name' value='`$tmp.aai.connectivityA.connectivity-id`' />-->\n<parameter name='eth-service-name' value='`$tmp.aai.connectivity.etht-svc-name`' />\n<parameter name='slice-id' value='`$vnf-topology-operation-input.service-information.service-instance-id`' />\n<parameter name='provider-id' value='`$tmp.aai.connectivity.access-provider-id`' />\n<parameter name='client-id' value='`$tmp.aai.connectivity.access-client-id`' />\n<parameter name='topology-id' value='`$tmp.aai.connectivity.access-topology-id`' />\n<!--<parameter name='otn-tunnel-name' value='`$tmp.aai.vpn-bindingA.vpn-name`' />-->\n<!--<parameter name='ethernet-end-point-name' value='`$tmp.aai.connectivityA.connectivity-id`' />-->\n<!--<parameter name='index-number' value='0' />-->\n<!--<parameter name='eth-node-id' value='`$tmp.aai.connectivityA.access-node-id`' />-->\n<!--<parameter name='eth-node-tp-id' value='`$tmp.aai.connectivityA.access-ltp-id`' />-->\n<!--<parameter name='CIR' value='`$tmp.aai.vpn-bindingA.route-distinguisher *1000000`' />-->\n<!--<parameter name='EIR' value='`$tmp.aai.vpn-bindingA.route-distinguisher *1000000`' />-->\n<!--<parameter name='cvlan' value='`$tmp.aai.connectivityA.cvlan`' />-->\n",
        "comments": "",
        "x": 265.8833312988281,
        "y": 2487,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "f84d6f72.692148",
        "type": "execute",
        "name": "execute RestApiCallNode Create ethernet Service without token",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.cll-ethernet-service-loop.templatefile`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainConn.url + '/restconf/data/ietf-eth-tran-service:etht-svc'`\" />\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.restapi.connection-oof-url`\" />-->\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainConn.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domainConn.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"patch\"/>\n<parameter name='dirPath' value=\"/opt/onap/sdnc/restconfapi/yang\" />\n<parameter name=\"responsePrefix\" value=\"vpn-result\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n",
        "comments": "",
        "outputs": 1,
        "x": 408.8833312988281,
        "y": 2547,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "7174c4fb.4236d4",
                "3df090d7.e28cf"
            ]
        ]
    },
    {
        "id": "7174c4fb.4236d4",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 721.3833312988281,
        "y": 2524,
        "z": "db287b1f.2984a8",
        "wires": [
            []
        ]
    },
    {
        "id": "3df090d7.e28cf",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 725.3833312988281,
        "y": 2564,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "bbef1ecc.7916"
            ]
        ]
    },
    {
        "id": "4d6cfe8e.59e2a",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create ethernet service rest api\" />\n",
        "comments": "",
        "x": 901.3833312988281,
        "y": 2528,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "bbef1ecc.7916",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 916.8833312988281,
        "y": 2582,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "b94bbfec.158258"
            ]
        ]
    },
    {
        "id": "b2dda6de.cb3b28",
        "type": "save",
        "name": "update vpn-binding resource (aka. OTN ) in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding' \n      key='vpn-binding.vpn-id = $tmp.aai.vpn-binding.vpn-id' >\n<parameter name='vpn-id' value='`$tmp.aai.vpn-binding.vpn-id`' />\n<parameter name='vpn-name' value='`$tmp.aai.vpn-binding.vpn-name`' />\n\n<parameter name='operational-status' value='Activated' />\n",
        "comments": "",
        "outputs": 1,
        "x": 1212.3833312988281,
        "y": 2551,
        "z": "db287b1f.2984a8",
        "wires": [
            []
        ]
    },
    {
        "id": "1cb10652.ba5e0a",
        "type": "comment",
        "name": "TODO: FIXME",
        "info": "use proper vpn-binding id and connectivity id\n\nAlso, does CCSDK support \"update\" operation for vpn-binding and connectivity?",
        "comments": "",
        "x": 2679.383331298828,
        "y": 1902,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "b94bbfec.158258",
        "type": "save",
        "name": "update connectivity resource in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='connectivity' \n      key='connectivity.connectivity-id = $tmp.aai.connectivity.connectivity-id'>\n<parameter name='connectivity-id' value='`$tmp.aai.connectivity.connectivity-id`' />\n<parameter name='operational-status' value='Activated' />\n",
        "comments": "",
        "outputs": 1,
        "x": 1174.3833312988281,
        "y": 2593,
        "z": "db287b1f.2984a8",
        "wires": [
            []
        ]
    },
    {
        "id": "70ed09af.22122",
        "type": "set",
        "name": "set leafOrRootAccess",
        "xml": "<set>\n<parameter name='`leafOrRootAccess`' value='ietf-eth-tran-types:leaf-access' />\n",
        "comments": "",
        "x": 584.3833312988281,
        "y": 1271,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "dfffb0d0.b2d2d",
        "type": "set",
        "name": "set leafOrRootAccess",
        "xml": "<set>\n<parameter name='`leafOrRootAccess`' value='ietf-eth-tran-types:root-primary' />\n",
        "comments": "",
        "x": 597.3833312988281,
        "y": 1367,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "9521e4ca.a61af",
        "type": "save",
        "name": "update vpn-binding A resource (aka. OTN domainA) in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding' \n      key='vpn-binding.vpn-id = $tmp.aai.vpn-bindingA.vpn-id' >\n<parameter name='vpn-id' value='`$tmp.aai.vpn-bindingA.vpn-id`' />\n<parameter name='vpn-name' value='`$tmp.aai.vpn-bindingA.vpn-name`' />\n\n<parameter name='operational-status' value='Activated' />\n",
        "comments": "",
        "outputs": 1,
        "x": 4333.883331298828,
        "y": 543,
        "z": "db287b1f.2984a8",
        "wires": [
            []
        ]
    },
    {
        "id": "1d1e23b2.17cb04",
        "type": "save",
        "name": "update vpn-binding G resource (aka. OTN domainA) in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding' \n      key='vpn-binding.vpn-id = $tmp.aai.vpn-bindingG.vpn-id' >\n<parameter name='vpn-id' value='`$tmp.aai.vpn-bindingG.vpn-id`' />\n<parameter name='vpn-name' value='`$tmp.aai.vpn-bindingG.vpn-name`' />\n\n<parameter name='operational-status' value='Activated' />\n",
        "comments": "",
        "outputs": 1,
        "x": 4236.883331298828,
        "y": 1362,
        "z": "db287b1f.2984a8",
        "wires": [
            []
        ]
    },
    {
        "id": "e35a6c95.6b3d6",
        "type": "save",
        "name": "update vpn-binding B resource (aka. OTN domainB) in AAI",
        "xml": "<update plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding' \n      key='vpn-binding.vpn-id = $tmp.aai.vpn-bindingB.vpn-id' >\n<parameter name='vpn-id' value='`$tmp.aai.vpn-bindingB.vpn-id`' />\n<parameter name='vpn-name' value='`$tmp.aai.vpn-bindingB.vpn-name`' />\n\n<parameter name='operational-status' value='Activated' />\n",
        "comments": "",
        "outputs": 1,
        "x": 3730.883331298828,
        "y": 2034,
        "z": "db287b1f.2984a8",
        "wires": [
            []
        ]
    },
    {
        "id": "9c5806bb.83c05",
        "type": "switchNode",
        "name": "switch connectivity is not already Activated (i.e. is either Created or Modified)",
        "xml": "<switch test=\"`$tmp.aai.connectivity.operational-status != 'Activated' `\">\n",
        "comments": "",
        "outputs": 1,
        "x": 831.8833312988281,
        "y": 842,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "24382f34.66808",
                "ea56d949.8ce4b"
            ]
        ]
    },
    {
        "id": "24382f34.66808",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1194.8833312988281,
        "y": 865,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "d7ed30c6.74c9b"
            ]
        ]
    },
    {
        "id": "ea56d949.8ce4b",
        "type": "outcomeFalse",
        "name": "false",
        "xml": "<outcome value='false'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1194.8833312988281,
        "y": 814,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "3707e8cf.65827"
            ]
        ]
    },
    {
        "id": "d7ed30c6.74c9b",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 1350.8833312988281,
        "y": 863,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "a7f36b9f.f75b88"
            ]
        ]
    },
    {
        "id": "3707e8cf.65827",
        "type": "block",
        "name": "block",
        "xml": "<block>",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 1327.8833312988281,
        "y": 815,
        "z": "db287b1f.2984a8",
        "wires": [
            []
        ]
    },
    {
        "id": "ed4d0298.cdb578",
        "type": "set",
        "name": "unset tmp.aai.vpn-binding",
        "xml": "<set>\n<parameter name='tmp.aai.vpn-binding.' value=\"\" />\n",
        "comments": "",
        "x": 2087.883331298828,
        "y": 213,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "1ced8517.ce35e3",
        "type": "set",
        "name": "set root-otn-tunnels-list array",
        "xml": "<set>\n<parameter name='`roottunsidx`' value='`$roottunsidx + 1`' />\n",
        "comments": "",
        "x": 3629.883331298828,
        "y": 2194,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "224f4283.917d26",
        "type": "set",
        "name": "set leaf-otn-tunnels-list array",
        "xml": "<set>\n<parameter name='`leaftunsidx`' value='`$leaftunsidx + 1`' />\n",
        "comments": "",
        "x": 4219.883331298828,
        "y": 667,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "b85bac18.623698",
        "type": "set",
        "name": "set ethernet-srv-end-points-list array",
        "xml": "<set>\n<parameter name='`epidx`' value='`$epidx + 1`' />\n",
        "comments": "",
        "x": 1393.8833312988281,
        "y": 1773,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "5524ecac.5cf47c",
        "type": "set",
        "name": "set filename",
        "xml": "<set>\n<parameter name='filenameclleths' value=\"`$leafOrRootAccess + $tmp.aai.connectivity.access-node-id`\" />",
        "comments": "",
        "x": 572.8833312988281,
        "y": 1507,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "a12bd239.f8368",
        "type": "execute",
        "name": "execute printContext",
        "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='printContext' >\n    <parameter name=\"filename\" value=\"`$filenameclleths`\" />\n",
        "comments": "",
        "outputs": 1,
        "x": 603.8833312988281,
        "y": 1547,
        "z": "db287b1f.2984a8",
        "wires": [
            []
        ]
    },
    {
        "id": "c01095c8.c5a848",
        "type": "set",
        "name": "set otn-tunnels-name-list array",
        "xml": "<set>\n<parameter name='`otn-tunnels-name-list[$otntunsidx].otn-tunnel-name`' value='`$tmp.aai.vpn-binding.vpn-name`' />\n<parameter name='`otn-tunnels-name-list[$otntunsidx].vpn-id`' value='`$tmp.aai.vpn-binding.vpn-id`' />\n<parameter name='`otn-tunnels-name-list_length`' value='`$otntunsidx + 1`' />\n",
        "comments": "",
        "x": 1151.8833312988281,
        "y": 1955,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "1e0b480.37d7ab8",
        "type": "set",
        "name": "set otn-tunnels-name-list array",
        "xml": "<set>\n<parameter name='`otntunsidx`' value='`$otntunsidx + 1`' />\n",
        "comments": "",
        "x": 1154.8833312988281,
        "y": 1997,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "5d1396ed.19b6f8",
        "type": "set",
        "name": "unset otn-tunnels-name-list array",
        "xml": "<set>\n<parameter name='`otn-tunnels-name-list.`' value='' />\n<parameter name='`otn-tunnels-name-list_length`' value='0' />\n<parameter name='`otntunsidx`' value='0' />\n",
        "comments": "",
        "x": 597.8833312988281,
        "y": 1637,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "1b4871a6.1cd8a6",
        "type": "set",
        "name": "set filename",
        "xml": "<set>\n<parameter name='filenamecllotns' value=\"`leafrootOTNtunnelnames`\" />",
        "comments": "",
        "x": 352.8833312988281,
        "y": 2016,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "48083140.e99758",
        "type": "execute",
        "name": "execute printContext",
        "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='printContext' >\n    <parameter name=\"filename\" value=\"`$filenamecllotns`\" />\n",
        "comments": "",
        "outputs": 1,
        "x": 360.8833312988281,
        "y": 2073,
        "z": "db287b1f.2984a8",
        "wires": [
            []
        ]
    },
    {
        "id": "d97c4e37.51bad8",
        "type": "execute",
        "name": "execute split tp-id to get pnf-name",
        "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='split' >\n<parameter name=\"original_string\" value='`$tmp.aai.uni.id`'/>\n<!--<parameter name=\"regex\" value=\"[^-]+$\"/>-->\n<parameter name=\"regex\" value=\"[-]+\"/>\n<parameter name=\"ctx_memory_result_key\" value=\"param-prefix-uni\"/>\n\n",
        "comments": "",
        "outputs": 1,
        "x": 1371.8833312988281,
        "y": 1622,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "3df77641.8d727a",
                "f024d61d.5a31c"
            ]
        ]
    },
    {
        "id": "f024d61d.5a31c",
        "type": "failure",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1594.8833312988281,
        "y": 1577,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "3c67000e.e921c"
            ]
        ]
    },
    {
        "id": "3df77641.8d727a",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1596.8833312988281,
        "y": 1641,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "de64177a.8916f"
            ]
        ]
    },
    {
        "id": "3c67000e.e921c",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 1759.8833312988281,
        "y": 1574,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "9bea7c66.5f62c8"
            ]
        ]
    },
    {
        "id": "de64177a.8916f",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value=\"An error occured while splitting sna1_route\" />\n",
        "comments": "",
        "x": 1758.8833312988281,
        "y": 1637,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "9bea7c66.5f62c8",
        "type": "set",
        "name": "set tmp.uni-node-id-short",
        "xml": "<set>\n<parameter name='tmp.uni-node-id-short' value='`$param-prefix-uni[$param-prefix-uni_length -4]`' />\n",
        "comments": "",
        "x": 1979.8833312988281,
        "y": 1588,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "7a38583b.020a88",
        "type": "outcome",
        "name": "esr-thirdparty-sdnc",
        "xml": "<outcome value='esr-thirdparty-sdnc'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1524.8833312988281,
        "y": 2313,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "c388a6bf.f87f3"
            ]
        ]
    },
    {
        "id": "a2f5b878.ad169",
        "type": "execute",
        "name": "get esr-thirdparty-sdnc",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"esr-thirdparty-sdnc\" \n\t\tkey=\"esr-thirdparty-sdnc.thirdparty-sdnc-id = $tmp.domainConn.esr-thirdparty-id AND \n\t\t     depth = '1'\"\n        pfx='tmp.aai.domainConn.esr-thirdparty-sdnc' local-only='false' >",
        "comments": "",
        "outputs": 1,
        "x": 1909.8833312988281,
        "y": 2326,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "7866488b.2039a8",
                "bdc692ef.1c0858",
                "823a852f.40d29"
            ]
        ]
    },
    {
        "id": "c388a6bf.f87f3",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 1703.8833312988281,
        "y": 2313,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "5c79d6d8.a6a8e",
                "a2f5b878.ad169"
            ]
        ]
    },
    {
        "id": "5c79d6d8.a6a8e",
        "type": "set",
        "name": "set esr-thirdparty-sdnc domainConn id",
        "xml": "<set>\n<parameter name='tmp.domainConn.esr-thirdparty-id' value=\"`$tmp.aai.source-pnf.relationship-list.relationship[$spvidx].relationship-data[0].relationship-value`\" />\n",
        "comments": "",
        "x": 1939.8833312988281,
        "y": 2274,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "7866488b.2039a8",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2119.883331298828,
        "y": 2317,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "4da79570.cd80cc"
            ]
        ]
    },
    {
        "id": "bdc692ef.1c0858",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2111.883331298828,
        "y": 2372,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "5ef7fec5.5efb98"
            ]
        ]
    },
    {
        "id": "823a852f.40d29",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2116.883331298828,
        "y": 2429,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "57488074.1d65e"
            ]
        ]
    },
    {
        "id": "57488074.1d65e",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 2268.883331298828,
        "y": 2430,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "5ef7fec5.5efb98",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 2279.883331298828,
        "y": 2375,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "4da79570.cd80cc",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 2264.265655517578,
        "y": 2314.6556701660156,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "69f8caaf.bba51c"
            ]
        ]
    },
    {
        "id": "69f8caaf.bba51c",
        "type": "set",
        "name": "set controller domainConn data",
        "xml": "<set>\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainConn.url' value=\"`$tmp.aai.domainConn.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].service-url`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainConn.user' value=\"`$tmp.aai.domainConn.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].user-name`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domainConn.password' value=\"`$tmp.aai.domainConn.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].password`\" />\n\n\n<!--<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >-->\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/restconf/data/ietf-network:networks'`\" />-->\n<!--<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />-->\n<!--<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />-->\n<!--<parameter name=\"format\" value=\"json\"/>-->\n<!--<parameter name=\"httpMethod\" value=\"get\"/>-->\n<!--<parameter name=\"responsePrefix\" value=\"topology\"/>-->\n<!--<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>-->\n<!--<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>-->\n<!--<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>-->\n<!--<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>-->\n",
        "comments": "",
        "x": 2478.883331298828,
        "y": 2311,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "53cc84ce.e1faf4",
        "type": "get-resource",
        "name": "get-resource src pnf",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"pnf\" \n\t\tkey=\"pnf.pnf-name = $tmp.pnf-name-forUrl\"\n        pfx='tmp.aai.source-pnf' local-only='false' >\n\n        <!--AND depth = '0'\"-->\n",
        "comments": "",
        "outputs": 1,
        "x": 602.8833312988281,
        "y": 2359,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "bb343bdc.881868",
                "8bc84f5e.0473d8",
                "78444b47.33ec34"
            ]
        ]
    },
    {
        "id": "bb343bdc.881868",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 798.3834533691406,
        "y": 2311,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "bf3ecbb9.4dd008"
            ]
        ]
    },
    {
        "id": "8bc84f5e.0473d8",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 790.3834533691406,
        "y": 2366,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "ef40b092.bc09e"
            ]
        ]
    },
    {
        "id": "bf3ecbb9.4dd008",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 942.7657775878906,
        "y": 2310.6556701660156,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "1285266.d4ce8da"
            ]
        ]
    },
    {
        "id": "1285266.d4ce8da",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for silentFailure='true' index='spvidx' start='0' end='`$tmp.aai.source-pnf.relationship-list.relationship_length`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 1126.8833312988281,
        "y": 2309,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "640d04c1.8428dc"
            ]
        ]
    },
    {
        "id": "640d04c1.8428dc",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.aai.source-pnf.relationship-list.relationship[$spvidx].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1321.8833312988281,
        "y": 2309,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "7a38583b.020a88"
            ]
        ]
    },
    {
        "id": "78444b47.33ec34",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 795.3834533691406,
        "y": 2423,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "b417de17.8b3a6"
            ]
        ]
    },
    {
        "id": "b417de17.8b3a6",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 947.3834533691406,
        "y": 2424,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "ef40b092.bc09e",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 958.3834533691406,
        "y": 2367,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "fc4eafc.4810e5",
        "type": "set",
        "name": "set tmp.pnf-name-forUrl",
        "xml": "<set>\n\n<parameter name='tmp.pnf-name-forUrl' value=\"`'networkId-providerId-' +\n                                                   $tmp.aai.connectivity.access-provider-id + '-clientId-' +\n                                                   $tmp.aai.connectivity.access-client-id + '-topologyId-' +\n                                                   $tmp.aai.connectivity.access-topology-id + '-nodeId-' +\n                                                   $tmp.aai.connectivity.access-node-id`\" />\n",
        "comments": "",
        "x": 592.8833312988281,
        "y": 2271,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "d94511cd.5d63f",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 337.8833312988281,
        "y": 2402,
        "z": "db287b1f.2984a8",
        "wires": [
            [
                "fc4eafc.4810e5",
                "53cc84ce.e1faf4"
            ]
        ]
    },
    {
        "id": "1a955b8d.047dd4",
        "type": "comment",
        "name": "Temporary skipping this check - to support multiple instances in one slice",
        "info": "",
        "comments": "",
        "x": 1552.8500061035156,
        "y": 219.88333129882812,
        "z": "db287b1f.2984a8",
        "wires": []
    },
    {
        "id": "9a0e1ef7.428b9",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
        "comments": "",
        "x": 754.8833312988281,
        "y": 442,
        "z": "db287b1f.2984a8",
        "wires": []
    }
]