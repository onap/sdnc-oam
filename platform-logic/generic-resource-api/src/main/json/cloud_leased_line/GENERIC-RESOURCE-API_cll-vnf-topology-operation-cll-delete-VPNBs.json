[
    {
        "id": "3822698e.fe6a9e",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.aai.source-pnf.relationship-list.relationship[$spvidx].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2722.4332885742188,
        "y": 1488,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "61592847.4c1088"
            ]
        ]
    },
    {
        "id": "61592847.4c1088",
        "type": "outcome",
        "name": "esr-thirdparty-sdnc",
        "xml": "<outcome value='esr-thirdparty-sdnc'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2859.4332885742188,
        "y": 1576,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "a18c2b6d.4397b"
            ]
        ]
    },
    {
        "id": "62ff1995.5919b8",
        "type": "execute",
        "name": "get esr-thirdparty-sdnc",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"esr-thirdparty-sdnc\" \n\t\tkey=\"esr-thirdparty-sdnc.thirdparty-sdnc-id = $tmp.domain.esr-thirdparty-id AND \n\t\t     depth = '1'\"\n        pfx='tmp.aai.domain.esr-thirdparty-sdnc' local-only='false' >",
        "comments": "",
        "outputs": 1,
        "x": 3244.4332885742188,
        "y": 1589,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "93829917.caf878",
                "4d145f4b.31c318",
                "47a377cc.3a6e08"
            ]
        ]
    },
    {
        "id": "a18c2b6d.4397b",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 3038.4332885742188,
        "y": 1576,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "f904d45e.838058",
                "62ff1995.5919b8",
                "1ddc0d65.0a518b"
            ]
        ]
    },
    {
        "id": "f904d45e.838058",
        "type": "set",
        "name": "set esr-thirdparty-sdnc domain id",
        "xml": "<set>\n<parameter name='tmp.domain.esr-thirdparty-id' value=\"`$tmp.aai.source-pnf.relationship-list.relationship[$spvidx].relationship-data[0].relationship-value`\" />\n",
        "comments": "",
        "x": 3274.4332885742188,
        "y": 1537,
        "z": "ec6164d7.ff9708",
        "wires": []
    },
    {
        "id": "93829917.caf878",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3454.4332885742188,
        "y": 1580,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "77ca3f11.791e38"
            ]
        ]
    },
    {
        "id": "4d145f4b.31c318",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3446.4332885742188,
        "y": 1635,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "40a5f22a.13a82c"
            ]
        ]
    },
    {
        "id": "47a377cc.3a6e08",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3451.4332885742188,
        "y": 1692,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "a269a8ad.5fc788"
            ]
        ]
    },
    {
        "id": "a269a8ad.5fc788",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 3603.4332885742188,
        "y": 1693,
        "z": "ec6164d7.ff9708",
        "wires": []
    },
    {
        "id": "40a5f22a.13a82c",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 3614.4332885742188,
        "y": 1638,
        "z": "ec6164d7.ff9708",
        "wires": []
    },
    {
        "id": "77ca3f11.791e38",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 3598.8156127929688,
        "y": 1577.6556701660156,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "1f7af3e2.81853c"
            ]
        ]
    },
    {
        "id": "1f7af3e2.81853c",
        "type": "set",
        "name": "set controller domain data",
        "xml": "<set>\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domain.url' value=\"`$tmp.aai.domain.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].service-url`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domain.user' value=\"`$tmp.aai.domain.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].user-name`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domain.password' value=\"`$tmp.aai.domain.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].password`\" />\n\n\n<!--<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >-->\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/restconf/data/ietf-network:networks'`\" />-->\n<!--<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />-->\n<!--<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />-->\n<!--<parameter name=\"format\" value=\"json\"/>-->\n<!--<parameter name=\"httpMethod\" value=\"get\"/>-->\n<!--<parameter name=\"responsePrefix\" value=\"topology\"/>-->\n<!--<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>-->\n<!--<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>-->\n<!--<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>-->\n<!--<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>-->\n",
        "comments": "",
        "x": 3813.4332885742188,
        "y": 1574,
        "z": "ec6164d7.ff9708",
        "wires": []
    },
    {
        "id": "1ddc0d65.0a518b",
        "type": "break",
        "name": "break",
        "xml": "<break>\n",
        "comments": "",
        "x": 3194.4332885742188,
        "y": 1653,
        "z": "ec6164d7.ff9708",
        "wires": []
    },
    {
        "id": "e639cfa.29b4c3",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing delete OTN tunnel rest api\" />\n",
        "comments": "",
        "x": 2614.9332885742188,
        "y": 1775,
        "z": "ec6164d7.ff9708",
        "wires": []
    },
    {
        "id": "1f0101e1.8e6866",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 2610.4332885742188,
        "y": 1840,
        "z": "ec6164d7.ff9708",
        "wires": [
            []
        ]
    },
    {
        "id": "944f61d3.f96e18",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for silentFailure='true' index='spvidx' start='0' end='`$tmp.aai.source-pnf.relationship-list.relationship_length`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 2520.4331665039062,
        "y": 1561,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "3822698e.fe6a9e"
            ]
        ]
    },
    {
        "id": "63959115.b850c",
        "type": "set",
        "name": "set pnf-name",
        "xml": "<set>\n<parameter name='tmp.domain.pnf-name' value=\"`'networkId-providerId-' +\n                                                   $tmp.aai.vpn-binding.access-provider-id + '-clientId-' +\n                                                   $tmp.aai.vpn-binding.access-client-id + '-topologyId-' +\n                                                   $tmp.aai.vpn-binding.access-topology-id + '-nodeId-' +\n                                                   $tmp.aai.vpn-binding.src-access-node-id`\" />\n",
        "comments": "",
        "x": 1968.4330444335938,
        "y": 1541,
        "z": "ec6164d7.ff9708",
        "wires": []
    },
    {
        "id": "a62a741e.9cd9d",
        "type": "get-resource",
        "name": "get-resource src pnf",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"pnf\" \n\t\tkey=\"pnf.pnf-name = $tmp.domain.pnf-name\"\n        pfx='tmp.aai.source-pnf' local-only='false' >\n\n        <!--AND depth = '0'\"-->\n",
        "comments": "",
        "outputs": 1,
        "x": 1996.4331665039062,
        "y": 1611,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "ca780146.c1231",
                "2112ad82.c29caa",
                "937e0d43.e6cd18"
            ]
        ]
    },
    {
        "id": "ca780146.c1231",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2191.9332885742188,
        "y": 1563,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "7599f2ce.c74a1c"
            ]
        ]
    },
    {
        "id": "2112ad82.c29caa",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2183.9332885742188,
        "y": 1618,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "5027d99d.8613"
            ]
        ]
    },
    {
        "id": "7599f2ce.c74a1c",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 2336.3156127929688,
        "y": 1562.6556701660156,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "944f61d3.f96e18"
            ]
        ]
    },
    {
        "id": "937e0d43.e6cd18",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2188.9332885742188,
        "y": 1675,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "76756fa2.c3dc2"
            ]
        ]
    },
    {
        "id": "76756fa2.c3dc2",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 2340.9332885742188,
        "y": 1676,
        "z": "ec6164d7.ff9708",
        "wires": []
    },
    {
        "id": "5027d99d.8613",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 2351.9332885742188,
        "y": 1619,
        "z": "ec6164d7.ff9708",
        "wires": []
    },
    {
        "id": "64d61f83.5de088",
        "type": "execute",
        "name": "execute RestApiCallNode Delete OTN tunnel with token",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<!--<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.ts-otn-src-domain-creation.templatefile`\" />-->\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domain.url + '/restconf/data/ietf-te:te/tunnels/tunnel=' + $tmp.aai.vpn-binding.vpn-name`\" />\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domain.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domain.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"delete\"/>\n<parameter name=\"responsePrefix\" value=\"otn-oof\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n<parameter name='customHttpHeaders' value=\"`'X-ACCESS-TOKEN=' + $prop.sdncRestApi.token_id`\" />",
        "comments": "",
        "outputs": 1,
        "x": 2106.4332885742188,
        "y": 1805,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "847a88ab.176f8",
                "60c8b991.b738f"
            ]
        ]
    },
    {
        "id": "847a88ab.176f8",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2438.9332885742188,
        "y": 1775,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "e639cfa.29b4c3"
            ]
        ]
    },
    {
        "id": "60c8b991.b738f",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2443.9332885742188,
        "y": 1840,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "1f0101e1.8e6866"
            ]
        ]
    },
    {
        "id": "a3d6fe2.756c3",
        "type": "save",
        "name": "delete vpn-binding resource in AAI",
        "xml": "<delete plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding' \n      key='vpn-binding.vpn-id = $tmp.aai.vpn-binding.vpn-id' >\n",
        "comments": "",
        "outputs": 1,
        "x": 2029.4332885742188,
        "y": 1936,
        "z": "ec6164d7.ff9708",
        "wires": [
            []
        ]
    },
    {
        "id": "f2fb74bb.786498",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 1738.4332885742188,
        "y": 1761,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "63959115.b850c",
                "a62a741e.9cd9d",
                "64d61f83.5de088",
                "a3d6fe2.756c3",
                "d781a807.293c48",
                "c5cf8874.0fba"
            ]
        ]
    },
    {
        "id": "d781a807.293c48",
        "type": "set",
        "name": "unset tmp.aai.vpn-binding",
        "xml": "<set>\n<parameter name='tmp.aai.vpn-binding.' value=\"\" />\n",
        "comments": "",
        "x": 2017.6331176757812,
        "y": 1444,
        "z": "ec6164d7.ff9708",
        "wires": []
    },
    {
        "id": "c5cf8874.0fba",
        "type": "set",
        "name": "set tmp.aai.vpn-binding",
        "xml": "<set>\n<parameter name='tmp.aai.vpn-binding.' value=\"`$tmp.aai.all-vpn-bindings.vpn-binding[$vpnbidx].`\" />\n",
        "comments": "",
        "x": 2009.6331176757812,
        "y": 1493,
        "z": "ec6164d7.ff9708",
        "wires": []
    },
    {
        "id": "ea6bf698.38c53",
        "type": "comment",
        "name": "find all OTNs that have srcTtpOtnLayer and increase their bandwidth",
        "info": "",
        "comments": "",
        "x": 939.6170654296875,
        "y": 1565.5166015625,
        "z": "ec6164d7.ff9708",
        "wires": []
    },
    {
        "id": "6975d798.e5c738",
        "type": "save",
        "name": "get all-vpn-bindings from aai",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"vpn-bindings\"\n\t    key=\"selflink = 'https://aai.onap:8443/aai/v24/network/vpn-bindings\"\n\t\tlocal-only=\"false\" \n\t\tpfx=\"tmp.aai.all-vpn-bindings\" >\n",
        "comments": "",
        "outputs": 1,
        "x": 837.6170654296875,
        "y": 1600.5166015625,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "c993cc39.ec87d",
                "2a52cdc6.c6690a",
                "7a224e7c.af9708"
            ]
        ]
    },
    {
        "id": "c993cc39.ec87d",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1042.6170654296875,
        "y": 1597.5166015625,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "6326654e.b84854"
            ]
        ]
    },
    {
        "id": "2a52cdc6.c6690a",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1026.1080322265625,
        "y": 1659.0906372070312,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "a71bbbd1.f4a8c"
            ]
        ]
    },
    {
        "id": "7a224e7c.af9708",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1023.6170654296875,
        "y": 1702.5166015625,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "ec0ca87c.f45398"
            ]
        ]
    },
    {
        "id": "6326654e.b84854",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 1210.6173095703125,
        "y": 1592.5166015625,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "2bc4a679.cf5d3a"
            ]
        ]
    },
    {
        "id": "a71bbbd1.f4a8c",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.l3vpn.pe1_id`\" />\n\n",
        "comments": "",
        "x": 1188.679443359375,
        "y": 1659.3763732910156,
        "z": "ec6164d7.ff9708",
        "wires": []
    },
    {
        "id": "ec0ca87c.f45398",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
        "comments": "",
        "x": 1190.6170654296875,
        "y": 1701.5166015625,
        "z": "ec6164d7.ff9708",
        "wires": []
    },
    {
        "id": "2bc4a679.cf5d3a",
        "type": "for",
        "name": "for vpnidx in all-vpn-bindings",
        "xml": "<for index='vpnbidx' start='0' end='`$tmp.aai.all-vpn-bindings.vpn-binding_length`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 836.6173706054688,
        "y": 1837.5166015625,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "7c4d0989.9bb298"
            ]
        ]
    },
    {
        "id": "7c4d0989.9bb298",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic='true'>",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 1066.6171264648438,
        "y": 1825.5166015625,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "bd37314.c09c9d"
            ]
        ]
    },
    {
        "id": "bd37314.c09c9d",
        "type": "switchNode",
        "name": "switch ops-note is srcTtpOtnLayer",
        "xml": "<switch test=\"`$tmp.aai.all-vpn-bindings.vpn-binding[$vpnbidx].ops-note == $tmp.srcTtpOtnLayer `\">\n\n",
        "comments": "",
        "outputs": 1,
        "x": 1302.4335327148438,
        "y": 1824.68310546875,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "d2ea08ce.4f3608",
                "40b454d5.b7ece4"
            ]
        ]
    },
    {
        "id": "d2ea08ce.4f3608",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1532.4335327148438,
        "y": 1819.6826171875,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "f2fb74bb.786498"
            ]
        ]
    },
    {
        "id": "40b454d5.b7ece4",
        "type": "outcomeFalse",
        "name": "false",
        "xml": "<outcome value='false'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1543.4335327148438,
        "y": 1862.6826171875,
        "z": "ec6164d7.ff9708",
        "wires": [
            []
        ]
    },
    {
        "id": "3e5224b.295e95c",
        "type": "set",
        "name": "set srcTtp OTN layer",
        "xml": "<set>\n<!--<parameter name='tmp.srcTtpOtnLayer' value=\"`$tmp.pce-src-node + '-' + -->\n<!--                                             $param-prefix-domainA[$param-prefix-domainA_length -2] + '-' +-->\n<!--                                             $tmp.source.ttp-id`\" />-->\n\n<parameter name='tmp.srcTtpOtnLayer' value=\"`$tmp.pce-src-node`\" />\n\n\n",
        "comments": "",
        "x": 1161.1166381835938,
        "y": 618.3998718261719,
        "z": "ec6164d7.ff9708",
        "wires": []
    },
    {
        "id": "2f96b0a0.fe469",
        "type": "set",
        "name": "unset tmp.aai.all-vpn-bindings",
        "xml": "<set>\n<parameter name='tmp.aai.all-vpn-bindings.' value='' />\n",
        "comments": "",
        "x": 816.3167724609375,
        "y": 1526.5166015625,
        "z": "ec6164d7.ff9708",
        "wires": []
    },
    {
        "id": "8609633e.a887d8",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 580.1166381835938,
        "y": 1556.35009765625,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "2f96b0a0.fe469",
                "6975d798.e5c738"
            ]
        ]
    },
    {
        "id": "483fdff.aacb22",
        "type": "switchNode",
        "name": "switch provider-id domainA",
        "xml": "<switch test='`$allNetworksList.network-resource[$netwidx].provider-id == $param-prefix-domainA-pnfName[2]`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1506.1166381835938,
        "y": 480.3998718261719,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "c84682e7.370ef"
            ]
        ]
    },
    {
        "id": "dda9e843.2f3f18",
        "type": "for",
        "name": "for netwidx..allNetworksList_length",
        "xml": "<for index='netwidx' start='0' end='`$allNetworksList.network-resource_length`' >",
        "comments": "",
        "outputs": 1,
        "x": 1213.1166381835938,
        "y": 474.3998718261719,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "483fdff.aacb22"
            ]
        ]
    },
    {
        "id": "d616c0c5.fad828",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1468.1166381835938,
        "y": 431.3998718261719,
        "z": "ec6164d7.ff9708",
        "wires": [
            []
        ]
    },
    {
        "id": "a2a08a1a.858e78",
        "type": "set",
        "name": "unset parameters",
        "xml": "<set>\n<parameter name='tmp.pce-src-node.' value='' />\n",
        "comments": "",
        "x": 1157.1166381835938,
        "y": 526.3998718261719,
        "z": "ec6164d7.ff9708",
        "wires": []
    },
    {
        "id": "201e5d50.a3833a",
        "type": "set",
        "name": "set tmp.pce-src-node",
        "xml": "<set>\n<!--<parameter name='tmp.pce-src-node' value=\"`$param-prefix-domainA-pnfName[0] + '-' +-->\n<!--                                                   $param-prefix-domainA-pnfName[1] + '-' +-->\n<!--                                                   $param-prefix-domainA-pnfName[2] + '-' +-->\n<!--                                                   $param-prefix-domainA-pnfName[3] + '-' +-->\n<!--                                                   $param-prefix-domainA-pnfName[4] + '-' +-->\n<!--                                                   $param-prefix-domainA-pnfName[5] + '-' +-->\n<!--                                                   1 + '-' +-->\n<!--                                                   $param-prefix-domainA-pnfName[7] + '-' +-->\n<!--                                                   $param-prefix-domainA-pnfName[8]`\" />-->\n\n<parameter name='tmp.pce-src-node' value=\"`$param-prefix-domainA-pnfName[0] + '-' +\n                                                   $param-prefix-domainA-pnfName[1] + '-' +\n                                                   $param-prefix-domainA-pnfName[2] + '-' +\n                                                   $param-prefix-domainA-pnfName[3] + '-' +\n                                                   $param-prefix-domainA-pnfName[4] + '-' +\n                                                   $param-prefix-domainA-pnfName[5] + '-' +\n                                                   $otnTopoIdSrc + '-' +\n                                                   $param-prefix-domainA-pnfName[7] + '-' +\n                                                   $param-prefix-domainA-pnfName[8]`\" />",
        "comments": "",
        "x": 1165.1166381835938,
        "y": 571.3998718261719,
        "z": "ec6164d7.ff9708",
        "wires": []
    },
    {
        "id": "6eecdb5f.76c2ac",
        "type": "set",
        "name": "unset otnTopoIdSrc",
        "xml": "<set>\n<parameter name='otnTopoIdSrc' value='' />\n",
        "comments": "",
        "x": 1162.1166381835938,
        "y": 424.3998718261719,
        "z": "ec6164d7.ff9708",
        "wires": []
    },
    {
        "id": "c84682e7.370ef",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1415.1166381835938,
        "y": 548.3998718261719,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "ab0f32b5.16cbf8"
            ]
        ]
    },
    {
        "id": "ab0f32b5.16cbf8",
        "type": "switchNode",
        "name": "switch te-topo-id",
        "xml": "<switch test='`$allNetworksList.network-resource[$netwidx].te-topo-id != $param-prefix-domainA-pnfName[6]`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1600.1166381835938,
        "y": 547.3998718261719,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "51342e13.198088"
            ]
        ]
    },
    {
        "id": "3e0e37bf.5a574",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic='true'>",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 857.1166381835938,
        "y": 446.3998718261719,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "a4e53180.2dfc9",
                "128161ed.802f86",
                "a2a08a1a.858e78",
                "201e5d50.a3833a",
                "3e5224b.295e95c",
                "dda9e843.2f3f18",
                "9fcccd6f.e18a48"
            ]
        ]
    },
    {
        "id": "b0a1b203.5dc08",
        "type": "comment",
        "name": "The following section is to find srcTtp OTN layer (its long name)",
        "info": "The following section is to find srcTtp OTN layer (its long name)",
        "comments": "",
        "x": 842.1166381835938,
        "y": 380.3998718261719,
        "z": "ec6164d7.ff9708",
        "wires": []
    },
    {
        "id": "128161ed.802f86",
        "type": "get-resource",
        "name": "get-resource network-resources-list",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"network-resources\"\n\t    key=\"selflink = 'https://aai.onap:8443/aai/v24/network/network-resources?depth=0'\"\n\t\tlocal-only=\"false\" \n\t\tpfx=\"allNetworksList\" >",
        "comments": "",
        "outputs": 1,
        "x": 1221.1166381835938,
        "y": 367.3998718261719,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "6219ad91.7b0784",
                "4229f1dc.fc23b8",
                "d616c0c5.fad828"
            ]
        ]
    },
    {
        "id": "6219ad91.7b0784",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1457.1166381835938,
        "y": 350.3998718261719,
        "z": "ec6164d7.ff9708",
        "wires": [
            []
        ]
    },
    {
        "id": "4229f1dc.fc23b8",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1454.1166381835938,
        "y": 391.3998718261719,
        "z": "ec6164d7.ff9708",
        "wires": [
            []
        ]
    },
    {
        "id": "a4e53180.2dfc9",
        "type": "set",
        "name": "unset parameters",
        "xml": "<set>\n<parameter name='allNetworksList.' value='' />\n",
        "comments": "",
        "x": 1170.1166381835938,
        "y": 324.3998718261719,
        "z": "ec6164d7.ff9708",
        "wires": []
    },
    {
        "id": "51342e13.198088",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1792.1166381835938,
        "y": 550.3998718261719,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "6b44ef76.186218"
            ]
        ]
    },
    {
        "id": "6b44ef76.186218",
        "type": "set",
        "name": "set otnTopoIdSrc",
        "xml": "<set>\n<parameter name='otnTopoIdSrc' value='`$allNetworksList.network-resource[$netwidx].te-topo-id`' />\n",
        "comments": "",
        "x": 1964.1166381835938,
        "y": 546.3998718261719,
        "z": "ec6164d7.ff9708",
        "wires": []
    },
    {
        "id": "425448fb.cf113",
        "type": "dgstart",
        "name": "DGSTART",
        "outputs": 1,
        "x": 145,
        "y": 115,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "99235c0c.841188"
            ]
        ]
    },
    {
        "id": "99235c0c.841188",
        "type": "service-logic",
        "name": "GENERIC-RESOURCE-API ${project.version}",
        "module": "GENERIC-RESOURCE-API",
        "version": "${project.version}",
        "comments": "",
        "xml": "<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>",
        "outputs": 1,
        "x": 429.2856903076172,
        "y": 176.23810863494873,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "d962c511.69b1b8"
            ]
        ]
    },
    {
        "id": "d962c511.69b1b8",
        "type": "method",
        "name": "method cll-vnf-topology-operation-cll-delete-VPNBs",
        "xml": "<method rpc='cll-vnf-topology-operation-cll-delete-VPNBs' mode='sync'>\n",
        "comments": "",
        "outputs": 1,
        "x": 435.42860412597656,
        "y": 261.0000305175781,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "3e0e37bf.5a574"
            ]
        ]
    },
    {
        "id": "9fcccd6f.e18a48",
        "type": "for",
        "name": "for each relationship of middle-man-conn",
        "xml": "<for index='rel-index' start='0' end='`$middle-man-conn.relationship-list.relationship_length`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 806.63330078125,
        "y": 876.0833740234375,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "fe8b9bc1.266868"
            ]
        ]
    },
    {
        "id": "fe8b9bc1.266868",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$middle-man-conn.relationship-list.relationship[$rel-index].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1106.967041015625,
        "y": 871.0833129882812,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "a50ce6d7.7af75"
            ]
        ]
    },
    {
        "id": "a50ce6d7.7af75",
        "type": "outcome",
        "name": "connectivity",
        "xml": "<outcome value='connectivity'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1286.6336669921875,
        "y": 871.0834045410156,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "878c81c6.c1cf08"
            ]
        ]
    },
    {
        "id": "878c81c6.c1cf08",
        "type": "save",
        "name": "get connectivity from aai",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"connectivity\"\n\t    key=\"connectivity.connectivity-id = $middle-man-conn.relationship-list.relationship[$rel-index].relationship-data[0].relationship-value\"\n\t\tlocal-only=\"false\" \n\t\tpfx=\"tmp.aai.connectivity\" >\n",
        "comments": "",
        "outputs": 1,
        "x": 1486.633544921875,
        "y": 871.0833740234375,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "e5ce5572.0e9be",
                "220d084e.f1aa2",
                "8b2d18ec.0684a8"
            ]
        ]
    },
    {
        "id": "8b2d18ec.0684a8",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1717.683349609375,
        "y": 821.8831787109375,
        "z": "ec6164d7.ff9708",
        "wires": [
            []
        ]
    },
    {
        "id": "220d084e.f1aa2",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1715.1923828125,
        "y": 865.3091430664062,
        "z": "ec6164d7.ff9708",
        "wires": [
            []
        ]
    },
    {
        "id": "e5ce5572.0e9be",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1693.63330078125,
        "y": 921.0833740234375,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "adf18092.0df43"
            ]
        ]
    },
    {
        "id": "adf18092.0df43",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 695.866943359375,
        "y": 1018.2830810546875,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "841267bf.5a37d8"
            ]
        ]
    },
    {
        "id": "841267bf.5a37d8",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for silentFailure='true' index='cridx' start='0' end='`$tmp.aai.connectivity.relationship-list.relationship_length`' >\n\n",
        "comments": "",
        "outputs": 1,
        "x": 869.866943359375,
        "y": 1020.2830810546875,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "83e51395.23054"
            ]
        ]
    },
    {
        "id": "83e51395.23054",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.aai.connectivity.relationship-list.relationship[$cridx].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1066.866943359375,
        "y": 1034.2830810546875,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "20d4597f.7ec4fe"
            ]
        ]
    },
    {
        "id": "20d4597f.7ec4fe",
        "type": "outcome",
        "name": "vpn-binding",
        "xml": "<outcome value='vpn-binding'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1234.866943359375,
        "y": 1027.2830810546875,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "962e1e07.ed3e1"
            ]
        ]
    },
    {
        "id": "962e1e07.ed3e1",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 1397.866943359375,
        "y": 1027.2830810546875,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "b3331932.59a4e"
            ]
        ]
    },
    {
        "id": "b3331932.59a4e",
        "type": "save",
        "name": "get vpn-binding from aai",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"vpn-binding\"\n\t    key=\"vpn-binding.vpn-id = $tmp.aai.connectivity.relationship-list.relationship[$cridx].relationship-data[0].relationship-value\"\n\t\tlocal-only=\"false\" \n\t\tpfx=\"tmp.aai.vpn-binding\" >\n",
        "comments": "",
        "outputs": 1,
        "x": 1073.866943359375,
        "y": 1167.2830810546875,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "1d1a3767.b90801",
                "1205c3c9.a1fe14",
                "ac824193.0ceb4"
            ]
        ]
    },
    {
        "id": "1d1a3767.b90801",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1284.866943359375,
        "y": 1169.2830810546875,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "ce3bd26f.86a788"
            ]
        ]
    },
    {
        "id": "1205c3c9.a1fe14",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1285.35791015625,
        "y": 1214.8571166992188,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "8c52b3a4.bb9928"
            ]
        ]
    },
    {
        "id": "ac824193.0ceb4",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1282.866943359375,
        "y": 1258.2830810546875,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "b8796894.76af28"
            ]
        ]
    },
    {
        "id": "8c52b3a4.bb9928",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.l3vpn.pe1_id`\" />\n\n",
        "comments": "",
        "x": 1447.9293212890625,
        "y": 1215.1428527832031,
        "z": "ec6164d7.ff9708",
        "wires": []
    },
    {
        "id": "b8796894.76af28",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
        "comments": "",
        "x": 1449.866943359375,
        "y": 1257.2830810546875,
        "z": "ec6164d7.ff9708",
        "wires": []
    },
    {
        "id": "3d324826.e49518",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 2047.866943359375,
        "y": 1097.2830810546875,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "cd0aab83.f02f78",
                "8058933f.2691e",
                "f481dab1.2bbd68",
                "119a4845.874928",
                "5f76b8d0.e5e58"
            ]
        ]
    },
    {
        "id": "cd0aab83.f02f78",
        "type": "set",
        "name": "set pnf-name",
        "xml": "<set>\n<parameter name='tmp.domain.pnf-name' value=\"`'networkId-providerId-' +\n                                                   $tmp.aai.vpn-binding.access-provider-id + '-clientId-' +\n                                                   $tmp.aai.vpn-binding.access-client-id + '-topologyId-' +\n                                                   $tmp.aai.vpn-binding.access-topology-id + '-nodeId-' +\n                                                   $tmp.aai.vpn-binding.src-access-node-id`\" />\n",
        "comments": "",
        "x": 2269.866943359375,
        "y": 815.2830810546875,
        "z": "ec6164d7.ff9708",
        "wires": []
    },
    {
        "id": "8058933f.2691e",
        "type": "get-resource",
        "name": "get-resource src pnf",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"pnf\" \n\t\tkey=\"pnf.pnf-name = $tmp.domain.pnf-name\"\n        pfx='tmp.aai.source-pnf' local-only='false' >\n\n        <!--AND depth = '0'\"-->\n",
        "comments": "",
        "outputs": 1,
        "x": 2295.866943359375,
        "y": 932.2830810546875,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "d483622c.685ad",
                "b6de022b.29ab58",
                "e510b446.5dd1e8"
            ]
        ]
    },
    {
        "id": "f481dab1.2bbd68",
        "type": "execute",
        "name": "execute RestApiCallNode Delete OTN tunnel with token",
        "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<!--<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.ts-otn-src-domain-creation.templatefile`\" />-->\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domain.url + '/restconf/data/ietf-te:te/tunnels/tunnel=' + $tmp.aai.vpn-binding.vpn-name`\" />\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domain.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.domain.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"delete\"/>\n<parameter name=\"responsePrefix\" value=\"otn-oof\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n<parameter name='customHttpHeaders' value=\"`'X-ACCESS-TOKEN=' + $prop.sdncRestApi.token_id`\" />",
        "comments": "",
        "outputs": 1,
        "x": 2398.866943359375,
        "y": 1199.2830810546875,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "422a3d0e.0ac58c",
                "dc94e365.153108"
            ]
        ]
    },
    {
        "id": "d483622c.685ad",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2491.3670654296875,
        "y": 884.2830810546875,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "d09e0056.1e082"
            ]
        ]
    },
    {
        "id": "b6de022b.29ab58",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2483.3670654296875,
        "y": 939.2830810546875,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "9a521350.d6234"
            ]
        ]
    },
    {
        "id": "d09e0056.1e082",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 2625.749267578125,
        "y": 878.9388427734375,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "f0956103.d162e8"
            ]
        ]
    },
    {
        "id": "e510b446.5dd1e8",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2488.3670654296875,
        "y": 996.2830810546875,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "e16f9ab0.64cc3"
            ]
        ]
    },
    {
        "id": "e16f9ab0.64cc3",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 2640.3670654296875,
        "y": 997.2830810546875,
        "z": "ec6164d7.ff9708",
        "wires": []
    },
    {
        "id": "9a521350.d6234",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 2651.3670654296875,
        "y": 940.2830810546875,
        "z": "ec6164d7.ff9708",
        "wires": []
    },
    {
        "id": "f0956103.d162e8",
        "type": "for",
        "name": "for each relationship",
        "xml": "<for silentFailure='true' index='spvidx' start='0' end='`$tmp.aai.source-pnf.relationship-list.relationship_length`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 2812.866455078125,
        "y": 880.2830810546875,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "af503a6c.61f9f8"
            ]
        ]
    },
    {
        "id": "af503a6c.61f9f8",
        "type": "switchNode",
        "name": "switch related-to",
        "xml": "<switch test='`$tmp.aai.source-pnf.relationship-list.relationship[$spvidx].related-to`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3053.866455078125,
        "y": 871.2830810546875,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "b61fba47.4726f8"
            ]
        ]
    },
    {
        "id": "422a3d0e.0ac58c",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2706.366455078125,
        "y": 1224.2830810546875,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "dec1fd1f.efb3a"
            ]
        ]
    },
    {
        "id": "dc94e365.153108",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 2707.366455078125,
        "y": 1169.2830810546875,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "52cd10d1.f921d8"
            ]
        ]
    },
    {
        "id": "dec1fd1f.efb3a",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing delete OTN tunnel rest api\" />\n",
        "comments": "",
        "x": 2878.366455078125,
        "y": 1222.2830810546875,
        "z": "ec6164d7.ff9708",
        "wires": []
    },
    {
        "id": "52cd10d1.f921d8",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 2874.866455078125,
        "y": 1171.2830810546875,
        "z": "ec6164d7.ff9708",
        "wires": [
            []
        ]
    },
    {
        "id": "a1fe3dae.a2d208",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 3410.8662109375,
        "y": 820.2830810546875,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "e7174ef6.88aea",
                "bfd51d3e.a21cb8",
                "b48cd5e6.4e4b88"
            ]
        ]
    },
    {
        "id": "b61fba47.4726f8",
        "type": "outcome",
        "name": "esr-thirdparty-sdnc",
        "xml": "<outcome value='esr-thirdparty-sdnc'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3259.866455078125,
        "y": 868.2830810546875,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "a1fe3dae.a2d208"
            ]
        ]
    },
    {
        "id": "bfd51d3e.a21cb8",
        "type": "execute",
        "name": "get esr-thirdparty-sdnc",
        "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"esr-thirdparty-sdnc\" \n\t\tkey=\"esr-thirdparty-sdnc.thirdparty-sdnc-id = $tmp.domain.esr-thirdparty-id AND \n\t\t     depth = '1'\"\n        pfx='tmp.aai.domain.esr-thirdparty-sdnc' local-only='false' >",
        "comments": "",
        "outputs": 1,
        "x": 3616.8662109375,
        "y": 833.2830810546875,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "cb1cf6fc.9ef978",
                "7d19de07.9d61",
                "2bc4bb18.4f1464"
            ]
        ]
    },
    {
        "id": "e7174ef6.88aea",
        "type": "set",
        "name": "set esr-thirdparty-sdnc domain id",
        "xml": "<set>\n<parameter name='tmp.domain.esr-thirdparty-id' value=\"`$tmp.aai.source-pnf.relationship-list.relationship[$spvidx].relationship-data[0].relationship-value`\" />\n",
        "comments": "",
        "x": 3646.8662109375,
        "y": 781.2830810546875,
        "z": "ec6164d7.ff9708",
        "wires": []
    },
    {
        "id": "cb1cf6fc.9ef978",
        "type": "success",
        "name": "success",
        "xml": "<outcome value='success'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3826.8662109375,
        "y": 824.2830810546875,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "a4768784.394af8"
            ]
        ]
    },
    {
        "id": "7d19de07.9d61",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3818.8662109375,
        "y": 879.2830810546875,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "4478591a.9ef568"
            ]
        ]
    },
    {
        "id": "2bc4bb18.4f1464",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 3823.8662109375,
        "y": 936.2830810546875,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "23b7e106.ef601e"
            ]
        ]
    },
    {
        "id": "b48cd5e6.4e4b88",
        "type": "break",
        "name": "break",
        "xml": "<break>\n",
        "comments": "",
        "x": 3566.8662109375,
        "y": 897.2830810546875,
        "z": "ec6164d7.ff9708",
        "wires": []
    },
    {
        "id": "23b7e106.ef601e",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 3975.8662109375,
        "y": 937.2830810546875,
        "z": "ec6164d7.ff9708",
        "wires": []
    },
    {
        "id": "4478591a.9ef568",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
        "comments": "",
        "x": 3986.8662109375,
        "y": 882.2830810546875,
        "z": "ec6164d7.ff9708",
        "wires": []
    },
    {
        "id": "a4768784.394af8",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 3971.24853515625,
        "y": 821.9387512207031,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "98ec4d86.407d4"
            ]
        ]
    },
    {
        "id": "98ec4d86.407d4",
        "type": "set",
        "name": "set controller domain data",
        "xml": "<set>\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domain.url' value=\"`$tmp.aai.domain.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].service-url`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domain.user' value=\"`$tmp.aai.domain.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].user-name`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.domain.password' value=\"`$tmp.aai.domain.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].password`\" />\n\n\n<!--<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >-->\n<!--<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/restconf/data/ietf-network:networks'`\" />-->\n<!--<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />-->\n<!--<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />-->\n<!--<parameter name=\"format\" value=\"json\"/>-->\n<!--<parameter name=\"httpMethod\" value=\"get\"/>-->\n<!--<parameter name=\"responsePrefix\" value=\"topology\"/>-->\n<!--<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.onap.client.jks\"/>-->\n<!--<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>-->\n<!--<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>-->\n<!--<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>-->\n",
        "comments": "",
        "x": 4185.8662109375,
        "y": 818.2830810546875,
        "z": "ec6164d7.ff9708",
        "wires": []
    },
    {
        "id": "371b3631.1fe46a",
        "type": "switchNode",
        "name": "switch ops-note is srcTtpOtnLayer",
        "xml": "<switch test=\"`$tmp.aai.vpn-binding.ops-note == $tmp.srcTtpOtnLayer `\">\n\n",
        "comments": "",
        "outputs": 1,
        "x": 1660.0999755859375,
        "y": 1107.2833251953125,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "5dda0eba.cba228",
                "cd15371c.43ee48"
            ]
        ]
    },
    {
        "id": "5dda0eba.cba228",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1890.0999755859375,
        "y": 1102.2828369140625,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "3d324826.e49518"
            ]
        ]
    },
    {
        "id": "cd15371c.43ee48",
        "type": "outcomeFalse",
        "name": "false",
        "xml": "<outcome value='false'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1901.0999755859375,
        "y": 1145.2828369140625,
        "z": "ec6164d7.ff9708",
        "wires": [
            []
        ]
    },
    {
        "id": "ce3bd26f.86a788",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic='true'>",
        "atomic": "true",
        "comments": "",
        "outputs": 1,
        "x": 1440.0999755859375,
        "y": 1164.683349609375,
        "z": "ec6164d7.ff9708",
        "wires": [
            [
                "371b3631.1fe46a"
            ]
        ]
    },
    {
        "id": "119a4845.874928",
        "type": "save",
        "name": "delete vpn-binding resource in AAI",
        "xml": "<delete plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding' \n      key='vpn-binding.vpn-id = $tmp.aai.vpn-binding.vpn-id' >\n",
        "comments": "",
        "outputs": 1,
        "x": 2345.816650390625,
        "y": 1314.4833984375,
        "z": "ec6164d7.ff9708",
        "wires": [
            []
        ]
    },
    {
        "id": "5f76b8d0.e5e58",
        "type": "set",
        "name": "set Underlay OTN Tunnel Name tmp.underlayOTN",
        "xml": "<set>\n<parameter name='tmp.underlayOTN' value=\"`$tmp.aai.vpn-binding.vpn-name`\" />\n",
        "comments": "",
        "x": 2348.0330810546875,
        "y": 750.2833251953125,
        "z": "ec6164d7.ff9708",
        "wires": []
    }
]