[{"id":"e2e49656.8ebb48","type":"dgstart","name":"DGSTART","outputs":1,"x":131.42857360839844,"y":110.98508548736572,"z":"18647007.5f06e","wires":[["c454fe16.3ed8a"]]},{"id":"c454fe16.3ed8a","type":"service-logic","name":"GENERIC-RESOURCE-API ${project.version}","module":"GENERIC-RESOURCE-API","version":"${project.version}","comments":"","xml":"<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>","outputs":1,"x":246.7142791748047,"y":150.55653285980225,"z":"18647007.5f06e","wires":[["be96a73d.265e28"]]},{"id":"be96a73d.265e28","type":"method","name":"method vf-module-topology-operation-unassign","xml":"<method rpc='vf-module-topology-operation-unassign' mode='sync'>\n","comments":"","outputs":1,"x":253.52387237548828,"y":190.98508167266846,"z":"18647007.5f06e","wires":[["81c49a47.fca5c8"]]},{"id":"9d3efd4.31149","type":"comment","name":"vf-module-topology-operation-unassign","info":"","comments":"","x":525.7734298706055,"y":58.57142925262451,"z":"18647007.5f06e","wires":[]},{"id":"c861a71.bf35958","type":"switchNode","name":"switch request-action","xml":"<switch test='`$vf-module-topology-operation-input.request-information.request-action`'>\n","comments":"","outputs":1,"x":536.6190338134766,"y":408.1755590438843,"z":"18647007.5f06e","wires":[["6b156d65.ae2c94","48863ddd.c15a14"]]},{"id":"6b156d65.ae2c94","type":"outcome","name":"DeleteVfModuleInstance","xml":"<outcome value='DeleteVfModuleInstance'>\n","comments":"","outputs":1,"x":798.6666488647461,"y":385.3184452056885,"z":"18647007.5f06e","wires":[["6429f10d.9c11b"]]},{"id":"48863ddd.c15a14","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":742.3332939147949,"y":430.6994342803955,"z":"18647007.5f06e","wires":[["3ad1862d.4098ea"]]},{"id":"6429f10d.9c11b","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":988.5238132476807,"y":385.3184766769409,"z":"18647007.5f06e","wires":[[]]},{"id":"3ad1862d.4098ea","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"If svc-action is 'deactivate' then request-action must be 'DeleteVfModuleInstance'\" />\n","comments":"","x":1007.3333015441895,"y":431.0327467918396,"z":"18647007.5f06e","wires":[]},{"id":"218fe261.ee2e0e","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":159.04767608642578,"y":1502.8897886276245,"z":"18647007.5f06e","wires":[["863442bb.c35bd","23bca180.487f5e","e49fcf2c.dc6dd","f2229878.1d7b18","fc31741.0ef9088","165bb54c.1c4a5b","ab2d7b3e.268578","35514a27.0c3786","eec63ebd.14593","e0000fd9.cea29"]]},{"id":"13f7711f.d4863f","type":"switchNode","name":"switch service-data.vnfs.vnf_length","xml":"<switch test='`$service-data.vnfs.vnf_length`'>\n","comments":"","outputs":1,"x":583.0952072143555,"y":552.6517343521118,"z":"18647007.5f06e","wires":[["431af51d.d60c3c","2f013004.d53e4"]]},{"id":"431af51d.d60c3c","type":"other","name":"NULL","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":823.8094787597656,"y":529.7944746017456,"z":"18647007.5f06e","wires":[["5ca2ab6d.26e0f4"]]},{"id":"2f013004.d53e4","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":823.5713195800781,"y":570.7469930648804,"z":"18647007.5f06e","wires":[["936aceca.3de96"]]},{"id":"5ca2ab6d.26e0f4","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"There are no VNFs defined in MD-SAL\" />\n","comments":"","x":990.4760932922363,"y":529.0802297592163,"z":"18647007.5f06e","wires":[]},{"id":"936aceca.3de96","type":"for","name":"for each vnf","xml":"<for index='idx' start='0' end='`$service-data.vnfs.vnf_length`' >\n","comments":"","outputs":1,"x":985.8094635009766,"y":570.4136114120483,"z":"18647007.5f06e","wires":[["14ab3d7f.68c0e3"]]},{"id":"14ab3d7f.68c0e3","type":"switchNode","name":"switch service data vnf == input vnf","xml":"<switch test='`$service-data.vnfs.vnf[$idx].vnf-id == $vf-module-topology-operation-input.vnf-information.vnf-id`'>\n","comments":"","outputs":1,"x":1237.1426811218262,"y":570.0802984237671,"z":"18647007.5f06e","wires":[["64ab69be.8fcc48"]]},{"id":"64ab69be.8fcc48","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":1467.1427726745605,"y":569.413652420044,"z":"18647007.5f06e","wires":[["b3bf1d7.e779de"]]},{"id":"1f2343f9.c1656c","type":"set","name":"set vnf-index to -1","xml":"<set>\n<parameter name='vnf-index' value='-1' />\n","comments":"","x":532.1428298950195,"y":484.0802335739136,"z":"18647007.5f06e","wires":[]},{"id":"2904a72b.2ba948","type":"set","name":"set vnf-index to idx","xml":"<set>\n<parameter name='vnf-index' value='`$idx`' />\n","comments":"","x":1788.8094100952148,"y":540.413610458374,"z":"18647007.5f06e","wires":[]},{"id":"6dfcbf43.c96e3","type":"switchNode","name":"switch vnf-index","xml":"<switch test='`$vnf-index`'>\n","comments":"","outputs":1,"x":522.1428375244141,"y":620.7469301223755,"z":"18647007.5f06e","wires":[["52af09ac.eaca28"]]},{"id":"52af09ac.eaca28","type":"outcome","name":"-1","xml":"<outcome value='-1'>\n","comments":"","outputs":1,"x":700.4762229919434,"y":620.0803060531616,"z":"18647007.5f06e","wires":[["c4d376c3.571488"]]},{"id":"c4d376c3.571488","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unable to find VNF ID ' + $vf-module-topology-operation-input.vnf-information.vnf-id + ' in MD-SAL'`\" />\n","comments":"","x":860.476131439209,"y":619.4136095046997,"z":"18647007.5f06e","wires":[]},{"id":"b3bf1d7.e779de","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1615.4762344360352,"y":568.3333511352539,"z":"18647007.5f06e","wires":[["2904a72b.2ba948","63b441b0.29b2"]]},{"id":"63b441b0.29b2","type":"break","name":"break","xml":"<break>\n","comments":"","x":1750.4762001037598,"y":589.9999370574951,"z":"18647007.5f06e","wires":[]},{"id":"3d580cb8.2983e4","type":"switchNode","name":"switch vf-module_length","xml":"<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length`'>\n","comments":"","outputs":1,"x":546.4285202026367,"y":742.6517381668091,"z":"18647007.5f06e","wires":[["59c54cf2.fb7004","28df31c9.48452e"]]},{"id":"59c54cf2.fb7004","type":"other","name":"NULL","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":730.4761581420898,"y":721.461142539978,"z":"18647007.5f06e","wires":[["4541f6e8.947688"]]},{"id":"28df31c9.48452e","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":730.2379989624023,"y":762.4136610031128,"z":"18647007.5f06e","wires":[["78b66442.fbfd7c"]]},{"id":"4541f6e8.947688","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'There are no VF modules defined in MD-SAL for VNF ' + $vf-module-topology-operation-input.vnf-information.vnf-id`\" />\n","comments":"","x":897.1427726745605,"y":720.7468976974487,"z":"18647007.5f06e","wires":[]},{"id":"78b66442.fbfd7c","type":"for","name":"for each vf-module","xml":"<for index='idx' start='0' end='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length`' >\n","comments":"","outputs":1,"x":892.4761428833008,"y":762.0802793502808,"z":"18647007.5f06e","wires":[["70b1df72.cfb8d"]]},{"id":"70b1df72.cfb8d","type":"switchNode","name":"switch service data vf-module == input vf-module","xml":"<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$idx].vf-module-id == $vf-module-topology-operation-input.vf-module-information.vf-module-id`'>\n","comments":"","outputs":1,"x":1198.8093032836914,"y":761.7470149993896,"z":"18647007.5f06e","wires":[["bc3ab08b.f7f65"]]},{"id":"bc3ab08b.f7f65","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":1468.8093566894531,"y":759.4136199951172,"z":"18647007.5f06e","wires":[["7ed3c4ad.1b318c"]]},{"id":"b33a0450.724278","type":"set","name":"set vf-module-index to -1","xml":"<set>\n<parameter name='vf-module-index' value='-1' />\n","comments":"","x":552.1428146362305,"y":677.4135961532593,"z":"18647007.5f06e","wires":[]},{"id":"c88bc5a0.0aa9d8","type":"set","name":"set vf-module-index to idx","xml":"<set>\n<parameter name='vf-module-index' value='`$idx`' />\n","comments":"","x":1798.8094482421875,"y":730.4135990142822,"z":"18647007.5f06e","wires":[]},{"id":"f25bb144.7f7c8","type":"switchNode","name":"switch vf-module-index","xml":"<switch test='`$vf-module-index`'>\n","comments":"","outputs":1,"x":543.809497833252,"y":814.0803089141846,"z":"18647007.5f06e","wires":[["ea2e1080.af206"]]},{"id":"ea2e1080.af206","type":"outcome","name":"-1","xml":"<outcome value='-1'>\n","comments":"","outputs":1,"x":722.1428833007812,"y":813.4136848449707,"z":"18647007.5f06e","wires":[["c0ea9272.92129"]]},{"id":"c0ea9272.92129","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unable to find VF module ID ' + $vf-module-topology-operation-input.vf-module-information.vf-module-id + ' in MD-SAL'`\" />\n","comments":"","x":882.1427917480469,"y":812.7469882965088,"z":"18647007.5f06e","wires":[]},{"id":"7ed3c4ad.1b318c","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1602.1428985595703,"y":758.3333597183228,"z":"18647007.5f06e","wires":[["c88bc5a0.0aa9d8","b5fd65f0.dd1658"]]},{"id":"b5fd65f0.dd1658","type":"break","name":"break","xml":"<break>\n","comments":"","x":1737.142864227295,"y":779.999945640564,"z":"18647007.5f06e","wires":[]},{"id":"459ba9fe.95a3b8","type":"switchNode","name":"switch order-status","xml":"<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-level-oper-status.order-status`'>\n","comments":"","outputs":1,"x":535.7143173217773,"y":1306.223168373108,"z":"18647007.5f06e","wires":[["dff3e662.ab0f08","5d3cf475.3a3f0c"]]},{"id":"dff3e662.ab0f08","type":"outcome","name":"Created","xml":"<outcome value='Created'>\n","comments":"","outputs":1,"x":711.5476875305176,"y":1268.7232003211975,"z":"18647007.5f06e","wires":[["17b63642.fdbe0a"]]},{"id":"5d3cf475.3a3f0c","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":710.7143058776855,"y":1326.2231512069702,"z":"18647007.5f06e","wires":[["fdf39a89.b626b8"]]},{"id":"17b63642.fdbe0a","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Order status must not be Created\" />\n","comments":"","x":879.8809280395508,"y":1268.723129749298,"z":"18647007.5f06e","wires":[]},{"id":"fdf39a89.b626b8","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":885.7143173217773,"y":1325.8898267745972,"z":"18647007.5f06e","wires":[[]]},{"id":"23bca180.487f5e","type":"update","name":"update EIPAM_IP_ASSIGNMENTS to PENDING_DELETE...","xml":"<update plugin=\"org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource\" resource=\"SQL\"\nkey=\"UPDATE EIPAM_IP_ASSIGNMENTS set status = $tmp.status WHERE info = $service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-topology-identifier.vf-module-id\" >","comments":"","outputs":1,"x":662.3810424804688,"y":1422.8898191452026,"z":"18647007.5f06e","wires":[["e0899af7.954688"]]},{"id":"863442bb.c35bd","type":"set","name":"set status variable","xml":"<set>\n<parameter name='tmp.status' value=\"`'PENDING_DELETE_' + $service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-topology-identifier.vf-module-id`\" />\n","comments":"","x":532.3810119628906,"y":1376.2231512069702,"z":"18647007.5f06e","wires":[]},{"id":"e0899af7.954688","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":967.3809509277344,"y":1421.2231187820435,"z":"18647007.5f06e","wires":[["e02614ec.c27ce8"]]},{"id":"e02614ec.c27ce8","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating EIPAM_IP_ASSIGNMENTS table\" />\n","comments":"","x":1157.3809776306152,"y":1421.0328540802002,"z":"18647007.5f06e","wires":[]},{"id":"165bb54c.1c4a5b","type":"execute","name":"execute EIPAM unassign IP addresses","xml":"<execute plugin=\"com.att.sdnctl.sli.plugin.eipam.EIPAMPlugin\" method=\"unassignIPAddress\">\n<parameter name=\"deleteEIPAM_status\" value=\"`$tmp.status`\" />\n","comments":"","outputs":1,"x":595.7143402099609,"y":1517.8898401260376,"z":"18647007.5f06e","wires":[["1ec6a5cd.de1d1a"]]},{"id":"1ec6a5cd.de1d1a","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":832.3809661865234,"y":1517.8897829055786,"z":"18647007.5f06e","wires":[["ea2d8dc1.6c576"]]},{"id":"ea2d8dc1.6c576","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error in EIPAM unassign IP address\" />\n","comments":"","x":1022.3809928894043,"y":1517.6995182037354,"z":"18647007.5f06e","wires":[]},{"id":"e49fcf2c.dc6dd","type":"for","name":"for each vm-type","xml":"<for silentFailure='true' index='vm-type-index' start='0' end='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-assignments.vms.vm_length`' >\n","comments":"","outputs":1,"x":527.3809967041016,"y":1562.8898010253906,"z":"18647007.5f06e","wires":[["633220ab.96e4c"]]},{"id":"633220ab.96e4c","type":"for","name":"for each vm","xml":"<for silentFailure='true' index='vm-index' start='0' end='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-count`' >\n","comments":"","outputs":1,"x":722.3810272216797,"y":1562.2228088378906,"z":"18647007.5f06e","wires":[["f69b3abe.d94218"]]},{"id":"50fe8de0.64f3a4","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1429.048095703125,"y":1560.5554113388062,"z":"18647007.5f06e","wires":[["ef7ad1cb.324"]]},{"id":"5ad8acf2.2bc374","type":"comment","name":"Not a failure","info":"","comments":"","x":1707.3810920715332,"y":1558.8892135620117,"z":"18647007.5f06e","wires":[]},{"id":"ef7ad1cb.324","type":"record","name":"record","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"GENERIC-RESOURCE-API.vf-module-topology-operation-assign:REQID\"/>\n<parameter name=\"field3\" value=\"`$vf-module-topology-operation-input.sdnc-request-header.svc-request-id`\"/>\n<parameter name=\"field4\" value=\"Failed to insert VIPR_CONFIGURATION record\"/>\n","comments":"","outputs":1,"x":1575.0480308532715,"y":1560.5560445785522,"z":"18647007.5f06e","wires":[[]]},{"id":"f69b3abe.d94218","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":890.7144203186035,"y":1561.222653388977,"z":"18647007.5f06e","wires":[["f06c39d0.0e3498"]]},{"id":"f06c39d0.0e3498","type":"delete","name":"delete any records in VIPR_CONFIGURATION","xml":"<delete plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource' resource='SQL'\n  key='DELETE from VIPR_CONFIGURATION WHERE vnf_id = $service-data.vnfs.vnf[$vnf-index].vnf-id\n     AND ecomp_service_instance_id = $service-data.service-information.service-instance-id\n     AND vm_name = $service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vm-name[$vm-index]' >","comments":"","outputs":1,"x":1177.3811340332031,"y":1560.8900833129883,"z":"18647007.5f06e","wires":[["50fe8de0.64f3a4"]]},{"id":"e8c6edd8.95256","type":"for","name":"for each vf module","xml":"<for index='idx' start='`$vf-module-index + 1`' end='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length`' >\n","comments":"","outputs":1,"x":1102.8888092041016,"y":2668.2228231430054,"z":"18647007.5f06e","wires":[["fb0fd2dc.832a4"]]},{"id":"cfa852b0.966f1","type":"comment","name":"Remove VF Module from service data","info":"","comments":"","x":481.7143096923828,"y":2623.461263656616,"z":"18647007.5f06e","wires":[]},{"id":"fb0fd2dc.832a4","type":"set","name":"move vf module to remove one","xml":"<set>\n\t<parameter name=\"tmpidx\" value=\"`$idx - 1`\"/>\n\t<parameter name=\"service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$tmpidx].\" value=\"$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$idx].\" />\n\t\n","comments":"","x":1346.4799423217773,"y":2667.2467889785767,"z":"18647007.5f06e","wires":[]},{"id":"f2229878.1d7b18","type":"switchNode","name":"switch vf-module_length","xml":"<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length`'>\n","comments":"","outputs":1,"x":549.146728515625,"y":2679.5644941329956,"z":"18647007.5f06e","wires":[["a6cda6a3.e5d988","5accced2.4e3d3"]]},{"id":"a6cda6a3.e5d988","type":"outcome","name":"1","xml":"<outcome value='1'>\n","comments":"","outputs":1,"x":744.480094909668,"y":2630.4691009521484,"z":"18647007.5f06e","wires":[["7a4f4b98.b84d24"]]},{"id":"7a4f4b98.b84d24","type":"set","name":"Remove vf modules","xml":"<set>\n\t<parameter name=\"service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.\" value=\"\"/>\n\n","comments":"","x":916.479866027832,"y":2630.469220161438,"z":"18647007.5f06e","wires":[]},{"id":"5accced2.4e3d3","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":743.1468505859375,"y":2725.2309103012085,"z":"18647007.5f06e","wires":[["7e34b293.efbcdc"]]},{"id":"86f76706.4026a8","type":"set","name":"set new vf module length","xml":"<set>\n\t<parameter name=\"service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length\" value=\"`$lastidx`\"/>\n\n\t\n","comments":"","x":1121.7763442993164,"y":2795.945300102234,"z":"18647007.5f06e","wires":[]},{"id":"cae448bb.baecd8","type":"set","name":"Remove the last vf module in the list","xml":"<set>\n\t<parameter name=\"service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$lastidx].\" value=\"\"/>\n","comments":"","x":1157.4799575805664,"y":2752.0564374923706,"z":"18647007.5f06e","wires":[]},{"id":"7e34b293.efbcdc","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":900.3847808837891,"y":2724.468912124634,"z":"18647007.5f06e","wires":[["e8c6edd8.95256","cae448bb.baecd8","86f76706.4026a8","2a268ef.d194272"]]},{"id":"fc31741.0ef9088","type":"returnSuccess","name":"return success","xml":"<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n","comments":"","x":521.7143402099609,"y":2856.080117225647,"z":"18647007.5f06e","wires":[]},{"id":"ab2d7b3e.268578","type":"set","name":"set service-type","xml":"<set>\n<parameter name='service-data.service-information.service-type' value='`$service-data.service-information.subscription-service-type`' />\n","comments":"EIPAM plug-in needs this attribute set with this name","x":524.0476531982422,"y":1468.8094816207886,"z":"18647007.5f06e","wires":[]},{"id":"2a268ef.d194272","type":"set","name":"set lastidx","xml":"<set>\n<parameter name='lastidx' value='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length - 1`' />\n","comments":"EIPAM plug-in needs this attribute set with this name","x":1075.619125366211,"y":2708.461136817932,"z":"18647007.5f06e","wires":[]},{"id":"dab4d76.c597428","type":"switchNode","name":"switch vf-module_length","xml":"<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length`'>\n","comments":"","outputs":1,"x":1546.2142639160156,"y":1879.9762592315674,"z":"18647007.5f06e","wires":[["6aafaac4.4c5d74"]]},{"id":"6aafaac4.4c5d74","type":"outcome","name":"1","xml":"<outcome value='1'>\n","comments":"","outputs":1,"x":1730.4999694824219,"y":1879.976245880127,"z":"18647007.5f06e","wires":[["ad3965bc.016e98"]]},{"id":"67ee289.747f3d8","type":"update","name":"update EIPAM_IP_ASSIGNMENTS to PENDING_DELETE...","xml":"<update plugin=\"org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource\" resource=\"SQL\"\nkey=\"UPDATE EIPAM_IP_ASSIGNMENTS set status = $tmp.status WHERE info = $aai.instance-group.instance-group[$ig-index].id\" >","comments":"","outputs":1,"x":2160.4999237060547,"y":1879.785903930664,"z":"18647007.5f06e","wires":[[]]},{"id":"b93947b5.bad4b8","type":"set","name":"set status variable","xml":"<set>\n<parameter name='tmp.status' value=\"`'PENDING_DELETE_' + $aai.instance-group.instance-group[$ig-index].id`\" />\n","comments":"","x":2030.499885559082,"y":1833.119276046753,"z":"18647007.5f06e","wires":[]},{"id":"c86e21dc.9ba1","type":"execute","name":"execute EIPAM unassign IP addresses","xml":"<execute plugin=\"com.att.sdnctl.sli.plugin.eipam.EIPAMPlugin\" method=\"unassignIPAddress\">\n<parameter name=\"deleteEIPAM_status\" value=\"`$tmp.status`\" />\n","comments":"","outputs":1,"x":2095.4998931884766,"y":1924.7859477996826,"z":"18647007.5f06e","wires":[[]]},{"id":"63fda02a.fa7dd","type":"comment","name":"roll back EIPAM floating addresses","info":"","comments":"","x":2139.785614013672,"y":1786.9291022618609,"z":"18647007.5f06e","wires":[]},{"id":"35514a27.0c3786","type":"switchNode","name":"switch network-instance-group-function","xml":"<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-assignments.vlan-vnfc-instance-groups.vlan-vnfc-instance-group[0].vnfcs.vnfc[0].vnic-groups.vnic-group[0].network-instance-group-function`'>\n","comments":"","outputs":1,"x":594.0476760864258,"y":1695.4761924743652,"z":"18647007.5f06e","wires":[["33381eac.5736d2","b7a26972.4da738"]]},{"id":"33381eac.5736d2","type":"other","name":"NULL","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":819.0476455688477,"y":1663.8095254898071,"z":"18647007.5f06e","wires":[["b38032a0.2b527"]]},{"id":"b7a26972.4da738","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":818.8095092773438,"y":1734.761920928955,"z":"18647007.5f06e","wires":[["3e53c2b5.286bae"]]},{"id":"b38032a0.2b527","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":945.7143821716309,"y":1662.1428575515747,"z":"18647007.5f06e","wires":[[]]},{"id":"3e53c2b5.286bae","type":"get-resource","name":"get-resource instance group","xml":"<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n  resource=\"instance-groups\" \n  key=\"instance-group.instance-group-function = $service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-assignments.vlan-vnfc-instance-groups.vlan-vnfc-instance-group[0].vnfcs.vnfc[0].vnic-groups.vnic-group[0].network-instance-group-function\n    AND instance-group.instance-group-type = 'L3-NETWORK'\"\n  pfx='aai.instance-group' local-only='false' >\n\n","comments":"","outputs":1,"x":1014.8810653686523,"y":1733.809497833252,"z":"18647007.5f06e","wires":[["e9603d51.250ee"]]},{"id":"e9603d51.250ee","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":1216.547695159912,"y":1734.6428718566895,"z":"18647007.5f06e","wires":[["2155541e.a7566c"]]},{"id":"b70af40a.ab7308","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1366.5476837158203,"y":1932.9764051437378,"z":"18647007.5f06e","wires":[["dab4d76.c597428","3f561058.c6b7c"]]},{"id":"ad3965bc.016e98","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1856.5476036071777,"y":1879.6429595947266,"z":"18647007.5f06e","wires":[["b93947b5.bad4b8","67ee289.747f3d8","c86e21dc.9ba1"]]},{"id":"3f561058.c6b7c","type":"for","name":"for each network-instance-group","xml":"<for index='nig-index' start='0' end='`$service-data.network-instance-groups.network-instance-group_length`' >\n","comments":"","outputs":1,"x":1566.5476150512695,"y":1987.976294517517,"z":"18647007.5f06e","wires":[["530e6588.dec85c"]]},{"id":"530e6588.dec85c","type":"switchNode","name":"network-instance-group-ids match?","xml":"<switch test='`$aai.instance-group.instance-group[$ig-index].id\n  == $service-data.network-instance-groups.network-instance-group[$nig-index].network-instance-group-id`'>\n","comments":"","outputs":1,"x":1871.5474548339844,"y":1987.9763402938843,"z":"18647007.5f06e","wires":[["da168f97.f5302"]]},{"id":"da168f97.f5302","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":2093.214225769043,"y":1986.6431188583374,"z":"18647007.5f06e","wires":[["c4aa2e87.97edb"]]},{"id":"c4aa2e87.97edb","type":"for","name":"for each network","xml":"<for index='network-index' start='0' end='`$service-data.network-instance-groups.network-instance-group[$nig-index].networks.network_length`' >\n","comments":"","outputs":1,"x":2248.9285621643066,"y":1985.3572444915771,"z":"18647007.5f06e","wires":[["d3c4d017.cbabf"]]},{"id":"d3c4d017.cbabf","type":"set","name":"clear vlan-tag-id and set network-status to unassigned","xml":"<set>\n<parameter name='service-data.network-instance-groups.network-instance-group[$nig-index].networks.network[$network-index].vlan-tag-id'\n  value='' />\n<parameter name='service-data.network-instance-groups.network-instance-group[$nig-index].networks.network[$network-index].network-status'\n  value='unassigned' />\n","comments":"","x":2560.3569946289062,"y":1983.9287071228027,"z":"18647007.5f06e","wires":[]},{"id":"2155541e.a7566c","type":"for","name":"for each returned instance-group","xml":"<for index='ig-index' start='0' end='`$aai.instance-group.instance-group_length`' >\n","comments":"","outputs":1,"x":1440.0476989746094,"y":1731.6428756713867,"z":"18647007.5f06e","wires":[["a61da9.e6305258"]]},{"id":"a61da9.e6305258","type":"for","name":"for each relationship","xml":"<for index='rel-index' start='0' end='`$aai.instance-group.instance-group[$ig-index].relationship-list.relationship_length`' >\n","comments":"","outputs":1,"x":1691.714340209961,"y":1730.6428747177124,"z":"18647007.5f06e","wires":[["997d3e95.fc12d"]]},{"id":"997d3e95.fc12d","type":"for","name":"for each relationship-data","xml":"<for index='reldata-index' start='0' end='`$aai.instance-group.instance-group[$ig-index].relationship-list.relationship[$rel-index].relationship-data_length`' >\n","comments":"","outputs":1,"x":1918.3810119628906,"y":1729.97624874115,"z":"18647007.5f06e","wires":[["b7d0eb3a.e77808"]]},{"id":"b7d0eb3a.e77808","type":"switchNode","name":"switch relationship-key == service-instance.service-instance-id","xml":"<switch test=\"`$aai.instance-group.instance-group[$ig-index].relationship-list.relationship[$rel-index].relationship-data[$reldata-index].relationship-key\n  == 'service-instance.service-instance-id'`\">\n","comments":"","outputs":1,"x":2276.714599609375,"y":1729.976167678833,"z":"18647007.5f06e","wires":[["ffbd0f3e.1275f"]]},{"id":"ffbd0f3e.1275f","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":2573.381057739258,"y":1729.9762001037598,"z":"18647007.5f06e","wires":[["cc3c2af6.11c288"]]},{"id":"cc3c2af6.11c288","type":"switchNode","name":"switch relationship-value == this service-instance-id","xml":"<switch test='`$aai.instance-group.instance-group[$ig-index].relationship-list.relationship[$rel-index].relationship-data[$reldata-index].relationship-value\n  == $service-data.service-information.service-instance-id`'>\n","comments":"","outputs":1,"x":2838.3808822631836,"y":1729.9761695861816,"z":"18647007.5f06e","wires":[["dff626a0.dc1248"]]},{"id":"dff626a0.dc1248","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":3098.3808517456055,"y":1729.9761600494385,"z":"18647007.5f06e","wires":[["b70af40a.ab7308"]]},{"id":"eec63ebd.14593","type":"for","name":"for each vm-type","xml":"<for silentFailure='true' index='vm-type-index' start='0'\n  end='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-assignments.vms.vm_length`' >\n","comments":"","outputs":1,"x":534.8810119628906,"y":2298.723051071167,"z":"18647007.5f06e","wires":[["ce9b06f.5de4df8"]]},{"id":"cb730a7e.b5f668","type":"for","name":"for each vnfc","xml":"<for silentFailure='true' index='vnfc-index' start='0' end='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names_length`' >\n","comments":"","outputs":1,"x":886.547779083252,"y":2393.104296684265,"z":"18647007.5f06e","wires":[["8409f6e0.cb49a8"]]},{"id":"9f0c497f.5452f8","type":"save","name":"delete vnfc in A&AI","xml":"<delete plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\"\n   resource=\"vnfc\"\n   key=\"vnfc.vnfc-name = $service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-name\">\n","comments":"","outputs":1,"x":1197.9762840270996,"y":2435.627844810486,"z":"18647007.5f06e","wires":[[]]},{"id":"bf694419.fb3e48","type":"comment","name":"check removed with US622450","info":"","comments":"","x":1090.0000305175781,"y":1296.1904892921448,"z":"18647007.5f06e","wires":[]},{"id":"52d01c9a.ee4734","type":"block","name":"block","xml":"<block>","atomic":"true","comments":"","outputs":1,"x":1494.0472831726074,"y":2382.889633178711,"z":"18647007.5f06e","wires":[["23e52a62.8371d6","e6b04d9f.26218"]]},{"id":"e6b04d9f.26218","type":"call","name":"call GENERIC-RESOURCE-API:naming-policy-generate-name","xml":"<call module='GENERIC-RESOURCE-API' rpc='naming-policy-generate-name' mode='sync' >\n","comments":"","outputs":1,"x":1806.3330192565918,"y":2407.461151123047,"z":"18647007.5f06e","wires":[[]]},{"id":"23e52a62.8371d6","type":"set","name":"set variables for deleting VNFC name","xml":"<set>\n<parameter name='naming-policy-generate-name-input.naming-type' value='VNFC' />\n<parameter name='naming-policy-generate-name-input.context-id' value='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-topology-identifier.vf-module-id`' />\n<parameter name='naming-policy-generate-name-input.vm-name' value='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vm-name[$vnfc-index]`' />\n<parameter name='naming-policy-generate-name-input.action' value='DELETE' />\n","comments":"","x":1726.0949745178223,"y":2360.318221092224,"z":"18647007.5f06e","wires":[]},{"id":"151cdfd1.7da61","type":"switchNode","name":"switch vnfc-name","xml":"<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-name`'>\n","comments":"","outputs":1,"x":1194.3809547424316,"y":2356.2228899002075,"z":"18647007.5f06e","wires":[["255c801a.7bb73","64e49e9a.0907e"]]},{"id":"255c801a.7bb73","type":"outcome","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":1364.380931854248,"y":2326.2229232788086,"z":"18647007.5f06e","wires":[["cfe202e2.fbb5c"]]},{"id":"64e49e9a.0907e","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":1364.3808898925781,"y":2382.4134368896484,"z":"18647007.5f06e","wires":[["52d01c9a.ee4734"]]},{"id":"cfe202e2.fbb5c","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1494.3807754516602,"y":2324.556275367737,"z":"18647007.5f06e","wires":[[]]},{"id":"1fe6d9a7.834656","type":"comment","name":"Rollback any generated VM and VNFC names","info":"","comments":"","x":582.7140884399414,"y":2251.2230615615845,"z":"18647007.5f06e","wires":[]},{"id":"ce9b06f.5de4df8","type":"block","name":"block","xml":"<block>","atomic":"true","comments":"","outputs":1,"x":698.7852401733398,"y":2299.1283378601074,"z":"18647007.5f06e","wires":[["8b6eeaed.c4c0f8","cb730a7e.b5f668","d0342dc.d3eafd"]]},{"id":"8b6eeaed.c4c0f8","type":"for","name":"for each vm-name","xml":"<for silentFailure='true' index='vm-name-index' start='0' end='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vm-name_length`' >\n","comments":"","outputs":1,"x":907.1184768676758,"y":2219.128580093384,"z":"18647007.5f06e","wires":[["1116a6ec.270f29"]]},{"id":"1116a6ec.270f29","type":"switchNode","name":"switch vm-name","xml":"<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vm-name[$vm-name-index]`'>\n","comments":"","outputs":1,"x":1102.118522644043,"y":2220.7952194213867,"z":"18647007.5f06e","wires":[["1df4fe9b.77f821","a4c9f40b.62e7e8"]]},{"id":"1df4fe9b.77f821","type":"outcome","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":1255.4518356323242,"y":2192.4618854522705,"z":"18647007.5f06e","wires":[["2232a7dc.efa278"]]},{"id":"2232a7dc.efa278","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1385.4516792297363,"y":2190.7952375411987,"z":"18647007.5f06e","wires":[[]]},{"id":"af279118.39d22","type":"block","name":"block","xml":"<block>","atomic":"true","comments":"","outputs":1,"x":1387.1185836791992,"y":2250.7951984405518,"z":"18647007.5f06e","wires":[["bb500d32.bedec","a9ef9323.9a9ed"]]},{"id":"a4c9f40b.62e7e8","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":1257.45219039917,"y":2250.3190021514893,"z":"18647007.5f06e","wires":[["af279118.39d22"]]},{"id":"a9ef9323.9a9ed","type":"call","name":"call GENERIC-RESOURCE-API:naming-policy-generate-name","xml":"<call module='GENERIC-RESOURCE-API' rpc='naming-policy-generate-name' mode='sync' >\n","comments":"","outputs":1,"x":1687.1184616088867,"y":2275.7951984405518,"z":"18647007.5f06e","wires":[[]]},{"id":"bb500d32.bedec","type":"set","name":"set variables for deleting VM name","xml":"<set>\n<parameter name='naming-policy-generate-name-input.naming-type' value='VM' />\n<parameter name='naming-policy-generate-name-input.context-id' value='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-topology-identifier.vf-module-id`' />\n<parameter name='naming-policy-generate-name-input.action' value='DELETE' />\n","comments":"","x":1601.880355834961,"y":2228.6522302627563,"z":"18647007.5f06e","wires":[]},{"id":"8409f6e0.cb49a8","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1034.0476875305176,"y":2391.889678001404,"z":"18647007.5f06e","wires":[["151cdfd1.7da61","9f0c497f.5452f8"]]},{"id":"e0000fd9.cea29","type":"switchNode","name":"switch vf-module-name","xml":"<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-topology-identifier.vf-module-name`'>\n","comments":"","outputs":1,"x":547.380973815918,"y":2089.5565156936646,"z":"18647007.5f06e","wires":[["d4acdb9a.079a18","af3adb74.311b58"]]},{"id":"d4acdb9a.079a18","type":"outcome","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":724.0475997924805,"y":2115.389748573303,"z":"18647007.5f06e","wires":[["a15536e0.beaed8"]]},{"id":"af3adb74.311b58","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":726.1428604125977,"y":2064.1756534576416,"z":"18647007.5f06e","wires":[["be7df5b1.c8d688"]]},{"id":"be7df5b1.c8d688","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":848.7142791748047,"y":2062.556513786316,"z":"18647007.5f06e","wires":[[]]},{"id":"a15536e0.beaed8","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":871.0475654602051,"y":2115.8897886276245,"z":"18647007.5f06e","wires":[["7ffb79a3.b3e2f8","10ec941b.acc1bc"]]},{"id":"10ec941b.acc1bc","type":"call","name":"call GENERIC-RESOURCE-API:naming-policy-generate-unique-name","xml":"<call module='GENERIC-RESOURCE-API' rpc='naming-policy-generate-unique-name' mode='sync' >\n","comments":"","outputs":1,"x":1220.714256286621,"y":2136.2231225967407,"z":"18647007.5f06e","wires":[[]]},{"id":"7ffb79a3.b3e2f8","type":"set","name":"set variables for deleting VF module name","xml":"<set>\n<parameter name='generate-unique-name-input.name-table-type' value='VF_MODULE_INSTANCE' />\n<parameter name='generate-unique-name-input.context-id' value='`$vf-module-topology-operation-input.vnf-information.vnf-id`' />\n<parameter name='generate-unique-name-input.action' value='DELETE' />\n","comments":"","x":1133.8091888427734,"y":2091.937413215637,"z":"18647007.5f06e","wires":[]},{"id":"d0342dc.d3eafd","type":"for","name":"for each vm-network","xml":"<for silentFailure='true' index='network-role-index' start='0' end='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network_length`' >\n","comments":"","outputs":1,"x":910.7143020629883,"y":2531.223017692566,"z":"18647007.5f06e","wires":[["b8830261.bd521"]]},{"id":"b8830261.bd521","type":"block","name":"block","xml":"<block>","atomic":"true","comments":"","outputs":1,"x":1100.547622680664,"y":2530.722456932068,"z":"18647007.5f06e","wires":[["496f47a6.204b08"]]},{"id":"496f47a6.204b08","type":"for","name":"for each vnfc","xml":"<for silentFailure='true' index='vnfc-index' start='0' end='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names_length`' >\n","comments":"","outputs":1,"x":1254.5476837158203,"y":2529.3892822265625,"z":"18647007.5f06e","wires":[["e0961315.d37bc"]]},{"id":"e0961315.d37bc","type":"block","name":"block","xml":"<block>","atomic":"true","comments":"","outputs":1,"x":1412.8810691833496,"y":2529.3892755508423,"z":"18647007.5f06e","wires":[["4448c71a.47c118","71117bd.9df1b84"]]},{"id":"4448c71a.47c118","type":"for","name":"for each floating ipv4 address","xml":"<for silentFailure='true' index='ipv4-index' start='0' end='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$vm-network-index].floating-ips.floating-ip-v4_length`' >\n","comments":"","outputs":1,"x":1617.7140884399414,"y":2498.555899620056,"z":"18647007.5f06e","wires":[["10d9315f.192e3f"]]},{"id":"71117bd.9df1b84","type":"for","name":"for each floating ipv6 address","xml":"<for silentFailure='true' index='ipv6-index' start='0' end='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$vm-network-index].floating-ips.floating-ip-v6_length`' >\n","comments":"","outputs":1,"x":1618.3806838989258,"y":2555.5556592941284,"z":"18647007.5f06e","wires":[["b3e81b2f.f62be8"]]},{"id":"10d9315f.192e3f","type":"delete","name":"delete vip-ipv4-address-list from A&AI","xml":"<delete plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n   resource=\"vip-ipv4-address-list\" \n   key=\"cloud-region.cloud-owner = $prop.cloud-region.cloud-owner\n\t  AND cloud-region.cloud-region-id = $vf-module-topology-operation-input.vf-module-request-input.aic-cloud-region\n\t  AND vip-ipv4-address-list.vip-ipv4-address = $service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$vm-network-index].floating-ips.floating-ip-v4[$ipv4-index]\" >","comments":"","outputs":1,"x":1921.7140884399414,"y":2498.555899620056,"z":"18647007.5f06e","wires":[[]]},{"id":"b3e81b2f.f62be8","type":"delete","name":"delete vip-ipv6-address-list from A&AI","xml":"<delete plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n   resource=\"vip-ipv6-address-list\" \n   key=\"cloud-region.cloud-owner = $prop.cloud-region.cloud-owner\n\t  AND cloud-region.cloud-region-id = $vf-module-topology-operation-input.vf-module-request-input.aic-cloud-region\n\t  AND vip-ipv6-address-list.vip-ipv6-address = $service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$vm-network-index].floating-ips.floating-ip-v6[$ipv6-index]\" >","comments":"","outputs":1,"x":1920.3806838989258,"y":2554.222529411316,"z":"18647007.5f06e","wires":[[]]},{"id":"81c49a47.fca5c8","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":197.38094329833984,"y":554.5238332748413,"z":"18647007.5f06e","wires":[["c861a71.bf35958","1f2343f9.c1656c","13f7711f.d4863f","6dfcbf43.c96e3","b33a0450.724278","3d580cb8.2983e4","f25bb144.7f7c8","2f3dab55.c79cc4","8494a6ce.b4d008","69ffa572.57fcfc","ae821284.ea3c7"]]},{"id":"cd77f2b1.29536","type":"call","name":"call self-serve-vf-module-unassign","xml":"<call module='GENERIC-RESOURCE-API' rpc='self-serve-vf-module-unassign' mode='sync' >\n","comments":"","outputs":1,"x":1006.6427383422852,"y":946.6547780036926,"z":"18647007.5f06e","wires":[["3c485d89.f7e462","44c95324.f14cdc"]]},{"id":"3c485d89.f7e462","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1251.392723083496,"y":946.9047665596008,"z":"18647007.5f06e","wires":[["b3dabebc.3fe24"]]},{"id":"b3dabebc.3fe24","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n<parameter name='error-code' value='500' />\n<parameter name='error-message' value=\"`'Encountered error while unassigning self-serve vf-moldule esources with error: '+ $error-message`\" />\n","comments":"","x":1416.9641494750977,"y":946.5476613044739,"z":"18647007.5f06e","wires":[]},{"id":"44c95324.f14cdc","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":1255.9998970031738,"y":997.4603009223938,"z":"18647007.5f06e","wires":[["c76910e9.f2862"]]},{"id":"c76910e9.f2862","type":"returnSuccess","name":"return success","xml":"<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n","comments":"","x":1424.5713119506836,"y":997.0317425727844,"z":"18647007.5f06e","wires":[]},{"id":"2f3dab55.c79cc4","type":"execute","name":"execute PropertiesNode","xml":"<execute plugin='org.onap.ccsdk.sli.plugins.prop.PropertiesNode' method='readProperties' >\n    <parameter name='fileName' value='%SDNC_CONFIG_DIR%/generic-resource-api-dg.properties' />\n    <parameter name='contextPrefix' value='prop' />\n","comments":"","outputs":1,"x":547.6190185546875,"y":256.93744468688965,"z":"18647007.5f06e","wires":[[]]},{"id":"8494a6ce.b4d008","type":"switchNode","name":"switch input cloud-owner","xml":"<switch test='`$vf-module-topology-operation-input.vf-module-request-input.cloud-owner`'>\n","comments":"","outputs":1,"x":549.2855911254883,"y":327.29407024383545,"z":"18647007.5f06e","wires":[["2c057656.bd036a","f6d09aaa.bbe858"]]},{"id":"2c057656.bd036a","type":"other","name":"NULL","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":732.6189651489258,"y":297.29405879974365,"z":"18647007.5f06e","wires":[["105a5789.51e418"]]},{"id":"f6d09aaa.bbe858","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":732.3808708190918,"y":338.2465524673462,"z":"18647007.5f06e","wires":[["78541ec2.14876"]]},{"id":"105a5789.51e418","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":867.6189193725586,"y":295.62739849090576,"z":"18647007.5f06e","wires":[[]]},{"id":"78541ec2.14876","type":"set","name":"set prop.cloud-region.cloud-owner","xml":"<set>\n<parameter name='prop.cloud-region.cloud-owner' value='`$vf-module-topology-operation-input.vf-module-request-input.cloud-owner`' />\n","comments":"","x":949.2855758666992,"y":337.2940797805786,"z":"18647007.5f06e","wires":[]},{"id":"8adaff9d.ffe82","type":"comment","name":"SELF-SERVE FORK","info":"","comments":"","x":929.9998931884766,"y":908.3334360122681,"z":"18647007.5f06e","wires":[]},{"id":"ae821284.ea3c7","type":"call","name":"call self-serve-vf-module-forking-logic","xml":"<call module='GENERIC-RESOURCE-API' rpc='self-serve-vf-module-forking-logic' mode='sync' >\n","comments":"","outputs":1,"x":587.3490371704102,"y":881.4886159896851,"z":"18647007.5f06e","wires":[[]]},{"id":"69ffa572.57fcfc","type":"switchNode","name":"switch ss.self-serve-flag","xml":"<switch test=\"`$ss.self-serve-flag`\">\n","comments":"","outputs":1,"x":545.7298965454102,"y":1009.2029423713684,"z":"18647007.5f06e","wires":[["c1005f53.215cb","9ffad06c.1ae2d"]]},{"id":"c1005f53.215cb","type":"outcomeFalse","name":"false","xml":"<outcome value='false'>\n","comments":"","outputs":1,"x":770.3963737487793,"y":1070.0596961975098,"z":"18647007.5f06e","wires":[["218fe261.ee2e0e"]]},{"id":"9ffad06c.1ae2d","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":768.444091796875,"y":947.2505326271057,"z":"18647007.5f06e","wires":[["cd77f2b1.29536"]]}]