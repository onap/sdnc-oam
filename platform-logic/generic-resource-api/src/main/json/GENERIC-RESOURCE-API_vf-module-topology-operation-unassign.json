[{"id":"c5287c43.5f3f1","type":"dgstart","name":"DGSTART","outputs":1,"x":122.85714721679688,"y":88.12794303894043,"z":"edca08.43dcd5f8","wires":[["76ae7991.2e2dd8"]]},{"id":"76ae7991.2e2dd8","type":"service-logic","name":"GENERIC-RESOURCE-API ${project.version}","module":"GENERIC-RESOURCE-API","version":"${project.version}","comments":"","xml":"<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>","outputs":1,"x":238.14285278320312,"y":127.69939041137695,"z":"edca08.43dcd5f8","wires":[["1e8b6d56.4e5da3"]]},{"id":"1e8b6d56.4e5da3","type":"method","name":"method vf-module-topology-operation-unassign","xml":"<method rpc='vf-module-topology-operation-unassign' mode='sync'>\n","comments":"","outputs":1,"x":244.95244598388672,"y":168.12793922424316,"z":"edca08.43dcd5f8","wires":[["46c1a821.48d258"]]},{"id":"603dc095.e3be5","type":"comment","name":"vf-module-topology-operation-unassign","info":"","comments":"","x":517.2020034790039,"y":35.71428680419922,"z":"edca08.43dcd5f8","wires":[]},{"id":"877764f1.c72548","type":"switchNode","name":"switch request-action","xml":"<switch test='`$vf-module-topology-operation-input.request-information.request-action`'>\n","comments":"","outputs":1,"x":526.3809585571289,"y":266.98508071899414,"z":"edca08.43dcd5f8","wires":[["f225ee87.6fc45","ef1800ab.a957d"]]},{"id":"f225ee87.6fc45","type":"outcome","name":"DeleteVfModuleInstance","xml":"<outcome value='DeleteVfModuleInstance'>\n","comments":"","outputs":1,"x":788.4285736083984,"y":244.12796688079834,"z":"edca08.43dcd5f8","wires":[["a08696bd.a802e8"]]},{"id":"ef1800ab.a957d","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":732.0952186584473,"y":289.50895595550537,"z":"edca08.43dcd5f8","wires":[["3cfd6dc.f729e92"]]},{"id":"a08696bd.a802e8","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":978.285737991333,"y":244.12799835205078,"z":"edca08.43dcd5f8","wires":[[]]},{"id":"3cfd6dc.f729e92","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"If svc-action is 'deactivate' then request-action must be 'DeleteVfModuleInstance'\" />\n","comments":"","x":997.0952262878418,"y":289.84226846694946,"z":"edca08.43dcd5f8","wires":[]},{"id":"18261499.1e3fdb","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":145.47624969482422,"y":1185.0326652526855,"z":"edca08.43dcd5f8","wires":[["1e283363.50d6bd","213ab44b.d5f03c","ebb914a6.6be4e8","25e098c.2ec0168","f494cdbd.9a967","212261c0.2d1dee","45c51d4.c2a85e4","dde9da09.b2a228","73a90d31.ecce84","edfc93db.b0f24"]]},{"id":"265413e1.39158c","type":"switchNode","name":"switch service-data.vnfs.vnf_length","xml":"<switch test='`$service-data.vnfs.vnf_length`'>\n","comments":"","outputs":1,"x":572.8571319580078,"y":411.4612560272217,"z":"edca08.43dcd5f8","wires":[["f74b05d0.b35e18","aedec041.8c0be"]]},{"id":"f74b05d0.b35e18","type":"other","name":"NULL","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":813.571403503418,"y":388.60399627685547,"z":"edca08.43dcd5f8","wires":[["39fc82f5.e1dcbe"]]},{"id":"aedec041.8c0be","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":813.3332443237305,"y":429.55651473999023,"z":"edca08.43dcd5f8","wires":[["2eb38eb5.7124a2"]]},{"id":"39fc82f5.e1dcbe","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"There are no VNFs defined in MD-SAL\" />\n","comments":"","x":980.2380180358887,"y":387.8897514343262,"z":"edca08.43dcd5f8","wires":[]},{"id":"2eb38eb5.7124a2","type":"for","name":"for each vnf","xml":"<for index='idx' start='0' end='`$service-data.vnfs.vnf_length`' >\n","comments":"","outputs":1,"x":975.5713882446289,"y":429.2231330871582,"z":"edca08.43dcd5f8","wires":[["9f5d1912.359358"]]},{"id":"9f5d1912.359358","type":"switchNode","name":"switch service data vnf == input vnf","xml":"<switch test='`$service-data.vnfs.vnf[$idx].vnf-id == $vf-module-topology-operation-input.vnf-information.vnf-id`'>\n","comments":"","outputs":1,"x":1226.9046058654785,"y":428.88982009887695,"z":"edca08.43dcd5f8","wires":[["c1d5555a.ade058"]]},{"id":"c1d5555a.ade058","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":1456.904697418213,"y":428.2231740951538,"z":"edca08.43dcd5f8","wires":[["aa0b499c.760688"]]},{"id":"1f8899f9.b231e6","type":"set","name":"set vnf-index to -1","xml":"<set>\n<parameter name='vnf-index' value='-1' />\n","comments":"","x":521.9047546386719,"y":342.88975524902344,"z":"edca08.43dcd5f8","wires":[]},{"id":"6aace9e1.3842a8","type":"set","name":"set vnf-index to idx","xml":"<set>\n<parameter name='vnf-index' value='`$idx`' />\n","comments":"","x":1778.5713348388672,"y":399.2231321334839,"z":"edca08.43dcd5f8","wires":[]},{"id":"a5cd088e.80d568","type":"switchNode","name":"switch vnf-index","xml":"<switch test='`$vnf-index`'>\n","comments":"","outputs":1,"x":511.9047622680664,"y":479.55645179748535,"z":"edca08.43dcd5f8","wires":[["2349c495.c77f4c"]]},{"id":"2349c495.c77f4c","type":"outcome","name":"-1","xml":"<outcome value='-1'>\n","comments":"","outputs":1,"x":690.2381477355957,"y":478.8898277282715,"z":"edca08.43dcd5f8","wires":[["9f767a43.0011a8"]]},{"id":"9f767a43.0011a8","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unable to find VNF ID ' + $vf-module-topology-operation-input.vnf-information.vnf-id + ' in MD-SAL'`\" />\n","comments":"","x":850.2380561828613,"y":478.22313117980957,"z":"edca08.43dcd5f8","wires":[]},{"id":"aa0b499c.760688","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1605.2381591796875,"y":427.14287281036377,"z":"edca08.43dcd5f8","wires":[["6aace9e1.3842a8","1cf1261c.75af7a"]]},{"id":"1cf1261c.75af7a","type":"break","name":"break","xml":"<break>\n","comments":"","x":1740.238124847412,"y":448.809458732605,"z":"edca08.43dcd5f8","wires":[]},{"id":"f4f336f5.5dea88","type":"switchNode","name":"switch vf-module_length","xml":"<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length`'>\n","comments":"","outputs":1,"x":536.1904449462891,"y":601.461259841919,"z":"edca08.43dcd5f8","wires":[["3896bab6.2db326","7cb8d84.f65b628"]]},{"id":"3896bab6.2db326","type":"other","name":"NULL","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":720.2380828857422,"y":580.2706642150879,"z":"edca08.43dcd5f8","wires":[["791c3ec1.974fb"]]},{"id":"7cb8d84.f65b628","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":719.9999237060547,"y":621.2231826782227,"z":"edca08.43dcd5f8","wires":[["6d076e62.18418"]]},{"id":"791c3ec1.974fb","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'There are no VF modules defined in MD-SAL for VNF ' + $vf-module-topology-operation-input.vnf-information.vnf-id`\" />\n","comments":"","x":886.9046974182129,"y":579.5564193725586,"z":"edca08.43dcd5f8","wires":[]},{"id":"6d076e62.18418","type":"for","name":"for each vf-module","xml":"<for index='idx' start='0' end='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length`' >\n","comments":"","outputs":1,"x":882.2380676269531,"y":620.8898010253906,"z":"edca08.43dcd5f8","wires":[["90fe8f40.82619"]]},{"id":"90fe8f40.82619","type":"switchNode","name":"switch service data vf-module == input vf-module","xml":"<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$idx].vf-module-id == $vf-module-topology-operation-input.vf-module-information.vf-module-id`'>\n","comments":"","outputs":1,"x":1188.5712280273438,"y":620.5565366744995,"z":"edca08.43dcd5f8","wires":[["7a4bf724.30d268"]]},{"id":"7a4bf724.30d268","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":1458.5712814331055,"y":618.223141670227,"z":"edca08.43dcd5f8","wires":[["4519a894.e67f48"]]},{"id":"47fc1d3b.5c4464","type":"set","name":"set vf-module-index to -1","xml":"<set>\n<parameter name='vf-module-index' value='-1' />\n","comments":"","x":541.9047393798828,"y":536.2231178283691,"z":"edca08.43dcd5f8","wires":[]},{"id":"f8fd364b.a66e28","type":"set","name":"set vf-module-index to idx","xml":"<set>\n<parameter name='vf-module-index' value='`$idx`' />\n","comments":"","x":1788.5713729858398,"y":589.2231206893921,"z":"edca08.43dcd5f8","wires":[]},{"id":"4a2fa4b4.4280bc","type":"switchNode","name":"switch vf-module-index","xml":"<switch test='`$vf-module-index`'>\n","comments":"","outputs":1,"x":533.5714225769043,"y":672.8898305892944,"z":"edca08.43dcd5f8","wires":[["fff4784.69d9688"]]},{"id":"fff4784.69d9688","type":"outcome","name":"-1","xml":"<outcome value='-1'>\n","comments":"","outputs":1,"x":711.9048080444336,"y":672.2232065200806,"z":"edca08.43dcd5f8","wires":[["a0822a4d.3ed978"]]},{"id":"a0822a4d.3ed978","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unable to find VF module ID ' + $vf-module-topology-operation-input.vf-module-information.vf-module-id + ' in MD-SAL'`\" />\n","comments":"","x":871.9047164916992,"y":671.5565099716187,"z":"edca08.43dcd5f8","wires":[]},{"id":"4519a894.e67f48","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1591.9048233032227,"y":617.1428813934326,"z":"edca08.43dcd5f8","wires":[["f8fd364b.a66e28","a4e65803.370178"]]},{"id":"a4e65803.370178","type":"break","name":"break","xml":"<break>\n","comments":"","x":1726.9047889709473,"y":638.8094673156738,"z":"edca08.43dcd5f8","wires":[]},{"id":"ef5a5aa5.646fa8","type":"switchNode","name":"switch order-status","xml":"<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-level-oper-status.order-status`'>\n","comments":"","outputs":1,"x":522.1428909301758,"y":988.366044998169,"z":"edca08.43dcd5f8","wires":[["e22e4cda.57e45","5acfa32e.6102ac"]]},{"id":"e22e4cda.57e45","type":"outcome","name":"Created","xml":"<outcome value='Created'>\n","comments":"","outputs":1,"x":697.976261138916,"y":950.8660769462585,"z":"edca08.43dcd5f8","wires":[["8903485a.9e52b8"]]},{"id":"5acfa32e.6102ac","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":697.142879486084,"y":1008.3660278320312,"z":"edca08.43dcd5f8","wires":[["92f3b1b9.5f215"]]},{"id":"8903485a.9e52b8","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Order status must not be Created\" />\n","comments":"","x":866.3095016479492,"y":950.8660063743591,"z":"edca08.43dcd5f8","wires":[]},{"id":"92f3b1b9.5f215","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":872.1428909301758,"y":1008.0327033996582,"z":"edca08.43dcd5f8","wires":[[]]},{"id":"213ab44b.d5f03c","type":"update","name":"update EIPAM_IP_ASSIGNMENTS to PENDING_DELETE...","xml":"<update plugin=\"org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource\" resource=\"SQL\"\nkey=\"UPDATE EIPAM_IP_ASSIGNMENTS set status = $tmp.status WHERE info = $service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-topology-identifier.vf-module-id\" >","comments":"","outputs":1,"x":648.8096160888672,"y":1105.0326957702637,"z":"edca08.43dcd5f8","wires":[["cdaabcdd.8298f"]]},{"id":"1e283363.50d6bd","type":"set","name":"set status variable","xml":"<set>\n<parameter name='tmp.status' value=\"`'PENDING_DELETE_' + $service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-topology-identifier.vf-module-id`\" />\n","comments":"","x":518.8095855712891,"y":1058.3660278320312,"z":"edca08.43dcd5f8","wires":[]},{"id":"cdaabcdd.8298f","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":953.8095245361328,"y":1103.3659954071045,"z":"edca08.43dcd5f8","wires":[["8bce0bc3.868868"]]},{"id":"8bce0bc3.868868","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating EIPAM_IP_ASSIGNMENTS table\" />\n","comments":"","x":1143.8095512390137,"y":1103.1757307052612,"z":"edca08.43dcd5f8","wires":[]},{"id":"212261c0.2d1dee","type":"execute","name":"execute EIPAM unassign IP addresses","xml":"<execute plugin=\"com.att.sdnctl.sli.plugin.eipam.EIPAMPlugin\" method=\"unassignIPAddress\">\n<parameter name=\"deleteEIPAM_status\" value=\"`$tmp.status`\" />\n","comments":"","outputs":1,"x":582.1429138183594,"y":1200.0327167510986,"z":"edca08.43dcd5f8","wires":[["31fbed3d.bb13d2"]]},{"id":"31fbed3d.bb13d2","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":818.8095397949219,"y":1200.0326595306396,"z":"edca08.43dcd5f8","wires":[["cd365e8a.c7ba6"]]},{"id":"cd365e8a.c7ba6","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error in EIPAM unassign IP address\" />\n","comments":"","x":1008.8095664978027,"y":1199.8423948287964,"z":"edca08.43dcd5f8","wires":[]},{"id":"ebb914a6.6be4e8","type":"for","name":"for each vm-type","xml":"<for silentFailure='true' index='vm-type-index' start='0' end='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-assignments.vms.vm_length`' >\n","comments":"","outputs":1,"x":513.8095703125,"y":1245.0326776504517,"z":"edca08.43dcd5f8","wires":[["81a4a3c8.aa3a3"]]},{"id":"81a4a3c8.aa3a3","type":"for","name":"for each vm","xml":"<for silentFailure='true' index='vm-index' start='0' end='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-count`' >\n","comments":"","outputs":1,"x":708.8096008300781,"y":1244.3656854629517,"z":"edca08.43dcd5f8","wires":[["fb5f9b43.404218"]]},{"id":"9293b60a.f4f688","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1415.4766693115234,"y":1242.6982879638672,"z":"edca08.43dcd5f8","wires":[["8c5f749e.c355b8"]]},{"id":"cb8e4288.88df1","type":"comment","name":"Not a failure","info":"","comments":"","x":1693.8096656799316,"y":1241.0320901870728,"z":"edca08.43dcd5f8","wires":[]},{"id":"8c5f749e.c355b8","type":"record","name":"record","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"GENERIC-RESOURCE-API.vf-module-topology-operation-assign:REQID\"/>\n<parameter name=\"field3\" value=\"`$vf-module-topology-operation-input.sdnc-request-header.svc-request-id`\"/>\n<parameter name=\"field4\" value=\"Failed to insert VIPR_CONFIGURATION record\"/>\n","comments":"","outputs":1,"x":1561.47660446167,"y":1242.6989212036133,"z":"edca08.43dcd5f8","wires":[[]]},{"id":"fb5f9b43.404218","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":877.142993927002,"y":1243.365530014038,"z":"edca08.43dcd5f8","wires":[["200c5e71.a0fd62"]]},{"id":"200c5e71.a0fd62","type":"delete","name":"delete any records in VIPR_CONFIGURATION","xml":"<delete plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource' resource='SQL'\n  key='DELETE from VIPR_CONFIGURATION WHERE vnf_id = $service-data.vnfs.vnf[$vnf-index].vnf-id\n     AND ecomp_service_instance_id = $service-data.service-information.service-instance-id\n     AND vm_name = $service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vm-name[$vm-index]' >","comments":"","outputs":1,"x":1163.8097076416016,"y":1243.0329599380493,"z":"edca08.43dcd5f8","wires":[["9293b60a.f4f688"]]},{"id":"35e0d06b.13a2e","type":"for","name":"for each vf module","xml":"<for index='idx' start='`$vf-module-index + 1`' end='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length`' >\n","comments":"","outputs":1,"x":1089.3173828125,"y":2350.3656997680664,"z":"edca08.43dcd5f8","wires":[["3aee46f3.7a0fca"]]},{"id":"fcb0b642.11b048","type":"comment","name":"Remove VF Module from service data","info":"","comments":"","x":468.14288330078125,"y":2305.6041402816772,"z":"edca08.43dcd5f8","wires":[]},{"id":"3aee46f3.7a0fca","type":"set","name":"move vf module to remove one","xml":"<set>\n\t<parameter name=\"tmpidx\" value=\"`$idx - 1`\"/>\n\t<parameter name=\"service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$tmpidx].\" value=\"$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$idx].\" />\n\t\n","comments":"","x":1332.9085159301758,"y":2349.3896656036377,"z":"edca08.43dcd5f8","wires":[]},{"id":"25e098c.2ec0168","type":"switchNode","name":"switch vf-module_length","xml":"<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length`'>\n","comments":"","outputs":1,"x":535.5753021240234,"y":2361.7073707580566,"z":"edca08.43dcd5f8","wires":[["27d9353f.6c425a","b11ba20f.3a1d3"]]},{"id":"27d9353f.6c425a","type":"outcome","name":"1","xml":"<outcome value='1'>\n","comments":"","outputs":1,"x":730.9086685180664,"y":2312.6119775772095,"z":"edca08.43dcd5f8","wires":[["9f2354ed.139ef8"]]},{"id":"9f2354ed.139ef8","type":"set","name":"Remove vf modules","xml":"<set>\n\t<parameter name=\"service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.\" value=\"\"/>\n\n","comments":"","x":902.9084396362305,"y":2312.612096786499,"z":"edca08.43dcd5f8","wires":[]},{"id":"b11ba20f.3a1d3","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":729.5754241943359,"y":2407.3737869262695,"z":"edca08.43dcd5f8","wires":[["f4ca2943.e1d358"]]},{"id":"47204c51.64f514","type":"set","name":"set new vf module length","xml":"<set>\n\t<parameter name=\"service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length\" value=\"`$lastidx`\"/>\n\n\t\n","comments":"","x":1108.2049179077148,"y":2478.088176727295,"z":"edca08.43dcd5f8","wires":[]},{"id":"2011f2de.dfeffe","type":"set","name":"Remove the last vf module in the list","xml":"<set>\n\t<parameter name=\"service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$lastidx].\" value=\"\"/>\n","comments":"","x":1143.9085311889648,"y":2434.1993141174316,"z":"edca08.43dcd5f8","wires":[]},{"id":"f4ca2943.e1d358","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":886.8133544921875,"y":2406.611788749695,"z":"edca08.43dcd5f8","wires":[["35e0d06b.13a2e","2011f2de.dfeffe","47204c51.64f514","d696060d.904598"]]},{"id":"f494cdbd.9a967","type":"returnSuccess","name":"return success","xml":"<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n","comments":"","x":508.1429138183594,"y":2538.222993850708,"z":"edca08.43dcd5f8","wires":[]},{"id":"45c51d4.c2a85e4","type":"set","name":"set service-type","xml":"<set>\n<parameter name='service-data.service-information.service-type' value='`$service-data.service-information.subscription-service-type`' />\n","comments":"EIPAM plug-in needs this attribute set with this name","x":510.4762268066406,"y":1150.9523582458496,"z":"edca08.43dcd5f8","wires":[]},{"id":"d696060d.904598","type":"set","name":"set lastidx","xml":"<set>\n<parameter name='lastidx' value='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length - 1`' />\n","comments":"EIPAM plug-in needs this attribute set with this name","x":1062.0476989746094,"y":2390.604013442993,"z":"edca08.43dcd5f8","wires":[]},{"id":"8933ba69.750ac8","type":"switchNode","name":"switch vf-module_length","xml":"<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length`'>\n","comments":"","outputs":1,"x":1532.642837524414,"y":1562.1191358566284,"z":"edca08.43dcd5f8","wires":[["1a7ae9f.bfc7216"]]},{"id":"1a7ae9f.bfc7216","type":"outcome","name":"1","xml":"<outcome value='1'>\n","comments":"","outputs":1,"x":1716.9285430908203,"y":1562.119122505188,"z":"edca08.43dcd5f8","wires":[["f468ff3e.ef554"]]},{"id":"c3cb6173.44b2","type":"update","name":"update EIPAM_IP_ASSIGNMENTS to PENDING_DELETE...","xml":"<update plugin=\"org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource\" resource=\"SQL\"\nkey=\"UPDATE EIPAM_IP_ASSIGNMENTS set status = $tmp.status WHERE info = $aai.instance-group.instance-group[$ig-index].id\" >","comments":"","outputs":1,"x":2146.928497314453,"y":1561.928780555725,"z":"edca08.43dcd5f8","wires":[[]]},{"id":"1f27993e.173167","type":"set","name":"set status variable","xml":"<set>\n<parameter name='tmp.status' value=\"`'PENDING_DELETE_' + $aai.instance-group.instance-group[$ig-index].id`\" />\n","comments":"","x":2016.9284591674805,"y":1515.262152671814,"z":"edca08.43dcd5f8","wires":[]},{"id":"e5c1c0e6.96de7","type":"execute","name":"execute EIPAM unassign IP addresses","xml":"<execute plugin=\"com.att.sdnctl.sli.plugin.eipam.EIPAMPlugin\" method=\"unassignIPAddress\">\n<parameter name=\"deleteEIPAM_status\" value=\"`$tmp.status`\" />\n","comments":"","outputs":1,"x":2081.928466796875,"y":1606.9288244247437,"z":"edca08.43dcd5f8","wires":[[]]},{"id":"c3990fef.4555a","type":"comment","name":"roll back EIPAM floating addresses","info":"","comments":"","x":2126.2141876220703,"y":1469.071978886922,"z":"edca08.43dcd5f8","wires":[]},{"id":"dde9da09.b2a228","type":"switchNode","name":"switch network-instance-group-function","xml":"<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-assignments.vlan-vnfc-instance-groups.vlan-vnfc-instance-group[0].vnfcs.vnfc[0].vnic-groups.vnic-group[0].network-instance-group-function`'>\n","comments":"","outputs":1,"x":580.4762496948242,"y":1377.6190690994263,"z":"edca08.43dcd5f8","wires":[["4f97f8c2.a0deb8","ca85af42.0739b"]]},{"id":"4f97f8c2.a0deb8","type":"other","name":"NULL","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":805.4762191772461,"y":1345.9524021148682,"z":"edca08.43dcd5f8","wires":[["6a988e2a.0b0cc"]]},{"id":"ca85af42.0739b","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":805.2380828857422,"y":1416.904797554016,"z":"edca08.43dcd5f8","wires":[["db124cac.14fa7"]]},{"id":"6a988e2a.0b0cc","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":932.1429557800293,"y":1344.2857341766357,"z":"edca08.43dcd5f8","wires":[[]]},{"id":"db124cac.14fa7","type":"get-resource","name":"get-resource instance group","xml":"<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n  resource=\"instance-groups\" \n  key=\"instance-group.instance-group-function = $service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-assignments.vlan-vnfc-instance-groups.vlan-vnfc-instance-group[0].vnfcs.vnfc[0].vnic-groups.vnic-group[0].network-instance-group-function\n    AND instance-group.instance-group-type = 'L3-NETWORK'\"\n  pfx='aai.instance-group' local-only='false' >\n\n","comments":"","outputs":1,"x":1001.3096389770508,"y":1415.952374458313,"z":"edca08.43dcd5f8","wires":[["384eeb8f.ffb444"]]},{"id":"384eeb8f.ffb444","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":1202.9762687683105,"y":1416.7857484817505,"z":"edca08.43dcd5f8","wires":[["c0ba523c.0e6c9"]]},{"id":"8d423e6c.0cf62","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1352.9762573242188,"y":1615.1192817687988,"z":"edca08.43dcd5f8","wires":[["8933ba69.750ac8","afb7d78e.98b0b8"]]},{"id":"f468ff3e.ef554","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1842.9761772155762,"y":1561.7858362197876,"z":"edca08.43dcd5f8","wires":[["1f27993e.173167","c3cb6173.44b2","e5c1c0e6.96de7"]]},{"id":"afb7d78e.98b0b8","type":"for","name":"for each network-instance-group","xml":"<for index='nig-index' start='0' end='`$service-data.network-instance-groups.network-instance-group_length`' >\n","comments":"","outputs":1,"x":1552.976188659668,"y":1670.1191711425781,"z":"edca08.43dcd5f8","wires":[["6df47669.2779f8"]]},{"id":"6df47669.2779f8","type":"switchNode","name":"network-instance-group-ids match?","xml":"<switch test='`$aai.instance-group.instance-group[$ig-index].id\n  == $service-data.network-instance-groups.network-instance-group[$nig-index].network-instance-group-id`'>\n","comments":"","outputs":1,"x":1857.9760284423828,"y":1670.1192169189453,"z":"edca08.43dcd5f8","wires":[["c936fde6.ea6b5"]]},{"id":"c936fde6.ea6b5","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":2079.6427993774414,"y":1668.7859954833984,"z":"edca08.43dcd5f8","wires":[["d40f9836.6816c8"]]},{"id":"d40f9836.6816c8","type":"for","name":"for each network","xml":"<for index='network-index' start='0' end='`$service-data.network-instance-groups.network-instance-group[$nig-index].networks.network_length`' >\n","comments":"","outputs":1,"x":2235.357135772705,"y":1667.5001211166382,"z":"edca08.43dcd5f8","wires":[["73a6e453.2dc27c"]]},{"id":"73a6e453.2dc27c","type":"set","name":"clear vlan-tag-id and set network-status to unassigned","xml":"<set>\n<parameter name='service-data.network-instance-groups.network-instance-group[$nig-index].networks.network[$network-index].vlan-tag-id'\n  value='' />\n<parameter name='service-data.network-instance-groups.network-instance-group[$nig-index].networks.network[$network-index].network-status'\n  value='unassigned' />\n","comments":"","x":2546.7855682373047,"y":1666.0715837478638,"z":"edca08.43dcd5f8","wires":[]},{"id":"c0ba523c.0e6c9","type":"for","name":"for each returned instance-group","xml":"<for index='ig-index' start='0' end='`$aai.instance-group.instance-group_length`' >\n","comments":"","outputs":1,"x":1426.4762725830078,"y":1413.7857522964478,"z":"edca08.43dcd5f8","wires":[["b27bb7c.bac2148"]]},{"id":"b27bb7c.bac2148","type":"for","name":"for each relationship","xml":"<for index='rel-index' start='0' end='`$aai.instance-group.instance-group[$ig-index].relationship-list.relationship_length`' >\n","comments":"","outputs":1,"x":1678.1429138183594,"y":1412.7857513427734,"z":"edca08.43dcd5f8","wires":[["5676aa24.301644"]]},{"id":"5676aa24.301644","type":"for","name":"for each relationship-data","xml":"<for index='reldata-index' start='0' end='`$aai.instance-group.instance-group[$ig-index].relationship-list.relationship[$rel-index].relationship-data_length`' >\n","comments":"","outputs":1,"x":1904.809585571289,"y":1412.119125366211,"z":"edca08.43dcd5f8","wires":[["722edf98.fcc32"]]},{"id":"722edf98.fcc32","type":"switchNode","name":"switch relationship-key == service-instance.service-instance-id","xml":"<switch test=\"`$aai.instance-group.instance-group[$ig-index].relationship-list.relationship[$rel-index].relationship-data[$reldata-index].relationship-key\n  == 'service-instance.service-instance-id'`\">\n","comments":"","outputs":1,"x":2263.1431732177734,"y":1412.119044303894,"z":"edca08.43dcd5f8","wires":[["bb7adcc6.be445"]]},{"id":"bb7adcc6.be445","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":2559.8096313476562,"y":1412.1190767288208,"z":"edca08.43dcd5f8","wires":[["565dbbdc.5b1974"]]},{"id":"565dbbdc.5b1974","type":"switchNode","name":"switch relationship-value == this service-instance-id","xml":"<switch test='`$aai.instance-group.instance-group[$ig-index].relationship-list.relationship[$rel-index].relationship-data[$reldata-index].relationship-value\n  == $service-data.service-information.service-instance-id`'>\n","comments":"","outputs":1,"x":2824.809455871582,"y":1412.1190462112427,"z":"edca08.43dcd5f8","wires":[["3623dcb7.0ba5a4"]]},{"id":"3623dcb7.0ba5a4","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":3084.809425354004,"y":1412.1190366744995,"z":"edca08.43dcd5f8","wires":[["8d423e6c.0cf62"]]},{"id":"73a90d31.ecce84","type":"for","name":"for each vm-type","xml":"<for silentFailure='true' index='vm-type-index' start='0'\n  end='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-assignments.vms.vm_length`' >\n","comments":"","outputs":1,"x":521.3095855712891,"y":1980.865927696228,"z":"edca08.43dcd5f8","wires":[["5d05a061.91ad9"]]},{"id":"db962940.0240b8","type":"for","name":"for each vnfc","xml":"<for silentFailure='true' index='vnfc-index' start='0' end='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names_length`' >\n","comments":"","outputs":1,"x":872.9763526916504,"y":2075.247173309326,"z":"edca08.43dcd5f8","wires":[["733586cf.315098"]]},{"id":"407d8547.27ee9c","type":"save","name":"delete vnfc in A&AI","xml":"<delete plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\"\n   resource=\"vnfc\"\n   key=\"vnfc.vnfc-name = $service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-name\">\n","comments":"","outputs":1,"x":1184.404857635498,"y":2117.770721435547,"z":"edca08.43dcd5f8","wires":[[]]},{"id":"4dea7724.e6e7c8","type":"comment","name":"check removed with US622450","info":"","comments":"","x":1076.4286041259766,"y":978.3333659172058,"z":"edca08.43dcd5f8","wires":[]},{"id":"bd116d68.1b7b1","type":"block","name":"block","xml":"<block>","atomic":"true","comments":"","outputs":1,"x":1480.4758567810059,"y":2065.032509803772,"z":"edca08.43dcd5f8","wires":[["2161ecb4.8612d4","4b228352.15c6ec"]]},{"id":"4b228352.15c6ec","type":"call","name":"call GENERIC-RESOURCE-API:naming-policy-generate-name","xml":"<call module='GENERIC-RESOURCE-API' rpc='naming-policy-generate-name' mode='sync' >\n","comments":"","outputs":1,"x":1792.7615928649902,"y":2089.604027748108,"z":"edca08.43dcd5f8","wires":[[]]},{"id":"2161ecb4.8612d4","type":"set","name":"set variables for deleting VNFC name","xml":"<set>\n<parameter name='naming-policy-generate-name-input.naming-type' value='VNFC' />\n<parameter name='naming-policy-generate-name-input.context-id' value='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-topology-identifier.vf-module-id`' />\n<parameter name='naming-policy-generate-name-input.vm-name' value='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vm-name[$vnfc-index]`' />\n<parameter name='naming-policy-generate-name-input.action' value='DELETE' />\n","comments":"","x":1712.5235481262207,"y":2042.4610977172852,"z":"edca08.43dcd5f8","wires":[]},{"id":"334d1abd.bce5c6","type":"switchNode","name":"switch vnfc-name","xml":"<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-name`'>\n","comments":"","outputs":1,"x":1180.80952835083,"y":2038.3657665252686,"z":"edca08.43dcd5f8","wires":[["97de8700.c67958","abf72ed3.2ae3d"]]},{"id":"97de8700.c67958","type":"outcome","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":1350.8095054626465,"y":2008.3657999038696,"z":"edca08.43dcd5f8","wires":[["8aceccf2.324bf"]]},{"id":"abf72ed3.2ae3d","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":1350.8094635009766,"y":2064.5563135147095,"z":"edca08.43dcd5f8","wires":[["bd116d68.1b7b1"]]},{"id":"8aceccf2.324bf","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1480.8093490600586,"y":2006.6991519927979,"z":"edca08.43dcd5f8","wires":[[]]},{"id":"d790b9f2.093218","type":"comment","name":"Rollback any generated VM and VNFC names","info":"","comments":"","x":569.1426620483398,"y":1933.3659381866455,"z":"edca08.43dcd5f8","wires":[]},{"id":"5d05a061.91ad9","type":"block","name":"block","xml":"<block>","atomic":"true","comments":"","outputs":1,"x":685.2138137817383,"y":1981.2712144851685,"z":"edca08.43dcd5f8","wires":[["b4709ea8.e1a46","db962940.0240b8","d8542c95.9e6d4"]]},{"id":"b4709ea8.e1a46","type":"for","name":"for each vm-name","xml":"<for silentFailure='true' index='vm-name-index' start='0' end='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vm-name_length`' >\n","comments":"","outputs":1,"x":893.5470504760742,"y":1901.2714567184448,"z":"edca08.43dcd5f8","wires":[["c63cd25e.7f96c"]]},{"id":"c63cd25e.7f96c","type":"switchNode","name":"switch vm-name","xml":"<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vm-name[$vm-name-index]`'>\n","comments":"","outputs":1,"x":1088.5470962524414,"y":1902.9380960464478,"z":"edca08.43dcd5f8","wires":[["c87987a3.006058","ac104589.688508"]]},{"id":"c87987a3.006058","type":"outcome","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":1241.8804092407227,"y":1874.6047620773315,"z":"edca08.43dcd5f8","wires":[["b2c06f9a.6b335"]]},{"id":"b2c06f9a.6b335","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1371.8802528381348,"y":1872.9381141662598,"z":"edca08.43dcd5f8","wires":[[]]},{"id":"1835d1da.8d6fbe","type":"block","name":"block","xml":"<block>","atomic":"true","comments":"","outputs":1,"x":1373.5471572875977,"y":1932.9380750656128,"z":"edca08.43dcd5f8","wires":[["6872fb60.d87f74","6b9ed6d8.a03198"]]},{"id":"ac104589.688508","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":1243.8807640075684,"y":1932.4618787765503,"z":"edca08.43dcd5f8","wires":[["1835d1da.8d6fbe"]]},{"id":"6b9ed6d8.a03198","type":"call","name":"call GENERIC-RESOURCE-API:naming-policy-generate-name","xml":"<call module='GENERIC-RESOURCE-API' rpc='naming-policy-generate-name' mode='sync' >\n","comments":"","outputs":1,"x":1673.5470352172852,"y":1957.9380750656128,"z":"edca08.43dcd5f8","wires":[[]]},{"id":"6872fb60.d87f74","type":"set","name":"set variables for deleting VM name","xml":"<set>\n<parameter name='naming-policy-generate-name-input.naming-type' value='VM' />\n<parameter name='naming-policy-generate-name-input.context-id' value='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-topology-identifier.vf-module-id`' />\n<parameter name='naming-policy-generate-name-input.action' value='DELETE' />\n","comments":"","x":1588.3089294433594,"y":1910.7951068878174,"z":"edca08.43dcd5f8","wires":[]},{"id":"733586cf.315098","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1020.476261138916,"y":2074.032554626465,"z":"edca08.43dcd5f8","wires":[["334d1abd.bce5c6","407d8547.27ee9c"]]},{"id":"edfc93db.b0f24","type":"switchNode","name":"switch vf-module-name","xml":"<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-topology-identifier.vf-module-name`'>\n","comments":"","outputs":1,"x":533.8095474243164,"y":1771.6993923187256,"z":"edca08.43dcd5f8","wires":[["8273d9f2.da4e78","2f2f0cce.6db7a4"]]},{"id":"8273d9f2.da4e78","type":"outcome","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":710.4761734008789,"y":1797.5326251983643,"z":"edca08.43dcd5f8","wires":[["b6cced29.52f11"]]},{"id":"2f2f0cce.6db7a4","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":712.5714340209961,"y":1746.3185300827026,"z":"edca08.43dcd5f8","wires":[["68d97b79.44c654"]]},{"id":"68d97b79.44c654","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":835.1428527832031,"y":1744.699390411377,"z":"edca08.43dcd5f8","wires":[[]]},{"id":"b6cced29.52f11","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":857.4761390686035,"y":1798.0326652526855,"z":"edca08.43dcd5f8","wires":[["8de0ac4a.3fc46","8e085c7d.0b77e"]]},{"id":"8e085c7d.0b77e","type":"call","name":"call GENERIC-RESOURCE-API:naming-policy-generate-unique-name","xml":"<call module='GENERIC-RESOURCE-API' rpc='naming-policy-generate-unique-name' mode='sync' >\n","comments":"","outputs":1,"x":1207.1428298950195,"y":1818.3659992218018,"z":"edca08.43dcd5f8","wires":[[]]},{"id":"8de0ac4a.3fc46","type":"set","name":"set variables for deleting VF module name","xml":"<set>\n<parameter name='generate-unique-name-input.name-table-type' value='VF_MODULE_INSTANCE' />\n<parameter name='generate-unique-name-input.context-id' value='`$vf-module-topology-operation-input.vnf-information.vnf-id`' />\n<parameter name='generate-unique-name-input.action' value='DELETE' />\n","comments":"","x":1120.2377624511719,"y":1774.0802898406982,"z":"edca08.43dcd5f8","wires":[]},{"id":"d8542c95.9e6d4","type":"for","name":"for each vm-network","xml":"<for silentFailure='true' index='network-role-index' start='0' end='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network_length`' >\n","comments":"","outputs":1,"x":897.1428756713867,"y":2213.365894317627,"z":"edca08.43dcd5f8","wires":[["9dbaf8be.2c5a78"]]},{"id":"9dbaf8be.2c5a78","type":"block","name":"block","xml":"<block>","atomic":"true","comments":"","outputs":1,"x":1086.9761962890625,"y":2212.865333557129,"z":"edca08.43dcd5f8","wires":[["b9e9da24.8c82f8"]]},{"id":"b9e9da24.8c82f8","type":"for","name":"for each vnfc","xml":"<for silentFailure='true' index='vnfc-index' start='0' end='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names_length`' >\n","comments":"","outputs":1,"x":1240.9762573242188,"y":2211.5321588516235,"z":"edca08.43dcd5f8","wires":[["e2b9d78b.cc4bf8"]]},{"id":"e2b9d78b.cc4bf8","type":"block","name":"block","xml":"<block>","atomic":"true","comments":"","outputs":1,"x":1399.309642791748,"y":2211.5321521759033,"z":"edca08.43dcd5f8","wires":[["bc08d54a.866b08","f2f380ca.fd766"]]},{"id":"bc08d54a.866b08","type":"for","name":"for each floating ipv4 address","xml":"<for silentFailure='true' index='ipv4-index' start='0' end='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$vm-network-index].floating-ips.floating-ip-v4_length`' >\n","comments":"","outputs":1,"x":1604.1426620483398,"y":2180.698776245117,"z":"edca08.43dcd5f8","wires":[["84da1564.384538"]]},{"id":"f2f380ca.fd766","type":"for","name":"for each floating ipv6 address","xml":"<for silentFailure='true' index='ipv6-index' start='0' end='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$vm-network-index].floating-ips.floating-ip-v6_length`' >\n","comments":"","outputs":1,"x":1604.8092575073242,"y":2237.6985359191895,"z":"edca08.43dcd5f8","wires":[["f7a702cd.67dd4"]]},{"id":"84da1564.384538","type":"delete","name":"delete vip-ipv4-address-list from A&AI","xml":"<delete plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n   resource=\"vip-ipv4-address-list\" \n   key=\"cloud-region.cloud-owner = $prop.cloud-region.cloud-owner\n\t  AND cloud-region.cloud-region-id = $vf-module-topology-operation-input.vf-module-request-input.aic-cloud-region\n\t  AND vip-ipv4-address-list.vip-ipv4-address = $service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$vm-network-index].floating-ips.floating-ip-v4[$ipv4-index]\" >","comments":"","outputs":1,"x":1908.1426620483398,"y":2180.698776245117,"z":"edca08.43dcd5f8","wires":[[]]},{"id":"f7a702cd.67dd4","type":"delete","name":"delete vip-ipv6-address-list from A&AI","xml":"<delete plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n   resource=\"vip-ipv6-address-list\" \n   key=\"cloud-region.cloud-owner = $prop.cloud-region.cloud-owner\n\t  AND cloud-region.cloud-region-id = $vf-module-topology-operation-input.vf-module-request-input.aic-cloud-region\n\t  AND vip-ipv6-address-list.vip-ipv6-address = $service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$vm-network-index].floating-ips.floating-ip-v6[$ipv6-index]\" >","comments":"","outputs":1,"x":1906.8092575073242,"y":2236.365406036377,"z":"edca08.43dcd5f8","wires":[[]]},{"id":"46c1a821.48d258","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":187.14285278320312,"y":479.99999618530273,"z":"edca08.43dcd5f8","wires":[["877764f1.c72548","1f8899f9.b231e6","265413e1.39158c","a5cd088e.80d568","47fc1d3b.5c4464","f4f336f5.5dea88","4a2fa4b4.4280bc","b03149b9.a4a018"]]},{"id":"b03149b9.a4a018","type":"switchNode","name":"switch: sdnc-generated-cloud-resources","xml":"<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.sdnc-generated-cloud-resources`'>\n","comments":"","outputs":1,"x":584.2857055664062,"y":745.7142944335938,"z":"edca08.43dcd5f8","wires":[["f52095ab.b5aa28","4cbc82c3.2a450c"]]},{"id":"f52095ab.b5aa28","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":844.0357513427734,"y":745.7142963409424,"z":"edca08.43dcd5f8","wires":[["a838eae6.120f88"]]},{"id":"a838eae6.120f88","type":"call","name":"call self-serve-vf-module-unassign","xml":"<call module='GENERIC-RESOURCE-API' rpc='self-serve-vf-module-unassign' mode='sync' >\n","comments":"","outputs":1,"x":1063.0713653564453,"y":745.4642925262451,"z":"edca08.43dcd5f8","wires":[["48b43ca2.72b954","6980526.c2eb1ac"]]},{"id":"48b43ca2.72b954","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1307.8213500976562,"y":745.7142810821533,"z":"edca08.43dcd5f8","wires":[["737083a6.fa25bc"]]},{"id":"737083a6.fa25bc","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n<parameter name='error-code' value='500' />\n<parameter name='error-message' value=\"`'Encountered error while unassigning self-serve vf-moldule esources with error: '+ $error-message`\" />\n","comments":"","x":1473.3927764892578,"y":745.3571758270264,"z":"edca08.43dcd5f8","wires":[]},{"id":"4cbc82c3.2a450c","type":"other","name":"Other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":845.4285278320312,"y":789.1269626617432,"z":"edca08.43dcd5f8","wires":[["18261499.1e3fdb"]]},{"id":"6980526.c2eb1ac","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":1312.428524017334,"y":796.2698154449463,"z":"edca08.43dcd5f8","wires":[["9574322f.8a1c2"]]},{"id":"9574322f.8a1c2","type":"returnSuccess","name":"return success","xml":"<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n","comments":"","x":1480.9999389648438,"y":795.8412570953369,"z":"edca08.43dcd5f8","wires":[]}]