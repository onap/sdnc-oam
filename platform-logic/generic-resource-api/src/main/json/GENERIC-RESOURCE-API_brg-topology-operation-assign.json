[
  {
    "id":"e5ee9a68.8f74a8",
    "type":"dgstart",
    "name":"DGSTART",
    "outputs":1,
    "x":125,
    "y":52.5,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "393cc04a.70965"
      ]
    ]
  },
  {
    "id":"393cc04a.70965",
    "type":"service-logic",
    "name":"GENERIC-RESOURCE-API ${project.version}",
    "module":"GENERIC-RESOURCE-API",
    "version":"${project.version}",
    "comments":"",
    "xml":"<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>",
    "outputs":1,
    "x":221.23807907104492,
    "y":113.45239067077637,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "8d790a6c.626248"
      ]
    ]
  },
  {
    "id":"8d790a6c.626248",
    "type":"method",
    "name":"brg-topology-operation-assign",
    "xml":"<method rpc='brg-topology-operation-assign' mode='sync'>\n",
    "comments":"",
    "outputs":1,
    "x":267.15485763549805,
    "y":148.69044589996338,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "709e013b.ec7ed"
      ]
    ]
  },
  {
    "id":"709e013b.ec7ed",
    "type":"block",
    "name":"block : atomic",
    "xml":"<block atomic=\"true\">",
    "atomic":"true",
    "comments":"",
    "outputs":1,
    "x":175.47619247436523,
    "y":292.0237879753113,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "5341126d.beb3cc",
        "18e0684.02efa98",
        "3d25a078.5fbfa",
        "4f907ab1.9b90b4",
        "8f923afe.9146b8"
      ]
    ]
  },
  {
    "id":"3cb0dbf.eb62a24",
    "type":"returnSuccess",
    "name":"return success",
    "xml":"<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n",
    "comments":"",
    "x":1018.6666564941406,
    "y":2219.0477046966553,
    "z":"25bf3deb.2eabd2",
    "wires":[

    ]
  },
  {
    "id":"b4a4d9bb.64b1c8",
    "type":"set",
    "name":"set output to api handler",
    "xml":"<set>\n<parameter name='allotted-resource-id' value='`$tmp.ar.allotted-resource-id`' />\n<parameter name='tunnelxconn-object-path' value=\"`$tmp.ar.self-link`\"/>\n<parameter name='service-object-path' value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $brg-topology-operation-input.service-information.service-instance-id\n + '/service-data/service-topology/'`\"/>\n \n",
    "comments":"",
    "x":1055.7540550231934,
    "y":2097.932439804077,
    "z":"25bf3deb.2eabd2",
    "wires":[

    ]
  },
  {
    "id":"77739892.271138",
    "type":"set",
    "name":"set allotted-resource-oper-status",
    "xml":"<set>\n<parameter name='brg-ar.allotted-resource-data.allotted-resource-oper-status.order-status' value='PendingCreate' />\n<parameter name='brg-ar.allotted-resource-data.allotted-resource-oper-status.last-action' value='`$brg-topology-operation-input.request-information.request-action`' />\n<parameter name='brg-ar.allotted-resource-data.allotted-resource-oper-status.last-rpc-action' value='`$brg-topology-operation-input.sdnc-request-header.svc-action`' />\n<parameter name='brg-ar.allotted-resource-data.allotted-resource-oper-status.last-svc-request-id' value='`$brg-topology-operation-input.sdnc-request-header.svc-request-id`' />\n<parameter name='brg-ar.allotted-resource-data.allotted-resource-oper-status.create-timestamp' value='`$tmp.current-time`' />\n",
    "comments":"",
    "x":1127.468376159668,
    "y":1515.1228160858154,
    "z":"25bf3deb.2eabd2",
    "wires":[

    ]
  },
  {
    "id":"18e0684.02efa98",
    "type":"set",
    "name":"set tmp.ar.self-link",
    "xml":"<set>\n<parameter name='tmp.ar.self-link' value=\"`'restconf/config/GENERIC-RESOURCE-API:tunnelxconn-allotted-resources/tunnelxconn-allotted-resource/'\n + $tmp.ar.allotted-resource-id\n + '/allotted-resource-data/tunnelxconn-topology/'` \" />\n\n",
    "comments":"",
    "x":605.7380676269531,
    "y":183.83331298828125,
    "z":"25bf3deb.2eabd2",
    "wires":[

    ]
  },
  {
    "id":"5341126d.beb3cc",
    "type":"set",
    "name":"set tmp.ar.allotted-resource-id,etc",
    "xml":"<set>\n<parameter name='tmp.ar.allotted-resource-id' value='`$brg-topology-operation-input.allotted-resource-information.allotted-resource-id`' />\n<parameter name='tmp.ar.parent-service-instance-id' value='`$brg-topology-operation-input.allotted-resource-information.parent-service-instance-id`' />\n\n\n",
    "comments":"",
    "x":658.997314453125,
    "y":146.09259033203125,
    "z":"25bf3deb.2eabd2",
    "wires":[

    ]
  },
  {
    "id":"2eb376c7.9249fa",
    "type":"success",
    "name":"success",
    "xml":"<outcome value='success'>\n",
    "comments":"",
    "outputs":1,
    "x":808.8148803710938,
    "y":331.76727294921875,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "bfb84d8.6226eb"
      ]
    ]
  },
  {
    "id":"98be663.e803998",
    "type":"execute",
    "name":"execute RestApiCallNode - PUT AR by id",
    "xml":"<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='templateFileName' value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.brg.templatefile`\" />\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.ar-url`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='PUT' />\n    <parameter name=\"responsePrefix\" value=\"mdsal-ar\" />\n\n",
    "comments":"",
    "outputs":1,
    "x":1148.8626251220703,
    "y":1739.6008231639862,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "567616cd.4d0bc8",
        "34674551.1ef96a",
        "c49baabf.6ac098"
      ]
    ]
  },
  {
    "id":"567616cd.4d0bc8",
    "type":"not-found",
    "name":"not-found",
    "xml":"<outcome value='not-found'>\n",
    "comments":"",
    "outputs":1,
    "x":1417.5040016174316,
    "y":1790.9322349056602,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "1afb211c.3db5af"
      ]
    ]
  },
  {
    "id":"34674551.1ef96a",
    "type":"failure",
    "name":"failure",
    "xml":"<outcome value='failure'>\n",
    "comments":"",
    "outputs":1,
    "x":1408.504051208496,
    "y":1759.4322606548667,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "1afb211c.3db5af"
      ]
    ]
  },
  {
    "id":"c49baabf.6ac098",
    "type":"success",
    "name":"success",
    "xml":"<outcome value='success'>\n",
    "comments":"",
    "outputs":1,
    "x":1412.2540893554688,
    "y":1729.789365530014,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "24c4fc44.bfefd4"
      ]
    ]
  },
  {
    "id":"1afb211c.3db5af",
    "type":"returnFailure",
    "name":"return failure",
    "xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating md-sal for tunnelxconn-allotted-resource\" />\n",
    "comments":"",
    "x":1578.2540893554688,
    "y":1760.1822844967246,
    "z":"25bf3deb.2eabd2",
    "wires":[

    ]
  },
  {
    "id":"b9913138.178af",
    "type":"set",
    "name":"set oper-status",
    "xml":"<set>\n<parameter name='brg-ar.allotted-resource-data.allotted-resource-oper-status.last-action' value='`$brg-ar.allotted-resource-data.allotted-resource-operation-information.request-information.request-action`' />\n<parameter name='brg-ar.allotted-resource-data.allotted-resource-oper-status.last-rpc-action' value='`$brg-ar.allotted-resource-status.rpc-action`' />\n<parameter name='brg-ar.allotted-resource-data.allotted-resource-oper-status.last-svc-request-id' value='`$brg-ar.allotted-resource-data.allotted-resource-operation-information.sdnc-request-header.svc-request-id`' />\n\n",
    "comments":"",
    "x":1158.5294189453125,
    "y":432.55291748046875,
    "z":"25bf3deb.2eabd2",
    "wires":[

    ]
  },
  {
    "id":"23613fee.e7e3c",
    "type":"comment",
    "name":"Save consumed-allotted-resources to mdsal",
    "info":"",
    "comments":"",
    "x":1226.2434692382812,
    "y":1114.2196044921875,
    "z":"25bf3deb.2eabd2",
    "wires":[

    ]
  },
  {
    "id":"c3ce8536.056418",
    "type":"comment",
    "name":"GET tunnelxconn-allotted-resource from mdsal",
    "info":"",
    "comments":"",
    "x":531.8148193359375,
    "y":302.2672119140625,
    "z":"25bf3deb.2eabd2",
    "wires":[

    ]
  },
  {
    "id":"bfb84d8.6226eb",
    "type":"returnFailure",
    "name":"return failure - tunnelxconn already exists",
    "xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" \n    value=\"`'Existing brg-allotted-resource with order status of ' + $mdsal-ar.allotted-resource-data.allotted-resource-oper-status.order-status + '.'`\" />\n",
    "comments":"",
    "x":1118.129150390625,
    "y":328.1243896484375,
    "z":"25bf3deb.2eabd2",
    "wires":[

    ]
  },
  {
    "id":"adfbfac.9b9f208",
    "type":"set",
    "name":"set brg-ar-identifiers",
    "xml":"<set>\n<parameter name='brg-ar-identifiers.consuming-service-instance-id' value=\"`$brg-topology-operation-input.service-information.service-instance-id` \" />\n<parameter name='brg-ar-identifiers.parent-service-instance-id' value=\"`$brg-topology-operation-input.allotted-resource-information.parent-service-instance-id` \" />\n<parameter name='brg-ar-identifiers.allotted-resource-type' value=\"`$brg-topology-operation-input.allotted-resource-information.allotted-resource-type` \" />\n<parameter name='brg-ar-identifiers.allotted-resource-id' value=\"`$tmp.ar.allotted-resource-id` \" />\n\n",
    "comments":"",
    "x":1168.38623046875,
    "y":526.1243896484375,
    "z":"25bf3deb.2eabd2",
    "wires":[

    ]
  },
  {
    "id":"dfee41c5.0d9b3",
    "type":"comment",
    "name":"Set allotted-resource-identifiers",
    "info":"",
    "comments":"",
    "x":1195.338623046875,
    "y":484.838623046875,
    "z":"25bf3deb.2eabd2",
    "wires":[

    ]
  },
  {
    "id":"ea01d74e.35b878",
    "type":"set",
    "name":"set identifiers in overall structure",
    "xml":"<set>\n<parameter name='brg-ar.allotted-resource-data.brg-topology.allotted-resource-identifiers.' \nvalue=\"`$brg-ar-identifiers.`\" />\n\n\n",
    "comments":"",
    "x":1185.38623046875,
    "y":834.410400390625,
    "z":"25bf3deb.2eabd2",
    "wires":[

    ]
  },
  {
    "id":"33b72d9b.8a20c2",
    "type":"set",
    "name":"set onap model information from input",
    "xml":"<set>\n<parameter name='tx-ar.allotted-resource-data.brg-topology.onap-model-information.' \nvalue=\"`$brg-topology-operation-input.allotted-resource-information.onap-model-information.`\" />\n\n\n",
    "comments":"",
    "x":1213.957763671875,
    "y":569.4100952148438,
    "z":"25bf3deb.2eabd2",
    "wires":[

    ]
  },
  {
    "id":"afbfed3a.08159",
    "type":"switchNode",
    "name":"switch model-invariant-uuid is null",
    "xml":"<switch test='$brg-topology-operation-input.allotted-resource-information.onap-model-information.model-invariant-uuid'>\n",
    "comments":"",
    "outputs":1,
    "x":1193.8148193359375,
    "y":608.69580078125,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "40b2b772.23c3f8"
      ]
    ]
  },
  {
    "id":"40b2b772.23c3f8",
    "type":"outcome",
    "name":"outcome null",
    "xml":"<outcome value=''>\n",
    "comments":"",
    "outputs":1,
    "x":1421.9576988220215,
    "y":610.1243271827698,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "853c921b.506c8"
      ]
    ]
  },
  {
    "id":"853c921b.506c8",
    "type":"set",
    "name":"set model-invariant-uuid",
    "xml":"<set>\n<parameter name='brg-ar.allotted-resource-data.brg-topology.onap-model-information.model-invariant-uuid' \nvalue=\"`$ar-model.invariant-uuid`\" />\n\n\n",
    "comments":"",
    "x":1623.38627243042,
    "y":609.5528798103333,
    "z":"25bf3deb.2eabd2",
    "wires":[

    ]
  },
  {
    "id":"d3ea34e9.368c88",
    "type":"switchNode",
    "name":"switch model-uuid is null",
    "xml":"<switch test='$brg-topology-operation-input.allotted-resource-information.onap-model-information.model-uuid'>\n",
    "comments":"",
    "outputs":1,
    "x":1166.2434158325195,
    "y":642.9815106391907,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "e20ffb32.51cf08"
      ]
    ]
  },
  {
    "id":"e20ffb32.51cf08",
    "type":"outcome",
    "name":"outcome null",
    "xml":"<outcome value=''>\n",
    "comments":"",
    "outputs":1,
    "x":1367.6719818115234,
    "y":643.5529322624207,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "3277974f.69b6d8"
      ]
    ]
  },
  {
    "id":"3277974f.69b6d8",
    "type":"set",
    "name":"set model-uuid",
    "xml":"<set>\n<parameter name='brg-ar.allotted-resource-data.brg-topology.onap-model-information.model-uuid' \nvalue=\"`$ar-model.uuid`\" />\n\n\n",
    "comments":"",
    "x":1560.529140472412,
    "y":643.5528540611267,
    "z":"25bf3deb.2eabd2",
    "wires":[

    ]
  },
  {
    "id":"40fda3ea.8add9c",
    "type":"switchNode",
    "name":"switch model-version is null",
    "xml":"<switch test='$brg-topology-operation-input.allotted-resource-information.onap-model-information.model-version'>\n",
    "comments":"",
    "outputs":1,
    "x":1174.8148193359375,
    "y":675.8386378288269,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "f1c91438.54f678"
      ]
    ]
  },
  {
    "id":"f1c91438.54f678",
    "type":"outcome",
    "name":"outcome null",
    "xml":"<outcome value=''>\n",
    "comments":"",
    "outputs":1,
    "x":1424.8148002624512,
    "y":675.8386225700378,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "dd6dede8.36e8b"
      ]
    ]
  },
  {
    "id":"dd6dede8.36e8b",
    "type":"set",
    "name":"set model-version",
    "xml":"<set>\n<parameter name='tx-ar.allotted-resource-data.tunnelxconn-topology.onap-model-information.model-version' \nvalue=\"`$ar-model.version`\" />\n\n\n",
    "comments":"",
    "x":1617.6719589233398,
    "y":675.8385443687439,
    "z":"25bf3deb.2eabd2",
    "wires":[

    ]
  },
  {
    "id":"c14238e7.7fc528",
    "type":"switchNode",
    "name":"switch ar-model.ecomp-generated-naming",
    "xml":"<switch test='`$ar-model.ecomp-generated-naming`'>\n",
    "comments":"",
    "outputs":1,
    "x":1238.38623046875,
    "y":778.2672729492188,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "e1eb2b6.299a9d8",
        "b14c2617.4ba278"
      ]
    ]
  },
  {
    "id":"e1eb2b6.299a9d8",
    "type":"other",
    "name":"outcome Y",
    "xml":"<outcome value='Y'>\n",
    "comments":"",
    "outputs":1,
    "x":1524.3862915039062,
    "y":777.6958618164062,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "cb449102.0bfe4"
      ]
    ]
  },
  {
    "id":"cb449102.0bfe4",
    "type":"block",
    "name":"block : atomic",
    "xml":"<block atomic=\"true\">\n",
    "atomic":"true",
    "comments":"",
    "outputs":1,
    "x":1678.1363525390625,
    "y":780.19580078125,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "6222201e.ef0d1"
      ]
    ]
  },
  {
    "id":"b14c2617.4ba278",
    "type":"other",
    "name":"other",
    "xml":"<outcome value='Other'>\n",
    "comments":"",
    "outputs":1,
    "x":1543.608642578125,
    "y":866.6958618164062,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "ba1cec2.367321"
      ]
    ]
  },
  {
    "id":"ba1cec2.367321",
    "type":"returnFailure",
    "name":"return failure",
    "xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error in allotted-resource-model data.  Ecomp-generated-naming should be true\" />\n\n",
    "comments":"",
    "x":1726.608642578125,
    "y":871.6958618164062,
    "z":"25bf3deb.2eabd2",
    "wires":[

    ]
  },
  {
    "id":"6222201e.ef0d1",
    "type":"switchNode",
    "name":"switch ar-model.ecomp-generated-naming",
    "xml":"<switch test='`$ar-model.naming-policy`'>\n",
    "comments":"",
    "outputs":1,
    "x":1814.38623046875,
    "y":829.267333984375,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "82b261b0.84ccc",
        "d8af7c81.cbd5"
      ]
    ]
  },
  {
    "id":"82b261b0.84ccc",
    "type":"other",
    "name":"outcome oam_network_policy",
    "xml":"<outcome value='oam_network_policy'>\n",
    "comments":"",
    "outputs":1,
    "x":2189.244140625,
    "y":832.8453369140625,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "a16beaa7.a8be68"
      ]
    ]
  },
  {
    "id":"d8af7c81.cbd5",
    "type":"other",
    "name":"other",
    "xml":"<outcome value='Other'>\n",
    "comments":"",
    "outputs":1,
    "x":2103.671875,
    "y":909.6958618164062,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "a16beaa7.a8be68"
      ]
    ]
  },
  {
    "id":"b92b0ebd.ec97e",
    "type":"set",
    "name":"set ar_name",
    "xml":"<set>\n<parameter name='tmp.ar-name' value='$TenantOAMNetworkRole_$LandingNetworkRole_SZ' />\n",
    "comments":"",
    "x":2495.100830078125,
    "y":868.2672729492188,
    "z":"25bf3deb.2eabd2",
    "wires":[

    ]
  },
  {
    "id":"ff0ac1c6.8d99",
    "type":"execute",
    "name":"execute SliStringUtils - replace TenantOAMNetworkRole",
    "xml":"<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"`$tmp.ar-name`\"/>\n    <parameter name=\"outputPath\" value=\"tmp.ar-name\"/>\n    <parameter name=\"target\" value=\"$TenantOAMNetworkRole\"/>\n    <parameter name=\"replacement\" value=\"`$tunnelxconn-topology-operation-input.tunnelxconn-request-input.untrusted-network-role`\"/>\n\n",
    "comments":"",
    "outputs":1,
    "x":2639.2437858581543,
    "y":912.1244196891785,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [

      ]
    ]
  },
  {
    "id":"11a52a68.e2bc36",
    "type":"execute",
    "name":"execute SliStringUtils - replace LandingNetworkRole",
    "xml":"<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"`$tmp.ar-name`\"/>\n    <parameter name=\"outputPath\" value=\"tmp.ar-name\"/>\n    <parameter name=\"target\" value=\"$LandingNetworkRole\"/>\n    <parameter name=\"replacement\" value=\"`$tunnelxconn-topology-operation-input.tunnelxconn-request-input.trusted-network-role`\"/>\n\n",
    "comments":"",
    "outputs":1,
    "x":2626.243896484375,
    "y":952.2672729492188,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [

      ]
    ]
  },
  {
    "id":"a16beaa7.a8be68",
    "type":"block",
    "name":"block: atomic",
    "xml":"<block atomic='true'>\n",
    "atomic":"false",
    "comments":"",
    "outputs":1,
    "x":2303.5292015075684,
    "y":907.8387522697449,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "b92b0ebd.ec97e",
        "ff0ac1c6.8d99",
        "11a52a68.e2bc36",
        "24287aef.ab1756"
      ]
    ]
  },
  {
    "id":"24287aef.ab1756",
    "type":"set",
    "name":"set identifiers.allotted-resource-name",
    "xml":"<set>\n<parameter name='brg-ar-identifiers.allotted-resource-name' value='`$tmp.ar-name`' />\n",
    "comments":"",
    "x":2584.1005859375,
    "y":1002.552978515625,
    "z":"25bf3deb.2eabd2",
    "wires":[

    ]
  },
  {
    "id":"16a390f2.71716f",
    "type":"set",
    "name":"set assignments in overall structure",
    "xml":"<set>\n<parameter name='brg-ar.allotted-resource-data.brg-topology.brg-assignments.' \nvalue=\"`$brg-ar-assignments.`\" />\n\n\n",
    "comments":"",
    "x":1193.8624572753906,
    "y":1039.1246919631958,
    "z":"25bf3deb.2eabd2",
    "wires":[

    ]
  },
  {
    "id":"57bd8950.360d48",
    "type":"set",
    "name":"Handle brg-ar-assignments",
    "xml":"<set>\n<parameter name='brg-ar-assignments.vbrg-wan-ip' value='127.0.0.1'/>\n",
    "comments":"",
    "x":1173.529052734375,
    "y":935.5530395507812,
    "z":"25bf3deb.2eabd2",
    "wires":[

    ]
  },
  {
    "id":"ad1d1f47.0fd92",
    "type":"for",
    "name":"for cidx..service-data.consumed-allotted-resources.consumed-allotted-resource[]",
    "xml":"<for index='cidx' start='0' end='`$service-data.consumed-allotted-resources.consumed-allotted-resource_length`' >\n",
    "comments":"",
    "outputs":1,
    "x":2211.8155822753906,
    "y":1312.5411586761475,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "9eff53f5.fba2e"
      ]
    ]
  },
  {
    "id":"4ca1ffaf.2765",
    "type":"switchNode",
    "name":"switch service-data.consumed-allotted-resources_length",
    "xml":"<switch test='`$service-data.consumed-allotted-resources.consumed-allotted-resource_length`'>\n",
    "comments":"",
    "outputs":1,
    "x":1242.8148193359375,
    "y":1200.005126953125,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "44b6b7be.364a78",
        "d6f3204f.2e124"
      ]
    ]
  },
  {
    "id":"44b6b7be.364a78",
    "type":"other",
    "name":"outcome Null",
    "xml":"<outcome value=''>\n",
    "comments":"",
    "outputs":1,
    "x":1618.2077865600586,
    "y":1204.6124458312988,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "da9136e5.9a43c8"
      ]
    ]
  },
  {
    "id":"d6f3204f.2e124",
    "type":"other",
    "name":"other",
    "xml":"<outcome value='Other'>\n",
    "comments":"",
    "outputs":1,
    "x":1616.9577865600586,
    "y":1294.6124477386475,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "e4b52287.ffa4f"
      ]
    ]
  },
  {
    "id":"9eff53f5.fba2e",
    "type":"switchNode",
    "name":"switch allotted-resource-id",
    "xml":"<switch test=\"`$service-data.consumed-allotted-resources.consumed-allotted-resource[$cidx].allotted-resource-id == $tmp.ar.allotted-resource-id`\">\n\n",
    "comments":"",
    "outputs":1,
    "x":2646.4106826782227,
    "y":1314.35085105896,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "4247aaf2.34bc24"
      ]
    ]
  },
  {
    "id":"4247aaf2.34bc24",
    "type":"outcomeTrue",
    "name":"true",
    "xml":"<outcome value='true'>\n",
    "comments":"",
    "outputs":1,
    "x":2853.220375061035,
    "y":1317.564962387085,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "4915e942.23f368"
      ]
    ]
  },
  {
    "id":"e4b52287.ffa4f",
    "type":"block",
    "name":"block : atomic",
    "xml":"<block atomic=\"true\">",
    "atomic":"true",
    "outputs":1,
    "x":1774.834976196289,
    "y":1300.9885501861572,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "ad1d1f47.0fd92",
        "f259b5a9.563638"
      ]
    ]
  },
  {
    "id":"4915e942.23f368",
    "type":"block",
    "name":"block : atomic",
    "xml":"<block atomic=\"true\">",
    "atomic":"true",
    "outputs":1,
    "x":3021.4817276000977,
    "y":1322.4222631454468,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "fbb9a58b.3d9f98",
        "f2f48ed3.1ccda"
      ]
    ]
  },
  {
    "id":"da9136e5.9a43c8",
    "type":"set",
    "name":"set cidx",
    "xml":"<set>\n<parameter name='tmp.cidx' value=\"`0`\" />\n<parameter name='service-data.consumed-allotted-resources.consumed-allotted-resource_length' value=\"1\" />\n\n\n",
    "comments":"",
    "x":1797.0647735595703,
    "y":1206.8266830444336,
    "z":"25bf3deb.2eabd2",
    "wires":[

    ]
  },
  {
    "id":"fbb9a58b.3d9f98",
    "type":"set",
    "name":"set tmp.cidx and ctx.consumed-ar",
    "xml":"<set>\n<parameter name='tmp.cidx' value='`$cidx`' />\n<parameter name='ctx.consumed-ar.' value='`$service-data.consumed-allotted-resources.consumed-allotted-resource[$cidx].`' />\n<parameter name='tmp.found-cidx' value='true' />",
    "comments":"",
    "x":3267.3391876220703,
    "y":1316.9937419891357,
    "z":"25bf3deb.2eabd2",
    "wires":[

    ]
  },
  {
    "id":"44d4d3b9.bceb9c",
    "type":"set",
    "name":"set consumed allotted resources",
    "xml":"<set>\n<parameter name='service-data.consumed-allotted-resources.consumed-allotted-resource[$tmp.cidx].allotted-resource-id' value=\"`$tmp.ar.allotted-resource-id` \" />\n<parameter name='service-data.consumed-allotted-resources.consumed-allotted-resource[$tmp.cidx].allotted-resource-type' value=\"`$brg-topology-operation-input.allotted-resource-information.allotted-resource-type` \" />\n<parameter name='service-data.consumed-allotted-resources.consumed-allotted-resource[$tmp.cidx].allotted-resource-pointer' value=\"`$tmp.ar.self-link` \" />\n<parameter name='service-data.consumed-allotted-resources.consumed-allotted-resource_length' value='`$tmp.cidx + 1`' />\n\n",
    "comments":"",
    "x":1153.6720123291016,
    "y":1365.326681137085,
    "z":"25bf3deb.2eabd2",
    "wires":[

    ]
  },
  {
    "id":"24c4fc44.bfefd4",
    "type":"block",
    "name":"block",
    "xml":"<block>\n",
    "atomic":"false",
    "comments":"",
    "outputs":1,
    "x":1553.910057067871,
    "y":1725.9815347194672,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "ee4c753c.c76778"
      ]
    ]
  },
  {
    "id":"d6830d95.f9764",
    "type":"comment",
    "name":"Add BRG AR to mdsal",
    "info":"",
    "comments":"",
    "x":1078.148208618164,
    "y":1700.6957080364227,
    "z":"25bf3deb.2eabd2",
    "wires":[

    ]
  },
  {
    "id":"85496e20.c7fce",
    "type":"execute",
    "name":"execute getTime",
    "xml":"<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='setTime' >\n    <parameter name=\"outputPath\" value=\"tmp.current-time\" />\n\n",
    "comments":"",
    "outputs":1,
    "x":1094.4814224243164,
    "y":1439.171986579895,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [

      ]
    ]
  },
  {
    "id":"5ce074ae.26955c",
    "type":"other",
    "name":"other",
    "xml":"<outcome value='Other'>\n",
    "comments":"",
    "outputs":1,
    "x":814.57666015625,
    "y":382.9814453125,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "eac1d1df.4a04c"
      ]
    ]
  },
  {
    "id":"eac1d1df.4a04c",
    "type":"block",
    "name":"block: atomic",
    "xml":"<block atomic=\"true\">\n",
    "atomic":"false",
    "comments":"",
    "outputs":1,
    "x":762.57666015625,
    "y":878.7908325195312,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "2e500645.0f8a1a",
        "adfbfac.9b9f208",
        "33b72d9b.8a20c2",
        "afbfed3a.08159",
        "d3ea34e9.368c88",
        "40fda3ea.8add9c",
        "b9913138.178af",
        "c14238e7.7fc528",
        "ea01d74e.35b878",
        "57bd8950.360d48",
        "16a390f2.71716f",
        "4ca1ffaf.2765",
        "44d4d3b9.bceb9c",
        "85496e20.c7fce",
        "77739892.271138",
        "c3886b00.abce88",
        "98be663.e803998",
        "b4a4d9bb.64b1c8",
        "3cb0dbf.eb62a24"
      ]
    ]
  },
  {
    "id":"2e500645.0f8a1a",
    "type":"set",
    "name":"set id",
    "xml":"<set>\n<parameter name='brg-ar.allotted-resource-id' value=\"`$tmp.ar.allotted-resource-id` \" />\n<parameter name='brg-ar.allotted-resource-status.action' value=\"`$brg-topology-operation-input.request-information.request-action` \" />\n<parameter name='brg-ar.allotted-resource-status.rpc-name' value=\"brg-topology-operation\" />\n<parameter name='brg-ar.allotted-resource-status.rpc-action' value=\"`$brg-topology-operation-input.sdnc-request-header.svc-action` \" />\n<parameter name='brg-ar.allotted-resource-data.allotted-resource-operation-information.request-information.' value=\"`$brg-topology-operation-input.request-information.` \" />\n<parameter name='brg-ar.allotted-resource-data.allotted-resource-operation-information.sdnc-request-header.' value=\"`$brg-topology-operation-input.sdnc-request-header.` \" />\n<parameter name='brg-ar.allotted-resource-data.allotted-resource-operation-information.service-information.' value=\"`$brg-topology-operation-input.service-information.` \" />\n<parameter name='brg-ar.allotted-resource-data.allotted-resource-operation-information.allotted-resource-information.' value=\"`$brg-topology-operation-input.allotted-resource-information.` \" />\n<parameter name='brg-ar.allotted-resource-data.allotted-resource-operation-information.tunnelxconn-request-input.' value=\"`$brg-topology-operation-input.brg-request-input.` \" />",
    "comments":"",
    "x":1133.2434387207031,
    "y":388.933837890625,
    "z":"25bf3deb.2eabd2",
    "wires":[

    ]
  },
  {
    "id":"c3886b00.abce88",
    "type":"update",
    "name":"update AAI allotted-resource",
    "xml":"<update plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"allotted-resource\" \n\t\tkey=\"customer.global-customer-id = $brg-topology-operation-input.service-information.global-customer-id AND\n\t\t\tservice-subscription.service-type = $brg-topology-operation-input.service-information.subscription-service-type AND\n\t\t\tservice-instance.service-instance-id = $brg-topology-operation-input.service-information.service-instance-id AND\n\t\t\tallotted-resource.id = $tmp.ar.allotted-resource-id\"\n        pfx='pfx' local-only='false' force='false'>\n\t<parameter name=\"description\" value=\"`$tunnelxconn-topology-operation-input.allotted-resource-information.allotted-resource-type`\" />\n\t<parameter name=\"selflink\" value=\"`$tmp.ar.self-link`\" />\n\t<parameter name=\"model-invariant-id\" value=\"`$ar-model.invariant-uuid`\" />\n\t<parameter name=\"model-version-id\" value=\"`$ar-model.uuid`\" />\n\t<parameter name=\"operational-status\" value=\"null\" />\n",
    "comments":"",
    "outputs":1,
    "x":1115.0529327392578,
    "y":1607.0767517089844,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "7ca7c810.8af8c8",
        "27b10af8.032016"
      ]
    ]
  },
  {
    "id":"7ca7c810.8af8c8",
    "type":"failure",
    "name":"failure",
    "xml":"<outcome value='failure'>\n",
    "comments":"",
    "outputs":1,
    "x":1370.814842224121,
    "y":1590.0292553901672,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "2112b130.25219e"
      ]
    ]
  },
  {
    "id":"2112b130.25219e",
    "type":"returnFailure",
    "name":"return failure",
    "xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"AAI failed\" />\n",
    "comments":"",
    "x":1537.338722229004,
    "y":1601.6483263969421,
    "z":"25bf3deb.2eabd2",
    "wires":[

    ]
  },
  {
    "id":"27b10af8.032016",
    "type":"failure",
    "name":"not-found",
    "xml":"<outcome value='not-found'>\n",
    "comments":"",
    "outputs":1,
    "x":1377.9101295471191,
    "y":1622.7912230491638,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "2112b130.25219e"
      ]
    ]
  },
  {
    "id":"f259b5a9.563638",
    "type":"switchNode",
    "name":"switch tmp.found-cidx",
    "xml":"<switch test='`$tmp.found-cidx`'>\n",
    "comments":"",
    "outputs":1,
    "x":2026.743423461914,
    "y":1558.7315921783447,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "74a25a57.2f53b4"
      ]
    ]
  },
  {
    "id":"74a25a57.2f53b4",
    "type":"outcomeTrue",
    "name":"false",
    "xml":"<outcome value='false'>\n",
    "comments":"",
    "outputs":1,
    "x":2216.743377685547,
    "y":1558.7315292358398,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "c642818d.c82e8"
      ]
    ]
  },
  {
    "id":"c642818d.c82e8",
    "type":"block",
    "name":"block : atomic",
    "xml":"<block atomic=\"true\">",
    "atomic":"true",
    "outputs":1,
    "x":2382.743377685547,
    "y":1558.7315292358398,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "94c7e089.4dbec"
      ]
    ]
  },
  {
    "id":"94c7e089.4dbec",
    "type":"set",
    "name":"set tmp.cidx ",
    "xml":"<set>\n<parameter name='tmp.cidx' value='`$service-data.consumed-allotted-resources.consumed-allotted-resource_length`' />\n",
    "comments":"",
    "x":2628.600706100464,
    "y":1559.3030033111572,
    "z":"25bf3deb.2eabd2",
    "wires":[

    ]
  },
  {
    "id":"ee4c753c.c76778",
    "type":"execute",
    "name":"execute RestApiCallNode - Update parent provided service AR",
    "xml":"<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='templateFileName' value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.parentsvc.templatefile`\" />\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.parent-ar-url`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='DELETE' />\n    <parameter name=\"responsePrefix\" value=\"parent\" />\n\n",
    "comments":"",
    "outputs":1,
    "x":1904.9521980285645,
    "y":1725.6904199123383,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "772b0aab.94a794",
        "cb34fc4a.b6aaa",
        "18d615d.09d0cea"
      ]
    ]
  },
  {
    "id":"633a71f3.b98a8",
    "type":"comment",
    "name":"Rollback parent",
    "info":"",
    "comments":"",
    "x":1748.9521255493164,
    "y":1695.3570504188538,
    "z":"25bf3deb.2eabd2",
    "wires":[

    ]
  },
  {
    "id":"772b0aab.94a794",
    "type":"not-found",
    "name":"not-found",
    "xml":"<outcome value='not-found'>\n",
    "comments":"",
    "outputs":1,
    "x":2276.2602462768555,
    "y":1786.3553862571716,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "17d2c2c8.78357d"
      ]
    ]
  },
  {
    "id":"cb34fc4a.b6aaa",
    "type":"failure",
    "name":"failure",
    "xml":"<outcome value='failure'>\n",
    "comments":"",
    "outputs":1,
    "x":2267.26029586792,
    "y":1754.8554120063782,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "17d2c2c8.78357d"
      ]
    ]
  },
  {
    "id":"18d615d.09d0cea",
    "type":"success",
    "name":"success",
    "xml":"<outcome value='success'>\n",
    "comments":"",
    "outputs":1,
    "x":2271.0103340148926,
    "y":1725.2125168815255,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "17d2c2c8.78357d"
      ]
    ]
  },
  {
    "id":"17d2c2c8.78357d",
    "type":"block",
    "name":"block",
    "xml":"<block>\n",
    "atomic":"false",
    "comments":"",
    "outputs":1,
    "x":2412.666301727295,
    "y":1721.4046860709786,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [

      ]
    ]
  },
  {
    "id":"9883554f.db10a8",
    "type":"comment",
    "name":"Generate naming",
    "info":"",
    "comments":"",
    "x":1169.3862762451172,
    "y":736.2672252655029,
    "z":"25bf3deb.2eabd2",
    "wires":[

    ]
  },
  {
    "id":"3d25a078.5fbfa",
    "type":"get-resource",
    "name":"get-resource tunnelxconn-allotted-resource",
    "xml":"<get-resource plugin='org.onap.ccsdk.sli.adaptors.resource.mdsal.ConfigResource' resource='GENERIC-RESOURCE-API' key='brg-allotted-resources/brg-allotted-resource/$brg-topology-operation-input.allotted-resource-information.allotted-resource-id/' pfx='mdsal-ar' >\n",
    "comments":"",
    "outputs":1,
    "x":514,
    "y":336.5,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [
        "2eb376c7.9249fa",
        "5ce074ae.26955c"
      ]
    ]
  },
  {
    "id":"4f907ab1.9b90b4",
    "type":"execute",
    "name":"execute Properties",
    "xml":"<execute plugin='org.onap.ccsdk.sli.plugins.prop.PropertiesNode' method='readProperties' >\n    <parameter name='fileName' value='%SDNC_CONFIG_DIR%/generic-resource-api-dg.properties' />\n    <parameter name='contextPrefix' value='prop' />\n",
    "comments":"",
    "outputs":1,
    "x":590,
    "y":225.5,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [

      ]
    ]
  },
  {
    "id":"8f923afe.9146b8",
    "type":"execute",
    "name":"generate allotted-resource url",
    "xml":"<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"`$prop.restapi.brg-allottedresource`\"/>\n    <parameter name=\"outputPath\" value=\"tmp.ar-url\"/>\n    <parameter name=\"target\" value=\"{allotted-resource-id}\"/>\n    <parameter name=\"replacement\" value=\"`$tmp.ar.allotted-resource-id`\"/>\n",
    "comments":"",
    "outputs":1,
    "x":597,
    "y":265.5,
    "z":"25bf3deb.2eabd2",
    "wires":[
      [

      ]
    ]
  },
  {
    "id":"f2f48ed3.1ccda",
    "type":"break",
    "name":"break",
    "xml":"<break>\n",
    "comments":"",
    "x":3180.243507385254,
    "y":1362.2316856384277,
    "z":"25bf3deb.2eabd2",
    "wires":[

    ]
  }
]