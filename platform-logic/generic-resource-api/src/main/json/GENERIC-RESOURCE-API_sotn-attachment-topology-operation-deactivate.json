[
  {
    "id": "723305d8.11e76c",
    "type": "dgstart",
    "name": "DGSTART",
    "outputs": 1,
    "x": 95.00390625,
    "y": 27.999999046325684,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "b93a23bf.14eff"
      ]
    ]
  },
  {
    "id": "b93a23bf.14eff",
    "type": "service-logic",
    "name": "GENERIC-RESOURCE-API ${project.version}",
    "module": "GENERIC-RESOURCE-API",
    "version": "${project.version}",
    "comments": "",
    "xml": "<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>",
    "outputs": 1,
    "x": 307.00391006469727,
    "y": 100.00001621246338,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "5b3dffa5.c765e"
      ]
    ]
  },
  {
    "id": "5b3dffa5.c765e",
    "type": "method",
    "name": "sotn-attachment-topology-operation-deactivate",
    "xml": "<method rpc='sotn-attachment-topology-operation-deactivate' mode='sync'>\n",
    "comments": "",
    "outputs": 1,
    "x": 295.0040283203125,
    "y": 187.99999904632568,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "1b5760f4.e377bf"
      ]
    ]
  },
  {
    "id": "1b5760f4.e377bf",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 311.0040283203125,
    "y": 743.0002436637878,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "35ca93cb.818e4c",
        "d010cc85.50d67",
        "61ac9ddf.c381f4",
        "9cfe2b87.83b668",
        "1d9b17a2.597f78",
        "cea26109.7f86d",
        "54189702.bd6308",
        "e57b213b.75c14",
        "cc614438.2bf6c8",
        "fcc726f0.284858",
        "8acea442.f49688",
        "3bb974a.bf8f88c",
        "85e1d23.e838c3",
        "f9a7c426.23e9f8",
        "9c7fe29e.71ca7",
        "24e481f8.3828fe",
        "adbe92fb.5a5cd",
        "cd672a69.e35f88",
        "f581f798.8d1028",
        "bce70d29.d57a8",
        "e94c0bb9.6dcf28"
      ]
    ]
  },
  {
    "id": "35ca93cb.818e4c",
    "type": "set",
    "name": "set tmp.ar.allotted-resource-id,etc",
    "xml": "<set>\n<parameter name='tmp.ar.allotted-resource-id' value='`$connection-attachment-topology-operation-input.allotted-resource-information.allotted-resource-id`' />\n<parameter name='tmp.ar.parent-service-instance-id' value='`$connection-attachment-topology-operation-input.allotted-resource-information.parent-service-instance-id`' />\n\n\n",
    "comments": "",
    "x": 707.9974670410156,
    "y": 141.9934859275818,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "c656a320.9b2dd",
    "type": "comment",
    "name": "set tmp ar-id to fetch resource from MDSAL",
    "info": "",
    "comments": "",
    "x": 736.9577789306641,
    "y": 106.02528190612793,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "d010cc85.50d67",
    "type": "set",
    "name": "set tmp.ar.self-link",
    "xml": "<set>\n<parameter name='tmp.ar.self-link' value=\"`'restconf/config/GENERIC-RESOURCE-API:connection-attachment-allotted-resources/connection-attachment-allotted-resource/'\n + $tmp.ar.allotted-resource-id\n + '/allotted-resource-data/connection-attachment-topology/'` \" />\n\n",
    "comments": "",
    "x": 661.9974060058594,
    "y": 234.99349117279053,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "1d9b17a2.597f78",
    "type": "execute",
    "name": "execute Properties",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.prop.PropertiesNode' method='readProperties' >\n    <parameter name='fileName' value='%SDNC_CONFIG_DIR%/generic-resource-api-dg.properties' />\n    <parameter name='contextPrefix' value='prop' />\n",
    "comments": "",
    "outputs": 1,
    "x": 668.2592964172363,
    "y": 322.6602201461792,
    "z": "d62527f6.b2b018",
    "wires": [
      []
    ]
  },
  {
    "id": "61ac9ddf.c381f4",
    "type": "execute",
    "name": "generate allotted-resource tmp.ar-url",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"`$prop.restapi.connection-attachment-allottedresource`\"/>\n    <parameter name=\"outputPath\" value=\"tmp.ar-url\"/>\n    <parameter name=\"target\" value=\"{allotted-resource-id}\"/>\n    <parameter name=\"replacement\" value=\"`$tmp.ar.allotted-resource-id`\"/>\n",
    "comments": "",
    "outputs": 1,
    "x": 718.2593994140625,
    "y": 409.6602210998535,
    "z": "d62527f6.b2b018",
    "wires": [
      []
    ]
  },
  {
    "id": "2e7f2bb4.112164",
    "type": "comment",
    "name": "GET connection-attachment-allotted-resource from mdsal",
    "info": "",
    "comments": "",
    "x": 761.8123931884766,
    "y": 480.53876781463623,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "4074f970.807e28",
    "type": "comment",
    "name": "Used for setting output to API Handler",
    "info": "",
    "comments": "",
    "x": 715.9974365234375,
    "y": 201.9935007095337,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "3d9d7c9e.78c9e4",
    "type": "comment",
    "name": "Obtain different URL, template location etc",
    "info": "For saving resource information to MDSAL & for AAI",
    "comments": "",
    "x": 733.9974021911621,
    "y": 287.882381439209,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "9a8093d2.b64ef",
    "type": "comment",
    "name": "Used to Get AR by id to MDSAL, same as self-link",
    "info": "",
    "comments": "",
    "x": 759.9974212646484,
    "y": 374.8823404312134,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "16169970.a028a7",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1202.6707344055176,
    "y": 528.0000276565552,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "72dd59c8.c307d8"
      ]
    ]
  },
  {
    "id": "72dd59c8.c307d8",
    "type": "block",
    "name": "block: atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1371.6707382202148,
    "y": 526.4999284744263,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "1a81e253.971f5e"
      ]
    ]
  },
  {
    "id": "1a81e253.971f5e",
    "type": "switchNode",
    "name": "switch cr length",
    "xml": "<switch test='`$mdsal-ar.connection-attachment-allotted-resource_length`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1544.5280075073242,
    "y": 464.11909103393555,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "b3f98515.d5c5a8",
        "d6ec8a36.2bd5b8"
      ]
    ]
  },
  {
    "id": "b3f98515.d5c5a8",
    "type": "other",
    "name": "outcome 1",
    "xml": "<outcome value='1'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1781.8612518310547,
    "y": 442.1190414428711,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "62a3f76e.e4fe88"
      ]
    ]
  },
  {
    "id": "62a3f76e.e4fe88",
    "type": "block",
    "name": "block: atomic",
    "xml": "<block atomic='true'>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1966.3851413726807,
    "y": 439.02387523651123,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "6e5fda99.432e04",
        "e8690773.d36c78",
        "1038f8cf.80cef7"
      ]
    ]
  },
  {
    "id": "bd8a4a5f.b15a58",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"404\" />\n    <parameter name=\"error-message\" value=\"Error: SOTN resource not found\" />\n    \n",
    "comments": "",
    "x": 1890.5229835510254,
    "y": 564.0661163330078,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "f9a70dc3.a8b91",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1194.5225372314453,
    "y": 563.0661125183105,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "b344ad0a.91a46"
      ]
    ]
  },
  {
    "id": "b344ad0a.91a46",
    "type": "block",
    "name": "block: atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1374.5224876403809,
    "y": 563.732663154602,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "bd8a4a5f.b15a58"
      ]
    ]
  },
  {
    "id": "d6ec8a36.2bd5b8",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1770.1892051696777,
    "y": 479.3994016647339,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "bd8a4a5f.b15a58"
      ]
    ]
  },
  {
    "id": "6e5fda99.432e04",
    "type": "set",
    "name": "set connection-attachment-ar from get",
    "xml": "<set>\n<parameter name='connection-attachment-ar.' value='$mdsal-ar.connection-attachment-allotted-resource[0].' />\n",
    "comments": "",
    "x": 2212.448699951172,
    "y": 399.0001049041748,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "1038f8cf.80cef7",
    "type": "set",
    "name": "set oper-status",
    "xml": "<set>\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.last-action' value='`$connection-attachment-ar.allotted-resource-data.allotted-resource-operation-information.request-information.request-action`' />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.last-rpc-action' value='`$connection-attachment-ar.allotted-resource-status.rpc-action`' />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.last-svc-request-id' value='`$connection-attachment-ar.allotted-resource-data.allotted-resource-operation-information.sdnc-request-header.svc-request-id`' />\n\n",
    "comments": "",
    "x": 2145.4486961364746,
    "y": 489.4286594390869,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "e8690773.d36c78",
    "type": "switchNode",
    "name": "switch order-status",
    "xml": "<switch test='`$connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.order-status`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2156.448532104492,
    "y": 443.00010871887207,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "dba605d9.c8d678",
        "cf99e852.bd7918"
      ]
    ]
  },
  {
    "id": "dba605d9.c8d678",
    "type": "outcome",
    "name": "outcome Active",
    "xml": "<outcome value='Active'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2363.048480987549,
    "y": 433.00010871887207,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "3e13da72.3b2296"
      ]
    ]
  },
  {
    "id": "cf99e852.bd7918",
    "type": "outcome",
    "name": "outcome Other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2362.7630004882812,
    "y": 475.4286994934082,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "4eb31dcc.6c01d4"
      ]
    ]
  },
  {
    "id": "3e13da72.3b2296",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 2515.5190353393555,
    "y": 431.37575912475586,
    "z": "d62527f6.b2b018",
    "wires": [
      []
    ]
  },
  {
    "id": "4eb31dcc.6c01d4",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" \n    value=\"`'Existing connection-attachment-allotted-resource with order status of ' + $connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.order-status + '.'`\" />\n",
    "comments": "",
    "x": 2535.6708908081055,
    "y": 472.0001106262207,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "63ccda61.32fba4",
    "type": "call",
    "name": "call GENERIC-RESOURCE-API:sotn-get-saved-ar-param",
    "xml": "<call module='GENERIC-RESOURCE-API' rpc='sotn-get-saved-ar-param' mode='sync' >\n",
    "comments": "",
    "outputs": 1,
    "x": 923.3070220947266,
    "y": 624.4935898780823,
    "z": "d62527f6.b2b018",
    "wires": [
      []
    ]
  },
  {
    "id": "cea26109.7f86d",
    "type": "block",
    "name": "block: atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 620.3131866455078,
    "y": 625.4999380111694,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "63ccda61.32fba4"
      ]
    ]
  },
  {
    "id": "bce81b73.847df8",
    "type": "comment",
    "name": "GET parent-service-data from mdsal to check existence of other End point",
    "info": "",
    "comments": "",
    "x": 802.0043487548828,
    "y": 686.5316972732544,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "21b9bd8f.a14b62",
    "type": "for",
    "name": "for pidx..mdsal-psd.service-data.provided-allotted-resources.provided-allotted-resource[]",
    "xml": "<for index='pidx' start='0' end='`$mdsal-psd.service-data.provided-allotted-resources.provided-allotted-resource_length`' >\n",
    "comments": "",
    "outputs": 1,
    "x": 1692.1889038085938,
    "y": 890.0040817260742,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "89c9398c.49de28"
      ]
    ]
  },
  {
    "id": "e8b454eb.9e1b08",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1098.3308753967285,
    "y": 1022.5755424499512,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "80501bfb.9218c8"
      ]
    ]
  },
  {
    "id": "b2acf823.705798",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 1289.4582767486572,
    "y": 887.7015702500939,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "21b9bd8f.a14b62"
      ]
    ]
  },
  {
    "id": "89c9398c.49de28",
    "type": "switchNode",
    "name": "switch allotted-resource-id",
    "xml": "<switch test=\"`$mdsal-psd.service-data.provided-allotted-resources.provided-allotted-resource[$pidx].allotted-resource-id == $tmp.ar.allotted-resource-id`\">\n\n",
    "comments": "",
    "outputs": 1,
    "x": 2127.300304412842,
    "y": 890.003978729248,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "972ec383.20e0f",
        "2680ac03.9291d4"
      ]
    ]
  },
  {
    "id": "972ec383.20e0f",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2336.110652923584,
    "y": 870.4684352874756,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "98425356.d910a"
      ]
    ]
  },
  {
    "id": "85d6ef00.8beef",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 2484.871406555176,
    "y": 906.3256168365479,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "138dcf4d.bd4ef1"
      ]
    ]
  },
  {
    "id": "138dcf4d.bd4ef1",
    "type": "set",
    "name": "set tmp.pidx and ptx.consumed-ar",
    "xml": "<set>\n<parameter name='tmp.pidx' value='`$pidx`' />\n<parameter name='tmp.provided-ar.' value='`$mdsal-psd.service-data.provided-allotted-resources.provided-allotted-resource[$pidx].`' />\n<parameter name='tmp.found-in-ar' value='true' />\n<parameter name='tmp.ep-available' value='true' />",
    "comments": "",
    "x": 2719.728843688965,
    "y": 904.8971481323242,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "7ebdeb6d.5df8c4",
    "type": "comment",
    "name": "Check existence of other AR in parent service data",
    "info": "Check if other allotted resource is available.",
    "comments": "",
    "x": 725.9667510986328,
    "y": 856.8929195404053,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "2620d87.4dedf28",
    "type": "other",
    "name": "outcome 1",
    "xml": "<outcome value='1'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1108.9832229614258,
    "y": 957.6772632598877,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "b393e98a.15ddd8"
      ]
    ]
  },
  {
    "id": "80501bfb.9218c8",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"404\" />\n    <parameter name=\"error-message\" value=\"Error: SOTN resource not found\" />\n    \n",
    "comments": "",
    "x": 1270.9832191467285,
    "y": 1021.6772842407227,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "6ae9b25c.33cf1c",
    "type": "other",
    "name": "outcome 2",
    "xml": "<outcome value='2'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1114.9832973480225,
    "y": 888.6772706285119,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "b2acf823.705798"
      ]
    ]
  },
  {
    "id": "98425356.d910a",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 2465.094711303711,
    "y": 865.6771755218506,
    "z": "d62527f6.b2b018",
    "wires": [
      []
    ]
  },
  {
    "id": "2680ac03.9291d4",
    "type": "outcomeTrue",
    "name": "false",
    "xml": "<outcome value='false'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2336.0947036743164,
    "y": 904.6771793365479,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "85d6ef00.8beef"
      ]
    ]
  },
  {
    "id": "56252793.d5fad8",
    "type": "switchNode",
    "name": "switch mdsal-psd.networks_length",
    "xml": "<switch test='`$mdsal-psd.service-data.networks.network_length`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1521.3169021606445,
    "y": 960.8997602462769,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "bdb217f7.e7a8e8",
        "102cf1c2.3ac42e"
      ]
    ]
  },
  {
    "id": "102cf1c2.3ac42e",
    "type": "other",
    "name": "outcome 1",
    "xml": "<outcome value='1'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1751.3169250488281,
    "y": 936.788592338562,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "db44c65d.c93f78"
      ]
    ]
  },
  {
    "id": "bdb217f7.e7a8e8",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1745.3170471191406,
    "y": 996.788592338562,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "a21f6c28.4487e"
      ]
    ]
  },
  {
    "id": "a21f6c28.4487e",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"404\" />\n    <parameter name=\"error-message\" value=\"Error: Incorrect state found more then 1 network\" />\n    \n",
    "comments": "",
    "x": 1917.9694328308105,
    "y": 996.890398979187,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "eb439b5.f917f68",
    "type": "set",
    "name": "set tmp.network.",
    "xml": "<set>\n<parameter name='tmp.network.' value='`$mdsal-psd.service-data.networks.network[0].`' />\n",
    "comments": "",
    "x": 2119.761848449707,
    "y": 926.7887516021729,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "b393e98a.15ddd8",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 1281.427577972412,
    "y": 958.7885112762451,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "56252793.d5fad8"
      ]
    ]
  },
  {
    "id": "db44c65d.c93f78",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 1919.094596862793,
    "y": 955.788426399231,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "eb439b5.f917f68",
        "92ce46d4.1ba158"
      ]
    ]
  },
  {
    "id": "92ce46d4.1ba158",
    "type": "for",
    "name": "for nidx..tmp.network.network-data.network-request-input.network...[]",
    "xml": "<for index='nidx' start='0' end='`$tmp.network.network-data.network-request-input.network-input-parameters.param_length`' >",
    "comments": "",
    "outputs": 1,
    "x": 2295.09521484375,
    "y": 998.7884340286255,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "cce66a15.577668"
      ]
    ]
  },
  {
    "id": "cce66a15.577668",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 2618.6508750915527,
    "y": 999.7885112762451,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "2d58ddeb.e317c2",
        "9eb17449.5ea848"
      ]
    ]
  },
  {
    "id": "2d58ddeb.e317c2",
    "type": "switchNode",
    "name": "switch access-node-id",
    "xml": "<switch test=\"`$tmp.network.network-data.network-request-input.network-input-parameters.param[$nidx].name == 'access-node-id'`\">",
    "comments": "",
    "outputs": 1,
    "x": 2797.1609802246094,
    "y": 983.7989292144775,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "681bcc.070e9434"
      ]
    ]
  },
  {
    "id": "681bcc.070e9434",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2984.1609802246094,
    "y": 984.7989292144775,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "3eec1b2b.1e7894"
      ]
    ]
  },
  {
    "id": "3eec1b2b.1e7894",
    "type": "set",
    "name": "set tmp.found-in-network tmp.ep-available",
    "xml": "<set>\n<parameter name='tmp.found-in-network' value='true' />\n<parameter name='tmp.ep-available' value='true' />",
    "comments": "",
    "x": 3235.160987854004,
    "y": 984.398871421814,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "9eb17449.5ea848",
    "type": "returnSuccess",
    "name": "return success",
    "xml": "<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n",
    "comments": "",
    "x": 2780.15087890625,
    "y": 1028.7885284423828,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "9cfe2b87.83b668",
    "type": "switchNode",
    "name": "switch tmp.ep-available",
    "xml": "<switch test='`$tmp.ep-available`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 657.3167724609375,
    "y": 1161.2327842712402,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "9faf9232.f47d7",
        "2240b5b2.649bfa"
      ]
    ]
  },
  {
    "id": "2240b5b2.649bfa",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 839.9836082458496,
    "y": 1185.5661926269531,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "3895abe2.de8304"
      ]
    ]
  },
  {
    "id": "9faf9232.f47d7",
    "type": "outcomeTrue",
    "name": "false",
    "xml": "<outcome value='false'>\n",
    "comments": "",
    "outputs": 1,
    "x": 842.8723793029785,
    "y": 1124.5662908554077,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "4cc27ddf.271dc4"
      ]
    ]
  },
  {
    "id": "4cc27ddf.271dc4",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 979.8724555969238,
    "y": 1123.4551048278809,
    "z": "d62527f6.b2b018",
    "wires": [
      []
    ]
  },
  {
    "id": "3895abe2.de8304",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 1010.0946960449219,
    "y": 1183.5661506652832,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "f9711b87.160768"
      ]
    ]
  },
  {
    "id": "419bcdda.3e4604",
    "type": "comment",
    "name": "GET connection-attachment-ar to store AR data from mdsal",
    "info": "",
    "comments": "",
    "x": 2195.476852416992,
    "y": 363.50396823883057,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "1528d5ea.24f81a",
    "type": "comment",
    "name": "Set source end point",
    "info": "",
    "comments": "",
    "x": 633.9767456054688,
    "y": 593.2540636062622,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "54189702.bd6308",
    "type": "set",
    "name": "set tmp.ar.parent-service-instance-id",
    "xml": "<set>\n<parameter name='tmp.ar.parent-service-instance-id' value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.parent-service-instance-id` \" />\n\n",
    "comments": "",
    "x": 686.9728240966797,
    "y": 718.000207901001,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "4189600a.49dd7",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1064.9728202819824,
    "y": 767.0002069473267,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "cf08d28.d7b073"
      ]
    ]
  },
  {
    "id": "36a46871.776478",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1056.8246231079102,
    "y": 802.066291809082,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "b02e077c.0fb248"
      ]
    ]
  },
  {
    "id": "b02e077c.0fb248",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"404\" />\n    <parameter name=\"error-message\" value=\"Error: SOTN resource not found\" />\n    \n",
    "comments": "",
    "x": 1231.9733085632324,
    "y": 798.3336420059204,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "cf08d28.d7b073",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1215.9728202819824,
    "y": 765.0002069473267,
    "z": "d62527f6.b2b018",
    "wires": [
      []
    ]
  },
  {
    "id": "e57b213b.75c14",
    "type": "set",
    "name": "set tmp.found-in-ar tmp.found-in-network tmp.ep-available to false",
    "xml": "<set>\n<parameter name='tmp.found-in-ar' value='false' />\n<parameter name='tmp.found-in-network' value='false' />\n<parameter name='tmp.ep-available' value='false' />",
    "comments": "",
    "x": 773.9728164672852,
    "y": 892.0001811981201,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "6b963930.2fc438",
    "type": "comment",
    "name": "If other EP exists delete from domain controller",
    "info": "",
    "comments": "",
    "x": 707.9727172851562,
    "y": 1085.9999961853027,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "da18d89a.3cecf8",
    "type": "set",
    "name": "set controller data",
    "xml": "<set>\n<parameter name='prop.sdncRestApi.thirdpartySdnc.url' value=\"`$tmp.aai.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].service-url`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.user' value=\"`$tmp.aai.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].user-name`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.password' value=\"`$tmp.aai.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].password`\" />\n",
    "comments": "",
    "x": 2712.97354888916,
    "y": 1383.0004253387451,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "9eef0de5.62a8f",
    "type": "get-resource",
    "name": "get-resource esr-thirdparty-sdnc",
    "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"esr-thirdparty-sdnc\" \n\t\tkey=\"esr-thirdparty-sdnc.thirdparty-sdnc-id = $tmp.thirdparty-sdnc-id AND \n\t\t     depth = '1'\"\n        pfx='tmp.aai.esr-thirdparty-sdnc' local-only='false' >\n\n",
    "comments": "",
    "outputs": 1,
    "x": 2276.473487854004,
    "y": 1442.0004253387451,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "8d687e9a.a7cde",
        "40370761.dfc728",
        "2013be25.905fd2"
      ]
    ]
  },
  {
    "id": "8d687e9a.a7cde",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2515.473487854004,
    "y": 1395.0004253387451,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "da18d89a.3cecf8"
      ]
    ]
  },
  {
    "id": "40370761.dfc728",
    "type": "not-found",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2518.964454650879,
    "y": 1442.5744609832764,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "2d03ff62.42759"
      ]
    ]
  },
  {
    "id": "2013be25.905fd2",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2514.297462463379,
    "y": 1483.9077739715576,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "69558dbd.6b41a4"
      ]
    ]
  },
  {
    "id": "2d03ff62.42759",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying esr-thirdparty-sdnc from AnAI with thirdparty-sdnc-id = ' + $tmp.thirdparty-sdnc-id`\" />\n\n",
    "comments": "",
    "x": 2695.5358657836914,
    "y": 1430.8601970672607,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "69558dbd.6b41a4",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying esr-thirdparty-sdnc from AnAI with thirdparty-sdnc-id = ' + $tmp.thirdparty-sdnc-id`\" />\n\n",
    "comments": "",
    "x": 2702.0700187683105,
    "y": 1479.3469667434692,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "db78af3f.7da65",
    "type": "get-resource",
    "name": "get-resource pnf",
    "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"pnf\" \n\t\tkey=\"pnf.pnf-name = $tmp.node-id AND \n\t\t     depth = '0'\"\n        pfx='tmp.aai.pnf' local-only='false' >\n\n",
    "comments": "",
    "outputs": 1,
    "x": 2218.9736404418945,
    "y": 1327.0004177093506,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "61833798.39ba98",
        "528d4397.aa3cfc",
        "84c30f24.fb0a1"
      ]
    ]
  },
  {
    "id": "61833798.39ba98",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2406.9736557006836,
    "y": 1273.000410079956,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "daff7902.b1db88"
      ]
    ]
  },
  {
    "id": "528d4397.aa3cfc",
    "type": "not-found",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2412.464702606201,
    "y": 1315.574306488037,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "166586ce.0cda99"
      ]
    ]
  },
  {
    "id": "84c30f24.fb0a1",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2398.797710418701,
    "y": 1353.907642364502,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "678d82ac.ae5d6c"
      ]
    ]
  },
  {
    "id": "166586ce.0cda99",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
    "comments": "",
    "x": 2566.036003112793,
    "y": 1305.860113143921,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "678d82ac.ae5d6c",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
    "comments": "",
    "x": 2562.570182800293,
    "y": 1345.3469324111938,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "daff7902.b1db88",
    "type": "set",
    "name": "set tmp.thirdparty-sdnc-id",
    "xml": "<set>\n<parameter name='tmp.thirdparty-sdnc-id' value=\"`$tmp.aai.pnf.relationship-list.relationship[0].relationship-data[0].relationship-value`\" />\n",
    "comments": "",
    "x": 2606.9736709594727,
    "y": 1268.000410079956,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "986a1e0f.f7767",
    "type": "comment",
    "name": "get domain controller information",
    "info": "",
    "comments": "",
    "x": 2262.4775466918945,
    "y": 1296.0043849945068,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "b4baf7f7.22c558",
    "type": "execute",
    "name": "execute RestApiCallNode Delete ethernet Service",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + 'restconf/data/ietf-eth-tran-service:etht-svc/etht-svc-instances=' + $tmp.vpn-name`\" />\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"delete\"/>\n<parameter name=\"responsePrefix\" value=\"vpn-result\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.openecomp.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n<parameter name='customHttpHeaders' value=\"`'X-ACCESS-TOKEN=' + $prop.sdncRestApi.token_id`\" />",
    "comments": "",
    "outputs": 1,
    "x": 2324.97354888916,
    "y": 1547.0004253387451,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "6752ec51.7639a4",
        "d8d0a6c8.efbc18"
      ]
    ]
  },
  {
    "id": "6752ec51.7639a4",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2611.973487854004,
    "y": 1570.0004253387451,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "bd289218.c6a72"
      ]
    ]
  },
  {
    "id": "bd289218.c6a72",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "comments": "",
    "outputs": 1,
    "x": 2781.9734268188477,
    "y": 1573.0004253387451,
    "z": "d62527f6.b2b018",
    "wires": [
      []
    ]
  },
  {
    "id": "36ad783d.9e7588",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create vpn rest api\" />\n",
    "comments": "",
    "x": 2781.97354888916,
    "y": 1529.0004253387451,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "d8d0a6c8.efbc18",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2614.9734268188477,
    "y": 1529.0004253387451,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "36ad783d.9e7588"
      ]
    ]
  },
  {
    "id": "ed20569.dfb37a8",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 936.7346534729004,
    "y": 1685.9527891874313,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "91a4ed95.6c28f"
      ]
    ]
  },
  {
    "id": "91a4ed95.6c28f",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"AAI failed\" />\n",
    "comments": "",
    "x": 1103.2585334777832,
    "y": 1697.5718601942062,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "cfe4159d.c3a2a8",
    "type": "failure",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 943.8299407958984,
    "y": 1718.714756846428,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "91a4ed95.6c28f"
      ]
    ]
  },
  {
    "id": "20858e35.eb67f2",
    "type": "comment",
    "name": "Save Resource to AAI",
    "info": "",
    "comments": "",
    "x": 655.7823677062988,
    "y": 1668.3021774291992,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "f9a7c426.23e9f8",
    "type": "set",
    "name": "set output to api handler",
    "xml": "<set>\n<parameter name='allotted-resource-id' value='`$tmp.ar.allotted-resource-id`' />\n<parameter name='connection-attachment-object-path' value=\"`$tmp.ar.self-link`\"/>\n<parameter name='service-object-path' value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $connection-attachment-topology-operation-input.service-information.service-instance-id\n + '/service-data/service-topology/'`\"/>\n \n",
    "comments": "",
    "x": 670.5500640869141,
    "y": 1589.8276586532593,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "9c7fe29e.71ca7",
    "type": "returnSuccess",
    "name": "return success",
    "xml": "<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n",
    "comments": "",
    "x": 638.9631462097168,
    "y": 1750.443410873413,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "85e1d23.e838c3",
    "type": "execute",
    "name": "execute RestApiCallNode - PUT AR by id",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='templateFileName' value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.sotn-attachment.templatefile`\" />\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.ar-url`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='PUT' />\n    <parameter name=\"responsePrefix\" value=\"mdsal-ar\" />\n\n",
    "comments": "",
    "outputs": 1,
    "x": 720.2821655273438,
    "y": 1497.4684324264526,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "5434dcca.bb3a54",
        "da8aa11e.e584c",
        "4ccafd8b.f06ca4"
      ]
    ]
  },
  {
    "id": "5434dcca.bb3a54",
    "type": "not-found",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 988.9235420227051,
    "y": 1548.7998441681266,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "9056a211.e2832"
      ]
    ]
  },
  {
    "id": "da8aa11e.e584c",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 979.9235916137695,
    "y": 1517.2998699173331,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "9056a211.e2832"
      ]
    ]
  },
  {
    "id": "4ccafd8b.f06ca4",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 983.6736297607422,
    "y": 1487.6569747924805,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "7f788f83.49fac"
      ]
    ]
  },
  {
    "id": "9056a211.e2832",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating md-sal for connection-attachment-allotted-resource\" />\n",
    "comments": "",
    "x": 1149.6736297607422,
    "y": 1518.049893759191,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "7f788f83.49fac",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1125.3295974731445,
    "y": 1483.8491439819336,
    "z": "d62527f6.b2b018",
    "wires": [
      []
    ]
  },
  {
    "id": "cc614438.2bf6c8",
    "type": "set",
    "name": "set ar-data",
    "xml": "<set>\n<parameter name='connection-attachment-ar.allotted-resource-status.action' value=\"`$connection-attachment-topology-operation-input.request-information.request-action` \" />\n<parameter name='connection-attachment-ar.allotted-resource-status.rpc-name' value=\"connection-attachment-topology-operation\" />\n<parameter name='connection-attachment-ar.allotted-resource-status.rpc-action' value=\"`$connection-attachment-topology-operation-input.sdnc-request-header.svc-action` \" />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-operation-information.request-information.' value=\"`$connection-attachment-topology-operation-input.request-information.` \" />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-operation-information.sdnc-request-header.' value=\"`$connection-attachment-topology-operation-input.sdnc-request-header.` \" />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-operation-information.service-information.' value=\"`$connection-attachment-topology-operation-input.service-information.` \" />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-operation-information.allotted-resource-information.' value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.` \" />",
    "comments": "",
    "x": 620.4957847595215,
    "y": 1347.8493554592133,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "8acea442.f49688",
    "type": "execute",
    "name": "execute getTime",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='setTime' >\n    <parameter name=\"outputPath\" value=\"tmp.current-time\" />\n\n",
    "comments": "",
    "outputs": 1,
    "x": 637.7816276550293,
    "y": 1420.4689531326294,
    "z": "d62527f6.b2b018",
    "wires": [
      []
    ]
  },
  {
    "id": "3bb974a.bf8f88c",
    "type": "set",
    "name": "set allotted-resource-oper-status",
    "xml": "<set>\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.order-status' value='PendingDelete' />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.last-action' value='`$connection-attachment-topology-operation-input.request-information.request-action`' />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.last-rpc-action' value='`$connection-attachment-topology-operation-input.sdnc-request-header.svc-action`' />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.last-svc-request-id' value='`$connection-attachment-topology-operation-input.sdnc-request-header.svc-request-id`' />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.create-timestamp' value='`$tmp.current-time`' />\n",
    "comments": "",
    "x": 692.768684387207,
    "y": 1458.420090675354,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "fcc726f0.284858",
    "type": "set",
    "name": "set model-data",
    "xml": "<set>\n<parameter name='connection-attachment-ar.allotted-resource-data.connection-attachment-topology.onap-model-information.' value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.onap-model-information.` \" />",
    "comments": "",
    "x": 634.3373260498047,
    "y": 1387.0240058898926,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "3bf2097d.8aae36",
    "type": "comment",
    "name": "Prepare data for allotted-resource addition to MDSAL",
    "info": "This will add to allotted-resource which is present inside service.",
    "comments": "",
    "x": 747.6707878112793,
    "y": 1308.0239579677582,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "691601b4.cefa8",
    "type": "comment",
    "name": "Add to allotted-resources in mdsal",
    "info": "",
    "comments": "",
    "x": 689.2506141662598,
    "y": 1275.4372596740723,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "24e481f8.3828fe",
    "type": "update",
    "name": "update AAI allotted-resource",
    "xml": "<update plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"allotted-resource\" \n\t\tkey=\"customer.global-customer-id = $connection-attachment-topology-operation-input.service-information.global-customer-id AND\n\t\t\tservice-subscription.service-type = $connection-attachment-topology-operation-input.service-information.subscription-service-type AND\n\t\t\tservice-instance.service-instance-id = $connection-attachment-topology-operation-input.allotted-resource-information.parent-service-instance-id AND\n\t\t\tallotted-resource.id = $tmp.ar.allotted-resource-id\"\n        pfx='pfx' local-only='false' force='false'>\n\t<parameter name=\"description\" value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.allotted-resource-type`\" />\n\t<parameter name=\"selflink\" value=\"`$tmp.ar.self-link`\" />\n\t<parameter name=\"model-invariant-id\" value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.onap-model-information.model-invariant-uuid`\" />\n\t<parameter name=\"model-version-id\" value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.onap-model-information.model-uuid`\" />\n\t<parameter name=\"operational-status\" value=\"PendingDelete\" />\n",
    "comments": "",
    "outputs": 1,
    "x": 682.2266464233398,
    "y": 1705.7543201446533,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "ed20569.dfb37a8",
        "cfe4159d.c3a2a8"
      ]
    ]
  },
  {
    "id": "f9711b87.160768",
    "type": "get-resource",
    "name": "get-resource connectivity",
    "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"connectivity\" \n\t\tkey=\"connectivity.connectivity-id = $mdsal-psd.networks.network[0].network-id AND \n\t\t     depth = '1'\"\n        pfx='tmp.connectivity' local-only='false' >\n",
    "comments": "",
    "outputs": 1,
    "x": 1216.0044708251953,
    "y": 1183.5044260025024,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "e8dbaf78.eb766",
        "ea01d9.9d936e28"
      ]
    ]
  },
  {
    "id": "a6bb1ea.7c54ae",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 1989.1217803955078,
    "y": 1380.3445587158203,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "24cf2227.78f68e",
        "47b66e56.0c9e7",
        "db78af3f.7da65",
        "9eef0de5.62a8f",
        "b4baf7f7.22c558"
      ]
    ]
  },
  {
    "id": "cb33e4b7.456d98",
    "type": "outcome",
    "name": "vpn-binding",
    "xml": "<outcome value='vpn-binding'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1815.290298461914,
    "y": 1382.8260822296143,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "a6bb1ea.7c54ae"
      ]
    ]
  },
  {
    "id": "701688.e397b978",
    "type": "for",
    "name": "for each relationship",
    "xml": "<for silentFailure='true' index='vidx' start='0' end='`$tmp.connectivity.relationship-list.relationship_length`' >\n",
    "comments": "",
    "outputs": 1,
    "x": 1437.0042419433594,
    "y": 1381.0043087005615,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "94d63358.5b92d"
      ]
    ]
  },
  {
    "id": "94d63358.5b92d",
    "type": "switchNode",
    "name": "switch related-to",
    "xml": "<switch test='`$tmp.connectivity.relationship-list.relationship[$vidx].related-to`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1649.0042533874512,
    "y": 1382.0043087005615,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "cb33e4b7.456d98"
      ]
    ]
  },
  {
    "id": "47b66e56.0c9e7",
    "type": "set",
    "name": "set tmp.vpn-name",
    "xml": "<set>\n<parameter name='tmp.vpn-name' value=\"`$tmp.connectivity.relationship-list.relationship[$vidx].relationship-data[0].relationship-value` \" />\n",
    "comments": "",
    "x": 2222.0044479370117,
    "y": 1094.0046253204346,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "24cf2227.78f68e",
    "type": "execute",
    "name": "split vpnName to find nodeId",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='split' >\n<parameter name=\"original_string\" value='`$tmp.vpn-name`'/>\n<parameter name=\"regex\" value=\"-\"/>\n<parameter name=\"ctx_memory_result_key\" value=\"route1\"/>\n",
    "comments": "",
    "outputs": 1,
    "x": 2258.0044021606445,
    "y": 1195.0039920806885,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "dbb4b750.654218",
        "602bf50c.a7d48c"
      ]
    ]
  },
  {
    "id": "602bf50c.a7d48c",
    "type": "failure",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2459.004592895508,
    "y": 1172.003984451294,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "b0e11516.2f09e8"
      ]
    ]
  },
  {
    "id": "b0e11516.2f09e8",
    "type": "set",
    "name": "set tmp.node-id",
    "xml": "<set>\n<parameter name='tmp.node-id' value='`$route1[0]`' />\n",
    "comments": "",
    "x": 2612.004753112793,
    "y": 1170.0039854049683,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "b2b0b641.daec08",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value=\"An error occured while splitting sna1_route\" />\n",
    "comments": "",
    "x": 2596.004919052124,
    "y": 1219.003987312317,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "dbb4b750.654218",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2456.00457572937,
    "y": 1220.0039892196655,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "b2b0b641.daec08"
      ]
    ]
  },
  {
    "id": "e8dbaf78.eb766",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1397.0040702819824,
    "y": 1218.0000705718994,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "139d89be.34d1e6"
      ]
    ]
  },
  {
    "id": "ea01d9.9d936e28",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1399.855800628662,
    "y": 1145.06631565094,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "e2f93c0e.c734a"
      ]
    ]
  },
  {
    "id": "e2f93c0e.c734a",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"404\" />\n    <parameter name=\"error-message\" value=\"Error: Connectivity resource not found\" />\n    \n",
    "comments": "",
    "x": 1542.0045700073242,
    "y": 1145.3337259292603,
    "z": "d62527f6.b2b018",
    "wires": []
  },
  {
    "id": "139d89be.34d1e6",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1399.0040817260742,
    "y": 1296.0002365112305,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "701688.e397b978"
      ]
    ]
  },
  {
    "id": "adbe92fb.5a5cd",
    "type": "execute",
    "name": "generate tmp.ar-other-url-connection",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"`$prop.restapi.connection-attachment-allottedresource`\"/>\n    <parameter name=\"outputPath\" value=\"tmp.ar-url-connection\"/>\n    <parameter name=\"target\" value=\"{allotted-resource-id}\"/>\n    <parameter name=\"replacement\" value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.allotted-resource-id`\"/>\n    \n\n",
    "comments": "",
    "outputs": 1,
    "x": 699.3373794555664,
    "y": 514.000150680542,
    "z": "d62527f6.b2b018",
    "wires": [
      []
    ]
  },
  {
    "id": "cd672a69.e35f88",
    "type": "execute",
    "name": "execute RestApiCallNode - get-resource connection-attachment-allotted-resource",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.ar-url-connection`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='GET' />\n    <parameter name=\"responsePrefix\" value=\"mdsal-ar\" />\n\n",
    "comments": "",
    "outputs": 1,
    "x": 835.3378601074219,
    "y": 544.4999485015869,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "16169970.a028a7",
        "f9a70dc3.a8b91"
      ]
    ]
  },
  {
    "id": "f581f798.8d1028",
    "type": "execute",
    "name": "get parent-service-data tmp.ar-url-psd",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"/restconf/config/GENERIC-RESOURCE-API:services/service/{service-instance-id}/service-data\"/>\n    <parameter name=\"outputPath\" value=\"tmp.ar-url-psd\"/>\n    <parameter name=\"target\" value=\"{service-instance-id}\"/>\n    <parameter name=\"replacement\" value=\"`$tmp.ar.parent-service-instance-id`\"/>\n",
    "comments": "",
    "outputs": 1,
    "x": 689.0041046142578,
    "y": 753.0002098083496,
    "z": "d62527f6.b2b018",
    "wires": [
      []
    ]
  },
  {
    "id": "bce70d29.d57a8",
    "type": "execute",
    "name": "execute RestApiCallNode - get-resource parent service data",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.ar-url-psd`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='GET' />\n    <parameter name=\"responsePrefix\" value=\"mdsal-psd\" />\n\n",
    "comments": "",
    "outputs": 1,
    "x": 756.0040664672852,
    "y": 788.0002937316895,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "4189600a.49dd7",
        "36a46871.776478"
      ]
    ]
  },
  {
    "id": "e94c0bb9.6dcf28",
    "type": "switchNode",
    "name": "switch mdsal-psd.service-data.provided-allotted-resources_length",
    "xml": "<switch test='`$mdsal-psd.service-data.provided-allotted-resources.provided-allotted-resource_length`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 772.1881866455078,
    "y": 962.7181215286255,
    "z": "d62527f6.b2b018",
    "wires": [
      [
        "e8b454eb.9e1b08",
        "2620d87.4dedf28",
        "6ae9b25c.33cf1c"
      ]
    ]
  }
]
