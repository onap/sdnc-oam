[
  {
    "id": "b54f27ef.5db9a8",
    "type": "dgstart",
    "name": "DGSTART",
    "outputs": 1,
    "x": 76.00390625,
    "y": 37.00390625,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "73825793.639008"
      ]
    ]
  },
  {
    "id": "73825793.639008",
    "type": "service-logic",
    "name": "GENERIC-RESOURCE-API ${project.version}",
    "module": "GENERIC-RESOURCE-API",
    "version": "${project.version}",
    "comments": "",
    "xml": "<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>",
    "outputs": 1,
    "x": 288.00391006469727,
    "y": 109.0039234161377,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "91a3b40f.a091b8"
      ]
    ]
  },
  {
    "id": "91a3b40f.a091b8",
    "type": "method",
    "name": "sotn-attachment-topology-operation-deactivate",
    "xml": "<method rpc='sotn-attachment-topology-operation-deactivate' mode='sync'>\n",
    "comments": "",
    "outputs": 1,
    "x": 276.0040283203125,
    "y": 197.00390625,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "8b49cdb4.0b003"
      ]
    ]
  },
  {
    "id": "8b49cdb4.0b003",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 292.0040283203125,
    "y": 752.0041508674622,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "c083b508.69c318",
        "520006f2.b2e4d8",
        "70bf29a.577bcd8",
        "648ef4ed.e1062c",
        "8e15ef85.af876",
        "7cd467cc.f359b8",
        "4ca01b12.aeeae4",
        "6963b7ed.1ac188",
        "2a2a1345.d7f2ec",
        "5c89f183.d2653",
        "f1e26abf.1dc9f8",
        "25f9e140.e4210e",
        "1507ea99.aa8315",
        "3a95a888.e92908",
        "dd09565b.b81778",
        "60ba1f59.42707",
        "bf1b5f9f.275aa",
        "ff509458.45f008",
        "980e2d4b.7e472",
        "372ff043.61187"
      ]
    ]
  },
  {
    "id": "c083b508.69c318",
    "type": "set",
    "name": "set tmp.ar.allotted-resource-id,etc",
    "xml": "<set>\n<parameter name='tmp.ar.allotted-resource-id' value='`$connection-attachment-topology-operation-input.allotted-resource-information.allotted-resource-id`' />\n<parameter name='tmp.ar.parent-service-instance-id' value='`$connection-attachment-topology-operation-input.allotted-resource-information.parent-service-instance-id`' />\n\n\n",
    "comments": "",
    "x": 688.9974670410156,
    "y": 150.9973931312561,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "8cf7665f.0ad548",
    "type": "comment",
    "name": "set tmp ar-id to fetch resource from MDSAL",
    "info": "",
    "comments": "",
    "x": 717.9577789306641,
    "y": 115.02918910980225,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "520006f2.b2e4d8",
    "type": "set",
    "name": "set tmp.ar.self-link",
    "xml": "<set>\n<parameter name='tmp.ar.self-link' value=\"`'restconf/config/GENERIC-RESOURCE-API:connection-attachment-allotted-resources/connection-attachment-allotted-resource/'\n + $tmp.ar.allotted-resource-id\n + '/allotted-resource-data/connection-attachment-topology/'` \" />\n\n",
    "comments": "",
    "x": 642.9974060058594,
    "y": 243.99739837646484,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "8e15ef85.af876",
    "type": "execute",
    "name": "execute Properties",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.prop.PropertiesNode' method='readProperties' >\n    <parameter name='fileName' value='%SDNC_CONFIG_DIR%/generic-resource-api-dg.properties' />\n    <parameter name='contextPrefix' value='prop' />\n",
    "comments": "",
    "outputs": 1,
    "x": 649.2592964172363,
    "y": 331.6641273498535,
    "z": "4ec136ff.390af8",
    "wires": [
      []
    ]
  },
  {
    "id": "70bf29a.577bcd8",
    "type": "execute",
    "name": "generate allotted-resource tmp.ar-url",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"`$prop.restapi.connection-attachment-allottedresource`\"/>\n    <parameter name=\"outputPath\" value=\"tmp.ar-url\"/>\n    <parameter name=\"target\" value=\"{allotted-resource-id}\"/>\n    <parameter name=\"replacement\" value=\"`$tmp.ar.allotted-resource-id`\"/>\n",
    "comments": "",
    "outputs": 1,
    "x": 699.2593994140625,
    "y": 418.66412830352783,
    "z": "4ec136ff.390af8",
    "wires": [
      []
    ]
  },
  {
    "id": "f4f0e304.bbd67",
    "type": "comment",
    "name": "GET connection-attachment-allotted-resource from mdsal",
    "info": "",
    "comments": "",
    "x": 742.8123931884766,
    "y": 489.54267501831055,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "3183ed7f.7cdf82",
    "type": "comment",
    "name": "Used for setting output to API Handler",
    "info": "",
    "comments": "",
    "x": 696.9974365234375,
    "y": 210.997407913208,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "61fa78e8.e88928",
    "type": "comment",
    "name": "Obtain different URL, template location etc",
    "info": "For saving resource information to MDSAL & for AAI",
    "comments": "",
    "x": 714.9974021911621,
    "y": 296.8862886428833,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "e460b896.d8ce98",
    "type": "comment",
    "name": "Used to Get AR by id to MDSAL, same as self-link",
    "info": "",
    "comments": "",
    "x": 740.9974212646484,
    "y": 383.8862476348877,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "f65756e0.dd7818",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1183.6707344055176,
    "y": 537.0039348602295,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "4dc0f774.40c9e8"
      ]
    ]
  },
  {
    "id": "4dc0f774.40c9e8",
    "type": "block",
    "name": "block: atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1352.6707382202148,
    "y": 535.5038356781006,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "a07cda93.450c08"
      ]
    ]
  },
  {
    "id": "a07cda93.450c08",
    "type": "switchNode",
    "name": "switch cr length",
    "xml": "<switch test='`$mdsal-ar.connection-attachment-allotted-resource_length`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1525.5280075073242,
    "y": 473.12299823760986,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "22ec9ce0.2f5dd4",
        "f2f6c092.18725"
      ]
    ]
  },
  {
    "id": "22ec9ce0.2f5dd4",
    "type": "other",
    "name": "outcome 1",
    "xml": "<outcome value='1'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1762.8612518310547,
    "y": 451.1229486465454,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "9d16e841.df5298"
      ]
    ]
  },
  {
    "id": "9d16e841.df5298",
    "type": "block",
    "name": "block: atomic",
    "xml": "<block atomic='true'>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1947.3851413726807,
    "y": 448.02778244018555,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "3e7b6049.99c1f",
        "76484c5f.5d8d34",
        "659367d9.de17c8"
      ]
    ]
  },
  {
    "id": "15003538.c9037b",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"404\" />\n    <parameter name=\"error-message\" value=\"Error: SOTN resource not found\" />\n    \n",
    "comments": "",
    "x": 1871.5229835510254,
    "y": 573.0700235366821,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "1584b53e.263d2b",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1175.5225372314453,
    "y": 572.0700197219849,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "cfb38062.240c9"
      ]
    ]
  },
  {
    "id": "cfb38062.240c9",
    "type": "block",
    "name": "block: atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1355.5224876403809,
    "y": 572.7365703582764,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "15003538.c9037b"
      ]
    ]
  },
  {
    "id": "f2f6c092.18725",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1751.1892051696777,
    "y": 488.4033088684082,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "15003538.c9037b"
      ]
    ]
  },
  {
    "id": "3e7b6049.99c1f",
    "type": "set",
    "name": "set connection-attachment-ar from get",
    "xml": "<set>\n<parameter name='connection-attachment-ar.' value='$mdsal-ar.connection-attachment-allotted-resource[0].' />\n",
    "comments": "",
    "x": 2193.448699951172,
    "y": 408.0040121078491,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "659367d9.de17c8",
    "type": "set",
    "name": "set oper-status",
    "xml": "<set>\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.last-action' value='`$connection-attachment-ar.allotted-resource-data.allotted-resource-operation-information.request-information.request-action`' />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.last-rpc-action' value='`$connection-attachment-ar.allotted-resource-status.rpc-action`' />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.last-svc-request-id' value='`$connection-attachment-ar.allotted-resource-data.allotted-resource-operation-information.sdnc-request-header.svc-request-id`' />\n\n",
    "comments": "",
    "x": 2126.4486961364746,
    "y": 498.43256664276123,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "76484c5f.5d8d34",
    "type": "switchNode",
    "name": "switch order-status",
    "xml": "<switch test='`$connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.order-status`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2137.448532104492,
    "y": 452.0040159225464,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "731472d3.90aa5c",
        "76bb9af5.092564"
      ]
    ]
  },
  {
    "id": "731472d3.90aa5c",
    "type": "outcome",
    "name": "outcome Active",
    "xml": "<outcome value='Active'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2344.048480987549,
    "y": 442.0040159225464,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "e2186fc5.ee965"
      ]
    ]
  },
  {
    "id": "76bb9af5.092564",
    "type": "outcome",
    "name": "outcome Other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2343.7630004882812,
    "y": 484.4326066970825,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "c14114c.2df93e8"
      ]
    ]
  },
  {
    "id": "e2186fc5.ee965",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 2496.5190353393555,
    "y": 440.3796663284302,
    "z": "4ec136ff.390af8",
    "wires": [
      []
    ]
  },
  {
    "id": "c14114c.2df93e8",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" \n    value=\"`'Existing connection-attachment-allotted-resource with order status of ' + $connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.order-status + '.'`\" />\n",
    "comments": "",
    "x": 2516.6708908081055,
    "y": 481.004017829895,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "71b7df96.cf2fe",
    "type": "call",
    "name": "call GENERIC-RESOURCE-API:sotn-get-saved-ar-param",
    "xml": "<call module='GENERIC-RESOURCE-API' rpc='sotn-get-saved-ar-param' mode='sync' >\n",
    "comments": "",
    "outputs": 1,
    "x": 904.3070220947266,
    "y": 633.4974970817566,
    "z": "4ec136ff.390af8",
    "wires": [
      []
    ]
  },
  {
    "id": "7cd467cc.f359b8",
    "type": "block",
    "name": "block: atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 601.3131866455078,
    "y": 634.5038452148438,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "71b7df96.cf2fe"
      ]
    ]
  },
  {
    "id": "e0dac461.755818",
    "type": "comment",
    "name": "GET parent-service-data from mdsal to check existence of other End point",
    "info": "",
    "comments": "",
    "x": 783.0043487548828,
    "y": 695.5356044769287,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "6358d403.359d6c",
    "type": "for",
    "name": "for pidx..mdsal-psd.service-data.provided-allotted-resources.provided-allotted-resource[]",
    "xml": "<for index='pidx' start='0' end='`$mdsal-psd.service-data.provided-allotted-resources.provided-allotted-resource_length`' >\n",
    "comments": "",
    "outputs": 1,
    "x": 1673.1889038085938,
    "y": 899.0079889297485,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "48ab36b2.10b5c8"
      ]
    ]
  },
  {
    "id": "e3f9ceb3.fcc12",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1079.3308753967285,
    "y": 1031.5794496536255,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "6bf2a454.b0478c"
      ]
    ]
  },
  {
    "id": "879c81fc.e34a9",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 1270.4582767486572,
    "y": 896.7054774537683,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "6358d403.359d6c"
      ]
    ]
  },
  {
    "id": "48ab36b2.10b5c8",
    "type": "switchNode",
    "name": "switch allotted-resource-id",
    "xml": "<switch test=\"`$mdsal-psd.service-data.provided-allotted-resources.provided-allotted-resource[$pidx].allotted-resource-id == $tmp.ar.allotted-resource-id`\">\n\n",
    "comments": "",
    "outputs": 1,
    "x": 2108.300304412842,
    "y": 899.0078859329224,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "ca0f68e.fe64c98",
        "9210d9d0.b73bc8"
      ]
    ]
  },
  {
    "id": "ca0f68e.fe64c98",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2317.110652923584,
    "y": 879.4723424911499,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "bd0a6759.014208"
      ]
    ]
  },
  {
    "id": "5b20e51b.570d9c",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 2465.871406555176,
    "y": 915.3295240402222,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "6fdc71ce.76ec1"
      ]
    ]
  },
  {
    "id": "6fdc71ce.76ec1",
    "type": "set",
    "name": "set tmp.pidx and ptx.consumed-ar",
    "xml": "<set>\n<parameter name='tmp.pidx' value='`$pidx`' />\n<parameter name='tmp.provided-ar.' value='`$mdsal-psd.service-data.provided-allotted-resources.provided-allotted-resource[$pidx].`' />\n<parameter name='tmp.found-in-ar' value='true' />\n<parameter name='tmp.ep-available' value='true' />",
    "comments": "",
    "x": 2700.728843688965,
    "y": 913.9010553359985,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "645720a8.c9b45",
    "type": "comment",
    "name": "Check existence of other AR in parent service data",
    "info": "Check if other allotted resource is available.",
    "comments": "",
    "x": 706.9667510986328,
    "y": 865.8968267440796,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "a518915c.e4ec5",
    "type": "other",
    "name": "outcome 1",
    "xml": "<outcome value='1'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1089.9832229614258,
    "y": 966.681170463562,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "613ca19d.9a54f"
      ]
    ]
  },
  {
    "id": "6bf2a454.b0478c",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"404\" />\n    <parameter name=\"error-message\" value=\"Error: SOTN resource not found\" />\n    \n",
    "comments": "",
    "x": 1251.9832191467285,
    "y": 1030.681191444397,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "525b4334.32e11c",
    "type": "other",
    "name": "outcome 2",
    "xml": "<outcome value='2'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1095.9832973480225,
    "y": 897.6811778321862,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "879c81fc.e34a9"
      ]
    ]
  },
  {
    "id": "bd0a6759.014208",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 2446.094711303711,
    "y": 874.6810827255249,
    "z": "4ec136ff.390af8",
    "wires": [
      []
    ]
  },
  {
    "id": "9210d9d0.b73bc8",
    "type": "outcomeTrue",
    "name": "false",
    "xml": "<outcome value='false'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2317.0947036743164,
    "y": 913.6810865402222,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "5b20e51b.570d9c"
      ]
    ]
  },
  {
    "id": "1306b994.c05466",
    "type": "switchNode",
    "name": "switch mdsal-psd.networks_length",
    "xml": "<switch test='`$mdsal-psd.service-data.networks.network_length`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1502.3169021606445,
    "y": 969.9036674499512,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "bcbc6710.4989d8",
        "4a1544ae.b670bc"
      ]
    ]
  },
  {
    "id": "4a1544ae.b670bc",
    "type": "other",
    "name": "outcome 1",
    "xml": "<outcome value='1'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1732.3169250488281,
    "y": 945.7924995422363,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "dd72a26.9ccfe6"
      ]
    ]
  },
  {
    "id": "bcbc6710.4989d8",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1726.3170471191406,
    "y": 1005.7924995422363,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "a79d34a4.7a5eb8"
      ]
    ]
  },
  {
    "id": "a79d34a4.7a5eb8",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"404\" />\n    <parameter name=\"error-message\" value=\"Error: Incorrect state found more then 1 network\" />\n    \n",
    "comments": "",
    "x": 1898.9694328308105,
    "y": 1005.8943061828613,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "4762bac5.0337d4",
    "type": "set",
    "name": "set tmp.network.",
    "xml": "<set>\n<parameter name='tmp.network.' value='`$mdsal-psd.service-data.networks.network[0].`' />\n",
    "comments": "",
    "x": 2100.761848449707,
    "y": 935.7926588058472,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "613ca19d.9a54f",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 1262.427577972412,
    "y": 967.7924184799194,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "1306b994.c05466"
      ]
    ]
  },
  {
    "id": "dd72a26.9ccfe6",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 1900.094596862793,
    "y": 964.7923336029053,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "4762bac5.0337d4",
        "da4b8e5c.bc1b9"
      ]
    ]
  },
  {
    "id": "da4b8e5c.bc1b9",
    "type": "for",
    "name": "for nidx..tmp.network.network-data.network-request-input.network...[]",
    "xml": "<for index='nidx' start='0' end='`$tmp.network.network-data.network-request-input.network-input-parameters.param_length`' >",
    "comments": "",
    "outputs": 1,
    "x": 2276.09521484375,
    "y": 1007.7923412322998,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "ff7a40b2.21a91"
      ]
    ]
  },
  {
    "id": "ff7a40b2.21a91",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 2599.6508750915527,
    "y": 1008.7924184799194,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "ffa1f84e.980b68",
        "b00db02b.eb8b6"
      ]
    ]
  },
  {
    "id": "ffa1f84e.980b68",
    "type": "switchNode",
    "name": "switch access-node-id",
    "xml": "<switch test=\"`$tmp.network.network-data.network-request-input.network-input-parameters.param[$nidx].name == 'access-node-id'`\">",
    "comments": "",
    "outputs": 1,
    "x": 2778.1609802246094,
    "y": 992.8028364181519,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "3081e79b.edd628"
      ]
    ]
  },
  {
    "id": "3081e79b.edd628",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2965.1609802246094,
    "y": 993.8028364181519,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "d1012448.dbd488"
      ]
    ]
  },
  {
    "id": "d1012448.dbd488",
    "type": "set",
    "name": "set tmp.found-in-network tmp.ep-available",
    "xml": "<set>\n<parameter name='tmp.found-in-network' value='true' />\n<parameter name='tmp.ep-available' value='true' />",
    "comments": "",
    "x": 3216.160987854004,
    "y": 993.4027786254883,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "b00db02b.eb8b6",
    "type": "returnSuccess",
    "name": "return success",
    "xml": "<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n",
    "comments": "",
    "x": 2761.15087890625,
    "y": 1037.7924356460571,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "648ef4ed.e1062c",
    "type": "switchNode",
    "name": "switch tmp.ep-available",
    "xml": "<switch test='`$tmp.ep-available`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 638.3167724609375,
    "y": 1170.2366914749146,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "59ee447d.77e34c",
        "88dd47.020332b8"
      ]
    ]
  },
  {
    "id": "88dd47.020332b8",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 820.9836082458496,
    "y": 1194.5700998306274,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "f03a557c.a1bc78"
      ]
    ]
  },
  {
    "id": "59ee447d.77e34c",
    "type": "outcomeTrue",
    "name": "false",
    "xml": "<outcome value='false'>\n",
    "comments": "",
    "outputs": 1,
    "x": 823.8723793029785,
    "y": 1133.570198059082,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "5a5c3a3.170aec4"
      ]
    ]
  },
  {
    "id": "5a5c3a3.170aec4",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 960.8724555969238,
    "y": 1132.4590120315552,
    "z": "4ec136ff.390af8",
    "wires": [
      []
    ]
  },
  {
    "id": "f03a557c.a1bc78",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 991.0946960449219,
    "y": 1192.5700578689575,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "7df4dec5.12529"
      ]
    ]
  },
  {
    "id": "530d26e7.1066c8",
    "type": "comment",
    "name": "GET connection-attachment-ar to store AR data from mdsal",
    "info": "",
    "comments": "",
    "x": 2176.476852416992,
    "y": 372.5078754425049,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "96d6938d.7bded",
    "type": "comment",
    "name": "Set source end point",
    "info": "",
    "comments": "",
    "x": 614.9767456054688,
    "y": 602.2579708099365,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "4ca01b12.aeeae4",
    "type": "set",
    "name": "set tmp.ar.parent-service-instance-id",
    "xml": "<set>\n<parameter name='tmp.ar.parent-service-instance-id' value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.parent-service-instance-id` \" />\n\n",
    "comments": "",
    "x": 667.9728240966797,
    "y": 727.0041151046753,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "13901d91.bcbec2",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1045.9728202819824,
    "y": 776.004114151001,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "1def54f0.081ddb"
      ]
    ]
  },
  {
    "id": "eada0637.1dd9c8",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1037.8246231079102,
    "y": 811.0701990127563,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "7eae3ac9.be18e4"
      ]
    ]
  },
  {
    "id": "7eae3ac9.be18e4",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"404\" />\n    <parameter name=\"error-message\" value=\"Error: SOTN resource not found\" />\n    \n",
    "comments": "",
    "x": 1212.9733085632324,
    "y": 807.3375492095947,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "1def54f0.081ddb",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1196.9728202819824,
    "y": 774.004114151001,
    "z": "4ec136ff.390af8",
    "wires": [
      []
    ]
  },
  {
    "id": "6963b7ed.1ac188",
    "type": "set",
    "name": "set tmp.found-in-ar tmp.found-in-network tmp.ep-available to false",
    "xml": "<set>\n<parameter name='tmp.found-in-ar' value='false' />\n<parameter name='tmp.found-in-network' value='false' />\n<parameter name='tmp.ep-available' value='false' />",
    "comments": "",
    "x": 754.9728164672852,
    "y": 901.0040884017944,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "e7dc10be.4a762",
    "type": "comment",
    "name": "If other EP exists delete from domain controller",
    "info": "",
    "comments": "",
    "x": 688.9727172851562,
    "y": 1095.003903388977,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "3c03726e.58d62e",
    "type": "set",
    "name": "set controller data",
    "xml": "<set>\n<parameter name='prop.sdncRestApi.thirdpartySdnc.url' value=\"`$tmp.aai.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].service-url`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.user' value=\"`$tmp.aai.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].user-name`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.password' value=\"`$tmp.aai.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].password`\" />\n",
    "comments": "",
    "x": 2693.97354888916,
    "y": 1392.0043325424194,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "b649f241.fe659",
    "type": "get-resource",
    "name": "get-resource esr-thirdparty-sdnc",
    "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"esr-thirdparty-sdnc\" \n\t\tkey=\"esr-thirdparty-sdnc.thirdparty-sdnc-id = $tmp.thirdparty-sdnc-id AND \n\t\t     depth = '1'\"\n        pfx='tmp.aai.esr-thirdparty-sdnc' local-only='false' >\n\n",
    "comments": "",
    "outputs": 1,
    "x": 2257.473487854004,
    "y": 1451.0043325424194,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "4eb1e7d1.a91458",
        "8b33a960.d74f98",
        "58a39417.8a89cc"
      ]
    ]
  },
  {
    "id": "4eb1e7d1.a91458",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2496.473487854004,
    "y": 1404.0043325424194,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "3c03726e.58d62e"
      ]
    ]
  },
  {
    "id": "8b33a960.d74f98",
    "type": "not-found",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2499.964454650879,
    "y": 1451.5783681869507,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "d1891615.f0fe68"
      ]
    ]
  },
  {
    "id": "58a39417.8a89cc",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2495.297462463379,
    "y": 1492.911681175232,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "9094de14.94959"
      ]
    ]
  },
  {
    "id": "d1891615.f0fe68",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying esr-thirdparty-sdnc from AnAI with thirdparty-sdnc-id = ' + $tmp.thirdparty-sdnc-id`\" />\n\n",
    "comments": "",
    "x": 2676.5358657836914,
    "y": 1439.864104270935,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "9094de14.94959",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying esr-thirdparty-sdnc from AnAI with thirdparty-sdnc-id = ' + $tmp.thirdparty-sdnc-id`\" />\n\n",
    "comments": "",
    "x": 2683.0700187683105,
    "y": 1488.3508739471436,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "de59b3c5.550e5",
    "type": "get-resource",
    "name": "get-resource pnf",
    "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"pnf\" \n\t\tkey=\"network-resource.network-id = $mdsal-psd.service-data.networks.network[0].network-id \n\t\tAND pnf.pnf-name = $tmp.node-id \n\t\tAND depth = '0'\"\n        pfx='tmp.aai.pnf' local-only='false' >\n\n\n\n",
    "comments": "",
    "outputs": 1,
    "x": 2199.9736404418945,
    "y": 1336.004324913025,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "e39bc756.013308",
        "2a9857ce.2f6878",
        "1952da4b.fcde26"
      ]
    ]
  },
  {
    "id": "e39bc756.013308",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2387.9736557006836,
    "y": 1282.0043172836304,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "21d4c191.6f41ee"
      ]
    ]
  },
  {
    "id": "2a9857ce.2f6878",
    "type": "not-found",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2393.464702606201,
    "y": 1324.5782136917114,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "7c6a4960.24dda8"
      ]
    ]
  },
  {
    "id": "1952da4b.fcde26",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2379.797710418701,
    "y": 1362.9115495681763,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "6c19b1e1.1bbdd"
      ]
    ]
  },
  {
    "id": "7c6a4960.24dda8",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
    "comments": "",
    "x": 2547.036003112793,
    "y": 1314.8640203475952,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "6c19b1e1.1bbdd",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
    "comments": "",
    "x": 2543.570182800293,
    "y": 1354.3508396148682,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "21d4c191.6f41ee",
    "type": "set",
    "name": "set tmp.thirdparty-sdnc-id",
    "xml": "<set>\n<parameter name='tmp.thirdparty-sdnc-id' value=\"`$tmp.aai.pnf.relationship-list.relationship[0].relationship-data[0].relationship-value`\" />\n",
    "comments": "",
    "x": 2587.9736709594727,
    "y": 1277.0043172836304,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "4f8efcb5.a9cf14",
    "type": "comment",
    "name": "get domain controller information",
    "info": "",
    "comments": "",
    "x": 2243.4775466918945,
    "y": 1305.0082921981812,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "35e0c434.3e437c",
    "type": "execute",
    "name": "execute RestApiCallNode Delete ethernet Service",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + 'restconf/data/ietf-eth-tran-service:etht-svc/etht-svc-instances=' + $tmp.vpn-name`\" />\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"delete\"/>\n<parameter name=\"responsePrefix\" value=\"vpn-result\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.openecomp.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n<parameter name='customHttpHeaders' value=\"`'X-ACCESS-TOKEN=' + $prop.sdncRestApi.token_id`\" />",
    "comments": "",
    "outputs": 1,
    "x": 2305.97354888916,
    "y": 1556.0043325424194,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "c3b6b741.e17f38",
        "dfd52870.a619b8"
      ]
    ]
  },
  {
    "id": "c3b6b741.e17f38",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2592.973487854004,
    "y": 1579.0043325424194,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "1373f104.3035cf"
      ]
    ]
  },
  {
    "id": "1373f104.3035cf",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "comments": "",
    "outputs": 1,
    "x": 2762.9734268188477,
    "y": 1582.0043325424194,
    "z": "4ec136ff.390af8",
    "wires": [
      []
    ]
  },
  {
    "id": "98709530.f9e578",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create vpn rest api\" />\n",
    "comments": "",
    "x": 2762.97354888916,
    "y": 1538.0043325424194,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "dfd52870.a619b8",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2595.9734268188477,
    "y": 1538.0043325424194,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "98709530.f9e578"
      ]
    ]
  },
  {
    "id": "a09d44d6.036498",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 917.7346534729004,
    "y": 1694.9566963911057,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "8338cff1.c1a26"
      ]
    ]
  },
  {
    "id": "8338cff1.c1a26",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"AAI failed\" />\n",
    "comments": "",
    "x": 1084.2585334777832,
    "y": 1706.5757673978806,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "9111ff4f.4282f",
    "type": "failure",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 924.8299407958984,
    "y": 1727.7186640501022,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "8338cff1.c1a26"
      ]
    ]
  },
  {
    "id": "e911009.f267e",
    "type": "comment",
    "name": "Save Resource to AAI",
    "info": "",
    "comments": "",
    "x": 636.7823677062988,
    "y": 1677.3060846328735,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "3a95a888.e92908",
    "type": "set",
    "name": "set output to api handler",
    "xml": "<set>\n<parameter name='allotted-resource-id' value='`$tmp.ar.allotted-resource-id`' />\n<parameter name='connection-attachment-object-path' value=\"`$tmp.ar.self-link`\"/>\n<parameter name='service-object-path' value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $connection-attachment-topology-operation-input.service-information.service-instance-id\n + '/service-data/service-topology/'`\"/>\n \n",
    "comments": "",
    "x": 651.5500640869141,
    "y": 1598.8315658569336,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "dd09565b.b81778",
    "type": "returnSuccess",
    "name": "return success",
    "xml": "<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n",
    "comments": "",
    "x": 619.9631462097168,
    "y": 1759.4473180770874,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "1507ea99.aa8315",
    "type": "execute",
    "name": "execute RestApiCallNode - PUT AR by id",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='templateFileName' value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.sotn-attachment.templatefile`\" />\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.ar-url`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='PUT' />\n    <parameter name=\"responsePrefix\" value=\"mdsal-ar\" />\n\n",
    "comments": "",
    "outputs": 1,
    "x": 701.2821655273438,
    "y": 1506.472339630127,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "36bc9007.e2fa4",
        "65e8ae51.bc0a7",
        "822d49a0.d686d8"
      ]
    ]
  },
  {
    "id": "36bc9007.e2fa4",
    "type": "not-found",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 969.9235420227051,
    "y": 1557.803751371801,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "4b0971a1.d1673"
      ]
    ]
  },
  {
    "id": "65e8ae51.bc0a7",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 960.9235916137695,
    "y": 1526.3037771210074,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "4b0971a1.d1673"
      ]
    ]
  },
  {
    "id": "822d49a0.d686d8",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 964.6736297607422,
    "y": 1496.6608819961548,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "d0da3bc8.9e8958"
      ]
    ]
  },
  {
    "id": "4b0971a1.d1673",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating md-sal for connection-attachment-allotted-resource\" />\n",
    "comments": "",
    "x": 1130.6736297607422,
    "y": 1527.0538009628654,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "d0da3bc8.9e8958",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1106.3295974731445,
    "y": 1492.853051185608,
    "z": "4ec136ff.390af8",
    "wires": [
      []
    ]
  },
  {
    "id": "2a2a1345.d7f2ec",
    "type": "set",
    "name": "set ar-data",
    "xml": "<set>\n<parameter name='connection-attachment-ar.allotted-resource-status.action' value=\"`$connection-attachment-topology-operation-input.request-information.request-action` \" />\n<parameter name='connection-attachment-ar.allotted-resource-status.rpc-name' value=\"connection-attachment-topology-operation\" />\n<parameter name='connection-attachment-ar.allotted-resource-status.rpc-action' value=\"`$connection-attachment-topology-operation-input.sdnc-request-header.svc-action` \" />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-operation-information.request-information.' value=\"`$connection-attachment-topology-operation-input.request-information.` \" />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-operation-information.sdnc-request-header.' value=\"`$connection-attachment-topology-operation-input.sdnc-request-header.` \" />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-operation-information.service-information.' value=\"`$connection-attachment-topology-operation-input.service-information.` \" />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-operation-information.allotted-resource-information.' value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.` \" />",
    "comments": "",
    "x": 601.4957847595215,
    "y": 1356.8532626628876,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "f1e26abf.1dc9f8",
    "type": "execute",
    "name": "execute getTime",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='setTime' >\n    <parameter name=\"outputPath\" value=\"tmp.current-time\" />\n\n",
    "comments": "",
    "outputs": 1,
    "x": 618.7816276550293,
    "y": 1429.4728603363037,
    "z": "4ec136ff.390af8",
    "wires": [
      []
    ]
  },
  {
    "id": "25f9e140.e4210e",
    "type": "set",
    "name": "set allotted-resource-oper-status",
    "xml": "<set>\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.order-status' value='PendingDelete' />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.last-action' value='`$connection-attachment-topology-operation-input.request-information.request-action`' />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.last-rpc-action' value='`$connection-attachment-topology-operation-input.sdnc-request-header.svc-action`' />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.last-svc-request-id' value='`$connection-attachment-topology-operation-input.sdnc-request-header.svc-request-id`' />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.create-timestamp' value='`$tmp.current-time`' />\n",
    "comments": "",
    "x": 673.768684387207,
    "y": 1467.4239978790283,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "5c89f183.d2653",
    "type": "set",
    "name": "set model-data",
    "xml": "<set>\n<parameter name='connection-attachment-ar.allotted-resource-data.connection-attachment-topology.onap-model-information.' value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.onap-model-information.` \" />",
    "comments": "",
    "x": 615.3373260498047,
    "y": 1396.027913093567,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "b42e02fb.93ce4",
    "type": "comment",
    "name": "Prepare data for allotted-resource addition to MDSAL",
    "info": "This will add to allotted-resource which is present inside service.",
    "comments": "",
    "x": 728.6707878112793,
    "y": 1317.0278651714325,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "3f84c752.6766f8",
    "type": "comment",
    "name": "Add to allotted-resources in mdsal",
    "info": "",
    "comments": "",
    "x": 670.2506141662598,
    "y": 1284.4411668777466,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "60ba1f59.42707",
    "type": "update",
    "name": "update AAI allotted-resource",
    "xml": "<update plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"allotted-resource\" \n\t\tkey=\"customer.global-customer-id = $connection-attachment-topology-operation-input.service-information.global-customer-id AND\n\t\t\tservice-subscription.service-type = $connection-attachment-topology-operation-input.service-information.subscription-service-type AND\n\t\t\tservice-instance.service-instance-id = $connection-attachment-topology-operation-input.allotted-resource-information.parent-service-instance-id AND\n\t\t\tallotted-resource.id = $tmp.ar.allotted-resource-id\"\n        pfx='pfx' local-only='false' force='false'>\n\t<parameter name=\"description\" value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.allotted-resource-type`\" />\n\t<parameter name=\"selflink\" value=\"`$tmp.ar.self-link`\" />\n\t<parameter name=\"model-invariant-id\" value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.onap-model-information.model-invariant-uuid`\" />\n\t<parameter name=\"model-version-id\" value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.onap-model-information.model-uuid`\" />\n\t<parameter name=\"operational-status\" value=\"PendingDelete\" />\n",
    "comments": "",
    "outputs": 1,
    "x": 663.2266464233398,
    "y": 1714.7582273483276,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "a09d44d6.036498",
        "9111ff4f.4282f"
      ]
    ]
  },
  {
    "id": "7df4dec5.12529",
    "type": "get-resource",
    "name": "get-resource connectivity",
    "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"connectivity\" \n\t\tkey=\"connectivity.connectivity-id = $mdsal-psd.networks.network[0].network-id AND \n\t\t     depth = '1'\"\n        pfx='tmp.connectivity' local-only='false' >\n",
    "comments": "",
    "outputs": 1,
    "x": 1197.0044708251953,
    "y": 1192.5083332061768,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "c873d73.0af9728",
        "1fd3fb2b.7cf7a5"
      ]
    ]
  },
  {
    "id": "482867b5.2cc388",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 1970.1217803955078,
    "y": 1389.3484659194946,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "6613cefb.76171",
        "6eb3502d.b2e8f",
        "de59b3c5.550e5",
        "b649f241.fe659",
        "35e0c434.3e437c"
      ]
    ]
  },
  {
    "id": "a4dcab46.732d98",
    "type": "outcome",
    "name": "vpn-binding",
    "xml": "<outcome value='vpn-binding'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1796.290298461914,
    "y": 1391.8299894332886,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "482867b5.2cc388"
      ]
    ]
  },
  {
    "id": "2e8bc3df.71844c",
    "type": "for",
    "name": "for each relationship",
    "xml": "<for silentFailure='true' index='vidx' start='0' end='`$tmp.connectivity.relationship-list.relationship_length`' >\n",
    "comments": "",
    "outputs": 1,
    "x": 1418.0042419433594,
    "y": 1390.0082159042358,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "8af67803.bf6a88"
      ]
    ]
  },
  {
    "id": "8af67803.bf6a88",
    "type": "switchNode",
    "name": "switch related-to",
    "xml": "<switch test='`$tmp.connectivity.relationship-list.relationship[$vidx].related-to`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1630.0042533874512,
    "y": 1391.0082159042358,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "a4dcab46.732d98"
      ]
    ]
  },
  {
    "id": "6eb3502d.b2e8f",
    "type": "set",
    "name": "set tmp.vpn-name",
    "xml": "<set>\n<parameter name='tmp.vpn-name' value=\"`$tmp.connectivity.relationship-list.relationship[$vidx].relationship-data[0].relationship-value` \" />\n",
    "comments": "",
    "x": 2203.0044479370117,
    "y": 1103.008532524109,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "6613cefb.76171",
    "type": "execute",
    "name": "split vpnName to find nodeId",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='split' >\n<parameter name=\"original_string\" value='`$tmp.vpn-name`'/>\n<parameter name=\"regex\" value=\"-\"/>\n<parameter name=\"ctx_memory_result_key\" value=\"route1\"/>\n",
    "comments": "",
    "outputs": 1,
    "x": 2239.0044021606445,
    "y": 1204.0078992843628,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "41fe5a08.6540e4",
        "12fef836.878578"
      ]
    ]
  },
  {
    "id": "12fef836.878578",
    "type": "failure",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2440.004592895508,
    "y": 1181.0078916549683,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "c4ef2190.9fbc6"
      ]
    ]
  },
  {
    "id": "c4ef2190.9fbc6",
    "type": "set",
    "name": "set tmp.node-id",
    "xml": "<set>\n<parameter name='tmp.node-id' value='`$route1[0]`' />\n",
    "comments": "",
    "x": 2593.004753112793,
    "y": 1179.0078926086426,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "fa885e6a.929bd",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value=\"An error occured while splitting sna1_route\" />\n",
    "comments": "",
    "x": 2577.004919052124,
    "y": 1228.0078945159912,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "41fe5a08.6540e4",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2437.00457572937,
    "y": 1229.0078964233398,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "fa885e6a.929bd"
      ]
    ]
  },
  {
    "id": "c873d73.0af9728",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1378.0040702819824,
    "y": 1227.0039777755737,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "72cdc300.185abc"
      ]
    ]
  },
  {
    "id": "1fd3fb2b.7cf7a5",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1380.855800628662,
    "y": 1154.0702228546143,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "132951fb.62166e"
      ]
    ]
  },
  {
    "id": "132951fb.62166e",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"404\" />\n    <parameter name=\"error-message\" value=\"Error: Connectivity resource not found\" />\n    \n",
    "comments": "",
    "x": 1523.0045700073242,
    "y": 1154.3376331329346,
    "z": "4ec136ff.390af8",
    "wires": []
  },
  {
    "id": "72cdc300.185abc",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1380.0040817260742,
    "y": 1305.0041437149048,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "2e8bc3df.71844c"
      ]
    ]
  },
  {
    "id": "bf1b5f9f.275aa",
    "type": "execute",
    "name": "execute RestApiCallNode - get-resource connection-attachment-allotted-resource",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.ar-url`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='GET' />\n    <parameter name=\"responsePrefix\" value=\"mdsal-ar\" />\n\n",
    "comments": "",
    "outputs": 1,
    "x": 816.3378601074219,
    "y": 553.5038557052612,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "f65756e0.dd7818",
        "1584b53e.263d2b"
      ]
    ]
  },
  {
    "id": "ff509458.45f008",
    "type": "execute",
    "name": "get parent-service-data tmp.ar-url-psd",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"/restconf/config/GENERIC-RESOURCE-API:services/service/{service-instance-id}/service-data\"/>\n    <parameter name=\"outputPath\" value=\"tmp.ar-url-psd\"/>\n    <parameter name=\"target\" value=\"{service-instance-id}\"/>\n    <parameter name=\"replacement\" value=\"`$tmp.ar.parent-service-instance-id`\"/>\n",
    "comments": "",
    "outputs": 1,
    "x": 670.0041046142578,
    "y": 762.0041170120239,
    "z": "4ec136ff.390af8",
    "wires": [
      []
    ]
  },
  {
    "id": "980e2d4b.7e472",
    "type": "execute",
    "name": "execute RestApiCallNode - get-resource parent service data",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.ar-url-psd`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='GET' />\n    <parameter name=\"responsePrefix\" value=\"mdsal-psd\" />\n\n",
    "comments": "",
    "outputs": 1,
    "x": 737.0040664672852,
    "y": 797.0042009353638,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "13901d91.bcbec2",
        "eada0637.1dd9c8"
      ]
    ]
  },
  {
    "id": "372ff043.61187",
    "type": "switchNode",
    "name": "switch mdsal-psd.service-data.provided-allotted-resources_length",
    "xml": "<switch test='`$mdsal-psd.service-data.provided-allotted-resources.provided-allotted-resource_length`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 753.1881866455078,
    "y": 971.7220287322998,
    "z": "4ec136ff.390af8",
    "wires": [
      [
        "e3f9ceb3.fcc12",
        "a518915c.e4ec5",
        "525b4334.32e11c"
      ]
    ]
  }
]