[
  {
    "id": "4cfb64e6.6e881c",
    "type": "dgstart",
    "name": "DGSTART",
    "outputs": 1,
    "x": 94,
    "y": 32,
    "z": "c671301.759d0d",
    "wires": [
      [
        "12c465a6.56166a"
      ]
    ]
  },
  {
    "id": "12c465a6.56166a",
    "type": "service-logic",
    "name": "GENERIC-RESOURCE-API ${project.version}",
    "module": "GENERIC-RESOURCE-API",
    "version": "${project.version}",
    "comments": "",
    "xml": "<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>",
    "outputs": 1,
    "x": 275.00000381469727,
    "y": 92.0000171661377,
    "z": "c671301.759d0d",
    "wires": [
      [
        "2a9804fb.335a2c"
      ]
    ]
  },
  {
    "id": "2a9804fb.335a2c",
    "type": "method",
    "name": "sotn-attachment-topology-operation-deactivate",
    "xml": "<method rpc='sotn-attachment-topology-operation-deactivate' mode='sync'>\n",
    "comments": "",
    "outputs": 1,
    "x": 263.0001220703125,
    "y": 180,
    "z": "c671301.759d0d",
    "wires": [
      [
        "8ef7baf0.8ab7b8"
      ]
    ]
  },
  {
    "id": "8ef7baf0.8ab7b8",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 279.0001220703125,
    "y": 735.0002446174622,
    "z": "c671301.759d0d",
    "wires": [
      [
        "7071662b.7233c8",
        "3ad2f841.5f9c18",
        "e4bfecd2.3089e",
        "8d649aff.9610f8",
        "76bb0e72.4c9e6",
        "cfcc4cd.498b3b",
        "d2afdfc8.3d49c",
        "ff0d92e9.55c77",
        "db753550.5e2778",
        "6873bae7.8cf8e4",
        "7a073085.0e81c",
        "6fa8d61c.7e4378",
        "39d4dd71.5f1112",
        "d845a062.e24db",
        "9b7849da.439398",
        "5b4906aa.434008",
        "485e569f.2b52d8",
        "417e0490.1d34dc",
        "d67f9f52.31c1f",
        "2a0b728c.4f365e"
      ]
    ]
  },
  {
    "id": "7071662b.7233c8",
    "type": "set",
    "name": "set tmp.ar.allotted-resource-id,etc",
    "xml": "<set>\n<parameter name='tmp.ar.allotted-resource-id' value='`$connection-attachment-topology-operation-input.allotted-resource-information.allotted-resource-id`' />\n<parameter name='tmp.ar.parent-service-instance-id' value='`$connection-attachment-topology-operation-input.allotted-resource-information.parent-service-instance-id`' />\n\n\n",
    "comments": "",
    "x": 675.9935607910156,
    "y": 133.9934868812561,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "f3d4b61.bd26248",
    "type": "comment",
    "name": "set tmp ar-id to fetch resource from MDSAL",
    "info": "",
    "comments": "",
    "x": 704.9538726806641,
    "y": 98.02528285980225,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "3ad2f841.5f9c18",
    "type": "set",
    "name": "set tmp.ar.self-link",
    "xml": "<set>\n<parameter name='tmp.ar.self-link' value=\"`'restconf/config/GENERIC-RESOURCE-API:connection-attachment-allotted-resources/connection-attachment-allotted-resource/'\n + $tmp.ar.allotted-resource-id\n + '/allotted-resource-data/connection-attachment-topology/'` \" />\n\n",
    "comments": "",
    "x": 629.9934997558594,
    "y": 226.99349212646484,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "76bb0e72.4c9e6",
    "type": "execute",
    "name": "execute Properties",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.prop.PropertiesNode' method='readProperties' >\n    <parameter name='fileName' value='%SDNC_CONFIG_DIR%/generic-resource-api-dg.properties' />\n    <parameter name='contextPrefix' value='prop' />\n",
    "comments": "",
    "outputs": 1,
    "x": 636.2553901672363,
    "y": 314.6602210998535,
    "z": "c671301.759d0d",
    "wires": [
      []
    ]
  },
  {
    "id": "e4bfecd2.3089e",
    "type": "execute",
    "name": "generate allotted-resource tmp.ar-url",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"`$prop.restapi.connection-attachment-allottedresource`\"/>\n    <parameter name=\"outputPath\" value=\"tmp.ar-url\"/>\n    <parameter name=\"target\" value=\"{allotted-resource-id}\"/>\n    <parameter name=\"replacement\" value=\"`$tmp.ar.allotted-resource-id`\"/>\n",
    "comments": "",
    "outputs": 1,
    "x": 686.2554931640625,
    "y": 401.66022205352783,
    "z": "c671301.759d0d",
    "wires": [
      []
    ]
  },
  {
    "id": "12a5d929.d1ab27",
    "type": "comment",
    "name": "GET connection-attachment-allotted-resource from mdsal",
    "info": "",
    "comments": "",
    "x": 729.8084869384766,
    "y": 472.53876876831055,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "d0fe36b8.253ae8",
    "type": "comment",
    "name": "Used for setting output to API Handler",
    "info": "",
    "comments": "",
    "x": 683.9935302734375,
    "y": 193.993501663208,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "b80d794b.4e9278",
    "type": "comment",
    "name": "Obtain different URL, template location etc",
    "info": "For saving resource information to MDSAL & for AAI",
    "comments": "",
    "x": 701.9934959411621,
    "y": 279.8823823928833,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "cbbc01c9.a6bad",
    "type": "comment",
    "name": "Used to Get AR by id to MDSAL, same as self-link",
    "info": "",
    "comments": "",
    "x": 727.9935150146484,
    "y": 366.8823413848877,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "dd903f73.c503a",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1170.6668281555176,
    "y": 520.0000286102295,
    "z": "c671301.759d0d",
    "wires": [
      [
        "a2e7e6e6.009bb8"
      ]
    ]
  },
  {
    "id": "a2e7e6e6.009bb8",
    "type": "block",
    "name": "block: atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1339.6668319702148,
    "y": 518.4999294281006,
    "z": "c671301.759d0d",
    "wires": [
      [
        "40901b07.2b8a34"
      ]
    ]
  },
  {
    "id": "40901b07.2b8a34",
    "type": "switchNode",
    "name": "switch cr length",
    "xml": "<switch test='`$mdsal-ar.connection-attachment-allotted-resource_length`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1512.5241012573242,
    "y": 456.11909198760986,
    "z": "c671301.759d0d",
    "wires": [
      [
        "ff35eb42.56bb08",
        "269f23f1.ccbfdc"
      ]
    ]
  },
  {
    "id": "ff35eb42.56bb08",
    "type": "other",
    "name": "outcome 1",
    "xml": "<outcome value='1'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1749.8573455810547,
    "y": 434.1190423965454,
    "z": "c671301.759d0d",
    "wires": [
      [
        "51f5ccd7.88acc4"
      ]
    ]
  },
  {
    "id": "51f5ccd7.88acc4",
    "type": "block",
    "name": "block: atomic",
    "xml": "<block atomic='true'>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1934.3812351226807,
    "y": 431.02387619018555,
    "z": "c671301.759d0d",
    "wires": [
      [
        "6cd3d1da.71f58",
        "b9e7534b.5d3c7",
        "69d088e.2321178"
      ]
    ]
  },
  {
    "id": "608eef9f.ff52c",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"404\" />\n    <parameter name=\"error-message\" value=\"Error: SOTN resource not found\" />\n    \n",
    "comments": "",
    "x": 1858.5190773010254,
    "y": 556.0661172866821,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "5569926e.6ec77c",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1162.5186309814453,
    "y": 555.0661134719849,
    "z": "c671301.759d0d",
    "wires": [
      [
        "8fd3c2e7.8c13"
      ]
    ]
  },
  {
    "id": "8fd3c2e7.8c13",
    "type": "block",
    "name": "block: atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1342.5185813903809,
    "y": 555.7326641082764,
    "z": "c671301.759d0d",
    "wires": [
      [
        "608eef9f.ff52c"
      ]
    ]
  },
  {
    "id": "269f23f1.ccbfdc",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1738.1852989196777,
    "y": 471.3994026184082,
    "z": "c671301.759d0d",
    "wires": [
      [
        "608eef9f.ff52c"
      ]
    ]
  },
  {
    "id": "6cd3d1da.71f58",
    "type": "set",
    "name": "set connection-attachment-ar from get",
    "xml": "<set>\n<parameter name='connection-attachment-ar.' value='$mdsal-ar.connection-attachment-allotted-resource[0].' />\n",
    "comments": "",
    "x": 2180.444793701172,
    "y": 391.0001058578491,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "69d088e.2321178",
    "type": "set",
    "name": "set oper-status",
    "xml": "<set>\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.last-action' value='`$connection-attachment-ar.allotted-resource-data.allotted-resource-operation-information.request-information.request-action`' />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.last-rpc-action' value='`$connection-attachment-ar.allotted-resource-status.rpc-action`' />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.last-svc-request-id' value='`$connection-attachment-ar.allotted-resource-data.allotted-resource-operation-information.sdnc-request-header.svc-request-id`' />\n\n",
    "comments": "",
    "x": 2113.4447898864746,
    "y": 481.42866039276123,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "b9e7534b.5d3c7",
    "type": "switchNode",
    "name": "switch order-status",
    "xml": "<switch test='`$connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.order-status`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2124.444625854492,
    "y": 435.0001096725464,
    "z": "c671301.759d0d",
    "wires": [
      [
        "e31f34a6.200f98",
        "4be6cb8d.440694"
      ]
    ]
  },
  {
    "id": "e31f34a6.200f98",
    "type": "outcome",
    "name": "outcome Active",
    "xml": "<outcome value='Active'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2331.044574737549,
    "y": 425.0001096725464,
    "z": "c671301.759d0d",
    "wires": [
      [
        "3c41da84.a11fe6"
      ]
    ]
  },
  {
    "id": "4be6cb8d.440694",
    "type": "outcome",
    "name": "outcome Other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2330.7590942382812,
    "y": 467.4287004470825,
    "z": "c671301.759d0d",
    "wires": [
      [
        "4f30d53e.7d564c"
      ]
    ]
  },
  {
    "id": "3c41da84.a11fe6",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 2483.5151290893555,
    "y": 423.3757600784302,
    "z": "c671301.759d0d",
    "wires": [
      []
    ]
  },
  {
    "id": "4f30d53e.7d564c",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" \n    value=\"`'Existing connection-attachment-allotted-resource with order status of ' + $connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.order-status + '.'`\" />\n",
    "comments": "",
    "x": 2503.6669845581055,
    "y": 464.000111579895,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "b70a2f75.befcc",
    "type": "call",
    "name": "call GENERIC-RESOURCE-API:sotn-get-saved-ar-param",
    "xml": "<call module='GENERIC-RESOURCE-API' rpc='sotn-get-saved-ar-param' mode='sync' >\n",
    "comments": "",
    "outputs": 1,
    "x": 891.3031158447266,
    "y": 616.4935908317566,
    "z": "c671301.759d0d",
    "wires": [
      []
    ]
  },
  {
    "id": "cfcc4cd.498b3b",
    "type": "block",
    "name": "block: atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 588.3092803955078,
    "y": 617.4999389648438,
    "z": "c671301.759d0d",
    "wires": [
      [
        "b70a2f75.befcc"
      ]
    ]
  },
  {
    "id": "11cd074.969d5f9",
    "type": "comment",
    "name": "GET parent-service-data from mdsal to check existence of other End point",
    "info": "",
    "comments": "",
    "x": 770.0004425048828,
    "y": 678.5316982269287,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "9f5cf8a1.eb07d8",
    "type": "for",
    "name": "for pidx..mdsal-psd.service-data.provided-allotted-resources.provided-allotted-resource[]",
    "xml": "<for index='pidx' start='0' end='`$mdsal-psd.service-data.provided-allotted-resources.provided-allotted-resource_length`' >\n",
    "comments": "",
    "outputs": 1,
    "x": 1660.1849975585938,
    "y": 882.0040826797485,
    "z": "c671301.759d0d",
    "wires": [
      [
        "60ecfe73.436f5"
      ]
    ]
  },
  {
    "id": "99b7fbfe.94a448",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1066.3269691467285,
    "y": 1014.5755434036255,
    "z": "c671301.759d0d",
    "wires": [
      [
        "6439feba.07b8e"
      ]
    ]
  },
  {
    "id": "bdbde57e.1f4d78",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 1257.4543704986572,
    "y": 879.7015712037683,
    "z": "c671301.759d0d",
    "wires": [
      [
        "9f5cf8a1.eb07d8"
      ]
    ]
  },
  {
    "id": "60ecfe73.436f5",
    "type": "switchNode",
    "name": "switch allotted-resource-id",
    "xml": "<switch test=\"`$mdsal-psd.service-data.provided-allotted-resources.provided-allotted-resource[$pidx].allotted-resource-id == $tmp.ar.allotted-resource-id`\">\n\n",
    "comments": "",
    "outputs": 1,
    "x": 2095.296398162842,
    "y": 882.0039796829224,
    "z": "c671301.759d0d",
    "wires": [
      [
        "1a655308.b661fd",
        "be68f27f.28bd6"
      ]
    ]
  },
  {
    "id": "1a655308.b661fd",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2304.106746673584,
    "y": 862.4684362411499,
    "z": "c671301.759d0d",
    "wires": [
      [
        "9a95bbc4.4906f8"
      ]
    ]
  },
  {
    "id": "b3792237.47167",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 2452.867500305176,
    "y": 898.3256177902222,
    "z": "c671301.759d0d",
    "wires": [
      [
        "5c963186.53d88"
      ]
    ]
  },
  {
    "id": "5c963186.53d88",
    "type": "set",
    "name": "set tmp.pidx and ptx.consumed-ar",
    "xml": "<set>\n<parameter name='tmp.pidx' value='`$pidx`' />\n<parameter name='tmp.provided-ar.' value='`$mdsal-psd.service-data.provided-allotted-resources.provided-allotted-resource[$pidx].`' />\n<parameter name='tmp.found-in-ar' value='true' />\n<parameter name='tmp.ep-available' value='true' />",
    "comments": "",
    "x": 2687.724937438965,
    "y": 896.8971490859985,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "bd64de18.15892",
    "type": "comment",
    "name": "Check existence of other AR in parent service data",
    "info": "Check if other allotted resource is available.",
    "comments": "",
    "x": 693.9628448486328,
    "y": 848.8929204940796,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "7e8c22a4.61fc8c",
    "type": "other",
    "name": "outcome 1",
    "xml": "<outcome value='1'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1076.9793167114258,
    "y": 949.677264213562,
    "z": "c671301.759d0d",
    "wires": [
      [
        "c4a79f00.128a8"
      ]
    ]
  },
  {
    "id": "6439feba.07b8e",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"404\" />\n    <parameter name=\"error-message\" value=\"Error: SOTN resource not found\" />\n    \n",
    "comments": "",
    "x": 1238.9793128967285,
    "y": 1013.677285194397,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "2061f78c.10bc08",
    "type": "other",
    "name": "outcome 2",
    "xml": "<outcome value='2'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1082.9793910980225,
    "y": 880.6772715821862,
    "z": "c671301.759d0d",
    "wires": [
      [
        "bdbde57e.1f4d78"
      ]
    ]
  },
  {
    "id": "9a95bbc4.4906f8",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 2433.090805053711,
    "y": 857.6771764755249,
    "z": "c671301.759d0d",
    "wires": [
      []
    ]
  },
  {
    "id": "be68f27f.28bd6",
    "type": "outcomeTrue",
    "name": "false",
    "xml": "<outcome value='false'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2304.0907974243164,
    "y": 896.6771802902222,
    "z": "c671301.759d0d",
    "wires": [
      [
        "b3792237.47167"
      ]
    ]
  },
  {
    "id": "de57d171.2f008",
    "type": "switchNode",
    "name": "switch mdsal-psd.networks_length",
    "xml": "<switch test='`$mdsal-psd.service-data.networks.network_length`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1489.3129959106445,
    "y": 952.8997611999512,
    "z": "c671301.759d0d",
    "wires": [
      [
        "2dedf29c.7f1aee",
        "754f989d.208718"
      ]
    ]
  },
  {
    "id": "754f989d.208718",
    "type": "other",
    "name": "outcome 1",
    "xml": "<outcome value='1'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1719.3130187988281,
    "y": 928.7885932922363,
    "z": "c671301.759d0d",
    "wires": [
      [
        "55c6b97a.4d77c8"
      ]
    ]
  },
  {
    "id": "2dedf29c.7f1aee",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1713.3131408691406,
    "y": 988.7885932922363,
    "z": "c671301.759d0d",
    "wires": [
      [
        "f186a46c.9bf998"
      ]
    ]
  },
  {
    "id": "f186a46c.9bf998",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"404\" />\n    <parameter name=\"error-message\" value=\"Error: Incorrect state found more then 1 network\" />\n    \n",
    "comments": "",
    "x": 1885.9655265808105,
    "y": 988.8903999328613,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "30d37efb.acb512",
    "type": "set",
    "name": "set tmp.network.",
    "xml": "<set>\n<parameter name='tmp.network.' value='`$mdsal-psd.service-data.networks.network[0].`' />\n",
    "comments": "",
    "x": 2087.757942199707,
    "y": 918.7887525558472,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "c4a79f00.128a8",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 1249.423671722412,
    "y": 950.7885122299194,
    "z": "c671301.759d0d",
    "wires": [
      [
        "de57d171.2f008"
      ]
    ]
  },
  {
    "id": "55c6b97a.4d77c8",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 1887.090690612793,
    "y": 947.7884273529053,
    "z": "c671301.759d0d",
    "wires": [
      [
        "30d37efb.acb512",
        "71f1a549.c26fcc"
      ]
    ]
  },
  {
    "id": "71f1a549.c26fcc",
    "type": "for",
    "name": "for nidx..tmp.network.network-data.network-request-input.network...[]",
    "xml": "<for index='nidx' start='0' end='`$tmp.network.network-data.network-request-input.network-input-parameters.param_length`' >",
    "comments": "",
    "outputs": 1,
    "x": 2263.09130859375,
    "y": 990.7884349822998,
    "z": "c671301.759d0d",
    "wires": [
      [
        "7875ac99.845f44"
      ]
    ]
  },
  {
    "id": "7875ac99.845f44",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 2586.6469688415527,
    "y": 991.7885122299194,
    "z": "c671301.759d0d",
    "wires": [
      [
        "e81ff7c1.f7c6b8",
        "bdffba6f.6b28d8"
      ]
    ]
  },
  {
    "id": "e81ff7c1.f7c6b8",
    "type": "switchNode",
    "name": "switch access-node-id",
    "xml": "<switch test=\"`$tmp.network.network-data.network-request-input.network-input-parameters.param[$nidx].name == 'access-node-id'`\">",
    "comments": "",
    "outputs": 1,
    "x": 2765.1570739746094,
    "y": 975.7989301681519,
    "z": "c671301.759d0d",
    "wires": [
      [
        "e7b692af.0dd02"
      ]
    ]
  },
  {
    "id": "e7b692af.0dd02",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2952.1570739746094,
    "y": 976.7989301681519,
    "z": "c671301.759d0d",
    "wires": [
      [
        "bf146f7a.eb901"
      ]
    ]
  },
  {
    "id": "bf146f7a.eb901",
    "type": "set",
    "name": "set tmp.found-in-network tmp.ep-available",
    "xml": "<set>\n<parameter name='tmp.found-in-network' value='true' />\n<parameter name='tmp.ep-available' value='true' />",
    "comments": "",
    "x": 3203.157081604004,
    "y": 976.3988723754883,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "bdffba6f.6b28d8",
    "type": "returnSuccess",
    "name": "return success",
    "xml": "<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n",
    "comments": "",
    "x": 2748.14697265625,
    "y": 1020.7885293960571,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "8d649aff.9610f8",
    "type": "switchNode",
    "name": "switch tmp.ep-available",
    "xml": "<switch test='`$tmp.ep-available`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 625.3128662109375,
    "y": 1153.2327852249146,
    "z": "c671301.759d0d",
    "wires": [
      [
        "4f8ffbf3.76c804",
        "5d810111.f89bf"
      ]
    ]
  },
  {
    "id": "5d810111.f89bf",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 807.9797019958496,
    "y": 1177.5661935806274,
    "z": "c671301.759d0d",
    "wires": [
      [
        "fc624863.8ed628"
      ]
    ]
  },
  {
    "id": "4f8ffbf3.76c804",
    "type": "outcomeTrue",
    "name": "false",
    "xml": "<outcome value='false'>\n",
    "comments": "",
    "outputs": 1,
    "x": 810.8684730529785,
    "y": 1116.566291809082,
    "z": "c671301.759d0d",
    "wires": [
      [
        "95d9e1c5.ffafd"
      ]
    ]
  },
  {
    "id": "95d9e1c5.ffafd",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 947.8685493469238,
    "y": 1115.4551057815552,
    "z": "c671301.759d0d",
    "wires": [
      []
    ]
  },
  {
    "id": "fc624863.8ed628",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 978.0907897949219,
    "y": 1175.5661516189575,
    "z": "c671301.759d0d",
    "wires": [
      [
        "36542d01.f14212"
      ]
    ]
  },
  {
    "id": "1ad5d4a1.aaa1eb",
    "type": "comment",
    "name": "GET connection-attachment-ar to store AR data from mdsal",
    "info": "",
    "comments": "",
    "x": 2163.472946166992,
    "y": 355.5039691925049,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "d24d901f.d9d76",
    "type": "comment",
    "name": "Set source end point",
    "info": "",
    "comments": "",
    "x": 601.9728393554688,
    "y": 585.2540645599365,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "d2afdfc8.3d49c",
    "type": "set",
    "name": "set tmp.ar.parent-service-instance-id",
    "xml": "<set>\n<parameter name='tmp.ar.parent-service-instance-id' value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.parent-service-instance-id` \" />\n\n",
    "comments": "",
    "x": 654.9689178466797,
    "y": 710.0002088546753,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "7153ec61.6a9434",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1032.9689140319824,
    "y": 759.000207901001,
    "z": "c671301.759d0d",
    "wires": [
      [
        "90308511.d0d098"
      ]
    ]
  },
  {
    "id": "f1d188a0.fe8058",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1024.8207168579102,
    "y": 794.0662927627563,
    "z": "c671301.759d0d",
    "wires": [
      [
        "f851790f.ede818"
      ]
    ]
  },
  {
    "id": "f851790f.ede818",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"404\" />\n    <parameter name=\"error-message\" value=\"Error: SOTN resource not found\" />\n    \n",
    "comments": "",
    "x": 1199.9694023132324,
    "y": 790.3336429595947,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "90308511.d0d098",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1183.9689140319824,
    "y": 757.000207901001,
    "z": "c671301.759d0d",
    "wires": [
      []
    ]
  },
  {
    "id": "ff0d92e9.55c77",
    "type": "set",
    "name": "set tmp.found-in-ar tmp.found-in-network tmp.ep-available to false",
    "xml": "<set>\n<parameter name='tmp.found-in-ar' value='false' />\n<parameter name='tmp.found-in-network' value='false' />\n<parameter name='tmp.ep-available' value='false' />",
    "comments": "",
    "x": 741.9689102172852,
    "y": 884.0001821517944,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "717c1a02.c09b54",
    "type": "comment",
    "name": "If other EP exists delete from domain controller",
    "info": "",
    "comments": "",
    "x": 675.9688110351562,
    "y": 1077.999997138977,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "b5225e87.1d6d6",
    "type": "set",
    "name": "set controller data",
    "xml": "<set>\n<parameter name='prop.sdncRestApi.thirdpartySdnc.url' value=\"`$tmp.aai.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].service-url`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.user' value=\"`$tmp.aai.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].user-name`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.password' value=\"`$tmp.aai.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].password`\" />\n",
    "comments": "",
    "x": 2680.96964263916,
    "y": 1375.0004262924194,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "a7698ae.d89d278",
    "type": "get-resource",
    "name": "get-resource esr-thirdparty-sdnc",
    "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"esr-thirdparty-sdnc\" \n\t\tkey=\"esr-thirdparty-sdnc.thirdparty-sdnc-id = $tmp.thirdparty-sdnc-id AND \n\t\t     depth = '1'\"\n        pfx='tmp.aai.esr-thirdparty-sdnc' local-only='false' >\n\n",
    "comments": "",
    "outputs": 1,
    "x": 2244.469581604004,
    "y": 1434.0004262924194,
    "z": "c671301.759d0d",
    "wires": [
      [
        "f44dc730.296008",
        "1e7b258.a67f1db",
        "565f7f73.66ef7"
      ]
    ]
  },
  {
    "id": "f44dc730.296008",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2483.469581604004,
    "y": 1387.0004262924194,
    "z": "c671301.759d0d",
    "wires": [
      [
        "b5225e87.1d6d6"
      ]
    ]
  },
  {
    "id": "1e7b258.a67f1db",
    "type": "not-found",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2486.960548400879,
    "y": 1434.5744619369507,
    "z": "c671301.759d0d",
    "wires": [
      [
        "b82d2ebf.1a1b3"
      ]
    ]
  },
  {
    "id": "565f7f73.66ef7",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2482.293556213379,
    "y": 1475.907774925232,
    "z": "c671301.759d0d",
    "wires": [
      [
        "a1bb007f.4a95b"
      ]
    ]
  },
  {
    "id": "b82d2ebf.1a1b3",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying esr-thirdparty-sdnc from AnAI with thirdparty-sdnc-id = ' + $tmp.thirdparty-sdnc-id`\" />\n\n",
    "comments": "",
    "x": 2663.5319595336914,
    "y": 1422.860198020935,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "a1bb007f.4a95b",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying esr-thirdparty-sdnc from AnAI with thirdparty-sdnc-id = ' + $tmp.thirdparty-sdnc-id`\" />\n\n",
    "comments": "",
    "x": 2670.0661125183105,
    "y": 1471.3469676971436,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "41073eca.4f87f",
    "type": "get-resource",
    "name": "get-resource pnf",
    "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"pnf\" \n\t\tkey=\"pnf.pnf-name = $tmp.node-id \n\t\tAND depth = '0'\"\n        pfx='tmp.aai.pnf' local-only='false' >\n\n\n\n",
    "comments": "",
    "outputs": 1,
    "x": 2186.9697341918945,
    "y": 1319.000418663025,
    "z": "c671301.759d0d",
    "wires": [
      [
        "ea378f67.57494",
        "868c9cb5.9db7b",
        "3a1faec8.e90752"
      ]
    ]
  },
  {
    "id": "ea378f67.57494",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2374.9697494506836,
    "y": 1265.0004110336304,
    "z": "c671301.759d0d",
    "wires": [
      [
        "1d2ccfbd.a8cd2"
      ]
    ]
  },
  {
    "id": "868c9cb5.9db7b",
    "type": "not-found",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2380.460796356201,
    "y": 1307.5743074417114,
    "z": "c671301.759d0d",
    "wires": [
      [
        "9b840dcb.a56fd"
      ]
    ]
  },
  {
    "id": "3a1faec8.e90752",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2366.793804168701,
    "y": 1345.9076433181763,
    "z": "c671301.759d0d",
    "wires": [
      [
        "6444ae02.9da9b"
      ]
    ]
  },
  {
    "id": "9b840dcb.a56fd",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
    "comments": "",
    "x": 2534.032096862793,
    "y": 1297.8601140975952,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "6444ae02.9da9b",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying pnf from AnAI with pnf-name = ' + $prop.connection-attachement.access-node-id`\" />\n\n",
    "comments": "",
    "x": 2530.566276550293,
    "y": 1337.3469333648682,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "1d2ccfbd.a8cd2",
    "type": "set",
    "name": "set tmp.thirdparty-sdnc-id",
    "xml": "<set>\n<parameter name='tmp.thirdparty-sdnc-id' value=\"`$tmp.aai.pnf.relationship-list.relationship[0].relationship-data[0].relationship-value`\" />\n",
    "comments": "",
    "x": 2574.9697647094727,
    "y": 1260.0004110336304,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "9df1ac2f.51afc",
    "type": "comment",
    "name": "get domain controller information",
    "info": "",
    "comments": "",
    "x": 2230.4736404418945,
    "y": 1288.0043859481812,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "8e68e45a.813908",
    "type": "execute",
    "name": "execute RestApiCallNode Delete ethernet Service",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/restconf/data/ietf-eth-tran-service:etht-svc/etht-svc-instances=' + $tmp.actual.vpn-name`\" />\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"delete\"/>\n<parameter name=\"responsePrefix\" value=\"vpn-result\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.openecomp.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n<parameter name='customHttpHeaders' value=\"`'X-ACCESS-TOKEN=' + $prop.sdncRestApi.token_id`\" />",
    "comments": "",
    "outputs": 1,
    "x": 2292.96964263916,
    "y": 1539.0004262924194,
    "z": "c671301.759d0d",
    "wires": [
      [
        "133da42a.747e7c",
        "65e79690.a17a38"
      ]
    ]
  },
  {
    "id": "133da42a.747e7c",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2579.969581604004,
    "y": 1562.0004262924194,
    "z": "c671301.759d0d",
    "wires": [
      [
        "25b2c93d.e0d066"
      ]
    ]
  },
  {
    "id": "25b2c93d.e0d066",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "comments": "",
    "outputs": 1,
    "x": 2749.9695205688477,
    "y": 1565.0004262924194,
    "z": "c671301.759d0d",
    "wires": [
      []
    ]
  },
  {
    "id": "48ed3cb6.2c6ac4",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create vpn rest api\" />\n",
    "comments": "",
    "x": 2749.96964263916,
    "y": 1521.0004262924194,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "65e79690.a17a38",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2582.9695205688477,
    "y": 1521.0004262924194,
    "z": "c671301.759d0d",
    "wires": [
      [
        "48ed3cb6.2c6ac4"
      ]
    ]
  },
  {
    "id": "d8c8a336.34039",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 904.7307472229004,
    "y": 1677.9527901411057,
    "z": "c671301.759d0d",
    "wires": [
      [
        "16163acd.838405"
      ]
    ]
  },
  {
    "id": "16163acd.838405",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"AAI failed\" />\n",
    "comments": "",
    "x": 1071.2546272277832,
    "y": 1689.5718611478806,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "dfa99ab0.574428",
    "type": "failure",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 911.8260345458984,
    "y": 1710.7147578001022,
    "z": "c671301.759d0d",
    "wires": [
      [
        "16163acd.838405"
      ]
    ]
  },
  {
    "id": "60dc28ca.d224f8",
    "type": "comment",
    "name": "Save Resource to AAI",
    "info": "",
    "comments": "",
    "x": 623.7784614562988,
    "y": 1660.3021783828735,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "d845a062.e24db",
    "type": "set",
    "name": "set output to api handler",
    "xml": "<set>\n<parameter name='allotted-resource-id' value='`$tmp.ar.allotted-resource-id`' />\n<parameter name='connection-attachment-object-path' value=\"`$tmp.ar.self-link`\"/>\n<parameter name='service-object-path' value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $connection-attachment-topology-operation-input.service-information.service-instance-id\n + '/service-data/service-topology/'`\"/>\n \n",
    "comments": "",
    "x": 638.5461578369141,
    "y": 1581.8276596069336,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "9b7849da.439398",
    "type": "returnSuccess",
    "name": "return success",
    "xml": "<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n",
    "comments": "",
    "x": 606.9592399597168,
    "y": 1742.4434118270874,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "39d4dd71.5f1112",
    "type": "execute",
    "name": "execute RestApiCallNode - PUT AR by id",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='templateFileName' value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.sotn-attachment.templatefile`\" />\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.ar-url`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='PUT' />\n    <parameter name=\"responsePrefix\" value=\"mdsal-ar\" />\n\n",
    "comments": "",
    "outputs": 1,
    "x": 688.2782592773438,
    "y": 1489.468433380127,
    "z": "c671301.759d0d",
    "wires": [
      [
        "f102f99f.ef15d8",
        "c83c9026.cf22e",
        "7e167ed3.568ff"
      ]
    ]
  },
  {
    "id": "f102f99f.ef15d8",
    "type": "not-found",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 956.9196357727051,
    "y": 1540.799845121801,
    "z": "c671301.759d0d",
    "wires": [
      [
        "5e6822ac.d3f74c"
      ]
    ]
  },
  {
    "id": "c83c9026.cf22e",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 947.9196853637695,
    "y": 1509.2998708710074,
    "z": "c671301.759d0d",
    "wires": [
      [
        "5e6822ac.d3f74c"
      ]
    ]
  },
  {
    "id": "7e167ed3.568ff",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 951.6697235107422,
    "y": 1479.6569757461548,
    "z": "c671301.759d0d",
    "wires": [
      [
        "a5182b73.66b2a8"
      ]
    ]
  },
  {
    "id": "5e6822ac.d3f74c",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating md-sal for connection-attachment-allotted-resource\" />\n",
    "comments": "",
    "x": 1117.6697235107422,
    "y": 1510.0498947128654,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "a5182b73.66b2a8",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1093.3256912231445,
    "y": 1475.849144935608,
    "z": "c671301.759d0d",
    "wires": [
      []
    ]
  },
  {
    "id": "db753550.5e2778",
    "type": "set",
    "name": "set ar-data",
    "xml": "<set>\n<parameter name='connection-attachment-ar.allotted-resource-status.action' value=\"`$connection-attachment-topology-operation-input.request-information.request-action` \" />\n<parameter name='connection-attachment-ar.allotted-resource-status.rpc-name' value=\"connection-attachment-topology-operation\" />\n<parameter name='connection-attachment-ar.allotted-resource-status.rpc-action' value=\"`$connection-attachment-topology-operation-input.sdnc-request-header.svc-action` \" />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-operation-information.request-information.' value=\"`$connection-attachment-topology-operation-input.request-information.` \" />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-operation-information.sdnc-request-header.' value=\"`$connection-attachment-topology-operation-input.sdnc-request-header.` \" />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-operation-information.service-information.' value=\"`$connection-attachment-topology-operation-input.service-information.` \" />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-operation-information.allotted-resource-information.' value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.` \" />",
    "comments": "",
    "x": 588.4918785095215,
    "y": 1339.8493564128876,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "7a073085.0e81c",
    "type": "execute",
    "name": "execute getTime",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='setTime' >\n    <parameter name=\"outputPath\" value=\"tmp.current-time\" />\n\n",
    "comments": "",
    "outputs": 1,
    "x": 605.7777214050293,
    "y": 1412.4689540863037,
    "z": "c671301.759d0d",
    "wires": [
      []
    ]
  },
  {
    "id": "6fa8d61c.7e4378",
    "type": "set",
    "name": "set allotted-resource-oper-status",
    "xml": "<set>\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.order-status' value='PendingDelete' />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.last-action' value='`$connection-attachment-topology-operation-input.request-information.request-action`' />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.last-rpc-action' value='`$connection-attachment-topology-operation-input.sdnc-request-header.svc-action`' />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.last-svc-request-id' value='`$connection-attachment-topology-operation-input.sdnc-request-header.svc-request-id`' />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.create-timestamp' value='`$tmp.current-time`' />\n",
    "comments": "",
    "x": 660.764778137207,
    "y": 1450.4200916290283,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "6873bae7.8cf8e4",
    "type": "set",
    "name": "set model-data",
    "xml": "<set>\n<parameter name='connection-attachment-ar.allotted-resource-data.connection-attachment-topology.onap-model-information.' value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.onap-model-information.` \" />",
    "comments": "",
    "x": 602.3334197998047,
    "y": 1379.024006843567,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "9fb656d5.ef4218",
    "type": "comment",
    "name": "Prepare data for allotted-resource addition to MDSAL",
    "info": "This will add to allotted-resource which is present inside service.",
    "comments": "",
    "x": 715.6668815612793,
    "y": 1300.0239589214325,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "ad67b90f.7f4058",
    "type": "comment",
    "name": "Add to allotted-resources in mdsal",
    "info": "",
    "comments": "",
    "x": 657.2467079162598,
    "y": 1267.4372606277466,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "5b4906aa.434008",
    "type": "update",
    "name": "update AAI allotted-resource",
    "xml": "<update plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"allotted-resource\" \n\t\tkey=\"customer.global-customer-id = $connection-attachment-topology-operation-input.service-information.global-customer-id AND\n\t\t\tservice-subscription.service-type = $connection-attachment-topology-operation-input.service-information.subscription-service-type AND\n\t\t\tservice-instance.service-instance-id = $connection-attachment-topology-operation-input.allotted-resource-information.parent-service-instance-id AND\n\t\t\tallotted-resource.id = $tmp.ar.allotted-resource-id\"\n        pfx='pfx' local-only='false' force='false'>\n\t<parameter name=\"description\" value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.allotted-resource-type`\" />\n\t<parameter name=\"selflink\" value=\"`$tmp.ar.self-link`\" />\n\t<!--parameter name=\"model-invariant-id\" value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.onap-model-information.model-invariant-uuid`\" />\n\t<parameter name=\"model-version-id\" value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.onap-model-information.model-uuid`\" /-->\n\t<parameter name=\"operational-status\" value=\"PendingDelete\" />\n",
    "comments": "",
    "outputs": 1,
    "x": 650.2227401733398,
    "y": 1697.7543210983276,
    "z": "c671301.759d0d",
    "wires": [
      [
        "d8c8a336.34039",
        "dfa99ab0.574428"
      ]
    ]
  },
  {
    "id": "36542d01.f14212",
    "type": "get-resource",
    "name": "get-resource connectivity",
    "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"connectivity\" \n\t\tkey=\"connectivity.connectivity-id = $mdsal-psd.service-data.networks.network[0].network-id AND \n\t\t     depth = '1'\"\n        pfx='tmp.connectivity' local-only='false' >\n",
    "comments": "",
    "outputs": 1,
    "x": 1184.0005645751953,
    "y": 1175.5044269561768,
    "z": "c671301.759d0d",
    "wires": [
      [
        "ac511500.01c158",
        "73ce6220.0aa3ac"
      ]
    ]
  },
  {
    "id": "acaf1b93.77d2c8",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 1957.1178741455078,
    "y": 1372.3445596694946,
    "z": "c671301.759d0d",
    "wires": [
      [
        "49ef2c84.8031a4",
        "240e11a5.31781e",
        "41073eca.4f87f",
        "a7698ae.d89d278",
        "8e68e45a.813908",
        "17a0b9d8.6d99a6"
      ]
    ]
  },
  {
    "id": "bfb6dec9.6c932",
    "type": "outcome",
    "name": "vpn-binding",
    "xml": "<outcome value='vpn-binding'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1783.286392211914,
    "y": 1374.8260831832886,
    "z": "c671301.759d0d",
    "wires": [
      [
        "acaf1b93.77d2c8"
      ]
    ]
  },
  {
    "id": "a4e854e4.e41328",
    "type": "for",
    "name": "for each relationship",
    "xml": "<for silentFailure='true' index='vidx' start='0' end='`$tmp.connectivity.relationship-list.relationship_length`' >\n",
    "comments": "",
    "outputs": 1,
    "x": 1405.0003356933594,
    "y": 1373.0043096542358,
    "z": "c671301.759d0d",
    "wires": [
      [
        "998442eb.48b4"
      ]
    ]
  },
  {
    "id": "998442eb.48b4",
    "type": "switchNode",
    "name": "switch related-to",
    "xml": "<switch test='`$tmp.connectivity.relationship-list.relationship[$vidx].related-to`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1617.0003471374512,
    "y": 1374.0043096542358,
    "z": "c671301.759d0d",
    "wires": [
      [
        "bfb6dec9.6c932"
      ]
    ]
  },
  {
    "id": "240e11a5.31781e",
    "type": "set",
    "name": "set tmp.vpn-name",
    "xml": "<set>\n<parameter name='tmp.vpn-name' value=\"`$tmp.connectivity.relationship-list.relationship[$vidx].relationship-data[0].relationship-value` \" />\n",
    "comments": "",
    "x": 2190.0005416870117,
    "y": 1086.004626274109,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "49ef2c84.8031a4",
    "type": "execute",
    "name": "split vpnName to find nodeId",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='split' >\n<parameter name=\"original_string\" value='`$tmp.vpn-name`'/>\n<parameter name=\"regex\" value=\"-\"/>\n<parameter name=\"ctx_memory_result_key\" value=\"route1\"/>\n",
    "comments": "",
    "outputs": 1,
    "x": 2226.0004959106445,
    "y": 1187.0039930343628,
    "z": "c671301.759d0d",
    "wires": [
      [
        "29be775d.300d28",
        "79e65a65.d62d64"
      ]
    ]
  },
  {
    "id": "79e65a65.d62d64",
    "type": "failure",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2427.000686645508,
    "y": 1164.0039854049683,
    "z": "c671301.759d0d",
    "wires": [
      [
        "2e37c245.6cda0e"
      ]
    ]
  },
  {
    "id": "2e37c245.6cda0e",
    "type": "set",
    "name": "set tmp.node-id",
    "xml": "<set>\n<parameter name='tmp.node-id' value='`$route1[0]`' />\n<parameter name='tmp.actual.vpn-name' value='`$route1[1]`' />\n",
    "comments": "",
    "x": 2580.000846862793,
    "y": 1162.0039863586426,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "3186476.c93d1b8",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value=\"An error occured while splitting sna1_route\" />\n",
    "comments": "",
    "x": 2564.001012802124,
    "y": 1211.0039882659912,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "29be775d.300d28",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2424.00066947937,
    "y": 1212.0039901733398,
    "z": "c671301.759d0d",
    "wires": [
      [
        "3186476.c93d1b8"
      ]
    ]
  },
  {
    "id": "ac511500.01c158",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1365.0001640319824,
    "y": 1210.0000715255737,
    "z": "c671301.759d0d",
    "wires": [
      [
        "35849f58.75b79"
      ]
    ]
  },
  {
    "id": "73ce6220.0aa3ac",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1367.851894378662,
    "y": 1137.0663166046143,
    "z": "c671301.759d0d",
    "wires": [
      [
        "3d1a3d62.7aa882"
      ]
    ]
  },
  {
    "id": "3d1a3d62.7aa882",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"404\" />\n    <parameter name=\"error-message\" value=\"Error: Connectivity resource not found\" />\n    \n",
    "comments": "",
    "x": 1510.0006637573242,
    "y": 1137.3337268829346,
    "z": "c671301.759d0d",
    "wires": []
  },
  {
    "id": "35849f58.75b79",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1367.0001754760742,
    "y": 1288.0002374649048,
    "z": "c671301.759d0d",
    "wires": [
      [
        "a4e854e4.e41328"
      ]
    ]
  },
  {
    "id": "485e569f.2b52d8",
    "type": "execute",
    "name": "execute RestApiCallNode - get-resource connection-attachment-allotted-resource",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.ar-url`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='GET' />\n    <parameter name=\"responsePrefix\" value=\"mdsal-ar\" />\n\n",
    "comments": "",
    "outputs": 1,
    "x": 803.3339538574219,
    "y": 536.4999494552612,
    "z": "c671301.759d0d",
    "wires": [
      [
        "dd903f73.c503a",
        "5569926e.6ec77c"
      ]
    ]
  },
  {
    "id": "417e0490.1d34dc",
    "type": "execute",
    "name": "get parent-service-data tmp.ar-url-psd",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"/restconf/config/GENERIC-RESOURCE-API:services/service/{service-instance-id}/service-data\"/>\n    <parameter name=\"outputPath\" value=\"tmp.ar-url-psd\"/>\n    <parameter name=\"target\" value=\"{service-instance-id}\"/>\n    <parameter name=\"replacement\" value=\"`$tmp.ar.parent-service-instance-id`\"/>\n",
    "comments": "",
    "outputs": 1,
    "x": 657.0001983642578,
    "y": 745.0002107620239,
    "z": "c671301.759d0d",
    "wires": [
      []
    ]
  },
  {
    "id": "d67f9f52.31c1f",
    "type": "execute",
    "name": "execute RestApiCallNode - get-resource parent service data",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.ar-url-psd`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='GET' />\n    <parameter name=\"responsePrefix\" value=\"mdsal-psd\" />\n\n",
    "comments": "",
    "outputs": 1,
    "x": 724.0001602172852,
    "y": 780.0002946853638,
    "z": "c671301.759d0d",
    "wires": [
      [
        "7153ec61.6a9434",
        "f1d188a0.fe8058"
      ]
    ]
  },
  {
    "id": "2a0b728c.4f365e",
    "type": "switchNode",
    "name": "switch mdsal-psd.service-data.provided-allotted-resources_length",
    "xml": "<switch test='`$mdsal-psd.service-data.provided-allotted-resources.provided-allotted-resource_length`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 740.1842803955078,
    "y": 954.7181224822998,
    "z": "c671301.759d0d",
    "wires": [
      [
        "99b7fbfe.94a448",
        "7e8c22a4.61fc8c",
        "2061f78c.10bc08"
      ]
    ]
  },
  {
    "id": "17a0b9d8.6d99a6",
    "type": "update",
    "name": "delete AAI vpn-binding",
    "xml": "<delete plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='vpn-binding' \n      key='vpn-binding.vpn-id = $tmp.vpn-name' >",
    "comments": "",
    "outputs": 1,
    "x": 2224,
    "y": 1642,
    "z": "c671301.759d0d",
    "wires": [
      [
        "496ebae3.0822d4",
        "1b687bcc.3acb54"
      ]
    ]
  },
  {
    "id": "496ebae3.0822d4",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2478.5080070495605,
    "y": 1622.198469042778,
    "z": "c671301.759d0d",
    "wires": [
      [
        "9a00ded1.17f07"
      ]
    ]
  },
  {
    "id": "1b687bcc.3acb54",
    "type": "failure",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2485.6032943725586,
    "y": 1654.9604367017746,
    "z": "c671301.759d0d",
    "wires": [
      [
        "9a00ded1.17f07"
      ]
    ]
  },
  {
    "id": "9a00ded1.17f07",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"AAI failed\" />\n",
    "comments": "",
    "x": 2645.0318870544434,
    "y": 1633.817540049553,
    "z": "c671301.759d0d",
    "wires": []
  }
]
