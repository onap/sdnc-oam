[{"id":"10eabda8.6b888a","type":"dgstart","name":"DGSTART","outputs":1,"x":145,"y":81,"z":"a0656fc9.dda71","wires":[["cd52b57d.bfbe08"]]},{"id":"cd52b57d.bfbe08","type":"service-logic","name":"GENERIC-RESOURCE-API  ${project.version}","module":"GENERIC-RESOURCE-API","version":" ${project.version}","comments":"","xml":"<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>","outputs":1,"x":241.23807907104492,"y":141.95239067077637,"z":"a0656fc9.dda71","wires":[["904d1598.a73d7"]]},{"id":"904d1598.a73d7","type":"method","name":"tunnelxconn-topology-operation-create","xml":"<method rpc='tunnelxconn-topology-operation-create' mode='sync'>\n","comments":"","outputs":1,"x":287.15485763549805,"y":177.19044589996338,"z":"a0656fc9.dda71","wires":[["49aeb9d.798acc8"]]},{"id":"49aeb9d.798acc8","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","comments":"","outputs":1,"x":147.97619247436523,"y":913.0238044261932,"z":"a0656fc9.dda71","wires":[["4d865dd7.64f20c","a0274c7a.6ebe","65d2a143.a02498","12607b02.52cf0d","d55cad77.b93e8","3a9bef92.106bb8","553c4aa3.391f5c","a0ff5ae9.3d78d","49a09902.0d6ba","72f4d871.5b224","5f18d90c.45cb9","543956f5.68f59","cc52eced.06ff9","8d87f176.05e24","d532def2.cf163","e41bf1b.ed0471","c4ca9f8b.96254","3b28aa19.65e62e","b047a9c4.e403f8","b2c28342.d9721","96a57432.cd3f48","b6b159ec.524da","af2b59b0.78298","9eb192c2.c1a4a","56b12519.af5d7c","29793093.a5cc08","a7d43db8.11ef7","d71aa0a1.4f6ba","16acd9a9.cf4c3e","ed7953e3.9a1dd","8781404d.98ab08"]]},{"id":"a0274c7a.6ebe","type":"returnSuccess","name":"return success","xml":"<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n","comments":"","x":416.6669921875,"y":2543.548095703125,"z":"a0656fc9.dda71","wires":[]},{"id":"4d865dd7.64f20c","type":"set","name":"set output to api handler","xml":"<set>\n<parameter name='allotted-resource-id' value='`$tmp.ar.allotted-resource-id`' />\n<parameter name='tunnelxconn-object-path' value=\"`$tmp.ar.self-link`\"/>\n<parameter name='service-object-path' value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $tunnelxconn-topology-operation-input.service-information.service-instance-id\n + '/service-data/service-topology/'`\"/>\n \n","comments":"","x":451.4208984375,"y":2464.670654296875,"z":"a0656fc9.dda71","wires":[]},{"id":"72f4d871.5b224","type":"set","name":"set allotted-resource-oper-status","xml":"<set>\n<parameter name='tx-ar.allotted-resource-data.allotted-resource-oper-status.order-status' value='Created' />\n<parameter name='tx-ar.allotted-resource-data.allotted-resource-oper-status.last-action' value='`$tunnelxconn-topology-operation-input.request-information.request-action`' />\n<parameter name='tx-ar.allotted-resource-data.allotted-resource-oper-status.last-rpc-action' value='`$tunnelxconn-topology-operation-input.sdnc-request-header.svc-action`' />\n<parameter name='tx-ar.allotted-resource-data.allotted-resource-oper-status.last-svc-request-id' value='`$tunnelxconn-topology-operation-input.sdnc-request-header.svc-request-id`' />\n<parameter name='tx-ar.allotted-resource-data.allotted-resource-oper-status.create-timestamp' value='`$tmp.current-time`' />\n","comments":"","x":501.7542190551758,"y":701.0514001846313,"z":"a0656fc9.dda71","wires":[]},{"id":"12607b02.52cf0d","type":"set","name":"set tmp.ar.self-link","xml":"<set>\n<parameter name='tmp.ar.self-link' value=\"`'restconf/config/GENERIC-RESOURCE-API:tunnelxconn-allotted-resources/tunnelxconn-allotted-resource/'\n + $tmp.ar.allotted-resource-id\n + '/allotted-resource-data/tunnelxconn-topology/'` \" />\n\n","comments":"","x":457.73806381225586,"y":294.33332538604736,"z":"a0656fc9.dda71","wires":[]},{"id":"65d2a143.a02498","type":"set","name":"set tmp.ar.allotted-resource-id,etc","xml":"<set>\n<parameter name='tmp.ar.allotted-resource-id' value='`$tunnelxconn-topology-operation-input.allotted-resource-information.allotted-resource-id`' />\n<parameter name='tmp.ar.parent-service-instance-id' value='`$tunnelxconn-topology-operation-input.allotted-resource-information.parent-service-instance-id`' />\n\n\n","comments":"","x":504.9973258972168,"y":260.59259128570557,"z":"a0656fc9.dda71","wires":[]},{"id":"d55cad77.b93e8","type":"execute","name":"execute Properties","xml":"<execute plugin='org.onap.ccsdk.sli.plugins.prop.PropertiesNode' method='readProperties' >\n    <parameter name='fileName' value='%SDNC_CONFIG_DIR%/generic-resource-api-dg.properties' />\n    <parameter name='contextPrefix' value='prop' />\n","comments":"","outputs":1,"x":459.9934387207031,"y":330.231538772583,"z":"a0656fc9.dda71","wires":[[]]},{"id":"553c4aa3.391f5c","type":"execute","name":"execute RestApiCallNode - Get AR by id","xml":"<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.ar-url`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='GET' />\n    <parameter name=\"responsePrefix\" value=\"mdsal-ar\" />\n\n","comments":"","outputs":1,"x":526.5187530517578,"y":491.4594917297363,"z":"a0656fc9.dda71","wires":[["155d1e12.b38eca","4e5b7398.d535bc"]]},{"id":"3a9bef92.106bb8","type":"execute","name":"generate allotted-resource url","xml":"<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"`$prop.restapi.tx-allottedresource`\"/>\n    <parameter name=\"outputPath\" value=\"tmp.ar-url\"/>\n    <parameter name=\"target\" value=\"{allotted-resource-id}\"/>\n    <parameter name=\"replacement\" value=\"`$tmp.ar.allotted-resource-id`\"/>\n","comments":"","outputs":1,"x":492.0648536682129,"y":390.0172290802002,"z":"a0656fc9.dda71","wires":[[]]},{"id":"155d1e12.b38eca","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":783.8148918151855,"y":490.26725220680237,"z":"a0656fc9.dda71","wires":[["a49d870d.6f9f9"]]},{"id":"a0ff5ae9.3d78d","type":"execute","name":"execute RestApiCallNode - PUT AR by id","xml":"<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='templateFileName' value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.tx.templatefile`\" />\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.ar-url`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='PUT' />\n    <parameter name=\"responsePrefix\" value=\"mdsal-ar\" />\n\n","comments":"","outputs":1,"x":524.5293273925781,"y":827.7675542831421,"z":"a0656fc9.dda71","wires":[["809f9b2f.20f788","734166bb.7a654","97cc802e.7802a8"]]},{"id":"809f9b2f.20f788","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":832.8373680114746,"y":832.0991821289062,"z":"a0656fc9.dda71","wires":[["c3372b96.5f1ef8"]]},{"id":"734166bb.7a654","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":825.8373947143555,"y":792.5990890488029,"z":"a0656fc9.dda71","wires":[["c3372b96.5f1ef8"]]},{"id":"97cc802e.7802a8","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":829.5874328613281,"y":762.9561939239502,"z":"a0656fc9.dda71","wires":[["9a82c753.7dbcc8"]]},{"id":"c3372b96.5f1ef8","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating md-sal for tunnelxconn-allotted-resource\" />\n","comments":"","x":995.5874328613281,"y":793.3491128906608,"z":"a0656fc9.dda71","wires":[]},{"id":"a49d870d.6f9f9","type":"block","name":"block: atomic","xml":"<block atomic=\"true\">\n","atomic":"false","comments":"","outputs":1,"x":964.8148460388184,"y":490.7672016620636,"z":"a0656fc9.dda71","wires":[["ccd4fd88.fc652","2cb487af.45cae"]]},{"id":"ccd4fd88.fc652","type":"switchNode","name":"switch tx length","xml":"<switch test='`$mdsal-ar.tunnelxconn-allotted-resource_length`'>\n","comments":"","outputs":1,"x":1210.6720924377441,"y":525.052964925766,"z":"a0656fc9.dda71","wires":[["22044b6.7c5bfb4"]]},{"id":"22044b6.7c5bfb4","type":"other","name":"outcome 1","xml":"<outcome value='1'>\n","comments":"","outputs":1,"x":1401.6720962524414,"y":525.0529625415802,"z":"a0656fc9.dda71","wires":[["3548e370.cc89ac"]]},{"id":"72b5b919.dc519","type":"set","name":"set tx-ar from get","xml":"<set>\n<parameter name='tx-ar.' value='$mdsal-ar.tunnelxconn-allotted-resource[0].' />\n","comments":"","x":1801.5292320251465,"y":525.6243867874146,"z":"a0656fc9.dda71","wires":[]},{"id":"3548e370.cc89ac","type":"block","name":"block: atomic","xml":"<block atomic='true'>\n","atomic":"false","comments":"","outputs":1,"x":1572.5290794372559,"y":525.6244316101074,"z":"a0656fc9.dda71","wires":[["72b5b919.dc519","33b18d27.828412","71f5485a.2965b"]]},{"id":"33b18d27.828412","type":"set","name":"set oper-status","xml":"<set>\n<parameter name='tx-ar.allotted-resource-data.allotted-resource-oper-status.last-action' value='`$tx-ar.allotted-resource-data.allotted-resource-operation-information.request-information.request-action`' />\n<parameter name='tx-ar.allotted-resource-data.allotted-resource-oper-status.last-rpc-action' value='`$tx-ar.allotted-resource-status.rpc-action`' />\n<parameter name='tx-ar.allotted-resource-data.allotted-resource-oper-status.last-svc-request-id' value='`$tx-ar.allotted-resource-data.allotted-resource-operation-information.sdnc-request-header.svc-request-id`' />\n\n","comments":"","x":1799.5294761657715,"y":593.0529508590698,"z":"a0656fc9.dda71","wires":[]},{"id":"b5fd1939.50b4f","type":"comment","name":"GET tunnelxconn-allotted-resource from mdsal","info":"","comments":"","x":551.8148155212402,"y":454.7671926021576,"z":"a0656fc9.dda71","wires":[]},{"id":"71f5485a.2965b","type":"switchNode","name":"switch order-status","xml":"<switch test='`$tx-ar.allotted-resource-data.allotted-resource-oper-status.order-status`'>\n","comments":"","outputs":1,"x":1809.52925491333,"y":558.6243848800659,"z":"a0656fc9.dda71","wires":[["56b2c752.d80ac8","52e4d4ef.beb2f4"]]},{"id":"56b2c752.d80ac8","type":"outcome","name":"outcome PendingCreate","xml":"<outcome value='PendingCreate'>\n","comments":"","outputs":1,"x":2021.1292114257812,"y":519.6243848800659,"z":"a0656fc9.dda71","wires":[["ac5e40f1.eb36e"]]},{"id":"52e4d4ef.beb2f4","type":"outcome","name":"outcome Other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":2046.8435859680176,"y":555.052975654602,"z":"a0656fc9.dda71","wires":[["ac5e40f1.eb36e"]]},{"id":"e8154b92.d1c34","type":"comment","name":"Set allotted-resource-identifiers","info":"","comments":"","x":507.33863830566406,"y":545.3386459350586,"z":"a0656fc9.dda71","wires":[]},{"id":"2cb487af.45cae","type":"set","name":"save backup copy of mdsal-ar for rollback","xml":"<set>\n<parameter name='bk-tx-ar' value='$mdsal-ar.' />\n","comments":"","x":1290.3864250183105,"y":490.76729369163513,"z":"a0656fc9.dda71","wires":[]},{"id":"8ddb0233.e7d7a8","type":"comment","name":"Create urls for restapi","info":"","comments":"","x":462.9576606750488,"y":359.6243562698364,"z":"a0656fc9.dda71","wires":[]},{"id":"9a82c753.7dbcc8","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":971.2434005737305,"y":759.1483631134033,"z":"a0656fc9.dda71","wires":[[]]},{"id":"3005f865.958118","type":"comment","name":"TO DO: vnf/put parent","info":"","comments":"","x":475.2433776855469,"y":766.4815540313718,"z":"a0656fc9.dda71","wires":[]},{"id":"49a09902.0d6ba","type":"execute","name":"execute getTime","xml":"<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='setTime' >\n    <parameter name=\"outputPath\" value=\"tmp.current-time\" />\n\n","comments":"","outputs":1,"x":449.24338150024414,"y":662.4815549850464,"z":"a0656fc9.dda71","wires":[[]]},{"id":"4e5b7398.d535bc","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":783.5766868591309,"y":526.4814250469208,"z":"a0656fc9.dda71","wires":[["825538dc.9a5e38"]]},{"id":"825538dc.9a5e38","type":"block","name":"block: atomic","xml":"<block atomic=\"true\">\n","atomic":"false","comments":"","outputs":1,"x":963.5766372680664,"y":527.1479756832123,"z":"a0656fc9.dda71","wires":[[]]},{"id":"5f18d90c.45cb9","type":"set","name":"set id","xml":"<set>\n<parameter name='tx-ar.allotted-resource-id' value=\"`$tmp.ar.allotted-resource-id` \" />\n<parameter name='tx-ar.allotted-resource-status.action' value=\"`$tunnelxconn-topology-operation-input.request-information.request-action` \" />\n<parameter name='tx-ar.allotted-resource-status.rpc-name' value=\"tunnelxconn-topology-operation\" />\n<parameter name='tx-ar.allotted-resource-status.rpc-action' value=\"`$tunnelxconn-topology-operation-input.sdnc-request-header.svc-action` \" />\n<parameter name='tx-ar.allotted-resource-data.allotted-resource-operation-information.request-information.' value=\"`$tunnelxconn-topology-operation-input.request-information.` \" />\n<parameter name='tx-ar.allotted-resource-data.allotted-resource-operation-information.sdnc-request-header.' value=\"`$tunnelxconn-topology-operation-input.sdnc-request-header.` \" />\n<parameter name='tx-ar.allotted-resource-data.allotted-resource-operation-information.service-information.' value=\"`$tunnelxconn-topology-operation-input.service-information.` \" />\n<parameter name='tx-ar.allotted-resource-data.allotted-resource-operation-information.allotted-resource-information.' value=\"`$tunnelxconn-topology-operation-input.allotted-resource-information.` \" />\n<parameter name='tx-ar.allotted-resource-data.allotted-resource-operation-information.tunnelxconn-request-input.' value=\"`$tunnelxconn-topology-operation-input.tunnelxconn-request-input.` \" />","comments":"","x":424.24343490600586,"y":584.1481971740723,"z":"a0656fc9.dda71","wires":[]},{"id":"ac5e40f1.eb36e","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":2235.5997276306152,"y":521.0000190734863,"z":"a0656fc9.dda71","wires":[[]]},{"id":"d532def2.cf163","type":"execute","name":"execute RestApiCallNode - setup vgMUX-vG vxlan tunnel port","xml":"<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='templateFileName' value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.vpp.vxlan-tunnel.templatefile`\" />\n    <parameter name='restapiUrl' value='`$tmp.honeycomb.url + $tmp.vpp-honeycomb-url`' />\n    <parameter name='restapiUser' value='`$prop.honeycomb.user`' />\n    <parameter name='restapiPassword' value='`$prop.honeycomb.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='PUT' />\n    <parameter name=\"responsePrefix\" value=\"honeycomb-vnf\" />\n\n","comments":"","outputs":1,"x":586.8331909179688,"y":1542.4521162509918,"z":"a0656fc9.dda71","wires":[["924bd69e.71f6f","25e52ca9.23d86c","236361e0.d15986"]]},{"id":"924bd69e.71f6f","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":951.1413116455078,"y":1584.783754967153,"z":"a0656fc9.dda71","wires":[["940005c0.168b48"]]},{"id":"25e52ca9.23d86c","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":942.1413612365723,"y":1553.2837807163596,"z":"a0656fc9.dda71","wires":[["940005c0.168b48"]]},{"id":"236361e0.d15986","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":945.8913993835449,"y":1523.640885591507,"z":"a0656fc9.dda71","wires":[["40938803.f5d7a8"]]},{"id":"940005c0.168b48","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating md-sal for tunnelxconn-allotted-resource\" />\n","comments":"","x":1111.891399383545,"y":1554.0338045582175,"z":"a0656fc9.dda71","wires":[]},{"id":"40938803.f5d7a8","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1087.5473670959473,"y":1519.83305478096,"z":"a0656fc9.dda71","wires":[[]]},{"id":"cc52eced.06ff9","type":"set","name":"set vgMUX-vG VXLAN Tunnel Port Props","xml":"<set>\n<parameter name='tmp.tunnel-name' value=\"`$tmp.tunnel-vgMUX-vG-name` \" />\n<parameter name='tmp.tunnel-dest-ip' value=\"`$tx-ar.allotted-resource-data.tunnelxconn-topology.tunnelxconn-assignments.vg-ip` \" />\n<parameter name='tmp.tunnel-src-ip' value=\"`$tx-ar.allotted-resource-data.tunnelxconn-topology.tunnelxconn-assignments.vgmux-bearer-ip` \" />\n<parameter name='tmp.tunnel-vni' value=\"`$tx-ar.allotted-resource-data.tunnelxconn-topology.tunnelxconn-assignments.vni` \" />","comments":"","x":521.9443817138672,"y":1434.7860252857208,"z":"a0656fc9.dda71","wires":[]},{"id":"8d87f176.05e24","type":"execute","name":"generate full vgMUX-vG vpp-honeycomb url","xml":"<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"`$prop.restapi.vpp-honeycomb`\"/>\n    <parameter name=\"outputPath\" value=\"tmp.vpp-honeycomb-url\"/>\n    <parameter name=\"target\" value=\"{tunnel-name}\"/>\n    <parameter name=\"replacement\" value=\"`$tmp.tunnel-name`\"/>\n","comments":"","outputs":1,"x":525.9443817138672,"y":1501.4522392749786,"z":"a0656fc9.dda71","wires":[[]]},{"id":"543956f5.68f59","type":"execute","name":"generate honeycomb-url to vgMUX","xml":"<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"`$prop.honeycomb.url`\"/>\n    <parameter name=\"outputPath\" value=\"tmp.honeycomb.url\"/>\n    <parameter name=\"target\" value=\"{honeycomb-instance-ip}\"/>\n    <parameter name=\"replacement\" value=\"`$tx-ar.allotted-resource-data.tunnelxconn-topology.tunnelxconn-assignments.vgmux-mgmt-ip`\"/>\n","comments":"","outputs":1,"x":505.2776794433594,"y":1373.119027376175,"z":"a0656fc9.dda71","wires":[[]]},{"id":"e41bf1b.ed0471","type":"execute","name":"execute RestApiCallNode - setup vgMUX-vBRG vxlan tunnel xconnect","xml":"<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='templateFileName' value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.vpp.xconnect.templatefile`\" />\n    <parameter name='restapiUrl' value=\"`$tmp.honeycomb.url + $tmp.vpp-honeycomb-url + '/v3po:l2' `\" />\n    <parameter name='restapiUser' value='`$prop.honeycomb.user`' />\n    <parameter name='restapiPassword' value='`$prop.honeycomb.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='PUT' />\n    <parameter name=\"responsePrefix\" value=\"honeycomb-vnf\" />\n\n","comments":"","outputs":1,"x":602.5001220703125,"y":1960.000272989273,"z":"a0656fc9.dda71","wires":[["40f64f13.8dfae","a00a935e.ac2978","d6ca5c98.c2f658"]]},{"id":"40f64f13.8dfae","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":932.8082027435303,"y":1998.331808231771,"z":"a0656fc9.dda71","wires":[["e653ae28.b63b3"]]},{"id":"a00a935e.ac2978","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":923.8082523345947,"y":1966.8318339809775,"z":"a0656fc9.dda71","wires":[["e653ae28.b63b3"]]},{"id":"d6ca5c98.c2f658","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":927.5582904815674,"y":1937.1889388561249,"z":"a0656fc9.dda71","wires":[["409056a6.973c2"]]},{"id":"e653ae28.b63b3","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating md-sal for tunnelxconn-allotted-resource\" />\n","comments":"","x":1093.5582904815674,"y":1967.5818578228354,"z":"a0656fc9.dda71","wires":[]},{"id":"409056a6.973c2","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1069.2142581939697,"y":1933.381108045578,"z":"a0656fc9.dda71","wires":[[]]},{"id":"c4ca9f8b.96254","type":"set","name":"set vgMUX to vG and vgMUX to vBRG VXLAN Tunnel Name","xml":"<set>\n<parameter name='tmp.tunnel-vgMUX-vG-name' value=\"`'vxlanTun' + $tx-ar.allotted-resource-data.tunnelxconn-topology.tunnelxconn-assignments.vg-ip` \" />\n<parameter name='tmp.tunnel-vgMUX-vBRG-name' value=\"`'vxlanTun' + $tx-ar.allotted-resource-data.tunnelxconn-topology.tunnelxconn-assignments.vbrg-wan-ip` \" />\n","comments":"","x":579.0001220703125,"y":1018.6667947769165,"z":"a0656fc9.dda71","wires":[]},{"id":"3b28aa19.65e62e","type":"set","name":"set vgMUX-vBRG VXLAN Tunnel Port Props","xml":"<set>\n<parameter name='tmp.tunnel-name' value=\"`$tmp.tunnel-vgMUX-vBRG-name` \" />\n<parameter name='tmp.tunnel-dest-ip' value=\"`$tx-ar.allotted-resource-data.tunnelxconn-topology.tunnelxconn-assignments.vbrg-wan-ip` \" />\n<parameter name='tmp.tunnel-src-ip' value=\"`$tx-ar.allotted-resource-data.tunnelxconn-topology.tunnelxconn-assignments.vgmux-lan-ip` \" />\n<parameter name='tmp.tunnel-vni' value=\"`$tx-ar.allotted-resource-data.tunnelxconn-topology.tunnelxconn-assignments.vni` \" />","comments":"","x":534.0001220703125,"y":1640.3334667682648,"z":"a0656fc9.dda71","wires":[]},{"id":"b2c28342.d9721","type":"execute","name":"execute RestApiCallNode - setup vgMUX-vBRG vxlan tunnel port","xml":"<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='templateFileName' value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.vpp.vxlan-tunnel.templatefile`\" />\n    <parameter name='restapiUrl' value='`$tmp.honeycomb.url + $tmp.vpp-honeycomb-url`' />\n    <parameter name='restapiUser' value='`$prop.honeycomb.user`' />\n    <parameter name='restapiPassword' value='`$prop.honeycomb.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='PUT' />\n    <parameter name=\"responsePrefix\" value=\"honeycomb-vnf\" />\n\n","comments":"","outputs":1,"x":586.0000915527344,"y":1800.3334696292877,"z":"a0656fc9.dda71","wires":[["8d18a5ff.3d88c","3d920785.09aed8","ac165b02.b084c8"]]},{"id":"8d18a5ff.3d88c","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":952.3081817626953,"y":1782.6650616154075,"z":"a0656fc9.dda71","wires":[["2df9823e.abe206"]]},{"id":"3d920785.09aed8","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":943.3082313537598,"y":1751.165087364614,"z":"a0656fc9.dda71","wires":[["2df9823e.abe206"]]},{"id":"ac165b02.b084c8","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":947.0582695007324,"y":1721.5221922397614,"z":"a0656fc9.dda71","wires":[["157122c.0b10c5d"]]},{"id":"2df9823e.abe206","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating md-sal for tunnelxconn-allotted-resource\" />\n","comments":"","x":1113.0582695007324,"y":1751.915111206472,"z":"a0656fc9.dda71","wires":[]},{"id":"157122c.0b10c5d","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1088.7142372131348,"y":1717.7143614292145,"z":"a0656fc9.dda71","wires":[[]]},{"id":"b047a9c4.e403f8","type":"execute","name":"generate full vgMUX-vBRG vpp-honeycomb url","xml":"<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"`$prop.restapi.vpp-honeycomb`\"/>\n    <parameter name=\"outputPath\" value=\"tmp.vpp-honeycomb-url\"/>\n    <parameter name=\"target\" value=\"{tunnel-name}\"/>\n    <parameter name=\"replacement\" value=\"`$tmp.tunnel-name`\"/>\n","comments":"","outputs":1,"x":538.0000610351562,"y":1692.3334228992462,"z":"a0656fc9.dda71","wires":[[]]},{"id":"b6b159ec.524da","type":"set","name":"set vgMUX-vBG xconnect url","xml":"<set>\n<parameter name='tmp.tunnel-name' value=\"`$tmp.tunnel-vgMUX-vG-name` \" />","comments":"","x":472.0000801086426,"y":2028.3334791660309,"z":"a0656fc9.dda71","wires":[]},{"id":"af2b59b0.78298","type":"execute","name":"generate full vgMUX-vG xconnect url","xml":"<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"`$prop.restapi.vpp-honeycomb`\"/>\n    <parameter name=\"outputPath\" value=\"tmp.vpp-honeycomb-url\"/>\n    <parameter name=\"target\" value=\"{tunnel-name}\"/>\n    <parameter name=\"replacement\" value=\"`$tmp.tunnel-name`\"/>\n","comments":"","outputs":1,"x":500.0000305175781,"y":2090.333482027054,"z":"a0656fc9.dda71","wires":[[]]},{"id":"9eb192c2.c1a4a","type":"set","name":"set xconnect Tunnel target","xml":"<set>\n<parameter name='tmp.tunnel-name' value=\"`$tmp.tunnel-vgMUX-vBRG-name` \" />\n","comments":"","x":468.0000762939453,"y":2158.3334839344025,"z":"a0656fc9.dda71","wires":[]},{"id":"96a57432.cd3f48","type":"set","name":"set xconnect Tunnel target","xml":"<set>\n<parameter name='tmp.tunnel-name' value=\"`$tmp.tunnel-vgMUX-vG-name` \" />\n","comments":"","x":460.00012969970703,"y":1864.3334696292877,"z":"a0656fc9.dda71","wires":[]},{"id":"56b12519.af5d7c","type":"execute","name":"execute RestApiCallNode - setup vgMUX-vG vxlan tunnel xconnect","xml":"<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='templateFileName' value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.vpp.xconnect.templatefile`\" />\n    <parameter name='restapiUrl' value=\"`$tmp.honeycomb.url + $tmp.vpp-honeycomb-url + '/v3po:l2' `\" />\n    <parameter name='restapiUser' value='`$prop.honeycomb.user`' />\n    <parameter name='restapiPassword' value='`$prop.honeycomb.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='PUT' />\n    <parameter name=\"responsePrefix\" value=\"honeycomb-vnf\" />\n\n","comments":"","outputs":1,"x":596.0000915527344,"y":2246.333485841751,"z":"a0656fc9.dda71","wires":[["567f008d.530b38","7391da9b.52c7ac","d4f8e79f.58389"]]},{"id":"567f008d.530b38","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":926.3081722259521,"y":2284.665021084249,"z":"a0656fc9.dda71","wires":[["b0cbf535.cca87"]]},{"id":"7391da9b.52c7ac","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":917.3082218170166,"y":2253.1650468334556,"z":"a0656fc9.dda71","wires":[["b0cbf535.cca87"]]},{"id":"d4f8e79f.58389","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":921.0582599639893,"y":2223.522151708603,"z":"a0656fc9.dda71","wires":[["eec2eb05.db5c68"]]},{"id":"b0cbf535.cca87","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating md-sal for tunnelxconn-allotted-resource\" />\n","comments":"","x":1085.0583305358887,"y":2253.9151890277863,"z":"a0656fc9.dda71","wires":[]},{"id":"eec2eb05.db5c68","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1062.7142276763916,"y":2219.714320898056,"z":"a0656fc9.dda71","wires":[[]]},{"id":"83ccddb3.a48628","type":"comment","name":"Get vgmux-mgmt-ip","info":"","comments":"","x":269.3334274291992,"y":1067.0002641677856,"z":"a0656fc9.dda71","wires":[]},{"id":"16acd9a9.cf4c3e","type":"get-resource","name":"get-resource IPADDR from dmaap DHCP_MAP ","xml":"<get-resource plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource' resource='IPADDR' key=\"SELECT min(ip_addr) ip from DHCP_MAP where mac_addr = $tx-ar.allotted-resource-data.allotted-resource-operation-information.tunnelxconn-request-input.brg-wan-mac-address\" pfx=\"tmp.brg-wan-ip\" >\n","comments":"","outputs":1,"x":540.0000152587891,"y":907.6666488647461,"z":"a0656fc9.dda71","wires":[[]]},{"id":"ed7953e3.9a1dd","type":"set","name":"set tunnelxconn-ar.allotted-resource-data.tunnelxconn-topology.tunnelxconn-assignments.vbrg-wan-ip","xml":"<set>\n<parameter name='tx-ar.allotted-resource-data.tunnelxconn-topology.tunnelxconn-assignments.vbrg-wan-ip' value='`$tmp.brg-wan-ip.ip`' />\n","comments":"","x":711.597412109375,"y":963.5832824707031,"z":"a0656fc9.dda71","wires":[]},{"id":"a7d43db8.11ef7","type":"call","name":"call GENERIC-RESOURCE-API:get-vnf-api-parent-instance","xml":"<call module='GENERIC-RESOURCE-API' rpc='get-vnf-api-parent-instance' mode='sync' >\n\n","comments":"","outputs":1,"x":576.8182067871094,"y":1173.8786926269531,"z":"a0656fc9.dda71","wires":[[]]},{"id":"29793093.a5cc08","type":"set","name":"set tmp.search.parent-service-instance-id to find vgmux-mgmt-ip","xml":"<set>\n<parameter name='tmp.search.parent-service-instance-id' value='`$tmp.ar.parent-service-instance-id`' />\n","comments":"","x":585.8485412597656,"y":1117.9696044921875,"z":"a0656fc9.dda71","wires":[]},{"id":"cdc07dd4.4d57a","type":"set","name":"set vgmux-mgmt-ip","xml":"<set>\n<parameter name='tx-ar.allotted-resource-data.tunnelxconn-topology.tunnelxconn-assignments.vgmux-mgmt-ip' value='`$parent-service-instance.service-data.vnf-topology-information.vnf-parameters[$paramidx].vnf-parameter-value`' />\n<!--\n<parameter name='tx-ar.allotted-resource-data.tunnelxconn-topology.tunnelxconn-assignments.vgmux-mgmt-ip' value='`$parent-service-instance.vnf-topology-information.vnf-parameters[$paramidx].vnf-parameter-value`' />\n\n-->","comments":"","x":1331.666488647461,"y":1281.000111579895,"z":"a0656fc9.dda71","wires":[]},{"id":"d71aa0a1.4f6ba","type":"for","name":"for vnf-parameters in parent-service-instance","xml":"<for index='paramidx' start='0' end='`$parent-service-instance.service-data.vnf-topology-information.vnf-parameters_length`' >\n<!--\n<for index='paramidx' start='0' end='`$parent-service-instance.vnf-topology-information.vnf-parameters_length`' >\n-->","comments":"","outputs":1,"x":531.666633605957,"y":1285.9997749328613,"z":"a0656fc9.dda71","wires":[["6d5d0bfe.6c00cc"]]},{"id":"6d5d0bfe.6c00cc","type":"switchNode","name":"switch parameter matches vgmux_private_ip_1","xml":"<switch test='`$parent-service-instance.service-data.vnf-topology-information.vnf-parameters[$paramidx].vnf-parameter-name == vgmux_private_ip_1`'>\n<!--\n<switch test='`$parent-service-instance.vnf-topology-information.vnf-parameters[$paramidx].vnf-parameter-name == vgmux_private_ip_1`'>\n-->\n\n\n","comments":"","outputs":1,"x":903.000114440918,"y":1284.9997787475586,"z":"a0656fc9.dda71","wires":[["67516516.43e044"]]},{"id":"67516516.43e044","type":"success","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":1161.66646194458,"y":1282.6665105819702,"z":"a0656fc9.dda71","wires":[["cdc07dd4.4d57a"]]},{"id":"f628720e.e34c48","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n","comments":"","x":167,"y":1284,"z":"a0656fc9.dda71","wires":[]},{"id":"8781404d.98ab08","type":"execute","name":"execute printContext","xml":"<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='printContext' >\n<parameter name='filename' value='/var/tmp/tunnel-xconn-create.log' />\n","comments":"","outputs":1,"x":508.3796691894531,"y":1584.8198165893555,"z":"a0656fc9.dda71","wires":[[]]},{"id":"da0f6bfc.76bbe","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n","comments":"","x":212.7272491455078,"y":1640,"z":"a0656fc9.dda71","wires":[]},{"id":"dd9f04d8.f9b078","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n","comments":"","x":1097.272705078125,"y":931.8181915283203,"z":"a0656fc9.dda71","wires":[]}]
