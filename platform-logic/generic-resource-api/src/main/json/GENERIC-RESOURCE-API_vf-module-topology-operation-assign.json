[{"id":"2d9a5021.a73fc","type":"dgstart","name":"DGSTART","outputs":1,"x":103.33332824707031,"y":92.0242999792099,"z":"c281e2a0.b9793","wires":[["7af2ba16.efbe04"]]},{"id":"7af2ba16.efbe04","type":"service-logic","name":"GENERIC-RESOURCE-API ${project.version}","module":"GENERIC-RESOURCE-API","version":"${project.version}","comments":"","xml":"<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>","outputs":1,"x":217.1904640197754,"y":131.83383786678314,"z":"c281e2a0.b9793","wires":[["9cd2d55b.54c678"]]},{"id":"9cd2d55b.54c678","type":"method","name":"method vf-module-topology-operation-assign","xml":"<method rpc='vf-module-topology-operation-assign' mode='sync'>\n","comments":"","outputs":1,"x":216.76195526123047,"y":172.0242999792099,"z":"c281e2a0.b9793","wires":[["fcb16772.796c08"]]},{"id":"84ba5ebf.ff60a","type":"comment","name":"vf-module-topology-operation-assign","info":"","comments":"","x":508.65442657470703,"y":34.99999940395355,"z":"c281e2a0.b9793","wires":[]},{"id":"ded68ff0.3a928","type":"switchNode","name":"switch request-action","xml":"<switch test='`$vf-module-topology-operation-input.request-information.request-action`'>\n","comments":"","outputs":1,"x":508.5238380432129,"y":347.54812228679657,"z":"c281e2a0.b9793","wires":[["68c9565e.9ca968","c3025ff2.eb1a4"]]},{"id":"68c9565e.9ca968","type":"outcome","name":"CreateVfModuleInstance","xml":"<outcome value='CreateVfModuleInstance'>\n","comments":"","outputs":1,"x":770.5714530944824,"y":324.69100844860077,"z":"c281e2a0.b9793","wires":[["c4aed937.2735f8"]]},{"id":"c3025ff2.eb1a4","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":714.2380981445312,"y":370.0719975233078,"z":"c281e2a0.b9793","wires":[["6602e840.996b48"]]},{"id":"c4aed937.2735f8","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":960.428617477417,"y":324.6910399198532,"z":"c281e2a0.b9793","wires":[[]]},{"id":"6602e840.996b48","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"If svc-action is 'assign' then request-action must be 'CreateVfModuleInstance'\" />\n","comments":"","x":979.2381057739258,"y":370.4053100347519,"z":"c281e2a0.b9793","wires":[]},{"id":"93af21a0.ebb87","type":"get-resource","name":"get-resource VF_MODULE_MODEL","xml":"<get-resource plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource' resource='SQL'\n  key='SELECT * from VF_MODULE_MODEL WHERE customization_uuid = $vf-module-topology-operation-input.vf-module-information.onap-model-information.model-customization-uuid'\n  pfx='db.vf-module-model'>\n\n","comments":"","outputs":1,"x":555.857105255127,"y":438.69107234477997,"z":"c281e2a0.b9793","wires":[["cc299718.add008","2fc346d7.b7eeaa"]]},{"id":"cc2e38cf.3deaa8","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'No model found for VF module customization UUID ' + $vf-module-topology-operation-input.vf-module-information.onap-model-information.model-customization-uuid`\" />\n","comments":"","x":997.2855262756348,"y":463.11954486370087,"z":"c281e2a0.b9793","wires":[]},{"id":"cc299718.add008","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":821.6427955627441,"y":419.0719031095505,"z":"c281e2a0.b9793","wires":[["1820f554.21472b"]]},{"id":"2fc346d7.b7eeaa","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":830.214225769043,"y":463.35761630535126,"z":"c281e2a0.b9793","wires":[["cc2e38cf.3deaa8"]]},{"id":"1820f554.21472b","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error reading VF_MODULE_MODEL table\" />\n","comments":"","x":996.6427268981934,"y":418.2148035764694,"z":"c281e2a0.b9793","wires":[]},{"id":"1fc7e563.9fd97b","type":"switchNode","name":"switch service-data.vnfs.vnf_length","xml":"<switch test='`$service-data.vnfs.vnf_length`'>\n","comments":"","outputs":1,"x":550.9523696899414,"y":647.2624076604843,"z":"c281e2a0.b9793","wires":[["be99c605.d53058","162bb610.abeb1a"]]},{"id":"be99c605.d53058","type":"other","name":"NULL","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":791.6666412353516,"y":624.4051479101181,"z":"c281e2a0.b9793","wires":[["e8dafdc2.bb5f3"]]},{"id":"162bb610.abeb1a","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":791.4284820556641,"y":665.3576663732529,"z":"c281e2a0.b9793","wires":[["d00d1f75.bb2b6"]]},{"id":"53d50dfc.924b64","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":129.52376556396484,"y":3128.9293060302734,"z":"c281e2a0.b9793","wires":[["7bd98255.dbf20c","73e41686.118588","c4bc8ce5.99831","75bfb79b.e8b428","e56ad2ae.3e458","9f83de03.191b2","a2b2f4bb.0b2c18","3c2d8086.e91e4","904ff883.8a93b8","74fef761.5900c8","8c426d11.4eff9","248e182d.ced848","29643f29.61c8b","3d7e906e.ebd9d","9567a7bf.617988","7146fa07.61fea4","4de8c9e1.b8f3c8","874eaff1.71395","d48930e4.19e86","41677f15.139e7","6782300a.2a6c","d2581847.10cc78","a5403308.f3a28","e28c7bde.2c20f8","b3a603a5.80e31","c04c47f5.514678","cdfcaf85.62d64","47fa3ee6.d0e38","e81704f9.71e908","3701ddfc.549122"]]},{"id":"e8dafdc2.bb5f3","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"There are no VNFs defined in MD-SAL\" />\n","comments":"","x":958.3332557678223,"y":623.6909030675888,"z":"c281e2a0.b9793","wires":[]},{"id":"d00d1f75.bb2b6","type":"for","name":"for each vnf","xml":"<for index='idx' start='0' end='`$service-data.vnfs.vnf_length`' >\n","comments":"","outputs":1,"x":953.6666259765625,"y":665.0242847204208,"z":"c281e2a0.b9793","wires":[["14386756.4e8489"]]},{"id":"14386756.4e8489","type":"switchNode","name":"switch service data vnf == input vnf","xml":"<switch test='`$service-data.vnfs.vnf[$idx].vnf-id == $vf-module-topology-operation-input.vnf-information.vnf-id`'>\n","comments":"","outputs":1,"x":1204.9999237060547,"y":664.6910127401352,"z":"c281e2a0.b9793","wires":[["37865014.a062a"]]},{"id":"37865014.a062a","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":1434.9999351501465,"y":664.0243257284164,"z":"c281e2a0.b9793","wires":[["163851b5.a752ee"]]},{"id":"1c73f9f3.baee96","type":"set","name":"set vnf-index to -1","xml":"<set>\n<parameter name='vnf-index' value='-1' />\n","comments":"","x":499.99999237060547,"y":578.6909068822861,"z":"c281e2a0.b9793","wires":[]},{"id":"f86c2fde.aa2bd","type":"set","name":"set vnf-index to idx","xml":"<set>\n<parameter name='vnf-index' value='`$idx`' />\n","comments":"","x":1756.6665725708008,"y":635.0242837667465,"z":"c281e2a0.b9793","wires":[]},{"id":"f91c0c48.6c834","type":"switchNode","name":"switch vnf-index","xml":"<switch test='`$vnf-index`'>\n","comments":"","outputs":1,"x":490,"y":715.357603430748,"z":"c281e2a0.b9793","wires":[["bed1bf89.09f41"]]},{"id":"bed1bf89.09f41","type":"outcome","name":"-1","xml":"<outcome value='-1'>\n","comments":"","outputs":1,"x":668.3333854675293,"y":714.6909793615341,"z":"c281e2a0.b9793","wires":[["fa5b072.c38b3f8"]]},{"id":"fa5b072.c38b3f8","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unable to find VNF ID ' + $vf-module-topology-operation-input.vnf-information.vnf-id + ' in MD-SAL'`\" />\n","comments":"","x":828.3332939147949,"y":714.0242828130722,"z":"c281e2a0.b9793","wires":[]},{"id":"7bd98255.dbf20c","type":"switchNode","name":"switch vf-module_length","xml":"<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length`'>\n","comments":"","outputs":1,"x":506.66672134399414,"y":1345.3577998876572,"z":"c281e2a0.b9793","wires":[["d1063b3e.8399a8","51fbb1de.23513"]]},{"id":"d1063b3e.8399a8","type":"other","name":"NULL","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":764.0476760864258,"y":1312.500573515892,"z":"c281e2a0.b9793","wires":[["3a248c3c.12aaa4"]]},{"id":"3a248c3c.12aaa4","type":"set","name":"set vf-module-index=0","xml":"<set>\n<parameter name='vf-module-index' value='0' />\n","comments":"","x":951.6667137145996,"y":1313.167348265648,"z":"c281e2a0.b9793","wires":[]},{"id":"51fbb1de.23513","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":764.4762191772461,"y":1376.786431670189,"z":"c281e2a0.b9793","wires":[["8ee77525.004438"]]},{"id":"a28b9cf0.20c42","type":"set","name":"set vf-module-index = vf-module_length","xml":"<set>\n<parameter name='vf-module-index' value='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length`' />\n","comments":"","x":1149.6667594909668,"y":1356.9768270254135,"z":"c281e2a0.b9793","wires":[]},{"id":"ce1be7a8.7c3d08","type":"for","name":"for each existing VF module","xml":"<for index='idx' start='0' end='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length`' >\n","comments":"","outputs":1,"x":1108.7618522644043,"y":1401.0720571279526,"z":"c281e2a0.b9793","wires":[["d81c79b.6803388"]]},{"id":"8ee77525.004438","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":901.1904983520508,"y":1376.7863572835922,"z":"c281e2a0.b9793","wires":[["a28b9cf0.20c42","ce1be7a8.7c3d08"]]},{"id":"d81c79b.6803388","type":"switchNode","name":"switch vf-module-information.vf-module-id == service-data.vnfs.vnf[].vf-modules.vf-module[].vf-module-id","xml":"<switch test='`$vf-module-topology-operation-input.vf-module-information.vf-module-id == $service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$idx].vf-module-id`'>\n","comments":"","outputs":1,"x":1612.3809547424316,"y":1400.643468260765,"z":"c281e2a0.b9793","wires":[["3b48a680.2d71fa"]]},{"id":"3b48a680.2d71fa","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":2055.0000038146973,"y":1400.2149194478989,"z":"c281e2a0.b9793","wires":[["e53e4394.1dd14"]]},{"id":"e53e4394.1dd14","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'VF module id ' + $service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$idx].vf-module-id\n       + ' already exists, and status is ' + $service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$idx].vf-module-data.vf-module-level-oper-status.order-status`\" />\n","comments":"","x":2206.904884338379,"y":1400.2149060964584,"z":"c281e2a0.b9793","wires":[]},{"id":"1db69374.c3c77d","type":"comment","name":"make sure this VF module doesn't exist already","info":"","comments":"","x":1638.8333015441895,"y":1355.2709602117538,"z":"c281e2a0.b9793","wires":[]},{"id":"73e41686.118588","type":"set","name":"set new vf-module_length","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length' value='`$vf-module-index + 1`' />\n","comments":"","x":517.3333015441895,"y":1456.357654929161,"z":"c281e2a0.b9793","wires":[]},{"id":"c4bc8ce5.99831","type":"set","name":"set vf-module-topology data","xml":"<set>\n<parameter name='tmp.vf-module-topology.vf-module-topology-identifier.vf-module-id' value='`$vf-module-topology-operation-input.vf-module-information.vf-module-id`' />\n<parameter name='tmp.vf-module-topology.vf-module-topology-identifier.vf-module-name' value='`$vf-module-topology-operation-input.vf-module-request-input.vf-module-name`' />\n<parameter name='tmp.vf-module-topology.vf-module-topology-identifier.vf-module-type' value='`$vf-module-topology-operation-input.vf-module-information.vf-module-type`' />\n<parameter name='tmp.vf-module-topology.tenant' value='`$vf-module-topology-operation-input.vf-module-request-input.tenant`' />\n<parameter name='tmp.vf-module-topology.aic-cloud-region' value='`$vf-module-topology-operation-input.vf-module-request-input.aic-cloud-region`' />\n","comments":"","x":523.8333206176758,"y":1568.8577617406845,"z":"c281e2a0.b9793","wires":[]},{"id":"f00c79c8.4ea308","type":"set","name":"set aic-clli","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.aic-clli'\n   value='`$aai-uid-split[$aai-uid-split_length - 1]`' />\n","comments":"","x":1284.7855796813965,"y":1728.0956882238388,"z":"c281e2a0.b9793","wires":[]},{"id":"75bfb79b.e8b428","type":"switchNode","name":"switch aic-clli","xml":"<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.aic-clli`'>\n","comments":"","outputs":1,"x":483.8332405090332,"y":1842.0480283498764,"z":"c281e2a0.b9793","wires":[["8457e1fa.daa57"]]},{"id":"8457e1fa.daa57","type":"outcome","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":629.1189308166504,"y":1842.0480970144272,"z":"c281e2a0.b9793","wires":[["c0499e5e.91fa6"]]},{"id":"c0499e5e.91fa6","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unable to find aic-clli in AAI for aic-cloud-region ' + $vf-module-topology-operation-input.vf-module-request-input.aic-cloud-region`\" />\n","comments":"","x":776.261791229248,"y":1841.6195310354233,"z":"c281e2a0.b9793","wires":[]},{"id":"e56ad2ae.3e458","type":"get-resource","name":"get-resource cloud region","xml":"<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"cloud-region\" \n\t\tkey=\"cloud-region.cloud-owner = $prop.cloud-region.cloud-owner AND \n\t\t     cloud-region.cloud-region-id = $vf-module-topology-operation-input.vf-module-request-input.aic-cloud-region\"\n        pfx='aai.cloud-region' local-only='false' >\n\n","comments":"","outputs":1,"x":522.6904563903809,"y":1642.1912997961044,"z":"c281e2a0.b9793","wires":[["6aa34830.c974d8","f9b5d3c8.7fc75"]]},{"id":"f9b5d3c8.7fc75","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":736.9366493225098,"y":1660.3421558141708,"z":"c281e2a0.b9793","wires":[["7aace544.2dd74c"]]},{"id":"7aace544.2dd74c","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error retrieving cloud region from AAI\" />\n","comments":"","x":911.9366226196289,"y":1660.3421920537949,"z":"c281e2a0.b9793","wires":[]},{"id":"6aa34830.c974d8","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":745.8652458190918,"y":1618.6278890371323,"z":"c281e2a0.b9793","wires":[["29f3627f.244d6e"]]},{"id":"29f3627f.244d6e","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Cloud region not found in AAI\" />\n","comments":"","x":912.2145233154297,"y":1617.9334663152695,"z":"c281e2a0.b9793","wires":[]},{"id":"163851b5.a752ee","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1583.333396911621,"y":662.9440244436264,"z":"c281e2a0.b9793","wires":[["f86c2fde.aa2bd","1b1f1fcd.8c776"]]},{"id":"1b1f1fcd.8c776","type":"break","name":"break","xml":"<break>\n","comments":"","x":1718.3333625793457,"y":684.6106103658676,"z":"c281e2a0.b9793","wires":[]},{"id":"bca2dc7a.e59f4","type":"set","name":"set from DB","xml":"<set>\n<parameter name='tmp.vf-module-topology.onap-model-information.model-invariant-uuid'\n  value='`$db.vf-module-model.invariant-uuid`' />\n","comments":"","x":898.1665802001953,"y":1883.4440215826035,"z":"c281e2a0.b9793","wires":[]},{"id":"9f83de03.191b2","type":"switchNode","name":"switch input model-invariant-uuid","xml":"<switch test='`$vf-module-topology-operation-input.vf-module-information.onap-model-information.model-invariant-uuid`'>\n","comments":"","outputs":1,"x":542.0236549377441,"y":1906.2684653997421,"z":"c281e2a0.b9793","wires":[["a9f807e7.281c98","4904267b.8c3e08"]]},{"id":"a9f807e7.281c98","type":"outcome","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":747.6903266906738,"y":1883.411428809166,"z":"c281e2a0.b9793","wires":[["bca2dc7a.e59f4"]]},{"id":"4904267b.8c3e08","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":749.1189231872559,"y":1927.6970199346542,"z":"c281e2a0.b9793","wires":[["6a656ab.7320b94"]]},{"id":"6a656ab.7320b94","type":"set","name":"set from input","xml":"<set>\n<parameter name='tmp.vf-module-topology.onap-model-information.model-invariant-uuid'\n  value='`$vf-module-topology-operation-input.vf-module-information.onap-model-information.model-invariant-uuid`' />\n","comments":"","x":903.4046592712402,"y":1927.1255921125412,"z":"c281e2a0.b9793","wires":[]},{"id":"123b74d.a39558b","type":"set","name":"set from DB","xml":"<set>\n<parameter name='tmp.vf-module-topology.onap-model-information.model-uuid'\n  value='`$db.vf-module-model.uuid`' />\n","comments":"","x":899.1188507080078,"y":1971.9826978445053,"z":"c281e2a0.b9793","wires":[]},{"id":"a2b2f4bb.0b2c18","type":"switchNode","name":"switch input model-uuid","xml":"<switch test='`$vf-module-topology-operation-input.vf-module-information.onap-model-information.model-uuid`'>\n","comments":"","outputs":1,"x":514.6426734924316,"y":1994.8072026968002,"z":"c281e2a0.b9793","wires":[["8e4c5daf.c12c","e8f34bfe.84a098"]]},{"id":"8e4c5daf.c12c","type":"outcome","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":748.6426467895508,"y":1971.9501346349716,"z":"c281e2a0.b9793","wires":[["123b74d.a39558b"]]},{"id":"e8f34bfe.84a098","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":750.0712432861328,"y":2016.23572576046,"z":"c281e2a0.b9793","wires":[["7a562a3f.415454"]]},{"id":"7a562a3f.415454","type":"set","name":"set from input","xml":"<set>\n<parameter name='tmp.vf-module-topology.onap-model-information.model-uuid'\n  value='`$vf-module-topology-operation-input.vf-module-information.onap-model-information.model-uuid`' />\n","comments":"","x":904.3569793701172,"y":2015.6642979383469,"z":"c281e2a0.b9793","wires":[]},{"id":"f1667332.fb679","type":"set","name":"set from DB","xml":"<set>\n<parameter name='tmp.vf-module-topology.onap-model-information.model-version'\n  value='`$db.vf-module-model.version`' />\n","comments":"","x":896.2617835998535,"y":2060.839905142784,"z":"c281e2a0.b9793","wires":[]},{"id":"3c2d8086.e91e4","type":"switchNode","name":"switch input model-version","xml":"<switch test='`$vf-module-topology-operation-input.vf-module-information.onap-model-information.model-version`'>\n","comments":"","outputs":1,"x":522.7855453491211,"y":2083.664349913597,"z":"c281e2a0.b9793","wires":[["2ecf8a2b.56e5b6","e5197406.efcf08"]]},{"id":"2ecf8a2b.56e5b6","type":"outcome","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":745.785530090332,"y":2060.8073123693466,"z":"c281e2a0.b9793","wires":[["f1667332.fb679"]]},{"id":"e5197406.efcf08","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":747.2141265869141,"y":2105.092903494835,"z":"c281e2a0.b9793","wires":[["1f679951.806f17"]]},{"id":"1f679951.806f17","type":"set","name":"set from input","xml":"<set>\n<parameter name='tmp.vf-module-topology.onap-model-information.model-version'\n  value='`$vf-module-topology-operation-input.vf-module-information.onap-model-information.model-version`' />\n","comments":"","x":901.4998626708984,"y":2104.521475672722,"z":"c281e2a0.b9793","wires":[]},{"id":"7576e19b.26deb","type":"set","name":"set from DB","xml":"<set>\n<parameter name='tmp.vf-module-topology.onap-model-information.model-name'\n  value='`$db.vf-module-model.name`' />\n","comments":"","x":896.2617835998535,"y":2147.982727408409,"z":"c281e2a0.b9793","wires":[]},{"id":"904ff883.8a93b8","type":"switchNode","name":"switch input model-name","xml":"<switch test='`$vf-module-topology-operation-input.vf-module-information.onap-model-information.model-name`'>\n","comments":"","outputs":1,"x":517.7855453491211,"y":2170.807172179222,"z":"c281e2a0.b9793","wires":[["b054211f.fbf68","2bfd5a29.d66f36"]]},{"id":"b054211f.fbf68","type":"outcome","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":745.785530090332,"y":2147.9501346349716,"z":"c281e2a0.b9793","wires":[["7576e19b.26deb"]]},{"id":"2bfd5a29.d66f36","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":747.2141265869141,"y":2192.23572576046,"z":"c281e2a0.b9793","wires":[["7070c1ef.3f726"]]},{"id":"7070c1ef.3f726","type":"set","name":"set from input","xml":"<set>\n<parameter name='tmp.vf-module-topology.onap-model-information.model-name'\n  value='`$vf-module-topology-operation-input.vf-module-information.onap-model-information.model-name`' />\n","comments":"","x":901.4998626708984,"y":2191.664297938347,"z":"c281e2a0.b9793","wires":[]},{"id":"74fef761.5900c8","type":"set","name":"set model-customization-uuid","xml":"<set>\n<parameter name='tmp.vf-module-topology.onap-model-information.model-customization-uuid'\n  value='`$vf-module-topology-operation-input.vf-module-information.onap-model-information.model-customization-uuid`' />\n","comments":"","x":532.2378807067871,"y":2243.3161615133286,"z":"c281e2a0.b9793","wires":[]},{"id":"8c426d11.4eff9","type":"set","name":"set vf-module-id","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-id'\n   value='`$vf-module-topology-operation-input.vf-module-information.vf-module-id`' />\n","comments":"","x":485.42852783203125,"y":1512.039337515831,"z":"c281e2a0.b9793","wires":[]},{"id":"248e182d.ced848","type":"for","name":"for each cloud-region relationship","xml":"<for index='idx' start='0' end='`$aai.cloud-region.relationship-list.relationship_length`' >\n","comments":"","outputs":1,"x":544.9442710876465,"y":1730.6979831457138,"z":"c281e2a0.b9793","wires":[["9fc47219.0a2e6"]]},{"id":"9fc47219.0a2e6","type":"switchNode","name":"switch related-to","xml":"<switch test='`$aai.cloud-region.relationship-list.relationship[$idx].related-to`'>\n","comments":"","outputs":1,"x":792.6228141784668,"y":1730.4479125738144,"z":"c281e2a0.b9793","wires":[["90f8324b.e01dd"]]},{"id":"90f8324b.e01dd","type":"outcome","name":"complex","xml":"<outcome value='complex'>\n","comments":"","outputs":1,"x":962.0871353149414,"y":1729.8407348394394,"z":"c281e2a0.b9793","wires":[["ca7ad58e.6dc9b8"]]},{"id":"151dbe70.34e1e2","type":"execute","name":"split related-link","xml":"<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='split'>\n   <parameter name='ctx_memory_result_key' value='aai-uid-split' />\n   <parameter name='original_string' value='`$aai.cloud-region.relationship-list.relationship[$idx].related-link`' />\n   <parameter name='regex' value='/' />\n","comments":"","outputs":1,"x":1302.1822929382324,"y":1684.2693103551865,"z":"c281e2a0.b9793","wires":[[]]},{"id":"ca7ad58e.6dc9b8","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":1121.8489952087402,"y":1730.9360984563828,"z":"c281e2a0.b9793","wires":[["151dbe70.34e1e2","42f33e9a.52f34","f00c79c8.4ea308"]]},{"id":"42f33e9a.52f34","type":"break","name":"break","xml":"<break>\n","comments":"","x":1271.8489570617676,"y":1774.2693952322006,"z":"c281e2a0.b9793","wires":[]},{"id":"6b1873f2.63696c","type":"execute","name":"execute PropertiesNode","xml":"<execute plugin='org.onap.ccsdk.sli.plugins.prop.PropertiesNode' method='readProperties' >\n    <parameter name='fileName' value='%SDNC_CONFIG_DIR%/generic-resource-api-dg.properties' />\n    <parameter name='contextPrefix' value='prop' />\n","comments":"","outputs":1,"x":522.3809509277344,"y":201.54810750484467,"z":"c281e2a0.b9793","wires":[[]]},{"id":"d48930e4.19e86","type":"set","name":"set order-status to PendingCreate","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-level-oper-status.order-status'\n  value='PendingCreate' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-level-oper-status.last-rpc-action'\n  value='`$vf-module-topology-operation-input.sdnc-request-header.svc-action`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-level-oper-status.last-action'\n  value='`$vf-module-topology-operation-input.sdnc-request-header.request-action`' />\n","comments":"","x":442.59556579589844,"y":7243.904448330402,"z":"c281e2a0.b9793","wires":[]},{"id":"6782300a.2a6c","type":"returnSuccess","name":"return success","xml":"<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n","comments":"","x":379.1668701171875,"y":7336.522778332233,"z":"c281e2a0.b9793","wires":[]},{"id":"874eaff1.71395","type":"set","name":"copy input data","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.sdnc-request-header.'\n   value='$vf-module-topology-operation-input.sdnc-request-header.' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.request-information.'\n   value='$vf-module-topology-operation-input.request-information.' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.service-information.'\n   value='$vf-module-topology-operation-input.service-information.' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vnf-information.'\n   value='$vf-module-topology-operation-input.vnf-information.' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-information.'\n   value='$vf-module-topology-operation-input.vf-module-information.' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-request-input.'\n   value='$vf-module-topology-operation-input.vf-module-request-input.' />\n\n","comments":"","x":383.45257568359375,"y":7196.2527530789375,"z":"c281e2a0.b9793","wires":[]},{"id":"4de8c9e1.b8f3c8","type":"set","name":"copy vf-module-topology data","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-topology.' value='tmp.vf-module-topology.' />\n","comments":"","x":428.33358001708984,"y":7148.038265049458,"z":"c281e2a0.b9793","wires":[]},{"id":"41677f15.139e7","type":"execute","name":"printContext","xml":"<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='printContext' >\n<parameter name='filename' value='/var/tmp/bgb-vfmodule.log' />\n","comments":"","outputs":1,"x":374.0478210449219,"y":7288.752594769001,"z":"c281e2a0.b9793","wires":[[]]},{"id":"3d7e906e.ebd9d","type":"save","name":"update vf-module","xml":"<update plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\"\n   resource=\"vf-module\"\n   key=\"vf-module.vf-module-id = $service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-id\n      AND generic-vnf.vnf-id = $service-data.vnfs.vnf[$vnf-index].vnf-id\"\n   force=\"true\" pfx=\"tmp.AnAI-data\">\n<parameter name=\"vf-module-name\" value=\"`$tmp.vf-module-topology.vf-module-topology-identifier.vf-module-name`\" />\n<parameter name=\"model-invariant-id\" value=\"`$tmp.vf-module-topology.onap-model-information.model-invariant-uuid`\" />\n<parameter name=\"model-version-id\" value=\"`$tmp.vf-module-topology.onap-model-information.model-uuid`\" />\n<parameter name=\"model-customization-id\" value=\"`$tmp.vf-module-topology.onap-model-information.model-customization-uuid`\" />\n<parameter name=\"selflink\" value=\"`$vf-module-object-path`\" />\n<parameter name=\"automated-assignment\" value=\"`$automated-assignment`\" />","comments":"","outputs":1,"x":447.4763069152832,"y":4350.039918899536,"z":"c281e2a0.b9793","wires":[["520e1afa.312c84","b2b6e56c.e7e828"]]},{"id":"d4511df.4c530e","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'No vf-module found in AAI for vf module ID ' + $service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-id`\" />\n","comments":"","x":952.523983001709,"y":4384.801349580288,"z":"c281e2a0.b9793","wires":[]},{"id":"520e1afa.312c84","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":622.5479469299316,"y":4318.420540809631,"z":"c281e2a0.b9793","wires":[["db8855fa.f2df38"]]},{"id":"b2b6e56c.e7e828","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":631.1193199157715,"y":4387.039630830288,"z":"c281e2a0.b9793","wires":[["e8612d8a.dedd3"]]},{"id":"48a0d3ef.d7a9fc","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating vf-module in AAI\" />\n","comments":"","x":957.5479011535645,"y":4336.56409740448,"z":"c281e2a0.b9793","wires":[]},{"id":"29643f29.61c8b","type":"set","name":"set vf-module-object-path","xml":"<set>\n<parameter name='vf-module-object-path'\n value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $vf-module-topology-operation-input.service-information.service-instance-id\n + '/service-data/vnfs/vnf/'\n + $service-data.vnfs.vnf[$vnf-index].vnf-id\n + '/vnf-data/vf-modules/vf-module/'\n + $vf-module-topology-operation-input.vf-module-information.vf-module-id\n + '/vf-module-data/vf-module-topology/'`\"/>\n<parameter name='vnf-object-path'\n value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $vf-module-topology-operation-input.service-information.service-instance-id\n + '/service-data/vnfs/vnf/'\n + $service-data.vnfs.vnf[$vnf-index].vnf-id\n + '/vnf-data/vnf-topology/'`\"/>\n<parameter name='service-object-path'\n value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $vf-module-topology-operation-input.service-information.service-instance-id\n + '/service-data/service-topology/'`\"/>\n","comments":"","x":471.14311599731445,"y":4225.564147949219,"z":"c281e2a0.b9793","wires":[]},{"id":"b325649c.60f8f8","type":"save","name":"save vf-module relationships","xml":"<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\"\n   resource=\"vf-module:relationship-list\"\n   key=\"vf-module.vf-module-id = $service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-id\n      AND generic-vnf.vnf-id = $service-data.vnfs.vnf[$vnf-index].vnf-id\"\n   force=\"true\" pfx=\"tmp.AnAI-data\">\n    <parameter name=\"relationship-list.relationship[0].related-to\" value=\"l3-network\" />\n    <parameter name=\"relationship-list.relationship[0].related-link\"\n      value=\"`'/aai/v$/network/l3-networks/l3-network/' +\n        $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$network-role-index].network-id`\" />\n","comments":"","outputs":1,"x":1241.166862487793,"y":5908.192313313484,"z":"c281e2a0.b9793","wires":[["94416827.3ed0a8","1ab568ac.3f88e7"]]},{"id":"94416827.3ed0a8","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1461.0002059936523,"y":5879.064057469368,"z":"c281e2a0.b9793","wires":[["556deb90.1cc9d4"]]},{"id":"1ab568ac.3f88e7","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":1469.5717391967773,"y":5931.683201909065,"z":"c281e2a0.b9793","wires":[["2389206e.4826b"]]},{"id":"ce287a6f.f11468","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating vf-module relationships in AAI\" />\n","comments":"","x":1796.0003395080566,"y":5898.873953938484,"z":"c281e2a0.b9793","wires":[]},{"id":"9567a7bf.617988","type":"for","name":"for each vm-type","xml":"<for silentFailure='true' index='vm-type-index' start='0' end='`$tmp.vf-module-topology.vf-module-assignments.vms.vm_length`' >\n","comments":"","outputs":1,"x":420.8335876464844,"y":5673.525866150856,"z":"c281e2a0.b9793","wires":[["4b2574f8.f62e7c"]]},{"id":"ded84e31.8d5cd","type":"for","name":"for each vm-network","xml":"<for silentFailure='true' index='network-role-index' start='0' end='`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network_length`' >\n","comments":"","outputs":1,"x":817.8335990905762,"y":6092.192698359489,"z":"c281e2a0.b9793","wires":[["892dba1f.949248"]]},{"id":"5e0cc948.1a6558","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'No l3-network found in AAI for network ID '\n      + $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$network-role-index].network-id`\" />\n","comments":"","x":1797.8337135314941,"y":5948.858494877815,"z":"c281e2a0.b9793","wires":[]},{"id":"7146fa07.61fea4","type":"for","name":"for each vm-type","xml":"<for silentFailure='true' index='vm-type-index' start='0' end='`$tmp.vf-module-topology.vf-module-assignments.vms.vm_length`' >\n","comments":"","outputs":1,"x":395.26212310791016,"y":7040.571921646595,"z":"c281e2a0.b9793","wires":[["7ae71150.3fb55"]]},{"id":"7ae71150.3fb55","type":"for","name":"for each vm","xml":"<for index='vm-index' start='0' end='`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-count`' >\n","comments":"","outputs":1,"x":590.2621536254883,"y":7039.904929459095,"z":"c281e2a0.b9793","wires":[["c15a118a.bb8aa"]]},{"id":"c05ff08f.7a6c4","type":"save","name":"save VIPR_CONFIGURATION","xml":"<save plugin=\"org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource\" resource=\"SQL\"\nkey=\"INSERT INTO VIPR_CONFIGURATION (vnf_id, vnf_name, ecomp_service_instance_id, vm_name, cloud_region_id, cloud_owner) VALUES ( $service-data.vnfs.vnf[$vnf-index].vnf-id , $service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-topology-identifier-structure.vnf-name , $service-data.service-information.service-instance-id , $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vm-name[$vm-index] , $tmp.vf-module-topology.aic-cloud-region , $prop.cloud-region.cloud-owner )\" >","comments":"","outputs":1,"x":981.9288558959961,"y":7062.572579681873,"z":"c281e2a0.b9793","wires":[["1d5a7adc.472855"]]},{"id":"b1fd5f15.884cb","type":"comment","name":"Not a failure","info":"","comments":"","x":1501.9287567138672,"y":7062.572584450245,"z":"c281e2a0.b9793","wires":[]},{"id":"1d5a7adc.472855","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1191.928840637207,"y":7062.572729408741,"z":"c281e2a0.b9793","wires":[["adb4b884.833d98"]]},{"id":"adb4b884.833d98","type":"record","name":"record","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"GENERIC-RESOURCE-API.vf-module-topology-operation-assign:REQID\"/>\n<parameter name=\"field3\" value=\"`$vf-module-topology-operation-input.sdnc-request-header.svc-request-id`\"/>\n<parameter name=\"field4\" value=\"Failed to insert VIPR_CONFIGURATION record\"/>\n","comments":"","outputs":1,"x":1335.2622833251953,"y":7062.572567284107,"z":"c281e2a0.b9793","wires":[[]]},{"id":"8e82ea05.d1d908","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1365.2624053955078,"y":7013.90428096056,"z":"c281e2a0.b9793","wires":[["a469752e.e63838"]]},{"id":"d971c450.d3f188","type":"comment","name":"Not a failure","info":"","comments":"","x":1688.595458984375,"y":7012.238103210926,"z":"c281e2a0.b9793","wires":[]},{"id":"a469752e.e63838","type":"record","name":"record","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"GENERIC-RESOURCE-API.vf-module-topology-operation-assign:REQID\"/>\n<parameter name=\"field3\" value=\"`$vf-module-topology-operation-input.sdnc-request-header.svc-request-id`\"/>\n<parameter name=\"field4\" value=\"Failed to insert VIPR_CONFIGURATION record\"/>\n","comments":"","outputs":1,"x":1511.2623405456543,"y":7013.904914200306,"z":"c281e2a0.b9793","wires":[[]]},{"id":"c15a118a.bb8aa","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":758.5955467224121,"y":7038.904774010181,"z":"c281e2a0.b9793","wires":[["b3791ee0.eee6b","c05ff08f.7a6c4"]]},{"id":"b3791ee0.eee6b","type":"delete","name":"delete any pre-existing records in VIPR_CONFIGURATION","xml":"<delete plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource' resource='SQL'\n  key='DELETE from VIPR_CONFIGURATION WHERE vnf_id = $service-data.vnfs.vnf[$vnf-index].vnf-id\n     AND ecomp_service_instance_id = $service-data.service-information.service-instance-id\n     AND vm_name = $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vm-name[$vm-index]' >","comments":"","outputs":1,"x":1071.9288711547852,"y":7014.238913834095,"z":"c281e2a0.b9793","wires":[["8e82ea05.d1d908"]]},{"id":"db8855fa.f2df38","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":780.8335151672363,"y":4318.191211700439,"z":"c281e2a0.b9793","wires":[["48a0d3ef.d7a9fc","a08e7f46.755f3"]]},{"id":"e8612d8a.dedd3","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":781.8334312438965,"y":4384.857501924038,"z":"c281e2a0.b9793","wires":[["d4511df.4c530e","a08e7f46.755f3"]]},{"id":"556deb90.1cc9d4","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":1629.5002098083496,"y":5878.858327031136,"z":"c281e2a0.b9793","wires":[["ce287a6f.f11468","f09ff6b.4f3f408"]]},{"id":"2389206e.4826b","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":1624.5002098083496,"y":5931.858169674873,"z":"c281e2a0.b9793","wires":[["5e0cc948.1a6558","f09ff6b.4f3f408"]]},{"id":"16645c8e.451fe3","type":"execute","name":"execute RestApiCallNode - get preload-list","xml":"<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='restapiUrl' value=\"`$prop.controller.url + $prop.restapi.preloadinformation + $vf-module-topology-operation-input.vf-module-request-input.vf-module-name + '/vf-module'`\" />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='GET' />\n    <parameter name=\"responsePrefix\" value=\"mdsal-preload\" />\n\n","comments":"","outputs":1,"x":966.6667060852051,"y":2388.1915343999863,"z":"c281e2a0.b9793","wires":[["92438f35.2e311","a51b6262.197c9"]]},{"id":"92438f35.2e311","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1230.0000216166177,"y":2351.5247507492695,"z":"c281e2a0.b9793","wires":[["662806dc.522f58"]]},{"id":"a51b6262.197c9","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":1233.333309173584,"y":2426.52474629879,"z":"c281e2a0.b9793","wires":[["ee759f3a.85ba2"]]},{"id":"662806dc.522f58","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1391.6667098999023,"y":2349.8580354452133,"z":"c281e2a0.b9793","wires":[["1ef4ca32.6d3916"]]},{"id":"ee759f3a.85ba2","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1388.3333168029785,"y":2426.5245879888535,"z":"c281e2a0.b9793","wires":[["c3e31139.9c682"]]},{"id":"1ef4ca32.6d3916","type":"switchNode","name":"switch mdsal-preload.response-code","xml":"<switch test='`$mdsal-preload.response-code`'>\n","comments":"","outputs":1,"x":1620.0000114440918,"y":2349.858076453209,"z":"c281e2a0.b9793","wires":[["28b0c60b.c37f4a","35732eb1.234eb2"]]},{"id":"28b0c60b.c37f4a","type":"outcome","name":"404 (not found)","xml":"<outcome value='404'>\n","comments":"","outputs":1,"x":1871.666748046875,"y":2313.1914504766464,"z":"c281e2a0.b9793","wires":[["e5249593.3b52e8"]]},{"id":"e5249593.3b52e8","type":"call","name":"call GENERIC-RESOURCE-API:vf-module-topology-operation-assign-no-preload","xml":"<call module='GENERIC-RESOURCE-API' rpc='vf-module-topology-operation-assign-no-preload' mode='sync' >\n","comments":"","outputs":1,"x":2268.3332176208496,"y":2311.5245784521103,"z":"c281e2a0.b9793","wires":[["838605d7.09b008"]]},{"id":"838605d7.09b008","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":2638.333366394043,"y":2309.8581146001816,"z":"c281e2a0.b9793","wires":[["5b13f1bd.9caa2"]]},{"id":"d1ff1b92.db4a78","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n","comments":"","x":2946.6667442321777,"y":2341.524851202965,"z":"c281e2a0.b9793","wires":[]},{"id":"35732eb1.234eb2","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":1846.6668281555176,"y":2369.857941031456,"z":"c281e2a0.b9793","wires":[["9d4e3c9a.59748"]]},{"id":"587561df.2ca4a","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error retrieving preload-information\" />\n","comments":"","x":2159.9997329711914,"y":2386.5243648290634,"z":"c281e2a0.b9793","wires":[]},{"id":"c3e31139.9c682","type":"call","name":"call GENERIC-RESOURCE-API:vf-module-topology-operation-assign-preload","xml":"<call module='GENERIC-RESOURCE-API' rpc='vf-module-topology-operation-assign-preload' mode='sync' >\n","comments":"","outputs":1,"x":1751.6666069030762,"y":2428.1913360357285,"z":"c281e2a0.b9793","wires":[["32d49f72.4cd54"]]},{"id":"32d49f72.4cd54","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":2107.333469390869,"y":2426.524954199791,"z":"c281e2a0.b9793","wires":[["893d3e7a.e5b1f"]]},{"id":"f8e976f1.7db4f8","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n","comments":"","x":2415.666721343994,"y":2448.1918491125107,"z":"c281e2a0.b9793","wires":[]},{"id":"4b2574f8.f62e7c","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":611.3336563110352,"y":5674.359100937843,"z":"c281e2a0.b9793","wires":[["ded84e31.8d5cd","aca03865.b65bb8"]]},{"id":"aca03865.b65bb8","type":"for","name":"for each vnfc","xml":"<for silentFailure='true' index='vnfc-index' start='0' end='`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names_length`' >\n","comments":"","outputs":1,"x":862.3337059020996,"y":4879.025192141533,"z":"c281e2a0.b9793","wires":[["10f304f5.ad9eeb"]]},{"id":"3c22f266.7fa8ae","type":"save","name":"save vnfc to A&AI","xml":"<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"vnfc\" \n\tkey=\"vnfc.vnfc-name = $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-name\" >\n<parameter name=\"vnfc-name\" value=\"`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-name`\" />\n<parameter name=\"nfc-naming-code\" value=\"`$tmp.nfc-naming-code`\" />\n<parameter name=\"nfc-function\" value=\"`$tmp.nfc-function`\" />\n<parameter name=\"model-invariant-id\" value=\"`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].invariant-uuid`\" />\n<parameter name=\"model-version-id\" value=\"`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].uuid`\" />\n<parameter name=\"model-customization-id\" value=\"`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].model-customization-uuid`\" />\n<parameter name=\"orchestration-status\" value=\"`PendingCreate`\" />\n<parameter name=\"in-maint\" value=\"true\" />\n<parameter name=\"prov-status\" value=\"`PREPROV`\" />\n","comments":"","outputs":1,"x":1588.3337745666504,"y":4687.359122633934,"z":"c281e2a0.b9793","wires":[["79f212bd.d038bc","c592d914.589c38"]]},{"id":"10f304f5.ad9eeb","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":1030.667007446289,"y":4879.692019343376,"z":"c281e2a0.b9793","wires":[["f18c3c9d.cd99d","91efb93f.b0b208","f8377f02.519e8","8511c134.e2a8c","502f3bfc.44fe14","3895a80b.eba038"]]},{"id":"79f212bd.d038bc","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1779.333812713623,"y":4639.69245660305,"z":"c281e2a0.b9793","wires":[["4e0f33a2.b03bdc"]]},{"id":"dd909f2a.31b4d","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error saving vnfc to AAI\" />\n","comments":"","x":2118.3339653015137,"y":4673.835712194443,"z":"c281e2a0.b9793","wires":[]},{"id":"4e0f33a2.b03bdc","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":1944.5004997253418,"y":4653.82028990984,"z":"c281e2a0.b9793","wires":[["dd909f2a.31b4d","78584413.02195c"]]},{"id":"f8377f02.519e8","type":"save","name":"save vnfc relationships","xml":"<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\"\n   resource=\"vnfc:relationship-list\"\n   key=\"vnfc.vnfc-name = $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-name\"\n   force=\"true\" pfx=\"tmp.AnAI-data\">\n    <parameter name=\"relationship-list.relationship[0].related-to\" value=\"generic-vnf\" />\n    <parameter name=\"relationship-list.relationship[0].related-link\"\n      value=\"`'/aai/v$/network/generic-vnfs/generic-vnf/' +\n        $vf-module-topology-operation-input.vnf-information.vnf-id`\" />\n    <parameter name=\"relationship-list.relationship[1].related-to\" value=\"vf-module\" />\n    <parameter name=\"relationship-list.relationship[1].related-link\"\n      value=\"`'/aai/v$/network/generic-vnfs/generic-vnf/' +\n        $vf-module-topology-operation-input.vnf-information.vnf-id +\n        '/vf-modules/vf-module/' +\n        $service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-id`\" />\n","comments":"","outputs":1,"x":1255.2382926940918,"y":4787.978354334831,"z":"c281e2a0.b9793","wires":[["c02a3486.e78ab8","34b8b94.60c9146"]]},{"id":"1be9a1e8.7e4a3e","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating vnfc relationships in AAI\" />\n","comments":"","x":1765.2382278442383,"y":4779.645190119743,"z":"c281e2a0.b9793","wires":[]},{"id":"c0926ac4.cdff28","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Not-found error updating vnfc relationships\" />\n","comments":"","x":1760.4051361083984,"y":4831.296397089958,"z":"c281e2a0.b9793","wires":[]},{"id":"706aad6f.b2a7c4","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":1587.0714836120605,"y":4761.295978426933,"z":"c281e2a0.b9793","wires":[["1be9a1e8.7e4a3e","78584413.02195c"]]},{"id":"719cde80.fcedc","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":1587.0715599060059,"y":4814.295737147331,"z":"c281e2a0.b9793","wires":[["c0926ac4.cdff28","78584413.02195c"]]},{"id":"c02a3486.e78ab8","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1430.238368988037,"y":4761.311648249626,"z":"c281e2a0.b9793","wires":[["706aad6f.b2a7c4"]]},{"id":"34b8b94.60c9146","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":1438.809902191162,"y":4813.930792689323,"z":"c281e2a0.b9793","wires":[["719cde80.fcedc"]]},{"id":"f18c3c9d.cd99d","type":"for","name":"for each vnfc-network-role","xml":"<for silentFailure='true' index='network-role-index' start='0' end='`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-networks.vnfc-network-data_length`' >\n","comments":"","outputs":1,"x":1252.714412689209,"y":5204.834762454033,"z":"c281e2a0.b9793","wires":[["58d1d842.f73148"]]},{"id":"d2581847.10cc78","type":"execute","name":"printContext","xml":"<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='printContext' >\n<parameter name='filename' value='/var/tmp/bgb-vfmoduleb.log' />\n","comments":"","outputs":1,"x":473.3333168029785,"y":2512.7385843992233,"z":"c281e2a0.b9793","wires":[[]]},{"id":"cda369d7.15b748","type":"for","name":"for each vnfc-subnetwork-role","xml":"<for silentFailure='true' index='subnet-role-index' start='0' end='`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-networks.vnfc-network-data[$network-role-index].vnfc-subnet_length`' >\n","comments":"","outputs":1,"x":1708.66695022583,"y":5168.02519595623,"z":"c281e2a0.b9793","wires":[["32bc244c.7220fc"]]},{"id":"32bc244c.7220fc","type":"for","name":"for each vnfc-address-family","xml":"<for silentFailure='true' index='address-family-index' start='0' end='`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-networks.vnfc-network-data[$network-role-index].vnfc-subnet[$subnet-role-index].vnfc-ip-assignments_length`' >\n","comments":"","outputs":1,"x":1976.0002937316895,"y":5167.02568423748,"z":"c281e2a0.b9793","wires":[["db76e4e5.4cf428"]]},{"id":"9ab4c052.39968","type":"for","name":"for each vnfc-ip-address","xml":"<for silentFailure='true' index='address-index' start='0' end='`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-networks.vnfc-network-data[$network-role-index].vnfc-subnet[$subnet-role-index].vnfc-ip-assignments[$address-family-index].vnfc-subnet-ip_length`' >\n","comments":"","outputs":1,"x":2407.9999046325684,"y":5233.691383719444,"z":"c281e2a0.b9793","wires":[["2cac435d.a1268c"]]},{"id":"db76e4e5.4cf428","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":2187.0000648498535,"y":5167.02514064312,"z":"c281e2a0.b9793","wires":[["d3b99c28.7e5cf","9ab4c052.39968"]]},{"id":"d3b99c28.7e5cf","type":"set","name":"set tmp.address-family","xml":"<set>\n<parameter name='tmp.address-family'\n  value='`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-networks.vnfc-network-data[$network-role-index].vnfc-subnet[$subnet-role-index].vnfc-ip-assignments[$address-family-index].vnfc-address-family`' />\n","comments":"","x":2407.0003929138184,"y":5087.025038123131,"z":"c281e2a0.b9793","wires":[]},{"id":"2cac435d.a1268c","type":"switchNode","name":"switch address family","xml":"<switch test='`$tmp.address-family`'>\n","comments":"","outputs":1,"x":2646.9999961853027,"y":5232.0252059698105,"z":"c281e2a0.b9793","wires":[["422dc838.bc08d8","12f35a08.f97c36"]]},{"id":"422dc838.bc08d8","type":"outcome","name":"ipv4","xml":"<outcome value='ipv4'>\n","comments":"","outputs":1,"x":2844.1430015563965,"y":5135.596466422081,"z":"c281e2a0.b9793","wires":[["ced8df69.6e36b"]]},{"id":"12f35a08.f97c36","type":"outcome","name":"ipv6","xml":"<outcome value='ipv6'>\n","comments":"","outputs":1,"x":2841.7620735168457,"y":5315.358497977257,"z":"c281e2a0.b9793","wires":[["970f00c2.cf0fb"]]},{"id":"eff5f3c5.e7a55","type":"comment","name":"Fixed IPs","info":"","comments":"","x":1725.6669654846191,"y":5129.692572951317,"z":"c281e2a0.b9793","wires":[]},{"id":"d1970dd3.007dd","type":"save","name":"save l3-interface-ipv4-address-list object to A&AI","xml":"<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"l3-interface-ipv4-address-list\" \n\tkey=\"vnfc.vnfc-name = $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-name\n\t  AND cp.cp-instance-id = $cp-instance-id\n\t  AND l3-interface-ipv4-address-list.l3-interface-ipv4-address = $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-networks.vnfc-network-data[$network-role-index].vnfc-subnet[$subnet-role-index].vnfc-ip-assignments[$address-family-index].vnfc-subnet-ip[$address-index].vnfc-ip-address\" >\n<parameter name=\"l3-interface-ipv4-address\" value=\"`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-networks.vnfc-network-data[$network-role-index].vnfc-subnet[$subnet-role-index].vnfc-ip-assignments[$address-family-index].vnfc-subnet-ip[$address-index].vnfc-ip-address`\" />\n<parameter name=\"l3-interface-ipv4-prefix-length\" value=\"32\" />\n<parameter name=\"is-floating\" value=\"false\" />\n","comments":"","outputs":1,"x":3287.476131439209,"y":5083.929546395939,"z":"c281e2a0.b9793","wires":[["fab7bb46.1f5f38"]]},{"id":"ced8df69.6e36b","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":2994.1430015563965,"y":5135.596385041874,"z":"c281e2a0.b9793","wires":[["d1970dd3.007dd","ddc33e2f.3f85c"]]},{"id":"6da202c1.e82a0c","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error creating l3-interface-ipv4-address-list object in AAI\" />\n","comments":"","x":3870.8096504211426,"y":5102.263205567997,"z":"c281e2a0.b9793","wires":[]},{"id":"12110c13.457344","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":3700.976005554199,"y":5083.91403869788,"z":"c281e2a0.b9793","wires":[["6da202c1.e82a0c","dcf2f8a.b203608"]]},{"id":"fab7bb46.1f5f38","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":3544.142890930176,"y":5083.929708520573,"z":"c281e2a0.b9793","wires":[["12110c13.457344"]]},{"id":"ddc33e2f.3f85c","type":"save","name":"save l3-interface-ipv4-address-list relationships","xml":"<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\"\n   resource=\"l3-interface-ipv4-address-list:relationship-list\"\n   key=\"vnfc.vnfc-name = $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-name\n\t  AND cp.cp-instance-id = $cp-instance-id\n\t  AND l3-interface-ipv4-address-list.l3-interface-ipv4-address = $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-networks.vnfc-network-data[$network-role-index].vnfc-subnet[$subnet-role-index].vnfc-ip-assignments[$address-family-index].vnfc-subnet-ip[$address-index].vnfc-ip-address\"\n   force=\"true\" pfx=\"tmp.AnAI-data\">\n    <parameter name=\"relationship-list.relationship[0].related-to\" value=\"l3-network\" />\n    <parameter name=\"relationship-list.relationship[0].related-link\"\n      value=\"`'/aai/v$/network/l3-networks/l3-network/' +\n        $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-networks.vnfc-network-data[$network-role-index].network-id`\" />\n    <parameter name=\"relationship-list.relationship[1].related-to\" value=\"subnet\" />\n    <parameter name=\"relationship-list.relationship[1].related-link\"\n      value=\"`'/aai/v$/network/l3-networks/l3-network/' +\n        $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-networks.vnfc-network-data[$network-role-index].network-id +\n        '/subnets/subnet/' +\n        $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-networks.vnfc-network-data[$network-role-index].vnfc-subnet[$subnet-role-index].vnfc-ip-assignments[$address-family-index].subnet-id`\" />\n","comments":"","outputs":1,"x":3282.476375579834,"y":5182.262965242069,"z":"c281e2a0.b9793","wires":[["f484ec25.b268d","88d1087b.6d8d38"]]},{"id":"7e0fd55c.99db0c","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating l3-interface-ipv4-address-list relationships in AAI\" />\n","comments":"","x":3869.1427574157715,"y":5173.929636994999,"z":"c281e2a0.b9793","wires":[]},{"id":"24562eff.689f42","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Not-found error updating l3-interface-ipv4-address-list relationships\" />\n","comments":"","x":3869.3096199035645,"y":5223.914094964664,"z":"c281e2a0.b9793","wires":[]},{"id":"a40cd1fe.30b81","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":3702.6426277160645,"y":5153.91401008765,"z":"c281e2a0.b9793","wires":[["7e0fd55c.99db0c","dcf2f8a.b203608"]]},{"id":"30626ca1.4d2404","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":3702.6427040100098,"y":5206.913768808048,"z":"c281e2a0.b9793","wires":[["24562eff.689f42","dcf2f8a.b203608"]]},{"id":"f484ec25.b268d","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":3545.809513092041,"y":5153.929679910343,"z":"c281e2a0.b9793","wires":[["a40cd1fe.30b81"]]},{"id":"88d1087b.6d8d38","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":3554.381046295166,"y":5206.54882435004,"z":"c281e2a0.b9793","wires":[["30626ca1.4d2404"]]},{"id":"86bb4824.2800f8","type":"save","name":"save l3-interface-ipv6-address-list object to A&AI","xml":"<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"l3-interface-ipv6-address-list\" \n\tkey=\"vnfc.vnfc-name = $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-name\n\t  AND cp.cp-instance-id = $cp-instance-id\n\t  AND l3-interface-ipv6-address-list.l3-interface-ipv6-address = $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-networks.vnfc-network-data[$network-role-index].vnfc-subnet[$subnet-role-index].vnfc-ip-assignments[$address-family-index].vnfc-subnet-ip[$address-index].vnfc-ip-address\" >\n<parameter name=\"l3-interface-ipv6-address\" value=\"`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-networks.vnfc-network-data[$network-role-index].vnfc-subnet[$subnet-role-index].vnfc-ip-assignments[$address-family-index].vnfc-subnet-ip[$address-index].vnfc-ip-address`\" />\n<parameter name=\"l3-interface-ipv6-prefix-length\" value=\"128\" />\n<parameter name=\"is-floating\" value=\"false\" />\n","comments":"","outputs":1,"x":3286.2858695983887,"y":5262.977602362633,"z":"c281e2a0.b9793","wires":[["b2f0c007.7919b"]]},{"id":"970f00c2.cf0fb","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":2992.952739715576,"y":5314.644441008568,"z":"c281e2a0.b9793","wires":[["86bb4824.2800f8","e4ea4722.56f548"]]},{"id":"af01a2f2.69bae","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error creating l3-interface-ipv6-address-list object in AAI\" />\n","comments":"","x":3869.6193885803223,"y":5281.311261534691,"z":"c281e2a0.b9793","wires":[]},{"id":"5e6beb7d.1b5734","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":3699.785743713379,"y":5262.962094664574,"z":"c281e2a0.b9793","wires":[["af01a2f2.69bae","dcf2f8a.b203608"]]},{"id":"b2f0c007.7919b","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":3542.9526290893555,"y":5262.9777644872665,"z":"c281e2a0.b9793","wires":[["5e6beb7d.1b5734"]]},{"id":"e4ea4722.56f548","type":"save","name":"save l3-interface-ipv6-address-list relationships","xml":"<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\"\n   resource=\"l3-interface-ipv6-address-list:relationship-list\"\n   key=\"vnfc.vnfc-name = $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-name\n\t  AND cp.cp-instance-id = $cp-instance-id\n\t  AND l3-interface-ipv6-address-list.l3-interface-ipv6-address = $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-networks.vnfc-network-data[$network-role-index].vnfc-subnet[$subnet-role-index].vnfc-ip-assignments[$address-family-index].vnfc-subnet-ip[$address-index].vnfc-ip-address\"\n   force=\"true\" pfx=\"tmp.AnAI-data\">\n    <parameter name=\"relationship-list.relationship[0].related-to\" value=\"l3-network\" />\n    <parameter name=\"relationship-list.relationship[0].related-link\"\n      value=\"`'/aai/v$/network/l3-networks/l3-network/' +\n        $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-networks.vnfc-network-data[$network-role-index].network-id`\" />\n    <parameter name=\"relationship-list.relationship[1].related-to\" value=\"subnet\" />\n    <parameter name=\"relationship-list.relationship[1].related-link\"\n      value=\"`'/aai/v$/network/l3-networks/l3-network/' +\n        $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-networks.vnfc-network-data[$network-role-index].network-id +\n        '/subnets/subnet/' +\n        $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-networks.vnfc-network-data[$network-role-index].vnfc-subnet[$subnet-role-index].vnfc-ip-assignments[$address-family-index].subnet-id`\" />\n","comments":"","outputs":1,"x":3281.2861137390137,"y":5361.311021208763,"z":"c281e2a0.b9793","wires":[["e4eb0c62.35753","84641592.59c4b8"]]},{"id":"bd5c910f.6a2c2","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating l3-interface-ipv6-address-list relationships in AAI\" />\n","comments":"","x":3867.952495574951,"y":5352.977692961693,"z":"c281e2a0.b9793","wires":[]},{"id":"bf7ea22c.dc7e9","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Not-found error updating l3-interface-ipv6-address-list relationships\" />\n","comments":"","x":3871.4527168273926,"y":5399.628709435463,"z":"c281e2a0.b9793","wires":[]},{"id":"db0a0453.a9c1d8","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":3701.452365875244,"y":5332.962066054344,"z":"c281e2a0.b9793","wires":[["bd5c910f.6a2c2","dcf2f8a.b203608"]]},{"id":"8fbdb335.3145a","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":3701.4524421691895,"y":5385.961824774742,"z":"c281e2a0.b9793","wires":[["bf7ea22c.dc7e9","dcf2f8a.b203608"]]},{"id":"e4eb0c62.35753","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":3544.6192512512207,"y":5332.977735877037,"z":"c281e2a0.b9793","wires":[["db0a0453.a9c1d8"]]},{"id":"84641592.59c4b8","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":3553.1907844543457,"y":5385.596880316734,"z":"c281e2a0.b9793","wires":[["8fbdb335.3145a"]]},{"id":"892dba1f.949248","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":1007.666919708252,"y":6091.692137598991,"z":"c281e2a0.b9793","wires":[["b521a46c.b159e8","b325649c.60f8f8","77af5ead.1750b","230ad0d3.dcd8f"]]},{"id":"422aad74.8213a4","type":"for","name":"for each vnfc","xml":"<for silentFailure='true' index='vnfc-index' start='0' end='`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names_length`' >\n","comments":"","outputs":1,"x":1655.6670951843262,"y":6214.025885462761,"z":"c281e2a0.b9793","wires":[["d11c836e.c57ae"]]},{"id":"273ee6c6.cc222a","type":"save","name":"save vip-ipv4-address-list object to A&AI","xml":"<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"vip-ipv4-address-list\" \n\tkey=\"cloud-region.cloud-owner = $prop.cloud-region.cloud-owner\n\t  AND cloud-region.cloud-region-id = $vf-module-topology-operation-input.vf-module-request-input.aic-cloud-region\n\t  AND vip-ipv4-address-list.vip-ipv4-address = $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$vm-network-index].floating-ips.floating-ip-v4[$ipv4-index]\" >\n<parameter name=\"vip-ipv4-address\" value=\"`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$vm-network-index].floating-ips.floating-ip-v4[$ipv4-index]`\" />\n<parameter name=\"vip-ipv4-prefix-length\" value=\"32\" />\n<parameter name=\"is-floating\" value=\"false\" />\n","comments":"","outputs":1,"x":1738.66695022583,"y":6045.358897089958,"z":"c281e2a0.b9793","wires":[["70cdaf6a.2be35","d9ff730a.67c18"]]},{"id":"77af5ead.1750b","type":"for","name":"for each floating ipv4 address","xml":"<for silentFailure='true' index='ipv4-index' start='0' end='`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$vm-network-index].floating-ips.floating-ip-v4_length`' >\n","comments":"","outputs":1,"x":1246.6669425964355,"y":6103.358969569206,"z":"c281e2a0.b9793","wires":[["f2ee7c90.8027d"]]},{"id":"f2ee7c90.8027d","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":1472.6669425964355,"y":6101.358969569206,"z":"c281e2a0.b9793","wires":[["273ee6c6.cc222a","6a394d7a.c76054","422aad74.8213a4"]]},{"id":"4696d84c.536f38","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error saving vip-ipv4-address-list in AAI\" />\n","comments":"","x":2300.66695022583,"y":6035.358897089958,"z":"c281e2a0.b9793","wires":[]},{"id":"d40560fc.5b0f1","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Not-found error saving vip-ipv4-address-list\" />\n","comments":"","x":2300.833812713623,"y":6085.343355059624,"z":"c281e2a0.b9793","wires":[]},{"id":"57c17fa7.ab7ef","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":2134.166820526123,"y":6015.34327018261,"z":"c281e2a0.b9793","wires":[["4696d84c.536f38","d97fd47e.81be38"]]},{"id":"14c28c2d.62e484","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":2134.1668968200684,"y":6068.3430289030075,"z":"c281e2a0.b9793","wires":[["d40560fc.5b0f1","d97fd47e.81be38"]]},{"id":"70cdaf6a.2be35","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1977.3337059020996,"y":6015.358940005302,"z":"c281e2a0.b9793","wires":[["57c17fa7.ab7ef"]]},{"id":"d9ff730a.67c18","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":1985.9052391052246,"y":6067.978084445,"z":"c281e2a0.b9793","wires":[["14c28c2d.62e484"]]},{"id":"16a29da1.16be62","type":"save","name":"save vip-ipv4-address-list relationships","xml":"<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\"\n   resource=\"vip-ipv4-address-list:relationship-list\"\n   key=\"cloud-region.cloud-owner = $prop.cloud-region.cloud-owner\n\t  AND cloud-region.cloud-region-id = $vf-module-topology-operation-input.vf-module-request-input.aic-cloud-region\n\t  AND vip-ipv4-address-list.vip-ipv4-address = $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$vm-network-index].floating-ips.floating-ip-v4[$ipv4-index]\"\n   force=\"true\" pfx=\"tmp.AnAI-data\">\n    <parameter name=\"relationship-list.relationship[0].related-to\" value=\"subnet\" />\n    <parameter name=\"relationship-list.relationship[0].related-link\"\n      value=\"`'/aai/v$/network/l3-networks/l3-network/'\n        + $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$vm-network-index].network-id\n        + '/subnets/subnet/'\n        + $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$vm-network-index].floating-ips.ipv4-subnet-id`\" />\n    <parameter name=\"relationship-list.relationship[1].related-to\" value=\"vnfc\" />\n    <parameter name=\"relationship-list.relationship[1].related-link\"\n      value=\"`'/aai/v$/network/vnfcs/vnfc/'\n        + $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-name`\" />\n","comments":"","outputs":1,"x":2074.3335456848145,"y":6158.025560259819,"z":"c281e2a0.b9793","wires":[["1b0899a1.fdf346","59a31fd3.2582c"]]},{"id":"3b3a05f8.37140a","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating vip-ipv4-address-list relationships in AAI\" />\n","comments":"","x":2643.999954223633,"y":6150.025529801846,"z":"c281e2a0.b9793","wires":[]},{"id":"8b4c122a.0d63f","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Not-found error updating vip-ipv4-address-list relationships\" />\n","comments":"","x":2644.166923522949,"y":6200.00970351696,"z":"c281e2a0.b9793","wires":[]},{"id":"3b5e37dd.a56ed8","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":2477.499824523926,"y":6130.009902894497,"z":"c281e2a0.b9793","wires":[["3b3a05f8.37140a","d97fd47e.81be38"]]},{"id":"e969a096.0bfe5","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":2477.499900817871,"y":6183.009661614895,"z":"c281e2a0.b9793","wires":[["8b4c122a.0d63f","d97fd47e.81be38"]]},{"id":"1b0899a1.fdf346","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":2320.6667098999023,"y":6130.02557271719,"z":"c281e2a0.b9793","wires":[["3b5e37dd.a56ed8"]]},{"id":"59a31fd3.2582c","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":2329.2382431030273,"y":6182.644717156887,"z":"c281e2a0.b9793","wires":[["e969a096.0bfe5"]]},{"id":"e1dbffc8.939b7","type":"save","name":"save vip-ipv6-address-list object to A&AI","xml":"<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"vip-ipv6-address-list\" \n\tkey=\"cloud-region.cloud-owner = $prop.cloud-region.cloud-owner\n\t  AND cloud-region.cloud-region-id = $vf-module-topology-operation-input.vf-module-request-input.aic-cloud-region\n\t  AND vip-ipv6-address-list.vip-ipv6-address = $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$vm-network-index].floating-ips.floating-ip-v6[$ipv6-index]\" >\n<parameter name=\"vip-ipv6-address\" value=\"`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$vm-network-index].floating-ips.floating-ip-v6[$ipv6-index]`\" />\n<parameter name=\"vip-ipv6-prefix-length\" value=\"128\" />\n<parameter name=\"is-floating\" value=\"false\" />\n","comments":"","outputs":1,"x":1742.0002784729004,"y":6368.691580653191,"z":"c281e2a0.b9793","wires":[["394b95f8.29020a","f814aa1.108ef58"]]},{"id":"230ad0d3.dcd8f","type":"for","name":"for each floating ipv6 address","xml":"<for silentFailure='true' index='ipv6-index' start='0' end='`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$vm-network-index].floating-ips.floating-ip-v6_length`' >\n","comments":"","outputs":1,"x":1250.0002708435059,"y":6425.691653132439,"z":"c281e2a0.b9793","wires":[["ef367330.94bfc"]]},{"id":"ef367330.94bfc","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":1476.0002708435059,"y":6424.691653132439,"z":"c281e2a0.b9793","wires":[["e1dbffc8.939b7","a49c461f.aacc58","c3c14d8c.8aef6"]]},{"id":"3487d10b.c1e98e","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error saving vip-ipv6-address-list in AAI\" />\n","comments":"","x":2304.0002784729004,"y":6358.691580653191,"z":"c281e2a0.b9793","wires":[]},{"id":"e8e52dbc.e99d5","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Not-found error saving vip-ipv6-address-list\" />\n","comments":"","x":2304.1671409606934,"y":6408.676038622856,"z":"c281e2a0.b9793","wires":[]},{"id":"c1739210.853b1","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":2137.5001487731934,"y":6338.675953745842,"z":"c281e2a0.b9793","wires":[["3487d10b.c1e98e","d97fd47e.81be38"]]},{"id":"fcd501b8.c93af","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":2137.5002250671387,"y":6391.67571246624,"z":"c281e2a0.b9793","wires":[["e8e52dbc.e99d5","d97fd47e.81be38"]]},{"id":"394b95f8.29020a","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1980.66703414917,"y":6338.691623568535,"z":"c281e2a0.b9793","wires":[["c1739210.853b1"]]},{"id":"f814aa1.108ef58","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":1989.238567352295,"y":6391.310768008232,"z":"c281e2a0.b9793","wires":[["fcd501b8.c93af"]]},{"id":"36065f46.a3418","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating vip-ipv6-address-list relationships in AAI\" />\n","comments":"","x":2637.3335342407227,"y":6471.691631257534,"z":"c281e2a0.b9793","wires":[]},{"id":"b524f4da.06da78","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Not-found error updating vip-ipv6-address-list relationships\" />\n","comments":"","x":2637.5003967285156,"y":6521.6760892272,"z":"c281e2a0.b9793","wires":[]},{"id":"7071c414.bf0c6c","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":2470.8334045410156,"y":6451.676004350185,"z":"c281e2a0.b9793","wires":[["36065f46.a3418","d97fd47e.81be38"]]},{"id":"6ea4248b.87e4ec","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":2470.833480834961,"y":6504.675763070583,"z":"c281e2a0.b9793","wires":[["b524f4da.06da78","d97fd47e.81be38"]]},{"id":"8c9b6322.65d4c","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":2314.000289916992,"y":6451.691674172878,"z":"c281e2a0.b9793","wires":[["7071c414.bf0c6c"]]},{"id":"19e68fff.7e74f","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":2322.571823120117,"y":6504.3108186125755,"z":"c281e2a0.b9793","wires":[["6ea4248b.87e4ec"]]},{"id":"130606e9.a6f699","type":"save","name":"save vip-ipv6-address-list relationships","xml":"<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\"\n   resource=\"vip-ipv6-address-list:relationship-list\"\n   key=\"cloud-region.cloud-owner = $prop.cloud-region.cloud-owner\n\t  AND cloud-region.cloud-region-id = $vf-module-topology-operation-input.vf-module-request-input.aic-cloud-region\n\t  AND vip-ipv6-address-list.vip-ipv6-address = $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$vm-network-index].floating-ips.floating-ip-v6[$ipv6-index]\"\n   force=\"true\" pfx=\"tmp.AnAI-data\">\n    <parameter name=\"relationship-list.relationship[0].related-to\" value=\"subnet\" />\n    <parameter name=\"relationship-list.relationship[0].related-link\"\n      value=\"`'/aai/v$/network/l3-networks/l3-network/'\n        + $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$vm-network-index].network-id\n        + '/subnets/subnet/'\n        + $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$vm-network-index].floating-ips.ipv6-subnet-id`\" />\n    <parameter name=\"relationship-list.relationship[1].related-to\" value=\"vnfc\" />\n    <parameter name=\"relationship-list.relationship[1].related-link\"\n      value=\"`'/aai/v$/network/vnfcs/vnfc/'\n        + $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-name`\" />\n","comments":"","outputs":1,"x":2069.667133331299,"y":6480.3580931425095,"z":"c281e2a0.b9793","wires":[["8c9b6322.65d4c","19e68fff.7e74f"]]},{"id":"a08e7f46.755f3","type":"call","name":"call GENERIC-RESOURCE-API:vf-module-topology-assign-rollback","xml":"<call module='GENERIC-RESOURCE-API' rpc='vf-module-topology-assign-rollback' mode='sync' >\n","comments":"","outputs":1,"x":1125.666805267334,"y":4288.691486299038,"z":"c281e2a0.b9793","wires":[[]]},{"id":"78584413.02195c","type":"call","name":"call GENERIC-RESOURCE-API:vf-module-topology-assign-rollback","xml":"<call module='GENERIC-RESOURCE-API' rpc='vf-module-topology-assign-rollback' mode='sync' >\n","comments":"","outputs":1,"x":2290.333751678467,"y":4626.692221403122,"z":"c281e2a0.b9793","wires":[[]]},{"id":"f09ff6b.4f3f408","type":"call","name":"call GENERIC-RESOURCE-API:vf-module-topology-assign-rollback","xml":"<call module='GENERIC-RESOURCE-API' rpc='vf-module-topology-assign-rollback' mode='sync' >\n","comments":"","outputs":1,"x":1999.000331878662,"y":5843.692058622837,"z":"c281e2a0.b9793","wires":[[]]},{"id":"d97fd47e.81be38","type":"call","name":"call GENERIC-RESOURCE-API:vf-module-topology-assign-rollback","xml":"<call module='GENERIC-RESOURCE-API' rpc='vf-module-topology-assign-rollback' mode='sync' >\n","comments":"","outputs":1,"x":2948.000461578369,"y":5962.691904902458,"z":"c281e2a0.b9793","wires":[[]]},{"id":"dcf2f8a.b203608","type":"call","name":"call GENERIC-RESOURCE-API:vf-module-topology-assign-rollback","xml":"<call module='GENERIC-RESOURCE-API' rpc='vf-module-topology-assign-rollback' mode='sync' >\n","comments":"","outputs":1,"x":4267.333450317383,"y":5010.35798484087,"z":"c281e2a0.b9793","wires":[[]]},{"id":"91efb93f.b0b208","type":"set","name":"set created_flag","xml":"<set>\n<parameter name='tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].created_flag' value='true' />\n","comments":"","x":1232.3335762023926,"y":4727.691877186298,"z":"c281e2a0.b9793","wires":[]},{"id":"b521a46c.b159e8","type":"set","name":"set created-flag","xml":"<set>\n<parameter name='tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$network-role-index].created-flag' value='true' />\n","comments":"","x":1203.000331878662,"y":5975.692058622837,"z":"c281e2a0.b9793","wires":[]},{"id":"6a394d7a.c76054","type":"set","name":"set created-ipv4-flag","xml":"<set>\n<parameter name='tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$vm-network-index].floating-ips.created-ipv4-flag' value='true' />\n","comments":"","x":1676.0002975463867,"y":6103.692138493061,"z":"c281e2a0.b9793","wires":[]},{"id":"a49c461f.aacc58","type":"set","name":"set created-ipv6-flag","xml":"<set>\n<parameter name='tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$vm-network-index].floating-ips.created-ipv6-flag' value='true' />\n","comments":"","x":1681.3336334228516,"y":6429.691741764545,"z":"c281e2a0.b9793","wires":[]},{"id":"c592d914.589c38","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":1782.3337516784668,"y":4687.692116081715,"z":"c281e2a0.b9793","wires":[["4e0f33a2.b03bdc"]]},{"id":"a5403308.f3a28","type":"call","name":"call GENERIC-RESOURCE-API:vf-module-topology-vlan-tagging-assign","xml":"<call module='GENERIC-RESOURCE-API' rpc='vf-module-topology-vlan-tagging-assign' mode='sync' >\n","comments":"","outputs":1,"x":566.0001106262207,"y":6767.691919207573,"z":"c281e2a0.b9793","wires":[["216aef87.16a46"]]},{"id":"216aef87.16a46","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":910.3335266113281,"y":6767.025414347649,"z":"c281e2a0.b9793","wires":[["17123af4.50edd5"]]},{"id":"17123af4.50edd5","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":1065.3334007263184,"y":6767.025210261345,"z":"c281e2a0.b9793","wires":[["c6913bf.53eafc8","320d2d80.f0c0d2","9585c15b.4e796"]]},{"id":"c6913bf.53eafc8","type":"call","name":"call GENERIC-RESOURCE-API:vf-module-topology-assign-rollback","xml":"<call module='GENERIC-RESOURCE-API' rpc='vf-module-topology-assign-rollback' mode='sync' >\n","comments":"","outputs":1,"x":1413.666690826416,"y":6712.025630116463,"z":"c281e2a0.b9793","wires":[[]]},{"id":"320d2d80.f0c0d2","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n","comments":"","x":1242.000129699707,"y":6810.3588581085205,"z":"c281e2a0.b9793","wires":[]},{"id":"9585c15b.4e796","type":"execute","name":"printContext","xml":"<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='printContext' >\n<parameter name='filename' value='/var/tmp/bgb-vlantaggingfailure.log' />\n","comments":"","outputs":1,"x":1237.0000267028809,"y":6763.691714167595,"z":"c281e2a0.b9793","wires":[[]]},{"id":"fcb16772.796c08","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":204.2261962890625,"y":523.5714410543442,"z":"c281e2a0.b9793","wires":[["6b1873f2.63696c","ded68ff0.3a928","93af21a0.ebb87","1c73f9f3.baee96","1fc7e563.9fd97b","f91c0c48.6c834","5da7dd5d.f1de64","e039d8f6.47eef8","bf338b07.458e28"]]},{"id":"e81704f9.71e908","type":"switchNode","name":"switch from-preload","xml":"<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-information.from-preload`'>\n","comments":"","outputs":1,"x":495.23804092407227,"y":2579.167204260826,"z":"c281e2a0.b9793","wires":[["b351a148.2bfbf","57831923.8bf9f8"]]},{"id":"b351a148.2bfbf","type":"outcomeFalse","name":"false","xml":"<outcome value='false'>\n","comments":"","outputs":1,"x":667.1427726745605,"y":2556.5482248067856,"z":"c281e2a0.b9793","wires":[["b0569611.335668"]]},{"id":"57831923.8bf9f8","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":668.8094253540039,"y":2601.548063635826,"z":"c281e2a0.b9793","wires":[["c0be6c68.19f8b"]]},{"id":"b0569611.335668","type":"set","name":"set automated-assignment to true","xml":"<set>\n<parameter name='automated-assignment' value='true' />\n","comments":"","x":882.1427574157715,"y":2554.8813956975937,"z":"c281e2a0.b9793","wires":[]},{"id":"c0be6c68.19f8b","type":"set","name":"set automated-assignment to false","xml":"<set>\n<parameter name='automated-assignment' value='false' />\n","comments":"","x":880.4760780334473,"y":2599.881315588951,"z":"c281e2a0.b9793","wires":[]},{"id":"c3c14d8c.8aef6","type":"for","name":"for each vnfc","xml":"<for silentFailure='true' index='vnfc-index' start='0' end='`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names_length`' >\n","comments":"","outputs":1,"x":1656.76216506958,"y":6528.5721653699875,"z":"c281e2a0.b9793","wires":[["2e71e36.46fa41c"]]},{"id":"98914ba2.b5d168","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Test return\" />\n","comments":"","x":121.33347702026367,"y":7008.359683454037,"z":"c281e2a0.b9793","wires":[]},{"id":"e28c7bde.2c20f8","type":"for","name":"for each vm-type","xml":"<for silentFailure='true' index='vm-type-index' start='0' end='`$tmp.vf-module-topology.vf-module-assignments.vms.vm_length`' >\n","comments":"","outputs":1,"x":474.00013732910156,"y":3939.3580869436264,"z":"c281e2a0.b9793","wires":[["ea402844.f404e8"]]},{"id":"ea402844.f404e8","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":664.5002059936523,"y":3940.1913217306137,"z":"c281e2a0.b9793","wires":[["270f9549.267bca"]]},{"id":"270f9549.267bca","type":"for","name":"for each vm-network","xml":"<for silentFailure='true' index='network-role-index' start='0' end='`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network_length`' >\n","comments":"","outputs":1,"x":866.0001373291016,"y":3939.3580869436264,"z":"c281e2a0.b9793","wires":[["9cc37ec0.b6b9b"]]},{"id":"9cc37ec0.b6b9b","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":1055.8334579467773,"y":3938.8575261831284,"z":"c281e2a0.b9793","wires":[["5873f3ba.4c9b5c"]]},{"id":"5873f3ba.4c9b5c","type":"get-resource","name":"get-resource VFC_RELATED_NETWORK_ROLE","xml":"<get-resource plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource' resource='SQL'\n  key='SELECT * from VFC_RELATED_NETWORK_ROLE where vfc_customization_uuid = $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].model-customization-uuid\n    and network_role = $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$network-role-index].network-role'\n  pfx='db.vnf-related-network-role[]'>\n\n","comments":"","outputs":1,"x":1345.3334312438965,"y":3937.3581689596176,"z":"c281e2a0.b9793","wires":[["9c99a7b6.bb4868","8924a698.c39db8"]]},{"id":"9c99a7b6.bb4868","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1616.3333702087402,"y":3842.0248712301254,"z":"c281e2a0.b9793","wires":[["7dc29872.91a5b8"]]},{"id":"7dc29872.91a5b8","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1763.5238876342773,"y":3840.5728858709335,"z":"c281e2a0.b9793","wires":[["8e11fe1e.0c602","b29ec429.4a9cd8"]]},{"id":"8924a698.c39db8","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":1604.6666221618652,"y":4061.6913427114487,"z":"c281e2a0.b9793","wires":[["97335d61.22ba5"]]},{"id":"e1abd020.26e2f","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":2022.9998741149902,"y":4063.6910985708237,"z":"c281e2a0.b9793","wires":[["d9c03e20.3fb9a","9450e20f.f2285","12eff2f5.e8988d","4e401ffc.c0185","35c23d78.e857f2","c3f481a4.4b488","482fcd9e.209524","d6877179.6bb64"]]},{"id":"8e11fe1e.0c602","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error reading VFC_RELATED_NETWORK_ROLE table\" />\n","comments":"","x":1915.6667442321777,"y":3837.3581231832504,"z":"c281e2a0.b9793","wires":[]},{"id":"9450e20f.f2285","type":"for","name":"for each vnf network","xml":"<for silentFailure='true' index='vnf-network-index' start='0' end='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network_length`' >\n","comments":"","outputs":1,"x":2218.000011444092,"y":3931.024754881859,"z":"c281e2a0.b9793","wires":[["e6786e9b.c0b27"]]},{"id":"d9c03e20.3fb9a","type":"set","name":"set found-related-network to false","xml":"<set>\n<parameter name='found-related-network' value='false' />\n","comments":"","x":2258.000087738037,"y":3872.6915315389633,"z":"c281e2a0.b9793","wires":[]},{"id":"efb78149.9b61c","type":"for","name":"for each related network","xml":"<for silentFailure='true' index='related-network-index' start='0' end='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network[$vnf-network-index].related-networks.related-network_length`' >\n","comments":"","outputs":1,"x":2616.999973297119,"y":3907.691018462181,"z":"c281e2a0.b9793","wires":[["cd1453b2.6f3a9"]]},{"id":"e6786e9b.c0b27","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":2406.000011444092,"y":3931.024754881859,"z":"c281e2a0.b9793","wires":[["efb78149.9b61c","90f69bfc.33fb08"]]},{"id":"cd1453b2.6f3a9","type":"switchNode","name":"switch network-role matches","xml":"<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network[$vnf-network-index].related-networks.related-network[$related-network-index].network-role\n  == $db.vnf-related-network-role[$db-related-network-index].related-network-role`'>\n","comments":"","outputs":1,"x":2868.9998893737793,"y":3907.6910947561264,"z":"c281e2a0.b9793","wires":[["cb14eefe.5a2de"]]},{"id":"97335d61.22ba5","type":"for","name":"for each db related-network","xml":"<for index='db-related-network-index' start='0' end='`$db.vnf-related-network-role_length`' >\n","comments":"","outputs":1,"x":1808.9999961853027,"y":4062.3580907583237,"z":"c281e2a0.b9793","wires":[["e1abd020.26e2f"]]},{"id":"e5c4c3e9.dd075","type":"call","name":"call GENERIC-RESOURCE-API:vf-module-topology-assign-rollback","xml":"<call module='GENERIC-RESOURCE-API' rpc='vf-module-topology-assign-rollback' mode='sync' >\n","comments":"","outputs":1,"x":290.00024032592773,"y":6968.359683454037,"z":"c281e2a0.b9793","wires":[[]]},{"id":"cb14eefe.5a2de","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":3068.9998893737793,"y":3905.6910947561264,"z":"c281e2a0.b9793","wires":[["9fb5cd77.e59a9"]]},{"id":"9fb5cd77.e59a9","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":3222.9998893737793,"y":3903.6910947561264,"z":"c281e2a0.b9793","wires":[["b5846dc6.9806f","513c0287.6cfb6c","267283a1.50d3ec"]]},{"id":"b5846dc6.9806f","type":"set","name":"set found-related-network to true","xml":"<set>\n<parameter name='found-related-network' value='true' />\n","comments":"","x":3455.0000495910645,"y":3863.357678771019,"z":"c281e2a0.b9793","wires":[]},{"id":"513c0287.6cfb6c","type":"break","name":"break","xml":"<break>\n","comments":"","x":3378.333225250244,"y":3950.0244287252426,"z":"c281e2a0.b9793","wires":[]},{"id":"12eff2f5.e8988d","type":"switchNode","name":"switch found-related-network","xml":"<switch test='`$found-related-network`'>\n","comments":"","outputs":1,"x":2240.999942779541,"y":4006.691232085228,"z":"c281e2a0.b9793","wires":[["bc751607.8087a8"]]},{"id":"bc751607.8087a8","type":"outcomeFalse","name":"false","xml":"<outcome value='false'>\n","comments":"","outputs":1,"x":2434.999942779541,"y":4004.691232085228,"z":"c281e2a0.b9793","wires":[["60aa6286.70a78c"]]},{"id":"da9b1694.5bb218","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unable to find related network '\n      + $db.vnf-related-network-role[$db-related-network-index].related-network-role + ' in vnf-networks'`\" />\n","comments":"","x":2712.999942779541,"y":4002.691232085228,"z":"c281e2a0.b9793","wires":[]},{"id":"60aa6286.70a78c","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":2564.999942779541,"y":4004.691232085228,"z":"c281e2a0.b9793","wires":[["da9b1694.5bb218","b29ec429.4a9cd8"]]},{"id":"b29ec429.4a9cd8","type":"call","name":"call GENERIC-RESOURCE-API:vf-module-topology-assign-rollback","xml":"<call module='GENERIC-RESOURCE-API' rpc='vf-module-topology-assign-rollback' mode='sync' >\n","comments":"","outputs":1,"x":2657.6667442321777,"y":3767.3581231832504,"z":"c281e2a0.b9793","wires":[[]]},{"id":"4e401ffc.c0185","type":"set","name":"set is-trunked and segmentation-id in vm-network","xml":"<set>\n<parameter name='$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$network-role-index].is-trunked'\n  value='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network[$saved-vnf-network-index].is-trunked`' />\n<parameter name='$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$network-role-index].segmentation-id'\n  value='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network[$saved-vnf-network-index].segmentation-id`' />\n","comments":"","x":2302.999942779541,"y":4054.691232085228,"z":"c281e2a0.b9793","wires":[]},{"id":"c3f481a4.4b488","type":"switchNode","name":"switch rn-index","xml":"<switch test='`$rn-index`'>\n","comments":"","outputs":1,"x":2190.999942779541,"y":4162.691232085228,"z":"c281e2a0.b9793","wires":[["ccb908a6.027e08"]]},{"id":"35c23d78.e857f2","type":"set","name":"set rn-index to related network length","xml":"<set>\n<parameter name='rn-index' value='`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$network-role-index].related-networks.related-network_length`' />\n","comments":"","x":2262.999942779541,"y":4106.691232085228,"z":"c281e2a0.b9793","wires":[]},{"id":"ccb908a6.027e08","type":"outcome","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":2354.999942779541,"y":4162.691232085228,"z":"c281e2a0.b9793","wires":[["4e1f13af.2c9acc"]]},{"id":"4e1f13af.2c9acc","type":"set","name":"set rn-index to 0","xml":"<set>\n<parameter name='rn-index' value='0' />\n","comments":"","x":2514.999942779541,"y":4162.691232085228,"z":"c281e2a0.b9793","wires":[]},{"id":"482fcd9e.209524","type":"set","name":"set related-network data","xml":"<set>\n<parameter name='tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$network-role-index].related-networks.related-network[$rn-index].network-id'\n  value='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network[$saved-vnf-network-index].related-networks.related-network[$saved-related-network-index].network-id`' />\n<parameter name='tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$network-role-index].related-networks.related-network[$rn-index].network-role'\n  value='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network[$saved-vnf-network-index].related-networks.related-network[$saved-related-network-index].network-role`' />\n<parameter name='tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$network-role-index].related-networks.related-network[$rn-index].vlan-tags.vlan-interface'\n  value='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network[$saved-vnf-network-index].related-networks.related-network[$saved-related-network-index].vlan-tags.vlan-interface`' />\n<parameter name='tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$network-role-index].related-networks.related-network[$rn-index].vlan-tags.lower-tag-id'\n  value='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network[$saved-vnf-network-index].related-networks.related-network[$saved-related-network-index].vlan-tags.lower-tag-id`' />\n<parameter name='tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$network-role-index].related-networks.related-network[$rn-index].vlan-tags.upper-tag-id'\n  value='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network[$saved-vnf-network-index].related-networks.related-network[$saved-related-network-index].vlan-tags.upper-tag-id`' />\n<parameter name='tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$network-role-index].related-networks.related-network[$rn-index].vlan-tags.is-private'\n  value='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network[$saved-vnf-network-index].related-networks.related-network[$saved-related-network-index].vlan-tags.is-private`' />\n","comments":"","x":2214.999942779541,"y":4214.691232085228,"z":"c281e2a0.b9793","wires":[]},{"id":"d6877179.6bb64","type":"set","name":"set new related network length","xml":"<set>\n<parameter name='tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$network-role-index].related-networks.related-network_length'\n  value='`$rn-index + 1`' />\n","comments":"","x":2232.999942779541,"y":4266.691232085228,"z":"c281e2a0.b9793","wires":[]},{"id":"90f69bfc.33fb08","type":"switchNode","name":"switch found-related-network","xml":"<switch test='`$found-related-network`'>\n","comments":"","outputs":1,"x":2629.9999961853027,"y":3955.3578790426254,"z":"c281e2a0.b9793","wires":[["bd4bfde9.e323c"]]},{"id":"bd4bfde9.e323c","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":2826.6668586730957,"y":3955.358250975609,"z":"c281e2a0.b9793","wires":[["14ae2838.2b3c78"]]},{"id":"14ae2838.2b3c78","type":"break","name":"break","xml":"<break>\n","comments":"","x":2956.6667442321777,"y":3953.6913751363754,"z":"c281e2a0.b9793","wires":[]},{"id":"267283a1.50d3ec","type":"set","name":"save indexes","xml":"<set>\n<parameter name='saved-vnf-network-index' value='`$vnf-network-index`' />\n<parameter name='saved-related-network-index' value='`$related-network-index`' />\n","comments":"","x":3396.6669578552246,"y":3905.35824906826,"z":"c281e2a0.b9793","wires":[]},{"id":"3967ae4a.28f732","type":"execute","name":"generate cp-instance-id","xml":"<execute plugin=\"org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils\" method=\"generateUUID\" >\n<parameter name=\"ctx-destination\" value=\"cp-instance-id\" />\n","comments":"","outputs":1,"x":1685.5714492797852,"y":4934.882302165031,"z":"c281e2a0.b9793","wires":[[]]},{"id":"194fb60a.c8055a","type":"save","name":"save cp to A&AI","xml":"<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"cp\" \n\tkey=\"vnfc.vnfc-name = $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-name\n\t  AND cp.cp-instance-id = $cp-instance-id\" >\n<parameter name=\"cp-instance-id\" value=\"`$cp-instance-id`\" />\n<parameter name=\"port-id\" value=\"0\" />\n","comments":"","outputs":1,"x":1667.2380714416504,"y":5001.54880797863,"z":"c281e2a0.b9793","wires":[["fc15bfb9.1690c","8fc1b804.471888"]]},{"id":"fc15bfb9.1690c","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1856.238052368164,"y":4977.215421497822,"z":"c281e2a0.b9793","wires":[["8be276b1.529838"]]},{"id":"8be276b1.529838","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":2023.404800415039,"y":4993.009855091572,"z":"c281e2a0.b9793","wires":[["4c72e4b8.c8b60c","78584413.02195c"]]},{"id":"8fc1b804.471888","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":1861.238052368164,"y":5026.881681263447,"z":"c281e2a0.b9793","wires":[["8be276b1.529838"]]},{"id":"4c72e4b8.c8b60c","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error creating cp object in AAI\" />\n","comments":"","x":2188.904811859131,"y":5004.882059931755,"z":"c281e2a0.b9793","wires":[]},{"id":"58d1d842.f73148","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":1462.0477714538574,"y":5204.167096018791,"z":"c281e2a0.b9793","wires":[["2a88c37a.f52dfc","cda369d7.15b748","3967ae4a.28f732","194fb60a.c8055a","82edde6c.cbd8c","d791c619.1c0de8"]]},{"id":"2a88c37a.f52dfc","type":"set","name":"set connection point data","xml":"<set>\n<parameter name='tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-networks.vnfc-network-data[$network-role-index].connection-point.connection-point-id'\n  value='`$cp-instance-id`' />\n<parameter name='tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-networks.vnfc-network-data[$network-role-index].connection-point.port-id'\n  value='0' />\n","comments":"","x":1697.5716133117676,"y":5079.406377673149,"z":"c281e2a0.b9793","wires":[]},{"id":"f7e0fa09.0da6e8","type":"comment","name":"Floating IPs","info":"","comments":"","x":1258.3334312438965,"y":6061.69149595499,"z":"c281e2a0.b9793","wires":[]},{"id":"82edde6c.cbd8c","type":"for","name":"for each vnf-network","xml":"<for index='vnf-network-index' start='0' end='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network_length`' >\n","comments":"","outputs":1,"x":1681.6666145324707,"y":5475.691871523857,"z":"c281e2a0.b9793","wires":[["23327f6f.5cc69"]]},{"id":"3f52c68d.db16fa","type":"save","name":"save cp relationship to l3-network","xml":"<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\"\n   resource=\"cp:relationship-list\"\n   key=\"vnfc.vnfc-name = $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-name\n     AND cp.cp-instance-id = $cp-instance-id\"\n   force=\"true\" pfx=\"tmp.AnAI-data\">\n    <parameter name=\"relationship-list.relationship[0].related-to\" value=\"l3-network\" />\n    <parameter name=\"relationship-list.relationship[0].related-link\"\n      value=\"`'/aai/v$/network/l3-networks/l3-network/' +\n        $service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network[$vnf-network-index].network-id`\" />\n","comments":"","outputs":1,"x":2320.0000953674316,"y":5475.358379244804,"z":"c281e2a0.b9793","wires":[["23e092ca.2884de","19f8e772.a624f9"]]},{"id":"cc5fddd3.e7b56","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":2691.8331336975098,"y":5448.676327586174,"z":"c281e2a0.b9793","wires":[["5e6832c6.09c0bc","bb628391.808e8"]]},{"id":"cf31ae7c.336ef","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":2691.833209991455,"y":5501.676086306572,"z":"c281e2a0.b9793","wires":[["5e6832c6.09c0bc","7b795e56.3998d"]]},{"id":"23e092ca.2884de","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":2535.0000190734863,"y":5448.691997408867,"z":"c281e2a0.b9793","wires":[["cc5fddd3.e7b56"]]},{"id":"19f8e772.a624f9","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":2543.5715522766113,"y":5501.311141848564,"z":"c281e2a0.b9793","wires":[["cf31ae7c.336ef"]]},{"id":"bb628391.808e8","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating cp relationship to l3-network in AAI\" />\n","comments":"","x":2863.999942779541,"y":5471.358703494071,"z":"c281e2a0.b9793","wires":[]},{"id":"7b795e56.3998d","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Not-found error updating cp relationship to l3-network\" />\n","comments":"","x":2859.166851043701,"y":5523.009910464286,"z":"c281e2a0.b9793","wires":[]},{"id":"5e6832c6.09c0bc","type":"call","name":"call GENERIC-RESOURCE-API:vf-module-topology-assign-rollback","xml":"<call module='GENERIC-RESOURCE-API' rpc='vf-module-topology-assign-rollback' mode='sync' >\n","comments":"","outputs":1,"x":3065.666706085205,"y":5421.358701586723,"z":"c281e2a0.b9793","wires":[[]]},{"id":"d791c619.1c0de8","type":"for","name":"for each vm-network","xml":"<for silentFailure='true' index='network-role-index' start='0' end='`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network_length`' >\n","comments":"","outputs":1,"x":1681.6667671203613,"y":5636.358226656914,"z":"c281e2a0.b9793","wires":[["5ca9d01e.1d8bc"]]},{"id":"3c0da287.0cae0e","type":"save","name":"save cp relationship to l3-network and vlan-tag","xml":"<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\"\n   resource=\"cp:relationship-list\"\n   key=\"vnfc.vnfc-name = $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-name\n     AND cp.cp-instance-id = $cp-instance-id\"\n   force=\"true\" pfx=\"tmp.AnAI-data\">\n    <parameter name=\"relationship-list.relationship[0].related-to\" value=\"l3-network\" />\n    <parameter name=\"relationship-list.relationship[0].related-link\"\n      value=\"`'/aai/v$/network/l3-networks/l3-network/' +\n        $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$network-role-index].related-networks.related-network[$related-network-index].network-id`\" />\n    <parameter name=\"relationship-list.relationship[1].related-to\" value=\"vlan-tag\" />\n    <parameter name=\"relationship-list.relationship[1].related-link\"\n      value=\"`'/aai/v$/network/vlan-tags/vlan-tag/' +\n        $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$network-role-index].related-networks.related-network[$related-network-index].vlan-tags.vlan-interface`\" />\n","comments":"","outputs":1,"x":2601.3337745666504,"y":5634.358221888542,"z":"c281e2a0.b9793","wires":[["4f85a505.0270ec","8f924327.75574"]]},{"id":"872090c1.b706b","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":3008.166820526123,"y":5607.675520777703,"z":"c281e2a0.b9793","wires":[["b515575c.247648","5e6832c6.09c0bc"]]},{"id":"561ae9eb.72a478","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":3008.1668968200684,"y":5660.675279498101,"z":"c281e2a0.b9793","wires":[["1d965a07.e719f6","5e6832c6.09c0bc"]]},{"id":"4f85a505.0270ec","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":2851.3337059020996,"y":5607.691190600396,"z":"c281e2a0.b9793","wires":[["872090c1.b706b"]]},{"id":"8f924327.75574","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":2859.9052391052246,"y":5660.310335040093,"z":"c281e2a0.b9793","wires":[["561ae9eb.72a478"]]},{"id":"b515575c.247648","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating cp relationship to l3-network and vlan-tag in AAI\" />\n","comments":"","x":3180.3336296081543,"y":5630.3578966856,"z":"c281e2a0.b9793","wires":[]},{"id":"1d965a07.e719f6","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Not-found error updating cp relationship to l3-network and vlan-tag\" />\n","comments":"","x":3175.5005378723145,"y":5682.009103655815,"z":"c281e2a0.b9793","wires":[]},{"id":"de59419e.974cd","type":"for","name":"for each related-network","xml":"<for silentFailure='true' index='related-network-index' start='0' end='`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$network-role-index].related-networks.related-network_length`' >\n","comments":"","outputs":1,"x":2297.3336067199707,"y":5634.3582228422165,"z":"c281e2a0.b9793","wires":[["3c0da287.0cae0e"]]},{"id":"b3a603a5.80e31","type":"call","name":"call GENERIC-RESOURCE-API:vf-module-generate-heat-parameters","xml":"<call module='GENERIC-RESOURCE-API' rpc='vf-module-generate-heat-parameters' mode='sync' >\n","comments":"","outputs":1,"x":555.6669006347656,"y":6877.358483314514,"z":"c281e2a0.b9793","wires":[[]]},{"id":"c04c47f5.514678","type":"execute","name":"printContext","xml":"<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='printContext' >\n<parameter name='filename' value='/var/tmp/bgb-vfmoduleheat.log' />\n","comments":"","outputs":1,"x":377.00022888183594,"y":6925.35858631134,"z":"c281e2a0.b9793","wires":[[]]},{"id":"cdfcaf85.62d64","type":"switchNode","name":"switch input vf-module-name","xml":"<switch test='`$vf-module-topology-operation-input.vf-module-request-input.vf-module-name`'>\n","comments":"","outputs":1,"x":528.3333320617676,"y":2361.1910442113876,"z":"c281e2a0.b9793","wires":[["a0874d5.7e761b","985e8945.d74038"]]},{"id":"a0874d5.7e761b","type":"outcome","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":728.333324432373,"y":2338.6909469366074,"z":"c281e2a0.b9793","wires":[["e5249593.3b52e8"]]},{"id":"985e8945.d74038","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":729.7619361877441,"y":2388.8101695775986,"z":"c281e2a0.b9793","wires":[["16645c8e.451fe3"]]},{"id":"63bfe42c.9fb95c","type":"for","name":"for each vnfc-subnet-role","xml":"<for index='subnet-role-index' start='0'\n  end='`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-networks.vnfc-network-data[$vnfc-network-index].vnfc-subnet_length`' >\n","comments":"","outputs":1,"x":1285.8334312438965,"y":3156.1907209157944,"z":"c281e2a0.b9793","wires":[["1e64ed59.1e5183"]]},{"id":"1e64ed59.1e5183","type":"for","name":"for each vnfc-address-family","xml":"<for index='address-family-index' start='0'\n  end='`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-networks.vnfc-network-data[$vnfc-network-index].vnfc-subnet[$subnet-role-index].vnfc-ip-assignments_length`' >\n","comments":"","outputs":1,"x":1534.166690826416,"y":3156.1907209157944,"z":"c281e2a0.b9793","wires":[["fea6d69d.d54528"]]},{"id":"47fa3ee6.d0e38","type":"for","name":"for each vm-type","xml":"<for silentFailure='true' index='vm-type-index' start='0' end='`$tmp.vf-module-topology.vf-module-assignments.vms.vm_length`' >\n","comments":"","outputs":1,"x":491.6666069030762,"y":2874.5240577459335,"z":"c281e2a0.b9793","wires":[["28ec4405.9a39ec"]]},{"id":"28ec4405.9a39ec","type":"for","name":"for each vnfc","xml":"<for silentFailure='true' index='vnfc-index' start='0' end='`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names_length`' >\n","comments":"","outputs":1,"x":673.3333854675293,"y":2873.1912063360214,"z":"c281e2a0.b9793","wires":[["45de94d5.73101c"]]},{"id":"45de94d5.73101c","type":"for","name":"for each vnfc-network","xml":"<for silentFailure='true' index='vnfc-network-index' start='0' end='`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-networks.vnfc-network-data_length`' >\n","comments":"","outputs":1,"x":874.4999580383301,"y":2873.0238956212997,"z":"c281e2a0.b9793","wires":[["ca740cea.e62d6"]]},{"id":"ca740cea.e62d6","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":1086.6666297912598,"y":2872.0242561101913,"z":"c281e2a0.b9793","wires":[["cbe13ead.16c16","7d23e100.1f668","362b374d.7670e8","63bfe42c.9fb95c"]]},{"id":"cbe13ead.16c16","type":"set","name":"set vnf-network-index to -1","xml":"<set>\n<parameter name='vnf-network-index' value='-1' />\n","comments":"","x":1298.3333473205566,"y":2825.3574699163437,"z":"c281e2a0.b9793","wires":[]},{"id":"7d23e100.1f668","type":"for","name":"for each vnf-network","xml":"<for index='idx' start='0' end='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network_length`' >\n","comments":"","outputs":1,"x":1280.0001373291016,"y":2872.024221777916,"z":"c281e2a0.b9793","wires":[["d69233bc.c9992"]]},{"id":"d69233bc.c9992","type":"switchNode","name":"switch network-roles match?","xml":"<switch test='`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-networks.vnfc-network-data[$vnfc-network-index].vnfc-network-role\n  == $service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network[$idx].network-role`'>\n","comments":"","outputs":1,"x":1521.6666069030762,"y":2870.3577169179916,"z":"c281e2a0.b9793","wires":[["4417b7d7.ed8cf8"]]},{"id":"4417b7d7.ed8cf8","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":1718.3332862854004,"y":2870.3576358556747,"z":"c281e2a0.b9793","wires":[["8d8e6fbf.ff49c"]]},{"id":"8d8e6fbf.ff49c","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":1871.6665077209473,"y":2870.3575080633163,"z":"c281e2a0.b9793","wires":[["cdb9a81.db01858","a342ffc7.9707f","3fd4ae58.22bfd2"]]},{"id":"cdb9a81.db01858","type":"set","name":"set vnf-network-index","xml":"<set>\n<parameter name='vnf-network-index' value='`$idx`' />\n","comments":"","x":2078.333339691162,"y":2818.690885901451,"z":"c281e2a0.b9793","wires":[]},{"id":"a342ffc7.9707f","type":"break","name":"break","xml":"<break>\n","comments":"","x":2033.3332557678223,"y":2908.690806746483,"z":"c281e2a0.b9793","wires":[]},{"id":"362b374d.7670e8","type":"switchNode","name":"switch vnf-network-index","xml":"<switch test='`$vnf-network-index`'>\n","comments":"","outputs":1,"x":1291.666675567627,"y":2932.0242236852646,"z":"c281e2a0.b9793","wires":[["5e7cd6b.8449228"]]},{"id":"5e7cd6b.8449228","type":"outcome","name":"-1","xml":"<outcome value='-1'>\n","comments":"","outputs":1,"x":1483.3333168029785,"y":2932.0244678258896,"z":"c281e2a0.b9793","wires":[["9244fe7f.31bdd"]]},{"id":"9244fe7f.31bdd","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":1631.6665077209473,"y":2930.3575080633163,"z":"c281e2a0.b9793","wires":[["870865f7.4f7ae8","59ea4147.35ab6"]]},{"id":"870865f7.4f7ae8","type":"call","name":"call GENERIC-RESOURCE-API:vf-module-topology-assign-rollback","xml":"<call module='GENERIC-RESOURCE-API' rpc='vf-module-topology-assign-rollback' mode='sync' >\n","comments":"","outputs":1,"x":3160.000141143799,"y":2782.0240854024887,"z":"c281e2a0.b9793","wires":[[]]},{"id":"59ea4147.35ab6","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'VNFC network role '\n      + $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-networks.vnfc-network-data[$vnfc-network-index].vnfc-network-role\n      + ' is not found in VNF network list'\n      `\" />\n\n\n\n","comments":"","x":1799.9998817443848,"y":2948.6907600164413,"z":"c281e2a0.b9793","wires":[]},{"id":"2a4765c5.30e19a","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":2323.333225250244,"y":3340.357359290123,"z":"c281e2a0.b9793","wires":[["7fb715db.138d3c","3542e589.394d0a","58b2c621.464728"]]},{"id":"7fb715db.138d3c","type":"for","name":"for each subnet-data","xml":"<for index='subnet-data-index' start='0' end='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network[$vnf-network-index].subnets-data.subnet-data_length`' >\n","comments":"","outputs":1,"x":2519.9999771118164,"y":3295.357278227806,"z":"c281e2a0.b9793","wires":[["747e7dc0.12e944"]]},{"id":"747e7dc0.12e944","type":"switchNode","name":"address-families match?","xml":"<switch test='`$tmp.address-family\n  == $service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network[$vnf-network-index].subnets-data.subnet-data[$subnet-data-index].ip-version`'>\n","comments":"","outputs":1,"x":2746.666603088379,"y":3295.357278227806,"z":"c281e2a0.b9793","wires":[["ed980615.6f71e8"]]},{"id":"ed980615.6f71e8","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":2926.6665687561035,"y":3295.357684493065,"z":"c281e2a0.b9793","wires":[["d55384f.ba55f78"]]},{"id":"b9054984.486ce8","type":"set","name":"set tmp.address-family","xml":"<set>\n<parameter name='tmp.address-family'\n  value='`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-networks.vnfc-network-data[$vnfc-network-index].vnfc-subnet[$subnet-role-index].vnfc-ip-assignments[$address-family-index].vnfc-address-family`' />\n","comments":"","x":2351.666561126709,"y":3158.6907724142075,"z":"c281e2a0.b9793","wires":[]},{"id":"fea6d69d.d54528","type":"switchNode","name":"switch vnfc-subnet-ip_length","xml":"<switch test='`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-networks.vnfc-network-data[$vnfc-network-index].vnfc-subnet[$subnet-role-index].vnfc-ip-assignments[$address-family-index].vnfc-subnet-ip_length`'>\n","comments":"","outputs":1,"x":1796.666904449463,"y":3155.3578075170517,"z":"c281e2a0.b9793","wires":[["6ff2b1b6.97745","1dd0e662.d10d8a","5ba80aca.dec534"]]},{"id":"6ff2b1b6.97745","type":"outcome","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":1998.3334159851074,"y":3055.357350707054,"z":"c281e2a0.b9793","wires":[["15aeaeb0.b6c1f1"]]},{"id":"1dd0e662.d10d8a","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":1994.7620468139648,"y":3241.3096421957016,"z":"c281e2a0.b9793","wires":[["bfd0cd27.17874"]]},{"id":"15aeaeb0.b6c1f1","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":2129.9999656677246,"y":3078.024097800255,"z":"c281e2a0.b9793","wires":[[]]},{"id":"6b48e8f1.05ab58","type":"set","name":"set subnet-id to -1","xml":"<set>\n<parameter name='subnet-id' value='-1' />\n","comments":"","x":3020.0004844665527,"y":3457.024764418602,"z":"c281e2a0.b9793","wires":[]},{"id":"bfd0cd27.17874","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":2148.3334617614746,"y":3240.357274413109,"z":"c281e2a0.b9793","wires":[["b9054984.486ce8","2a4765c5.30e19a"]]},{"id":"63d0a0de.61222","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":4280.000082015991,"y":3628.6912413835526,"z":"c281e2a0.b9793","wires":[["3e091462.40e70c","aaa9a679.f9ece8"]]},{"id":"aaa9a679.f9ece8","type":"execute","name":"execute isInSameSubnet","xml":"<execute plugin=\"com.att.sdnctl.sli.plugin.ipAddressTools.IpAddressTool\" method=\"isInSameSubnet\">\n\t<parameter name=\"firstIPAddr\" value=\"`$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network[$vnf-network-index].subnets-data.subnet-data[$subnet-data-index].network-start-address`\" />\n\t<parameter name=\"secondIPAddr\" value=\"`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-networks.vnfc-network-data[$vnfc-network-index].vnfc-subnet[$subnet-role-index].vnfc-ip-assignments[$address-family-index].vnfc-subnet-ip[0].vnfc-ip-address`\" />\n\t<parameter name=\"subnet\" value=\"`$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network[$vnf-network-index].subnets-data.subnet-data[$subnet-data-index].cidr-mask`\" />\n\t<parameter name=\"ipType\" value=\"`$ip-type`\" />\n","comments":"","outputs":1,"x":4495.00008392334,"y":3678.6909152269363,"z":"c281e2a0.b9793","wires":[["a4b9a2d6.98cf9"]]},{"id":"3e091462.40e70c","type":"switchNode","name":"switch tmp.address-family","xml":"<switch test='`$tmp.address-family`'>\n","comments":"","outputs":1,"x":4496.667240142822,"y":3585.3579016923904,"z":"c281e2a0.b9793","wires":[["13cdd504.b1a3ab","cb684de4.29a3e"]]},{"id":"13cdd504.b1a3ab","type":"outcome","name":"ipv4","xml":"<outcome value='ipv4'>\n","comments":"","outputs":1,"x":4700.000502268473,"y":3558.6911320288973,"z":"c281e2a0.b9793","wires":[["7ea6517b.eea13"]]},{"id":"cb684de4.29a3e","type":"outcome","name":"ipv6","xml":"<outcome value='ipv6'>\n","comments":"","outputs":1,"x":4700.000175476074,"y":3605.357659459114,"z":"c281e2a0.b9793","wires":[["1086dd41.8fbd03"]]},{"id":"7ea6517b.eea13","type":"set","name":"set ip-type parameter to IPv4","xml":"<set>\n<parameter name='ip-type' value='IPv4' />\n","comments":"","x":4896.666988372803,"y":3557.024605870247,"z":"c281e2a0.b9793","wires":[]},{"id":"1086dd41.8fbd03","type":"set","name":"set ip-type parameter to IPv6","xml":"<set>\n<parameter name='ip-type' value='IPv6' />\n","comments":"","x":4901.66686630249,"y":3605.3576785326004,"z":"c281e2a0.b9793","wires":[]},{"id":"7fc46df.2b38294","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":4835.000114440918,"y":3678.3576785326004,"z":"c281e2a0.b9793","wires":[["4cf41fe7.a3106","74f11025.3f1fc"]]},{"id":"4cf41fe7.a3106","type":"set","name":"set subnet-id","xml":"<set>\n<parameter name='subnet-id' value='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network[$vnf-network-index].subnets-data.subnet-data[$subnet-data-index].sdnc-subnet-id`' />\n","comments":"","x":5013.333435058594,"y":3655.0241652727127,"z":"c281e2a0.b9793","wires":[]},{"id":"74f11025.3f1fc","type":"break","name":"break","xml":"<break>\n","comments":"","x":4998.333438873291,"y":3701.6911593675613,"z":"c281e2a0.b9793","wires":[]},{"id":"d31bd158.412b6","type":"switchNode","name":"switch subnet-id","xml":"<switch test='`$subnet-id`'>\n","comments":"","outputs":1,"x":3011.666358947754,"y":3618.6914991140366,"z":"c281e2a0.b9793","wires":[["c2f0bf51.995e6"]]},{"id":"c2f0bf51.995e6","type":"outcome","name":"-1","xml":"<outcome value='-1'>\n","comments":"","outputs":1,"x":3168.33292388916,"y":3618.691434264183,"z":"c281e2a0.b9793","wires":[["dede0c8.bac57f"]]},{"id":"dede0c8.bac57f","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":3316.666114807129,"y":3617.02447450161,"z":"c281e2a0.b9793","wires":[["ca343905.3a2938","870865f7.4f7ae8"]]},{"id":"ca343905.3a2938","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Not able to find VNF network subnet that contains address '\n      + $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-networks.vnfc-network-data[$vnfc-network-index].vnfc-subnet[$subnet-role-index].vnfc-ip-assignments[$address-family-index].vnfc-subnet-ip[0].vnfc-ip-address\n      `\" />\n\n\n\n","comments":"","x":3484.9994468688965,"y":3633.6909497976303,"z":"c281e2a0.b9793","wires":[]},{"id":"ff78938e.825b6","type":"set","name":"set subnet-id in vnfc-ip-assignments (temp variable)","xml":"<set>\n<parameter name='tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-networks.vnfc-network-data[$vnfc-network-index].vnfc-subnet[$subnet-role-index].vnfc-ip-assignments[$address-family-index].subnet-id' value='`$subnet-id`' />\n","comments":"","x":3123.3330039978027,"y":3695.358270049095,"z":"c281e2a0.b9793","wires":[]},{"id":"3701ddfc.549122","type":"execute","name":"printContext","xml":"<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='printContext' >\n<parameter name='filename' value='/var/tmp/bgb-vfmodulec.log' />\n","comments":"","outputs":1,"x":476.66659927368164,"y":3290.3575080633163,"z":"c281e2a0.b9793","wires":[[]]},{"id":"a4b9a2d6.98cf9","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":4681.666687011719,"y":3678.6914035081863,"z":"c281e2a0.b9793","wires":[["7fc46df.2b38294"]]},{"id":"3fd4ae58.22bfd2","type":"set","name":"set network-id","xml":"<set>\n<parameter name='$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-networks.vnfc-network-data[$vnfc-network-index].network-id'\n  value='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network[$idx].network-id`' />\n","comments":"","x":2054.999843597412,"y":2863.6909688711166,"z":"c281e2a0.b9793","wires":[]},{"id":"8511c134.e2a8c","type":"switchNode","name":"switch nfc-naming-code","xml":"<switch test='`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].nfc-naming-code`'>\n","comments":"","outputs":1,"x":1253.333309173584,"y":4478.690696597099,"z":"c281e2a0.b9793","wires":[["fefb667e.d34c38","d37e094c.044388"]]},{"id":"fefb667e.d34c38","type":"outcome","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":1438.3332557678223,"y":4453.690515398979,"z":"c281e2a0.b9793","wires":[["22f4451.03ddbba"]]},{"id":"d37e094c.044388","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":1436.4285278320312,"y":4500.476343035698,"z":"c281e2a0.b9793","wires":[["538b8daa.f6cfd4"]]},{"id":"22f4451.03ddbba","type":"set","name":"set tmp.nfc-naming-code to DEFAULT","xml":"<set>\n<parameter name='tmp.nfc-naming-code' value='DEFAULT' />\n","comments":"","x":1670.0000267028809,"y":4452.023865580559,"z":"c281e2a0.b9793","wires":[]},{"id":"538b8daa.f6cfd4","type":"set","name":"set tmp.nfc-naming-code","xml":"<set>\n<parameter name='tmp.nfc-naming-code' value='`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].nfc-naming-code`' />\n","comments":"","x":1626.6665382385254,"y":4500.357363581657,"z":"c281e2a0.b9793","wires":[]},{"id":"502f3bfc.44fe14","type":"switchNode","name":"switch nfc-function","xml":"<switch test='`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].nfc-function`'>\n","comments":"","outputs":1,"x":1241.6666412353516,"y":4577.02387034893,"z":"c281e2a0.b9793","wires":[["e45a052c.062058","3fa16d0d.6e4072"]]},{"id":"e45a052c.062058","type":"outcome","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":1438.3332481384277,"y":4552.023668169975,"z":"c281e2a0.b9793","wires":[["f1f8cad2.a52678"]]},{"id":"3fa16d0d.6e4072","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":1436.4285202026367,"y":4598.809495806694,"z":"c281e2a0.b9793","wires":[["b39423fa.914b2"]]},{"id":"f1f8cad2.a52678","type":"set","name":"set tmp.nfc-function to DEFAULT","xml":"<set>\n<parameter name='tmp.nfc-function' value='DEFAULT' />\n","comments":"","x":1650.0000305175781,"y":4550.356877207756,"z":"c281e2a0.b9793","wires":[]},{"id":"b39423fa.914b2","type":"set","name":"set tmp.nfc-function","xml":"<set>\n<parameter name='tmp.nfc-function' value='`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].nfc-function`' />\n","comments":"","x":1608.3331604003906,"y":4598.690538287163,"z":"c281e2a0.b9793","wires":[]},{"id":"335ebcdf.36a974","type":"call","name":"call GENERIC-RESOURCE-API:vf-module-topology-assign-rollback","xml":"<call module='GENERIC-RESOURCE-API' rpc='vf-module-topology-assign-rollback' mode='sync' >\n","comments":"","outputs":1,"x":2881.6666297912598,"y":2233.6910041570663,"z":"c281e2a0.b9793","wires":[[]]},{"id":"5b13f1bd.9caa2","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":2788.3331336975098,"y":2308.6910041570663,"z":"c281e2a0.b9793","wires":[["d1ff1b92.db4a78","335ebcdf.36a974"]]},{"id":"9d4e3c9a.59748","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":1993.3331871032715,"y":2368.690867781639,"z":"c281e2a0.b9793","wires":[["587561df.2ca4a","335ebcdf.36a974"]]},{"id":"893d3e7a.e5b1f","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":2255.000051498413,"y":2423.6910346746445,"z":"c281e2a0.b9793","wires":[["f8e976f1.7db4f8","335ebcdf.36a974"]]},{"id":"23327f6f.5cc69","type":"switchNode","name":"switch network-roles match?","xml":"<switch test='`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-networks.vnfc-network-data[$network-role-index].vnfc-network-role\n  == $service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network[$vnf-network-index].network-role`'>\n","comments":"","outputs":1,"x":1914.99995803833,"y":5475.69089782238,"z":"c281e2a0.b9793","wires":[["855fc1b0.470bd"]]},{"id":"855fc1b0.470bd","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":2113.333427429199,"y":5475.358053088188,"z":"c281e2a0.b9793","wires":[["3f52c68d.db16fa"]]},{"id":"5ca9d01e.1d8bc","type":"switchNode","name":"switch network-roles match?","xml":"<switch test='`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$network-role-index].network-role\n  == $service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network[$vnf-network-index].network-role`'>\n","comments":"","outputs":1,"x":1918.3333015441895,"y":5635.357345461845,"z":"c281e2a0.b9793","wires":[["f791184e.351938"]]},{"id":"f791184e.351938","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":2116.6667709350586,"y":5635.0245007276535,"z":"c281e2a0.b9793","wires":[["de59419e.974cd"]]},{"id":"d11c836e.c57ae","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":1821.6665840148926,"y":6213.69076526165,"z":"c281e2a0.b9793","wires":[["16a29da1.16be62","4f07c4c.b2fe53c"]]},{"id":"2e71e36.46fa41c","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":1823.3333320617676,"y":6528.690776705742,"z":"c281e2a0.b9793","wires":[["130606e9.a6f699","f15c2e92.d48f7"]]},{"id":"4f07c4c.b2fe53c","type":"for","name":"for each vnfc-network-role","xml":"<for silentFailure='true' index='vnfc-network-role-index' start='0' end='`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-networks.vnfc-network-data_length`' >\n","comments":"","outputs":1,"x":2038.3335304260254,"y":6272.023936152458,"z":"c281e2a0.b9793","wires":[["9934c0c5.d4a4f"]]},{"id":"e62cf23e.da265","type":"save","name":"save vip-ipv4-address-list relationship to cp","xml":"<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\"\n   resource=\"vip-ipv4-address-list:relationship-list\"\n   key=\"cloud-region.cloud-owner = $prop.cloud-region.cloud-owner\n\t  AND cloud-region.cloud-region-id = $vf-module-topology-operation-input.vf-module-request-input.aic-cloud-region\n\t  AND vip-ipv4-address-list.vip-ipv4-address = $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$vm-network-index].floating-ips.floating-ip-v4[$ipv4-index]\"\n   force=\"true\" pfx=\"tmp.AnAI-data\">\n    <parameter name=\"relationship-list.relationship[0].related-to\" value=\"cp\" />\n    <parameter name=\"relationship-list.relationship[0].related-link\"\n      value=\"`'/aai/v$/network/vnfcs/vnfc/'\n        + $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-name\n        + '/cps/cp/'\n        + $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-networks.vnfc-network-data[$vnfc-network-role-index].connection-point.connection-point-id`\" />\n","comments":"","outputs":1,"x":2713.33345413208,"y":6272.023774981499,"z":"c281e2a0.b9793","wires":[["cddad6ff.adc0f8","b720eecf.4edee"]]},{"id":"c5ca07d0.0eed48","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating vip-ipv4-address-list relationship to cp in AAI\" />\n","comments":"","x":3271.666675567627,"y":6265.357183337212,"z":"c281e2a0.b9793","wires":[]},{"id":"7d7a1cba.6ee544","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Not-found error updating vip-ipv4-address-list relationship to cp\" />\n","comments":"","x":3271.8336448669434,"y":6315.341357052326,"z":"c281e2a0.b9793","wires":[]},{"id":"41faa6f2.0ce628","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":3105.16654586792,"y":6245.341556429863,"z":"c281e2a0.b9793","wires":[["c5ca07d0.0eed48","d97fd47e.81be38"]]},{"id":"918c8065.51778","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":3105.1666221618652,"y":6298.341315150261,"z":"c281e2a0.b9793","wires":[["7d7a1cba.6ee544","d97fd47e.81be38"]]},{"id":"cddad6ff.adc0f8","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":2948.3334312438965,"y":6245.357226252556,"z":"c281e2a0.b9793","wires":[["41faa6f2.0ce628"]]},{"id":"b720eecf.4edee","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":2956.9049644470215,"y":6297.976370692253,"z":"c281e2a0.b9793","wires":[["918c8065.51778"]]},{"id":"f15c2e92.d48f7","type":"for","name":"for each vnfc-network-role","xml":"<for silentFailure='true' index='vnfc-network-role-index' start='0' end='`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-networks.vnfc-network-data_length`' >\n","comments":"","outputs":1,"x":2039.999927520752,"y":6595.357345461845,"z":"c281e2a0.b9793","wires":[["825e7345.364df"]]},{"id":"6956e16a.25406","type":"save","name":"save vip-ipv6-address-list relationship to cp","xml":"<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\"\n   resource=\"vip-ipv6-address-list:relationship-list\"\n   key=\"cloud-region.cloud-owner = $prop.cloud-region.cloud-owner\n\t  AND cloud-region.cloud-region-id = $vf-module-topology-operation-input.vf-module-request-input.aic-cloud-region\n\t  AND vip-ipv6-address-list.vip-ipv6-address = $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$vm-network-index].floating-ips.floating-ip-v6[$ipv6-index]\"\n   force=\"true\" pfx=\"tmp.AnAI-data\">\n    <parameter name=\"relationship-list.relationship[0].related-to\" value=\"cp\" />\n    <parameter name=\"relationship-list.relationship[0].related-link\"\n      value=\"`'/aai/v$/network/vnfcs/vnfc/'\n        + $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-name\n        + '/cps/cp/'\n        + $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-networks.vnfc-network-data[$vnfc-network-role-index].connection-point.connection-point-id`\" />\n","comments":"","outputs":1,"x":2709.9998817443848,"y":6593.690128207207,"z":"c281e2a0.b9793","wires":[["2f5ed9c4.0c68e6","71893f41.6f1ae"]]},{"id":"8e980bb1.a44fd8","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating vip-ipv4-address-list relationship to cp in AAI\" />\n","comments":"","x":3268.3331031799316,"y":6587.02353656292,"z":"c281e2a0.b9793","wires":[]},{"id":"ab83bee.d05ae4","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Not-found error updating vip-ipv4-address-list relationship to cp\" />\n","comments":"","x":3268.500072479248,"y":6637.007710278034,"z":"c281e2a0.b9793","wires":[]},{"id":"d0ad927.298097","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":3101.8329734802246,"y":6567.007909655571,"z":"c281e2a0.b9793","wires":[["8e980bb1.a44fd8"]]},{"id":"5be147c2.a43998","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":3101.83304977417,"y":6620.007668375969,"z":"c281e2a0.b9793","wires":[["ab83bee.d05ae4"]]},{"id":"2f5ed9c4.0c68e6","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":2944.999858856201,"y":6567.023579478264,"z":"c281e2a0.b9793","wires":[["d0ad927.298097"]]},{"id":"71893f41.6f1ae","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":2953.571392059326,"y":6619.642723917961,"z":"c281e2a0.b9793","wires":[["5be147c2.a43998"]]},{"id":"9934c0c5.d4a4f","type":"switchNode","name":"switch network-roles match?","xml":"<switch test='`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$network-role-index].network-role\n  == $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-networks.vnfc-network-data[$vnfc-network-role-index].vnfc-network-role`'>\n","comments":"","outputs":1,"x":2291.6665992736816,"y":6272.023612856865,"z":"c281e2a0.b9793","wires":[["582dbc15.d387a4"]]},{"id":"582dbc15.d387a4","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":2478.3334426879883,"y":6272.024100184441,"z":"c281e2a0.b9793","wires":[["e62cf23e.da265"]]},{"id":"825e7345.364df","type":"switchNode","name":"switch network-roles match?","xml":"<switch test='`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-networks.vm-network[$network-role-index].network-role\n  == $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-networks.vnfc-network-data[$vnfc-network-role-index].vnfc-network-role`'>\n","comments":"","outputs":1,"x":2288.333179473877,"y":6593.690353274345,"z":"c281e2a0.b9793","wires":[["a65004e7.415cc8"]]},{"id":"a65004e7.415cc8","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":2475.0000228881836,"y":6593.690840601921,"z":"c281e2a0.b9793","wires":[["6956e16a.25406"]]},{"id":"3759e633.b179fa","type":"comment","name":"SELF-SERVE FORK","info":"","comments":"","x":658.0476226806641,"y":882.0476239919662,"z":"c281e2a0.b9793","wires":[]},{"id":"137fbedc.65c061","type":"call","name":"call self-serve-vf-module-assign","xml":"<call module='GENERIC-RESOURCE-API' rpc='self-serve-vf-module-assign' mode='sync' >\n","comments":"","outputs":1,"x":1191.0827674865723,"y":926.9644302129745,"z":"c281e2a0.b9793","wires":[["937bb6ab.d3e928"]]},{"id":"fdcc1343.84631","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Failed to create self-serve assignment for vf-module with vf-module-id=' + $vf-module-topology-operation-input.vf-module-information.vf-module-id + ' with error: ' + $error-message`\" />\n","comments":"","x":1575.1541442871094,"y":926.9643806219101,"z":"c281e2a0.b9793","wires":[]},{"id":"937bb6ab.d3e928","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1411.3803482055664,"y":926.4524616003036,"z":"c281e2a0.b9793","wires":[["fdcc1343.84631"]]},{"id":"6a0dafd2.849e5","type":"returnSuccess","name":"return success","xml":"<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n","comments":"","x":1137.9520111083984,"y":1076.8093494176865,"z":"c281e2a0.b9793","wires":[]},{"id":"cc9761fc.c3c32","type":"execute","name":"printContext","xml":"<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='printContext' >\n<parameter name='filename' value='/var/tmp/ss-vnfend.log' />\n","comments":"","outputs":1,"x":1129.99955368042,"y":1031.300893187523,"z":"c281e2a0.b9793","wires":[[]]},{"id":"a85a3080.68cd","type":"set","name":"set order-status to PendingCreate","xml":"<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-level-oper-status.order-status'\n  value='PendingCreate' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-level-oper-status.last-rpc-action'\n  value='`$vf-module-topology-operation-input.sdnc-request-header.svc-action`' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-level-oper-status.last-action'\n  value='`$vf-module-topology-operation-input.sdnc-request-header.request-action`' />\n","comments":"","x":1200.690071105957,"y":980.2617877721786,"z":"c281e2a0.b9793","wires":[]},{"id":"9c7519a.27013e8","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":911.7854995727539,"y":926.6425918340683,"z":"c281e2a0.b9793","wires":[["137fbedc.65c061","a85a3080.68cd","cc9761fc.c3c32","6a0dafd2.849e5"]]},{"id":"ef0240de.c2124","type":"comment","name":"First, count the subnets for this address family","info":"","comments":"","x":2653.3337364196777,"y":3204.999768614769,"z":"c281e2a0.b9793","wires":[]},{"id":"5db15b6.cca79a4","type":"for","name":"for each subnet-data","xml":"<for index='subnet-data-index' start='0' end='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network[$vnf-network-index].subnets-data.subnet-data_length`' >\n","comments":"","outputs":1,"x":3026.6664237976074,"y":3500.000272154808,"z":"c281e2a0.b9793","wires":[["e0589a82.b6b1d8"]]},{"id":"e0589a82.b6b1d8","type":"switchNode","name":"address-families match?","xml":"<switch test='`$tmp.address-family\n  == $service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network[$vnf-network-index].subnets-data.subnet-data[$subnet-data-index].ip-version`'>\n","comments":"","outputs":1,"x":3253.33304977417,"y":3500.000272154808,"z":"c281e2a0.b9793","wires":[["4ec55305.664b0c"]]},{"id":"4ec55305.664b0c","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":3433.3330154418945,"y":3500.000678420067,"z":"c281e2a0.b9793","wires":[["625e2ff1.7ba5e"]]},{"id":"3542e589.394d0a","type":"set","name":"set af-count to 0","xml":"<set>\n<parameter name='af-count' value='0' />\n","comments":"","x":2508.333309173584,"y":3246.6665204763412,"z":"c281e2a0.b9793","wires":[]},{"id":"6857e7c7.9ac808","type":"set","name":"increment af-count","xml":"<set>\n<parameter name='af-count' value='`$af-count + 1`' />\n","comments":"","x":3256.666675567627,"y":3313.333270430565,"z":"c281e2a0.b9793","wires":[]},{"id":"d55384f.ba55f78","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":3073.33304977417,"y":3294.999955534935,"z":"c281e2a0.b9793","wires":[["6857e7c7.9ac808","76e163ca.f2491c"]]},{"id":"76e163ca.f2491c","type":"set","name":"set subnet-id","xml":"<set>\n<parameter name='subnet-id' value='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network[$vnf-network-index].subnets-data.subnet-data[$subnet-data-index].sdnc-subnet-id`' />\n","comments":"","x":3238.333095550537,"y":3268.3332685232162,"z":"c281e2a0.b9793","wires":[]},{"id":"58b2c621.464728","type":"switchNode","name":"switch af-count","xml":"<switch test='`$af-count`'>\n","comments":"","outputs":1,"x":2498.3337211608887,"y":3483.3334373235703,"z":"c281e2a0.b9793","wires":[["e6df7a02.54e718","ebdc3582.f7c488"]]},{"id":"e6df7a02.54e718","type":"outcome","name":"1","xml":"<outcome value='1'>\n","comments":"","outputs":1,"x":2658.333240509033,"y":3381.6666063070297,"z":"c281e2a0.b9793","wires":[["8ca971fd.7953b"]]},{"id":"8ca971fd.7953b","type":"set","name":"set subnet-id in vnfc-ip-assignments (temp variable)","xml":"<set>\n<parameter name='tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-networks.vnfc-network-data[$vnfc-network-index].vnfc-subnet[$subnet-role-index].vnfc-ip-assignments[$address-family-index].subnet-id'\n  value='`$subnet-id`' />\n","comments":"","x":2931.66654586792,"y":3379.999955534935,"z":"c281e2a0.b9793","wires":[]},{"id":"ebdc3582.f7c488","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":2658.3331565856934,"y":3583.3335260152817,"z":"c281e2a0.b9793","wires":[["42d68fbe.9be82"]]},{"id":"42d68fbe.9be82","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":2814.999797821045,"y":3583.33320748806,"z":"c281e2a0.b9793","wires":[["6b48e8f1.05ab58","5db15b6.cca79a4","d31bd158.412b6","ff78938e.825b6"]]},{"id":"625e2ff1.7ba5e","type":"switchNode","name":"switch network-start-address","xml":"<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network[$vnf-network-index].subnets-data.subnet-data[$subnet-data-index].network-start-address`'>\n","comments":"","outputs":1,"x":3628.333194732666,"y":3498.3335222005844,"z":"c281e2a0.b9793","wires":[["2d6c2df0.f0f642","b9ce861f.3022c8"]]},{"id":"2d6c2df0.f0f642","type":"outcome","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":3825.00004196167,"y":3433.3331328630447,"z":"c281e2a0.b9793","wires":[["41bb84ce.add04c"]]},{"id":"b9ce861f.3022c8","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":3818.0954399108887,"y":3567.6190444231033,"z":"c281e2a0.b9793","wires":[["5a93119c.cf602"]]},{"id":"5a93119c.cf602","type":"switchNode","name":"switch cidr-mask","xml":"<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network[$vnf-network-index].subnets-data.subnet-data[$subnet-data-index].cidr-mask`'>\n","comments":"","outputs":1,"x":3973.3332328796387,"y":3566.6662513017654,"z":"c281e2a0.b9793","wires":[["8a2d4bda.e6bad8","6b592583.089c9c"]]},{"id":"8a2d4bda.e6bad8","type":"outcome","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":4128.333309173584,"y":3496.666550755501,"z":"c281e2a0.b9793","wires":[["6444f1bd.5b332"]]},{"id":"6b592583.089c9c","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":4131.429105758667,"y":3629.285637974739,"z":"c281e2a0.b9793","wires":[["63d0a0de.61222"]]},{"id":"5ba80aca.dec534","type":"outcome","name":"0","xml":"<outcome value='0'>","comments":"","outputs":1,"x":1999.9999198913574,"y":3103.33320748806,"z":"c281e2a0.b9793","wires":[["15aeaeb0.b6c1f1"]]},{"id":"fa3499eb.092408","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'SDNC subnet id '\n      + $service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network[$vnf-network-index].subnets-data.subnet-data[$subnet-data-index].sdnc-subnet-id\n      + ' does not have network-start-address populated'`\" />\n\n\n\n","comments":"","x":4133.333545684814,"y":3448.3329697847366,"z":"c281e2a0.b9793","wires":[]},{"id":"41bb84ce.add04c","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":3969.999969482422,"y":3433.3329001665115,"z":"c281e2a0.b9793","wires":[["fa3499eb.092408","870865f7.4f7ae8"]]},{"id":"7aa00293.47497c","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'SDNC subnet id '\n      + $service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-resource-assignments.vnf-networks.vnf-network[$vnf-network-index].subnets-data.subnet-data[$subnet-data-index].sdnc-subnet-id\n      + ' does not have cidr-mask populated'`\" />\n\n\n\n","comments":"","x":4438.333400726318,"y":3509.999837040901,"z":"c281e2a0.b9793","wires":[]},{"id":"6444f1bd.5b332","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","outputs":1,"x":4274.999824523926,"y":3494.999767422676,"z":"c281e2a0.b9793","wires":[["7aa00293.47497c","870865f7.4f7ae8"]]},{"id":"98127124.d9fe3","type":"comment","name":"Ignore address families with no addresses","info":"","comments":"","x":2274.333293914795,"y":3033.66670358181,"z":"c281e2a0.b9793","wires":[]},{"id":"3895a80b.eba038","type":"switchNode","name":"switch invariant-uuid","xml":"<switch test='`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].invariant-uuid`'>\n","comments":"","outputs":1,"x":1245.0001335144043,"y":4663.33308160305,"z":"c281e2a0.b9793","wires":[["a47fd206.3d3c2","45c89d5c.a1aa24"]]},{"id":"a47fd206.3d3c2","type":"outcome","name":"NULL","xml":"<outcome value=''>","comments":"","outputs":1,"x":1426.66654586792,"y":4639.99971139431,"z":"c281e2a0.b9793","wires":[["f6afc45b.804248"]]},{"id":"45c89d5c.a1aa24","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":1424.761817932129,"y":4686.785539031029,"z":"c281e2a0.b9793","wires":[["3c22f266.7fa8ae"]]},{"id":"f6afc45b.804248","type":"save","name":"save vnfc to A&AI","xml":"<save plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\tresource=\"vnfc\" \n\tkey=\"vnfc.vnfc-name = $tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-name\" >\n<parameter name=\"vnfc-name\" value=\"`$tmp.vf-module-topology.vf-module-assignments.vms.vm[$vm-type-index].vm-names.vnfc-names[$vnfc-index].vnfc-name`\" />\n<parameter name=\"nfc-naming-code\" value=\"`$tmp.nfc-naming-code`\" />\n<parameter name=\"nfc-function\" value=\"`$tmp.nfc-function`\" />\n<parameter name=\"orchestration-status\" value=\"`PendingCreate`\" />\n<parameter name=\"in-maint\" value=\"true\" />\n<parameter name=\"prov-status\" value=\"`PREPROV`\" />\n","comments":"","outputs":1,"x":1588.3331718444824,"y":4641.66670358181,"z":"c281e2a0.b9793","wires":[["79f212bd.d038bc","c592d914.589c38"]]},{"id":"5da7dd5d.f1de64","type":"switchNode","name":"switch input cloud-owner","xml":"<switch test='`$vf-module-topology-operation-input.vf-module-request-input.cloud-owner`'>\n","comments":"","outputs":1,"x":524.0475234985352,"y":271.90473306179047,"z":"c281e2a0.b9793","wires":[["21814d13.e07672","ba916891.51c8d8"]]},{"id":"21814d13.e07672","type":"other","name":"NULL","xml":"<outcome value=''>\n","comments":"","outputs":1,"x":707.3808975219727,"y":241.90472161769867,"z":"c281e2a0.b9793","wires":[["48e33c5f.92d444"]]},{"id":"ba916891.51c8d8","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":707.1428031921387,"y":282.8572152853012,"z":"c281e2a0.b9793","wires":[["9fe4b9db.e85ac8"]]},{"id":"48e33c5f.92d444","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":842.3808517456055,"y":240.23806130886078,"z":"c281e2a0.b9793","wires":[[]]},{"id":"9fe4b9db.e85ac8","type":"set","name":"set prop.cloud-region.cloud-owner","xml":"<set>\n<parameter name='prop.cloud-region.cloud-owner' value='`$vf-module-topology-operation-input.vf-module-request-input.cloud-owner`' />\n","comments":"","x":924.0475082397461,"y":281.90474259853363,"z":"c281e2a0.b9793","wires":[]},{"id":"e039d8f6.47eef8","type":"call","name":"call self-serve-vf-module-forking-logic","xml":"<call module='GENERIC-RESOURCE-API' rpc='self-serve-vf-module-forking-logic' mode='sync' >\n","comments":"","outputs":1,"x":555.634895324707,"y":823.2980636358261,"z":"c281e2a0.b9793","wires":[[]]},{"id":"bf338b07.458e28","type":"switchNode","name":"switch ss.self-serve-flag","xml":"<switch test=\"`$ss.self-serve-flag`\">\n","comments":"","outputs":1,"x":513.7776336669922,"y":1050.298132300377,"z":"c281e2a0.b9793","wires":[["9ccc3f87.c2f8f","21fed37d.10b52c"]]},{"id":"9ccc3f87.c2f8f","type":"outcomeFalse","name":"false","xml":"<outcome value='false'>\n","comments":"","outputs":1,"x":734.4918327331543,"y":1167.8690313100815,"z":"c281e2a0.b9793","wires":[["53d50dfc.924b64"]]},{"id":"21fed37d.10b52c","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":735.0632858276367,"y":926.726668715477,"z":"c281e2a0.b9793","wires":[["9c7519a.27013e8"]]}]