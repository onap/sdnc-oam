[
  {
    "id": "e1802764.010338",
    "type": "dgstart",
    "name": "DGSTART",
    "outputs": 1,
    "x": 75.00390625,
    "y": 55.999998688697815,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      [
        "cfe32243.1a54"
      ]
    ]
  },
  {
    "id": "cfe32243.1a54",
    "type": "service-logic",
    "name": "GENERIC-RESOURCE-API ${project.version}",
    "module": "GENERIC-RESOURCE-API",
    "version": "${project.version}",
    "comments": "",
    "xml": "<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>",
    "outputs": 1,
    "x": 287.00391006469727,
    "y": 128.0000158548355,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      [
        "f32ba3f6.6902c"
      ]
    ]
  },
  {
    "id": "f32ba3f6.6902c",
    "type": "method",
    "name": "sotn-attachment-topology-operation-create",
    "xml": "<method rpc='sotn-attachment-topology-operation-create' mode='sync'>\n",
    "comments": "",
    "outputs": 1,
    "x": 275.0040283203125,
    "y": 215.99999868869781,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      [
        "7c54b5b2.a3083c"
      ]
    ]
  },
  {
    "id": "7c54b5b2.a3083c",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 195.00395965576172,
    "y": 965.0002466440201,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      [
        "3de219b6.a5b006",
        "2c7c8b4.5796074",
        "9525b61d.f44608",
        "45124265.84320c",
        "3e0bbdc4.8ce3d2",
        "efb9af7d.38a8c",
        "67a07981.adb6b8",
        "238da366.150bec",
        "482be69b.e1e678",
        "9c36769e.3b9b78",
        "1db7126.81503ee",
        "279f61dd.0cdaee",
        "b18196af.f3d2c8",
        "d586facb.6928c8",
        "83c4b03a.da76",
        "aeb52a03.a21508",
        "d0d20150.466f4",
        "3704681e.a28308",
        "d25d451e.0f6438",
        "54b45ac5.3b96f4",
        "6f9dfa46.6d74e4",
        "5a5883b8.a68a6c",
        "d769ff10.bfeae"
      ]
    ]
  },
  {
    "id": "d194eb73.9913d8",
    "type": "comment",
    "name": "Set allotted resource id if not sent by SO",
    "info": "",
    "comments": "",
    "x": 679.0806579589844,
    "y": 125.43391764163971,
    "z": "2de7bdd3.0e47b2",
    "wires": []
  },
  {
    "id": "3de219b6.a5b006",
    "type": "switchNode",
    "name": "switch allotted-resource-id",
    "xml": "<switch test='`$connection-attachment-topology-operation-input.allotted-resource-information.allotted-resource-id`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 625.0039367675781,
    "y": 180.99999105930328,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      [
        "c41cb638.52f6f8",
        "e38afa57.231908"
      ]
    ]
  },
  {
    "id": "c41cb638.52f6f8",
    "type": "outcome",
    "name": "NULL",
    "xml": "<outcome value=''>",
    "comments": "",
    "outputs": 1,
    "x": 823.0040245056152,
    "y": 150.9999796152115,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      [
        "1f1d00d8.31b19f"
      ]
    ]
  },
  {
    "id": "e38afa57.231908",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 822.0039329528809,
    "y": 187.99999010562897,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      [
        "3ee7f443.e400dc"
      ]
    ]
  },
  {
    "id": "3ee7f443.e400dc",
    "type": "set",
    "name": "set tmp.ar.allotted-resource-id",
    "xml": "<set>\n<parameter name='tmp.ar.allotted-resource-id' value='`$connection-attachment-topology-operation-input.allotted-resource-information.allotted-resource-id`' />\n",
    "comments": "",
    "x": 1020.0039215087891,
    "y": 185.0000091791153,
    "z": "2de7bdd3.0e47b2",
    "wires": []
  },
  {
    "id": "2c7c8b4.5796074",
    "type": "set",
    "name": "set tmp.ar.self-link",
    "xml": "<set>\n<parameter name='tmp.ar.self-link' value=\"`'restconf/config/GENERIC-RESOURCE-API:connection-attachment-allotted-resources/connection-attachment-allotted-resource/'\n + $tmp.ar.allotted-resource-id\n + '/allotted-resource-data/connection-attachment-topology/'` \" />\n\n",
    "comments": "",
    "x": 593.0038604736328,
    "y": 402.0000978708267,
    "z": "2de7bdd3.0e47b2",
    "wires": []
  },
  {
    "id": "9525b61d.f44608",
    "type": "execute",
    "name": "execute Properties",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.prop.PropertiesNode' method='readProperties' >\n    <parameter name='fileName' value='%SDNC_CONFIG_DIR%/generic-resource-api-dg.properties' />\n    <parameter name='contextPrefix' value='prop' />\n",
    "comments": "",
    "outputs": 1,
    "x": 593.2657775878906,
    "y": 483.6667791604996,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      []
    ]
  },
  {
    "id": "45124265.84320c",
    "type": "execute",
    "name": "generate allotted-resource tmp.ar-url",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"`$prop.restapi.connection-attachment-allottedresource`\"/>\n    <parameter name=\"outputPath\" value=\"tmp.ar-url\"/>\n    <parameter name=\"target\" value=\"{allotted-resource-id}\"/>\n    <parameter name=\"replacement\" value=\"`$tmp.ar.allotted-resource-id`\"/>\n",
    "comments": "",
    "outputs": 1,
    "x": 646.2658386230469,
    "y": 570.6666971445084,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      []
    ]
  },
  {
    "id": "1f1d00d8.31b19f",
    "type": "execute",
    "name": "execute tmp.ar.allotted-resource-id",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='generateUUID' >\n<parameter name=\"ctx-destination\" value=\"tmp.ar.allotted-resource-id\"/>\n",
    "comments": "",
    "outputs": 1,
    "x": 1038.0040016174316,
    "y": 151.99998533725739,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      [
        "febe994.1667068"
      ]
    ]
  },
  {
    "id": "febe994.1667068",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1256.0040435791016,
    "y": 151.99994909763336,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      [
        "39c9fb3d.bda924"
      ]
    ]
  },
  {
    "id": "39c9fb3d.bda924",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value=\"An error occured while generation allotted resource ID\" />\n",
    "comments": "",
    "x": 1422.0039978027344,
    "y": 151.9999634027481,
    "z": "2de7bdd3.0e47b2",
    "wires": []
  },
  {
    "id": "a969345.5e133c8",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1152.0041370391846,
    "y": 642.7778698205948,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      [
        "d1ab386a.e79358"
      ]
    ]
  },
  {
    "id": "50f962fe.84264c",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error: Existing connection attachment allotted resource\" />\n    \n",
    "comments": "",
    "x": 1885.5225162506104,
    "y": 643.8439413309097,
    "z": "2de7bdd3.0e47b2",
    "wires": []
  },
  {
    "id": "a49d5ad5.f5a9d8",
    "type": "comment",
    "name": "Check for non existence of allotted resource",
    "info": "",
    "comments": "",
    "x": 1008.0040588378906,
    "y": 576.7779365777969,
    "z": "2de7bdd3.0e47b2",
    "wires": []
  },
  {
    "id": "d5f1890a.be37b8",
    "type": "for",
    "name": "for cidx..service-data.consumed-allotted-resources.consumed-allotted-resource[]",
    "xml": "<for index='cidx' start='0' end='`$service-data.consumed-allotted-resources.consumed-allotted-resource_length`' >\n",
    "comments": "",
    "outputs": 1,
    "x": 1528.6706047058105,
    "y": 787.000048995018,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      [
        "f2c143a3.1f8e7"
      ]
    ]
  },
  {
    "id": "efb9af7d.38a8c",
    "type": "switchNode",
    "name": "switch service-data.consumed-allotted-resources_length",
    "xml": "<switch test='`$service-data.consumed-allotted-resources.consumed-allotted-resource_length`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 710.6699295043945,
    "y": 763.7140814065933,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      [
        "82a04eb.e5042b",
        "c28a32d1.b979"
      ]
    ]
  },
  {
    "id": "82a04eb.e5042b",
    "type": "other",
    "name": "outcome Null",
    "xml": "<outcome value=''>\n",
    "comments": "",
    "outputs": 1,
    "x": 1014.8128280639648,
    "y": 732.5715185403824,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      [
        "9ed3f44e.0ef248"
      ]
    ]
  },
  {
    "id": "c28a32d1.b979",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 991.8128776550293,
    "y": 793.5714737176895,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      [
        "7748cb78.c02984"
      ]
    ]
  },
  {
    "id": "7748cb78.c02984",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 1151.9399681091309,
    "y": 791.6974502801895,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      [
        "d5f1890a.be37b8",
        "6c68e940.a09698",
        "9bbf5449.409148"
      ]
    ]
  },
  {
    "id": "9ed3f44e.0ef248",
    "type": "set",
    "name": "set cidx",
    "xml": "<set>\n<parameter name='tmp.cidx' value=\"`0`\" />\n<parameter name='service-data.consumed-allotted-resources.consumed-allotted-resource_length' value=\"1\" />\n\n\n",
    "comments": "",
    "x": 1164.6698112487793,
    "y": 730.2855688333511,
    "z": "2de7bdd3.0e47b2",
    "wires": []
  },
  {
    "id": "67a07981.adb6b8",
    "type": "set",
    "name": "set consumed allotted resources",
    "xml": "<set>\n<parameter name='service-data.consumed-allotted-resources.consumed-allotted-resource[$tmp.cidx].allotted-resource-id' value=\"`$tmp.ar.allotted-resource-id` \" />\n<parameter name='service-data.consumed-allotted-resources.consumed-allotted-resource[$tmp.cidx].allotted-resource-type' value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.allotted-resource-type` \" />\n<parameter name='service-data.consumed-allotted-resources.consumed-allotted-resource[$tmp.cidx].allotted-resource-pointer' value=\"`$tmp.ar.self-link` \" />\n<parameter name='service-data.consumed-allotted-resources.consumed-allotted-resource_length' value='`$tmp.cidx + 1`' />\n\n",
    "comments": "",
    "x": 639.5272216796875,
    "y": 867.2856460809708,
    "z": "2de7bdd3.0e47b2",
    "wires": []
  },
  {
    "id": "6c68e940.a09698",
    "type": "switchNode",
    "name": "switch tmp.found-cidx",
    "xml": "<switch test='`$tmp.found-cidx`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1341.0550155639648,
    "y": 823.7089730501175,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      [
        "e6bed7c6.008fc8"
      ]
    ]
  },
  {
    "id": "e6bed7c6.008fc8",
    "type": "outcomeTrue",
    "name": "false",
    "xml": "<outcome value='false'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1531.0549697875977,
    "y": 823.7089101076126,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      [
        "c94cbc62.004a2"
      ]
    ]
  },
  {
    "id": "c94cbc62.004a2",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 1697.0549697875977,
    "y": 823.7089101076126,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      [
        "f71f33c4.6780f"
      ]
    ]
  },
  {
    "id": "f2c143a3.1f8e7",
    "type": "switchNode",
    "name": "switch allotted-resource-id",
    "xml": "<switch test=\"`$service-data.consumed-allotted-resources.consumed-allotted-resource[$cidx].allotted-resource-id == $tmp.ar.allotted-resource-id`\">\n\n",
    "comments": "",
    "outputs": 1,
    "x": 1945.7822341918945,
    "y": 784.0000759363174,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      [
        "22afa8c.31c5058"
      ]
    ]
  },
  {
    "id": "22afa8c.31c5058",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2127.591808319092,
    "y": 784.4645229578018,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      [
        "349f45ed.6a61aa"
      ]
    ]
  },
  {
    "id": "f71f33c4.6780f",
    "type": "set",
    "name": "set tmp.cidx",
    "xml": "<set>\n<parameter name='tmp.cidx' value='`$service-data.consumed-allotted-resources.consumed-allotted-resource_length`' />\n",
    "comments": "",
    "x": 1858.928352355957,
    "y": 823.2206112146378,
    "z": "2de7bdd3.0e47b2",
    "wires": []
  },
  {
    "id": "8d32b4a4.1a9fd8",
    "type": "comment",
    "name": "Add to consumed service consumed-allotted-resources in mdsal",
    "info": "Prepare data and add to service-data",
    "comments": "",
    "x": 731.671142578125,
    "y": 694.0000454187393,
    "z": "2de7bdd3.0e47b2",
    "wires": []
  },
  {
    "id": "fc9006c6.395558",
    "type": "comment",
    "name": "This set resource will be added to MDSAL by provider code",
    "info": "Below we add to service-data.consumed-allotted-resource at last index",
    "comments": "",
    "x": 719.0040588378906,
    "y": 832.7781378030777,
    "z": "2de7bdd3.0e47b2",
    "wires": []
  },
  {
    "id": "d769ff10.bfeae",
    "type": "update",
    "name": "update AAI allotted-resource",
    "xml": "<update plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"allotted-resource\" \n\t\tkey=\"customer.global-customer-id = $connection-attachment-topology-operation-input.service-information.global-customer-id AND\n\t\t\tservice-subscription.service-type = $connection-attachment-topology-operation-input.service-information.subscription-service-type AND\n\t\t\tservice-instance.service-instance-id = $connection-attachment-topology-operation-input.allotted-resource-information.parent-service-instance-id AND\n\t\t\tallotted-resource.id = $tmp.ar.allotted-resource-id\"\n        pfx='pfx' local-only='false' force='false'>\n    <parameter name=\"id\" value=\"`$tmp.ar.allotted-resource-id`\" />\n\t<parameter name=\"name\" value=\"`$prop.connection-attachment.sotnVpnName`\" />\n\t<parameter name=\"access-provider-id\" value=\"`$prop.connection-attachment.access-provider-id`\" />\n\t<parameter name=\"access-client-id\" value=\"`$prop.connection-attachment.access-client-id`\" />\n\t<parameter name=\"access-topology-id\" value=\"`$prop.connection-attachment.access-topology-id`\" />\n\t<parameter name=\"access-node-id\" value=\"`$prop.connection-attachment.access-node-id`\" />\n\t<parameter name=\"access-ltp-id\" value=\"`$prop.connection-attachment.access-ltp-id`\" />\t\n\t<parameter name=\"cvlan\" value=\"`$prop.connection-attachment.cVLAN`\" />\n    <parameter name=\"vpn-name\" value=\"`$prop.connection-attachment.sotnVpnName`\" />\n\t<parameter name=\"selflink\" value=\"`$tmp.ar.self-link`\" />\n\t<parameter name=\"model-invariant-id\" value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.onap-model-information.model-invariant-uuid`\" />\n\t<parameter name=\"model-version-id\" value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.onap-model-information.model-uuid`\" />\n\t<parameter name=\"operational-status\" value=\"Created\" />\n",
    "comments": "",
    "outputs": 1,
    "x": 629.6947631835938,
    "y": 1792.5319019556046,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      [
        "e5663fd7.08761",
        "b7403b0d.cfc148"
      ]
    ]
  },
  {
    "id": "e5663fd7.08761",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 824.4566993713379,
    "y": 1783.4845033884048,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      [
        "345b8d51.157ff2"
      ]
    ]
  },
  {
    "id": "345b8d51.157ff2",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"AAI failed\" />\n",
    "comments": "",
    "x": 990.9805793762207,
    "y": 1795.1035743951797,
    "z": "2de7bdd3.0e47b2",
    "wires": []
  },
  {
    "id": "b7403b0d.cfc148",
    "type": "failure",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 831.5519866943359,
    "y": 1816.2464710474014,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      [
        "345b8d51.157ff2"
      ]
    ]
  },
  {
    "id": "ff8e9cff.e34a3",
    "type": "comment",
    "name": "Save Resource to AAI",
    "info": "",
    "comments": "",
    "x": 605.50439453125,
    "y": 1754.8338733911514,
    "z": "2de7bdd3.0e47b2",
    "wires": []
  },
  {
    "id": "5f517bd0.1d2334",
    "type": "comment",
    "name": "Set allotted resource type if not sent by SO",
    "info": "",
    "comments": "",
    "x": 665.00390625,
    "y": 233.99999868869781,
    "z": "2de7bdd3.0e47b2",
    "wires": []
  },
  {
    "id": "3e0bbdc4.8ce3d2",
    "type": "switchNode",
    "name": "switch allotted-resource-type",
    "xml": "<switch test='`$connection-attachment-topology-operation-input.allotted-resource-information.allotted-resource-type`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 626.9272155761719,
    "y": 274.5660549402237,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      [
        "ff0b47c3.5cf7f8",
        "8dd15a77.fb7568"
      ]
    ]
  },
  {
    "id": "ff0b47c3.5cf7f8",
    "type": "outcome",
    "name": "NULL",
    "xml": "<outcome value=''>",
    "comments": "",
    "outputs": 1,
    "x": 829.9273681640625,
    "y": 259.56605780124664,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      [
        "aae71526.aed0c8"
      ]
    ]
  },
  {
    "id": "8dd15a77.fb7568",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 822.9271965026855,
    "y": 299.5660778284073,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      [
        "c7c46784.6950a8"
      ]
    ]
  },
  {
    "id": "c7c46784.6950a8",
    "type": "set",
    "name": "set tmp.ar.allotted-resource-type",
    "xml": "<set>\n<parameter name='tmp.ar.allotted-resource-type' value='`$connection-attachment-topology-operation-input.allotted-resource-information.allotted-resource-type`' />\n",
    "comments": "",
    "x": 1054.9271812438965,
    "y": 299.56608259677887,
    "z": "2de7bdd3.0e47b2",
    "wires": []
  },
  {
    "id": "e793c2ca.7f688",
    "type": "comment",
    "name": "For storage in AAI connection-attachment-topology",
    "info": "",
    "comments": "",
    "x": 690.0038681030273,
    "y": 368.9999986886978,
    "z": "2de7bdd3.0e47b2",
    "wires": []
  },
  {
    "id": "a57110f9.dcd37",
    "type": "comment",
    "name": "Obtain different URL, template location etc",
    "info": "For saving resource information to MDSAL & for AAI",
    "comments": "",
    "x": 665.0038528442383,
    "y": 450.8889080286026,
    "z": "2de7bdd3.0e47b2",
    "wires": []
  },
  {
    "id": "9489b4d2.52d1b8",
    "type": "comment",
    "name": "Used for Put AR by id to MDSAL",
    "info": "",
    "comments": "",
    "x": 631.0039367675781,
    "y": 539.8889251947403,
    "z": "2de7bdd3.0e47b2",
    "wires": []
  },
  {
    "id": "454699aa.1f7a38",
    "type": "comment",
    "name": "Obtain the last index in services",
    "info": "ServiceData is added by Provider code",
    "comments": "",
    "x": 632.4483795166016,
    "y": 725.88886988163,
    "z": "2de7bdd3.0e47b2",
    "wires": []
  },
  {
    "id": "54b45ac5.3b96f4",
    "type": "set",
    "name": "set output to api handler",
    "xml": "<set>\n<parameter name='allotted-resource-id' value='`$tmp.ar.allotted-resource-id`' />\n<parameter name='connection-attachment-object-path' value=\"`$tmp.ar.self-link`\"/>\n<parameter name='service-object-path' value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $connection-attachment-topology-operation-input.service-information.service-instance-id\n + '/service-data/service-topology/'`\"/>\n \n",
    "comments": "",
    "x": 615.2720489501953,
    "y": 1699.3592010736465,
    "z": "2de7bdd3.0e47b2",
    "wires": []
  },
  {
    "id": "6f9dfa46.6d74e4",
    "type": "returnSuccess",
    "name": "return success",
    "xml": "<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n",
    "comments": "",
    "x": 583.6851272583008,
    "y": 1840.9749876260757,
    "z": "2de7bdd3.0e47b2",
    "wires": []
  },
  {
    "id": "aae71526.aed0c8",
    "type": "set",
    "name": "set tmp.ar.allotted-resource-type",
    "xml": "<set>\n<parameter name='tmp.ar.allotted-resource-type' value=\"SOTNAttachmentInstance\" />\n",
    "comments": "",
    "x": 1069.0040550231934,
    "y": 259.99998438358307,
    "z": "2de7bdd3.0e47b2",
    "wires": []
  },
  {
    "id": "d0d20150.466f4",
    "type": "call",
    "name": "call GENERIC-RESOURCE-API:sotn-get-saved-ar-param",
    "xml": "<call module='GENERIC-RESOURCE-API' rpc='sotn-get-saved-ar-param' mode='sync' >\n",
    "comments": "",
    "outputs": 1,
    "x": 716.9980697631836,
    "y": 1559.4938122034073,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      []
    ]
  },
  {
    "id": "d25d451e.0f6438",
    "type": "execute",
    "name": "execute RestApiCallNode - PUT AR by id",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='templateFileName' value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.sotn-attachment.templatefile`\" />\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.ar-url`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='PUT' />\n    <parameter name=\"responsePrefix\" value=\"mdsal-ar\" />\n\n",
    "comments": "",
    "outputs": 1,
    "x": 666.0041809082031,
    "y": 1633.0001302957535,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      [
        "a217bcb.4b0424",
        "c7307e94.33922",
        "88ae5959.9952c8"
      ]
    ]
  },
  {
    "id": "a217bcb.4b0424",
    "type": "not-found",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 915.6455345153809,
    "y": 1671.331460595131,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      [
        "45489cfb.5ec6b4"
      ]
    ]
  },
  {
    "id": "c7307e94.33922",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 906.6455841064453,
    "y": 1639.8314863443375,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      [
        "45489cfb.5ec6b4"
      ]
    ]
  },
  {
    "id": "88ae5959.9952c8",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 910.395622253418,
    "y": 1610.1885912194848,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      [
        "b883302d.2867d"
      ]
    ]
  },
  {
    "id": "45489cfb.5ec6b4",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating md-sal for connection-attachment-allotted-resource\" />\n",
    "comments": "",
    "x": 1076.395622253418,
    "y": 1640.5815101861954,
    "z": "2de7bdd3.0e47b2",
    "wires": []
  },
  {
    "id": "b883302d.2867d",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1052.0515899658203,
    "y": 1606.380760408938,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      []
    ]
  },
  {
    "id": "1db7126.81503ee",
    "type": "execute",
    "name": "execute RestApiCallNode - Update parent provided service AR",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='templateFileName' value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.parentsvc.templatefile`\" />\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.parent-ar-url`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='PUT' />\n    <parameter name=\"responsePrefix\" value=\"parent\" />\n\n",
    "comments": "",
    "outputs": 1,
    "x": 731.0038604736328,
    "y": 1149.0001636743546,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      [
        "8baa1385.678c1",
        "f79c7ce6.35926",
        "8ab7afc7.379db"
      ]
    ]
  },
  {
    "id": "8baa1385.678c1",
    "type": "not-found",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1039.3119201660156,
    "y": 1180.9984394311905,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      [
        "1986b301.84772d"
      ]
    ]
  },
  {
    "id": "f79c7ce6.35926",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1030.31196975708,
    "y": 1149.498465180397,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      [
        "1986b301.84772d"
      ]
    ]
  },
  {
    "id": "8ab7afc7.379db",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1034.0620079040527,
    "y": 1119.8555700555444,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      [
        "c35b2d72.8a40a"
      ]
    ]
  },
  {
    "id": "1986b301.84772d",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating md-sal for connection-attachment-allotted-resource\" />\n",
    "comments": "",
    "x": 1200.0620079040527,
    "y": 1150.248489022255,
    "z": "2de7bdd3.0e47b2",
    "wires": []
  },
  {
    "id": "c35b2d72.8a40a",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1175.717975616455,
    "y": 1116.0477392449975,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      []
    ]
  },
  {
    "id": "373cdeec.8a9792",
    "type": "comment",
    "name": "Put the parent allotted resource in mdsal",
    "info": "",
    "comments": "",
    "x": 660.0038070678711,
    "y": 1111.0000702142715,
    "z": "2de7bdd3.0e47b2",
    "wires": []
  },
  {
    "id": "b18196af.f3d2c8",
    "type": "set",
    "name": "set connection-attachment-ar-identifiers",
    "xml": "<set>\n<parameter name='connection-attachment-ar-identifiers.consuming-service-instance-id' value=\"`$connection-attachment-topology-operation-input.service-information.service-instance-id` \" />\n<parameter name='connection-attachment-ar-identifiers.parent-service-instance-id' value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.parent-service-instance-id` \" />\n<parameter name='connection-attachment-ar-identifiers.allotted-resource-type' value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.allotted-resource-type` \" />\n<parameter name='connection-attachment-ar-identifiers.allotted-resource-id' value=\"`$tmp.ar.allotted-resource-id` \" />\n\n",
    "comments": "",
    "x": 656.3609924316406,
    "y": 1313.571689248085,
    "z": "2de7bdd3.0e47b2",
    "wires": []
  },
  {
    "id": "279f61dd.0cdaee",
    "type": "set",
    "name": "set ar-data",
    "xml": "<set>\n<parameter name='connection-attachment-ar.allotted-resource-id' value=\"`$tmp.ar.allotted-resource-id` \" />\n<parameter name='connection-attachment-ar.allotted-resource-status.action' value=\"`$connection-attachment-topology-operation-input.request-information.request-action` \" />\n<parameter name='connection-attachment-ar.allotted-resource-status.rpc-name' value=\"connection-attachment-topology-operation\" />\n<parameter name='connection-attachment-ar.allotted-resource-status.rpc-action' value=\"`$connection-attachment-topology-operation-input.sdnc-request-header.svc-action` \" />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-operation-information.request-information.' value=\"`$connection-attachment-topology-operation-input.request-information.` \" />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-operation-information.sdnc-request-header.' value=\"`$connection-attachment-topology-operation-input.sdnc-request-header.` \" />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-operation-information.service-information.' value=\"`$connection-attachment-topology-operation-input.service-information.` \" />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-operation-information.allotted-resource-information.' value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.` \" />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-operation-information.connection-attachment-request-input.' value=\"`$connection-attachment-topology-operation-input.connection-attachment-request-input.` \" />",
    "comments": "",
    "x": 570.2177734375,
    "y": 1281.3810459375381,
    "z": "2de7bdd3.0e47b2",
    "wires": []
  },
  {
    "id": "d586facb.6928c8",
    "type": "set",
    "name": "set identifiers in overall structure",
    "xml": "<set>\n<parameter name='connection-attachment-ar.allotted-resource-data.connection-attachment-topology.allotted-resource-identifiers.' \nvalue=\"`$connection-attachment-ar-identifiers.`\" />\n\n\n",
    "comments": "",
    "x": 635.1707916259766,
    "y": 1347.6668745279312,
    "z": "2de7bdd3.0e47b2",
    "wires": []
  },
  {
    "id": "83c4b03a.da76",
    "type": "execute",
    "name": "execute getTime",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='setTime' >\n    <parameter name=\"outputPath\" value=\"tmp.current-time\" />\n\n",
    "comments": "",
    "outputs": 1,
    "x": 587.5036315917969,
    "y": 1421.0004020929337,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      []
    ]
  },
  {
    "id": "aeb52a03.a21508",
    "type": "set",
    "name": "set allotted-resource-oper-status",
    "xml": "<set>\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.order-status' value='Created' />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.last-action' value='`$connection-attachment-topology-operation-input.request-information.request-action`' />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.last-rpc-action' value='`$connection-attachment-topology-operation-input.sdnc-request-header.svc-action`' />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.last-svc-request-id' value='`$connection-attachment-topology-operation-input.sdnc-request-header.svc-request-id`' />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.create-timestamp' value='`$tmp.current-time`' />\n",
    "comments": "",
    "x": 638.4906692504883,
    "y": 1476.95163500309,
    "z": "2de7bdd3.0e47b2",
    "wires": []
  },
  {
    "id": "3704681e.a28308",
    "type": "set",
    "name": "set model-data",
    "xml": "<set>\n<parameter name='connection-attachment-ar.allotted-resource-data.connection-attachment-topology.onap-model-information.' value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.onap-model-information.` \" />",
    "comments": "",
    "x": 583.0592880249023,
    "y": 1382.555760025978,
    "z": "2de7bdd3.0e47b2",
    "wires": []
  },
  {
    "id": "9f0192ed.a3fed",
    "type": "comment",
    "name": "Prepare data for allotted-resource addition to MDSAL",
    "info": "This will add to allotted-resource which is present inside service.",
    "comments": "",
    "x": 700.3927764892578,
    "y": 1247.5556064844131,
    "z": "2de7bdd3.0e47b2",
    "wires": []
  },
  {
    "id": "9c36769e.3b9b78",
    "type": "execute",
    "name": "generate parent-ar url - replace allotted-resource-id",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"`$tmp.parent-ar-url`\"/>\n    <parameter name=\"outputPath\" value=\"tmp.parent-ar-url\"/>\n    <parameter name=\"target\" value=\"{allotted-resource-id}\"/>\n    <parameter name=\"replacement\" value=\"`$tmp.ar.allotted-resource-id`\"/>\n",
    "comments": "",
    "outputs": 1,
    "x": 695.5039215087891,
    "y": 1075.0000091791153,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      []
    ]
  },
  {
    "id": "482be69b.e1e678",
    "type": "execute",
    "name": "generate parent-ar url - replace service-instance-id",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"`$prop.restapi.parent-provided-resource`\"/>\n    <parameter name=\"outputPath\" value=\"tmp.parent-ar-url\"/>\n    <parameter name=\"target\" value=\"{service-instance-id}\"/>\n    <parameter name=\"replacement\" value=\"`$tmp.ar.parent-service-instance-id`\"/>\n",
    "comments": "",
    "outputs": 1,
    "x": 691.5038452148438,
    "y": 1032.0001455545425,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      []
    ]
  },
  {
    "id": "db2548a3.2d9d88",
    "type": "comment",
    "name": "Prepare Parent AR URL",
    "info": "Preparation to set provided-allotted-resource in parent service instance",
    "comments": "",
    "x": 609.5043029785156,
    "y": 961.000098824501,
    "z": "2de7bdd3.0e47b2",
    "wires": []
  },
  {
    "id": "238da366.150bec",
    "type": "set",
    "name": "set tmp.ar.parent-service-instance-id",
    "xml": "<set>\n<parameter name='tmp.ar.parent-service-instance-id' value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.parent-service-instance-id` \" />\n\n",
    "comments": "",
    "x": 648.5040969848633,
    "y": 994.500038266182,
    "z": "2de7bdd3.0e47b2",
    "wires": []
  },
  {
    "id": "62fbf7be.c1d928",
    "type": "comment",
    "name": "Required for filling template values",
    "info": "This is done because connection-attachment is generic resource and doesn't have specific parameters",
    "comments": "",
    "x": 643.0042724609375,
    "y": 1522.4998852014542,
    "z": "2de7bdd3.0e47b2",
    "wires": []
  },
  {
    "id": "349f45ed.6a61aa",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating md-sal for connection-attachment-allotted-resource as cosumed allotted resource already exists.\" />\n",
    "comments": "",
    "x": 2205.7608795166016,
    "y": 832.6458278894424,
    "z": "2de7bdd3.0e47b2",
    "wires": []
  },
  {
    "id": "9bbf5449.409148",
    "type": "set",
    "name": "set tmp.found-cidx",
    "xml": "<set>\n<parameter name='tmp.found-cidx' value=\"`false`\" />\n\n\n",
    "comments": "",
    "x": 1331.6500511169434,
    "y": 744.3125709295273,
    "z": "2de7bdd3.0e47b2",
    "wires": []
  },
  {
    "id": "de27f2ed.26659",
    "type": "comment",
    "name": "Add to parent services provided-allotted-resources in mdsal",
    "info": "",
    "comments": "",
    "x": 720.2054138183594,
    "y": 928.9792553186417,
    "z": "2de7bdd3.0e47b2",
    "wires": []
  },
  {
    "id": "a649f8c3.5ee428",
    "type": "comment",
    "name": "Add to allotted-resources in mdsal",
    "info": "",
    "comments": "",
    "x": 640.9726028442383,
    "y": 1214.9689356088638,
    "z": "2de7bdd3.0e47b2",
    "wires": []
  },
  {
    "id": "d1ab386a.e79358",
    "type": "block",
    "name": "block: atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1314.003957748413,
    "y": 642.2777591943741,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      [
        "4f0a5d33.427474"
      ]
    ]
  },
  {
    "id": "4f0a5d33.427474",
    "type": "switchNode",
    "name": "switch cr length",
    "xml": "<switch test='`$mdsal-ar.connection-attachment-allotted-resource_length`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1501.8613376617432,
    "y": 642.8968945741653,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      [
        "d605048c.9bb9e8"
      ]
    ]
  },
  {
    "id": "d605048c.9bb9e8",
    "type": "other",
    "name": "outcome 1",
    "xml": "<outcome value='1'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1701.1944599151611,
    "y": 642.8969732522964,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      [
        "50f962fe.84264c"
      ]
    ]
  },
  {
    "id": "5a5883b8.a68a6c",
    "type": "execute",
    "name": "execute RestApiCallNode - get-resource connection-attachment-allotted-resource",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.ar-url`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='GET' />\n    <parameter name=\"responsePrefix\" value=\"mdsal-ar\" />\n\n",
    "comments": "",
    "outputs": 1,
    "x": 786.0039596557617,
    "y": 637.0000349283218,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      [
        "a969345.5e133c8",
        "ca5d3b75.7711f8"
      ]
    ]
  },
  {
    "id": "ca5d3b75.7711f8",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1154.0039901733398,
    "y": 607.0000330209732,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      [
        "9eb0da65.d80ea8"
      ]
    ]
  },
  {
    "id": "9eb0da65.d80ea8",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1306.0039901733398,
    "y": 606.0000330209732,
    "z": "2de7bdd3.0e47b2",
    "wires": [
      []
    ]
  }
]