[
  {
    "id": "adb1788a.cf9f38",
    "type": "dgstart",
    "name": "DGSTART",
    "outputs": 1,
    "x": 116.00390625,
    "y": 44.999999046325684,
    "z": "cd9be5df.ce2908",
    "wires": [
      [
        "a98f689a.e0ea58"
      ]
    ]
  },
  {
    "id": "a98f689a.e0ea58",
    "type": "service-logic",
    "name": "GENERIC-RESOURCE-API ${project.version}",
    "module": "GENERIC-RESOURCE-API",
    "version": "${project.version}",
    "comments": "",
    "xml": "<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>",
    "outputs": 1,
    "x": 328.00391006469727,
    "y": 117.00001621246338,
    "z": "cd9be5df.ce2908",
    "wires": [
      [
        "a5265b50.60d3d8"
      ]
    ]
  },
  {
    "id": "a5265b50.60d3d8",
    "type": "method",
    "name": "sotn-attachment-topology-operation-create",
    "xml": "<method rpc='sotn-attachment-topology-operation-create' mode='sync'>\n",
    "comments": "",
    "outputs": 1,
    "x": 316.0040283203125,
    "y": 204.99999904632568,
    "z": "cd9be5df.ce2908",
    "wires": [
      [
        "abbfd961.d4b0e8"
      ]
    ]
  },
  {
    "id": "abbfd961.d4b0e8",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 236.00395965576172,
    "y": 954.000247001648,
    "z": "cd9be5df.ce2908",
    "wires": [
      [
        "eb67ee8b.bf244",
        "220745d9.e7ba6a",
        "2a06f015.c839b",
        "a33f602.ac944a",
        "e860512d.3a9e9",
        "fee5e4c9.0ba448",
        "4dc283b6.91bacc",
        "7955c841.e97a58",
        "fa779466.451918",
        "c3a30593.5755d8",
        "a6939d07.10c8f",
        "465324d8.73e58c",
        "96fd2d4.3efccd",
        "eaaea0ea.31b57",
        "d974b696.f92d58",
        "c290a3d2.4b9bc",
        "bd67321d.42bb1",
        "604d94ec.b3a5ec",
        "cfa3c909.8098f8",
        "fb5d252f.afc7e8",
        "c69bb6da.e373b8",
        "cd515755.334938",
        "87d51b5a.de9838"
      ]
    ]
  },
  {
    "id": "5d24e3d3.1b11bc",
    "type": "comment",
    "name": "Set allotted resource id if not sent by SO",
    "info": "",
    "comments": "",
    "x": 720.0806579589844,
    "y": 114.43391799926758,
    "z": "cd9be5df.ce2908",
    "wires": []
  },
  {
    "id": "eb67ee8b.bf244",
    "type": "switchNode",
    "name": "switch allotted-resource-id",
    "xml": "<switch test='`$connection-attachment-topology-operation-input.allotted-resource-information.allotted-resource-id`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 666.0039367675781,
    "y": 169.99999141693115,
    "z": "cd9be5df.ce2908",
    "wires": [
      [
        "ecada738.108f88",
        "344a1f5.0533ce"
      ]
    ]
  },
  {
    "id": "ecada738.108f88",
    "type": "outcome",
    "name": "NULL",
    "xml": "<outcome value=''>",
    "comments": "",
    "outputs": 1,
    "x": 864.0040245056152,
    "y": 139.99997997283936,
    "z": "cd9be5df.ce2908",
    "wires": [
      [
        "b66e7665.e7da38"
      ]
    ]
  },
  {
    "id": "344a1f5.0533ce",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 863.0039329528809,
    "y": 176.99999046325684,
    "z": "cd9be5df.ce2908",
    "wires": [
      [
        "35115dc6.f6ea92"
      ]
    ]
  },
  {
    "id": "35115dc6.f6ea92",
    "type": "set",
    "name": "set tmp.ar.allotted-resource-id",
    "xml": "<set>\n<parameter name='tmp.ar.allotted-resource-id' value='`$connection-attachment-topology-operation-input.allotted-resource-information.allotted-resource-id`' />\n",
    "comments": "",
    "x": 1061.003921508789,
    "y": 174.00000953674316,
    "z": "cd9be5df.ce2908",
    "wires": []
  },
  {
    "id": "220745d9.e7ba6a",
    "type": "set",
    "name": "set tmp.ar.self-link",
    "xml": "<set>\n<parameter name='tmp.ar.self-link' value=\"`'restconf/config/GENERIC-RESOURCE-API:connection-attachment-allotted-resources/connection-attachment-allotted-resource/'\n + $tmp.ar.allotted-resource-id\n + '/allotted-resource-data/connection-attachment-topology/'` \" />\n\n",
    "comments": "",
    "x": 634.0038604736328,
    "y": 391.0000982284546,
    "z": "cd9be5df.ce2908",
    "wires": []
  },
  {
    "id": "2a06f015.c839b",
    "type": "execute",
    "name": "execute Properties",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.prop.PropertiesNode' method='readProperties' >\n    <parameter name='fileName' value='%SDNC_CONFIG_DIR%/generic-resource-api-dg.properties' />\n    <parameter name='contextPrefix' value='prop' />\n",
    "comments": "",
    "outputs": 1,
    "x": 634.2657775878906,
    "y": 472.66677951812744,
    "z": "cd9be5df.ce2908",
    "wires": [
      []
    ]
  },
  {
    "id": "a33f602.ac944a",
    "type": "execute",
    "name": "generate allotted-resource tmp.ar-url",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"`$prop.restapi.connection-attachment-allottedresource`\"/>\n    <parameter name=\"outputPath\" value=\"tmp.ar-url\"/>\n    <parameter name=\"target\" value=\"{allotted-resource-id}\"/>\n    <parameter name=\"replacement\" value=\"`$tmp.ar.allotted-resource-id`\"/>\n",
    "comments": "",
    "outputs": 1,
    "x": 687.2658386230469,
    "y": 559.6666975021362,
    "z": "cd9be5df.ce2908",
    "wires": [
      []
    ]
  },
  {
    "id": "b66e7665.e7da38",
    "type": "execute",
    "name": "execute tmp.ar.allotted-resource-id",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='generateUUID' >\n<parameter name=\"ctx-destination\" value=\"tmp.ar.allotted-resource-id\"/>\n",
    "comments": "",
    "outputs": 1,
    "x": 1079.0040016174316,
    "y": 140.99998569488525,
    "z": "cd9be5df.ce2908",
    "wires": [
      [
        "609a8de0.6e7824"
      ]
    ]
  },
  {
    "id": "609a8de0.6e7824",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1297.0040435791016,
    "y": 140.99994945526123,
    "z": "cd9be5df.ce2908",
    "wires": [
      [
        "5f376291.b45a1c"
      ]
    ]
  },
  {
    "id": "5f376291.b45a1c",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value=\"An error occured while generation allotted resource ID\" />\n",
    "comments": "",
    "x": 1463.0039978027344,
    "y": 140.99996376037598,
    "z": "cd9be5df.ce2908",
    "wires": []
  },
  {
    "id": "23e2be4c.571a12",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1193.0041370391846,
    "y": 631.7778701782227,
    "z": "cd9be5df.ce2908",
    "wires": [
      [
        "5a7187fc.7cbe38"
      ]
    ]
  },
  {
    "id": "9b07dcd5.e21ac",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error: Existing connection attachment allotted resource\" />\n    \n",
    "comments": "",
    "x": 1926.5225162506104,
    "y": 632.8439416885376,
    "z": "cd9be5df.ce2908",
    "wires": []
  },
  {
    "id": "3b013387.32149c",
    "type": "comment",
    "name": "Check for non existence of allotted resource",
    "info": "",
    "comments": "",
    "x": 1049.0040588378906,
    "y": 565.7779369354248,
    "z": "cd9be5df.ce2908",
    "wires": []
  },
  {
    "id": "d8869a7d.cab028",
    "type": "for",
    "name": "for cidx..service-data.consumed-allotted-resources.consumed-allotted-resource[]",
    "xml": "<for index='cidx' start='0' end='`$service-data.consumed-allotted-resources.consumed-allotted-resource_length`' >\n",
    "comments": "",
    "outputs": 1,
    "x": 1569.6706047058105,
    "y": 776.0000493526459,
    "z": "cd9be5df.ce2908",
    "wires": [
      [
        "302d9adc.f174a6"
      ]
    ]
  },
  {
    "id": "fee5e4c9.0ba448",
    "type": "switchNode",
    "name": "switch service-data.consumed-allotted-resources_length",
    "xml": "<switch test='`$service-data.consumed-allotted-resources.consumed-allotted-resource_length`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 751.6699295043945,
    "y": 752.7140817642212,
    "z": "cd9be5df.ce2908",
    "wires": [
      [
        "398c7fde.777f7",
        "930fb668.78c318"
      ]
    ]
  },
  {
    "id": "398c7fde.777f7",
    "type": "other",
    "name": "outcome Null",
    "xml": "<outcome value=''>\n",
    "comments": "",
    "outputs": 1,
    "x": 1055.8128280639648,
    "y": 721.5715188980103,
    "z": "cd9be5df.ce2908",
    "wires": [
      [
        "e27ac12e.c0f94"
      ]
    ]
  },
  {
    "id": "930fb668.78c318",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1032.8128776550293,
    "y": 782.5714740753174,
    "z": "cd9be5df.ce2908",
    "wires": [
      [
        "adb840cd.cb1f1"
      ]
    ]
  },
  {
    "id": "adb840cd.cb1f1",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 1192.9399681091309,
    "y": 780.6974506378174,
    "z": "cd9be5df.ce2908",
    "wires": [
      [
        "d8869a7d.cab028",
        "4b2529c3.216af8",
        "4094a21b.818aac"
      ]
    ]
  },
  {
    "id": "e27ac12e.c0f94",
    "type": "set",
    "name": "set cidx",
    "xml": "<set>\n<parameter name='tmp.cidx' value=\"`0`\" />\n<parameter name='service-data.consumed-allotted-resources.consumed-allotted-resource_length' value=\"1\" />\n\n\n",
    "comments": "",
    "x": 1205.6698112487793,
    "y": 719.285569190979,
    "z": "cd9be5df.ce2908",
    "wires": []
  },
  {
    "id": "4dc283b6.91bacc",
    "type": "set",
    "name": "set consumed allotted resources",
    "xml": "<set>\n<parameter name='service-data.consumed-allotted-resources.consumed-allotted-resource[$tmp.cidx].allotted-resource-id' value=\"`$tmp.ar.allotted-resource-id` \" />\n<parameter name='service-data.consumed-allotted-resources.consumed-allotted-resource[$tmp.cidx].allotted-resource-type' value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.allotted-resource-type` \" />\n<parameter name='service-data.consumed-allotted-resources.consumed-allotted-resource[$tmp.cidx].allotted-resource-pointer' value=\"`$tmp.ar.self-link` \" />\n<parameter name='service-data.consumed-allotted-resources.consumed-allotted-resource_length' value='`$tmp.cidx + 1`' />\n\n",
    "comments": "",
    "x": 680.5272216796875,
    "y": 856.2856464385986,
    "z": "cd9be5df.ce2908",
    "wires": []
  },
  {
    "id": "4b2529c3.216af8",
    "type": "switchNode",
    "name": "switch tmp.found-cidx",
    "xml": "<switch test='`$tmp.found-cidx`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1382.0550155639648,
    "y": 812.7089734077454,
    "z": "cd9be5df.ce2908",
    "wires": [
      [
        "ad8b7f98.50946"
      ]
    ]
  },
  {
    "id": "ad8b7f98.50946",
    "type": "outcomeTrue",
    "name": "false",
    "xml": "<outcome value='false'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1572.0549697875977,
    "y": 812.7089104652405,
    "z": "cd9be5df.ce2908",
    "wires": [
      [
        "41779dc1.ba7be4"
      ]
    ]
  },
  {
    "id": "41779dc1.ba7be4",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 1738.0549697875977,
    "y": 812.7089104652405,
    "z": "cd9be5df.ce2908",
    "wires": [
      [
        "2f440c06.1088f4"
      ]
    ]
  },
  {
    "id": "302d9adc.f174a6",
    "type": "switchNode",
    "name": "switch allotted-resource-id",
    "xml": "<switch test=\"`$service-data.consumed-allotted-resources.consumed-allotted-resource[$cidx].allotted-resource-id == $tmp.ar.allotted-resource-id`\">\n\n",
    "comments": "",
    "outputs": 1,
    "x": 1986.7822341918945,
    "y": 773.0000762939453,
    "z": "cd9be5df.ce2908",
    "wires": [
      [
        "5fd968eb.dbee58"
      ]
    ]
  },
  {
    "id": "5fd968eb.dbee58",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2168.591808319092,
    "y": 773.4645233154297,
    "z": "cd9be5df.ce2908",
    "wires": [
      [
        "5f190cf1.6a6b14"
      ]
    ]
  },
  {
    "id": "2f440c06.1088f4",
    "type": "set",
    "name": "set tmp.cidx",
    "xml": "<set>\n<parameter name='tmp.cidx' value='`$service-data.consumed-allotted-resources.consumed-allotted-resource_length`' />\n",
    "comments": "",
    "x": 1899.928352355957,
    "y": 812.2206115722656,
    "z": "cd9be5df.ce2908",
    "wires": []
  },
  {
    "id": "19105472.f6180c",
    "type": "comment",
    "name": "Add to consumed service consumed-allotted-resources in mdsal",
    "info": "Prepare data and add to service-data",
    "comments": "",
    "x": 772.671142578125,
    "y": 683.0000457763672,
    "z": "cd9be5df.ce2908",
    "wires": []
  },
  {
    "id": "6cb0630f.018f0c",
    "type": "comment",
    "name": "This set resource will be added to MDSAL by provider code",
    "info": "Below we add to service-data.consumed-allotted-resource at last index",
    "comments": "",
    "x": 760.0040588378906,
    "y": 821.7781381607056,
    "z": "cd9be5df.ce2908",
    "wires": []
  },
  {
    "id": "87d51b5a.de9838",
    "type": "update",
    "name": "update AAI allotted-resource",
    "xml": "<update plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"allotted-resource\" \n\t\tkey=\"customer.global-customer-id = $connection-attachment-topology-operation-input.service-information.global-customer-id AND\n\t\t\tservice-subscription.service-type = $connection-attachment-topology-operation-input.service-information.subscription-service-type AND\n\t\t\tservice-instance.service-instance-id = $connection-attachment-topology-operation-input.allotted-resource-information.parent-service-instance-id AND\n\t\t\tallotted-resource.id = $tmp.ar.allotted-resource-id\"\n        pfx='pfx' local-only='false' force='false'>\n    <parameter name=\"id\" value=\"`$tmp.ar.allotted-resource-id`\" />\n\t<parameter name=\"name\" value=\"`$prop.connection-attachment.sotnVpnName`\" />\n\t<parameter name=\"access-provider-id\" value=\"`$prop.connection-attachment.access-provider-id`\" />\n\t<parameter name=\"access-client-id\" value=\"`$prop.connection-attachment.access-client-id`\" />\n\t<parameter name=\"access-topology-id\" value=\"`$prop.connection-attachment.access-topology-id`\" />\n\t<parameter name=\"access-node-id\" value=\"`$prop.connection-attachment.access-node-id`\" />\n\t<parameter name=\"access-ltp-id\" value=\"`$prop.connection-attachment.access-ltp-id`\" />\t\n\t<parameter name=\"cvlan\" value=\"`$prop.connection-attachment.cVLAN`\" />\n    <parameter name=\"vpn-name\" value=\"`$prop.connection-attachment.sotnVpnName`\" />\n\t<parameter name=\"selflink\" value=\"`$tmp.ar.self-link`\" />\n\t<parameter name=\"model-invariant-id\" value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.onap-model-information.model-invariant-uuid`\" />\n\t<parameter name=\"model-version-id\" value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.onap-model-information.model-uuid`\" />\n\t<parameter name=\"operational-status\" value=\"Created\" />\n",
    "comments": "",
    "outputs": 1,
    "x": 670.6947631835938,
    "y": 1781.5319023132324,
    "z": "cd9be5df.ce2908",
    "wires": [
      [
        "b228ba2a.5eb858",
        "8dc6aba6.274fd8"
      ]
    ]
  },
  {
    "id": "b228ba2a.5eb858",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 865.4566993713379,
    "y": 1772.4845037460327,
    "z": "cd9be5df.ce2908",
    "wires": [
      [
        "318219a7.93b5f6"
      ]
    ]
  },
  {
    "id": "318219a7.93b5f6",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"AAI failed\" />\n",
    "comments": "",
    "x": 1031.9805793762207,
    "y": 1784.1035747528076,
    "z": "cd9be5df.ce2908",
    "wires": []
  },
  {
    "id": "8dc6aba6.274fd8",
    "type": "failure",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 872.5519866943359,
    "y": 1805.2464714050293,
    "z": "cd9be5df.ce2908",
    "wires": [
      [
        "318219a7.93b5f6"
      ]
    ]
  },
  {
    "id": "a4412b8a.bdd4c8",
    "type": "comment",
    "name": "Save Resource to AAI",
    "info": "",
    "comments": "",
    "x": 646.50439453125,
    "y": 1743.8338737487793,
    "z": "cd9be5df.ce2908",
    "wires": []
  },
  {
    "id": "1dc5b46a.d6f27c",
    "type": "comment",
    "name": "Set allotted resource type if not sent by SO",
    "info": "",
    "comments": "",
    "x": 706.00390625,
    "y": 222.99999904632568,
    "z": "cd9be5df.ce2908",
    "wires": []
  },
  {
    "id": "e860512d.3a9e9",
    "type": "switchNode",
    "name": "switch allotted-resource-type",
    "xml": "<switch test='`$connection-attachment-topology-operation-input.allotted-resource-information.allotted-resource-type`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 667.9272155761719,
    "y": 263.56605529785156,
    "z": "cd9be5df.ce2908",
    "wires": [
      [
        "6ea7eebb.9881c",
        "6e63f7cb.1a7468"
      ]
    ]
  },
  {
    "id": "6ea7eebb.9881c",
    "type": "outcome",
    "name": "NULL",
    "xml": "<outcome value=''>",
    "comments": "",
    "outputs": 1,
    "x": 870.9273681640625,
    "y": 248.5660581588745,
    "z": "cd9be5df.ce2908",
    "wires": [
      [
        "73c7d597.95055c"
      ]
    ]
  },
  {
    "id": "6e63f7cb.1a7468",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 863.9271965026855,
    "y": 288.56607818603516,
    "z": "cd9be5df.ce2908",
    "wires": [
      [
        "a066a0c6.f96ce"
      ]
    ]
  },
  {
    "id": "a066a0c6.f96ce",
    "type": "set",
    "name": "set tmp.ar.allotted-resource-type",
    "xml": "<set>\n<parameter name='tmp.ar.allotted-resource-type' value='`$connection-attachment-topology-operation-input.allotted-resource-information.allotted-resource-type`' />\n",
    "comments": "",
    "x": 1095.9271812438965,
    "y": 288.56608295440674,
    "z": "cd9be5df.ce2908",
    "wires": []
  },
  {
    "id": "3618be06.ef2b72",
    "type": "comment",
    "name": "For storage in AAI connection-attachment-topology",
    "info": "",
    "comments": "",
    "x": 731.0038681030273,
    "y": 357.9999990463257,
    "z": "cd9be5df.ce2908",
    "wires": []
  },
  {
    "id": "cfe42c68.ed396",
    "type": "comment",
    "name": "Obtain different URL, template location etc",
    "info": "For saving resource information to MDSAL & for AAI",
    "comments": "",
    "x": 706.0038528442383,
    "y": 439.88890838623047,
    "z": "cd9be5df.ce2908",
    "wires": []
  },
  {
    "id": "69bf5592.4b80fc",
    "type": "comment",
    "name": "Used for Put AR by id to MDSAL",
    "info": "",
    "comments": "",
    "x": 672.0039367675781,
    "y": 528.8889255523682,
    "z": "cd9be5df.ce2908",
    "wires": []
  },
  {
    "id": "5fd6e18a.ea534",
    "type": "comment",
    "name": "Obtain the last index in services",
    "info": "ServiceData is added by Provider code",
    "comments": "",
    "x": 673.4483795166016,
    "y": 714.8888702392578,
    "z": "cd9be5df.ce2908",
    "wires": []
  },
  {
    "id": "fb5d252f.afc7e8",
    "type": "set",
    "name": "set output to api handler",
    "xml": "<set>\n<parameter name='allotted-resource-id' value='`$tmp.ar.allotted-resource-id`' />\n<parameter name='connection-attachment-object-path' value=\"`$tmp.ar.self-link`\"/>\n<parameter name='service-object-path' value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $connection-attachment-topology-operation-input.service-information.service-instance-id\n + '/service-data/service-topology/'`\"/>\n \n",
    "comments": "",
    "x": 656.2720489501953,
    "y": 1688.3592014312744,
    "z": "cd9be5df.ce2908",
    "wires": []
  },
  {
    "id": "c69bb6da.e373b8",
    "type": "returnSuccess",
    "name": "return success",
    "xml": "<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n",
    "comments": "",
    "x": 624.6851272583008,
    "y": 1829.9749879837036,
    "z": "cd9be5df.ce2908",
    "wires": []
  },
  {
    "id": "73c7d597.95055c",
    "type": "set",
    "name": "set tmp.ar.allotted-resource-type",
    "xml": "<set>\n<parameter name='tmp.ar.allotted-resource-type' value=\"SOTNAttachmentInstance\" />\n",
    "comments": "",
    "x": 1110.0040550231934,
    "y": 248.99998474121094,
    "z": "cd9be5df.ce2908",
    "wires": []
  },
  {
    "id": "bd67321d.42bb1",
    "type": "call",
    "name": "call GENERIC-RESOURCE-API:sotn-get-saved-ar-param",
    "xml": "<call module='GENERIC-RESOURCE-API' rpc='sotn-get-saved-ar-param' mode='sync' >\n",
    "comments": "",
    "outputs": 1,
    "x": 757.9980697631836,
    "y": 1548.4938125610352,
    "z": "cd9be5df.ce2908",
    "wires": [
      []
    ]
  },
  {
    "id": "cfa3c909.8098f8",
    "type": "execute",
    "name": "execute RestApiCallNode - PUT AR by id",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='templateFileName' value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.sotn-attachment.templatefile`\" />\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.ar-url`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='PUT' />\n    <parameter name=\"responsePrefix\" value=\"mdsal-ar\" />\n\n",
    "comments": "",
    "outputs": 1,
    "x": 707.0041809082031,
    "y": 1622.0001306533813,
    "z": "cd9be5df.ce2908",
    "wires": [
      [
        "3353e41f.241ecc",
        "6e7ce891.59b488",
        "a7ba9eed.19c34"
      ]
    ]
  },
  {
    "id": "3353e41f.241ecc",
    "type": "not-found",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 956.6455345153809,
    "y": 1660.3314609527588,
    "z": "cd9be5df.ce2908",
    "wires": [
      [
        "d4af4530.ee27d8"
      ]
    ]
  },
  {
    "id": "6e7ce891.59b488",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 947.6455841064453,
    "y": 1628.8314867019653,
    "z": "cd9be5df.ce2908",
    "wires": [
      [
        "d4af4530.ee27d8"
      ]
    ]
  },
  {
    "id": "a7ba9eed.19c34",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 951.395622253418,
    "y": 1599.1885915771127,
    "z": "cd9be5df.ce2908",
    "wires": [
      [
        "1506a4c.38be55b"
      ]
    ]
  },
  {
    "id": "d4af4530.ee27d8",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating md-sal for connection-attachment-allotted-resource\" />\n",
    "comments": "",
    "x": 1117.395622253418,
    "y": 1629.5815105438232,
    "z": "cd9be5df.ce2908",
    "wires": []
  },
  {
    "id": "1506a4c.38be55b",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1093.0515899658203,
    "y": 1595.3807607665658,
    "z": "cd9be5df.ce2908",
    "wires": [
      []
    ]
  },
  {
    "id": "a6939d07.10c8f",
    "type": "execute",
    "name": "execute RestApiCallNode - Update parent provided service AR",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='templateFileName' value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.parentsvc.templatefile`\" />\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.parent-ar-url`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='PUT' />\n    <parameter name=\"responsePrefix\" value=\"parent\" />\n\n",
    "comments": "",
    "outputs": 1,
    "x": 772.0038604736328,
    "y": 1138.0001640319824,
    "z": "cd9be5df.ce2908",
    "wires": [
      [
        "4754aabd.5d8774",
        "2a75672c.2d3568",
        "9a95b194.a8985"
      ]
    ]
  },
  {
    "id": "4754aabd.5d8774",
    "type": "not-found",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1080.3119201660156,
    "y": 1169.9984397888184,
    "z": "cd9be5df.ce2908",
    "wires": [
      [
        "67ec360d.cb3488"
      ]
    ]
  },
  {
    "id": "2a75672c.2d3568",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1071.31196975708,
    "y": 1138.498465538025,
    "z": "cd9be5df.ce2908",
    "wires": [
      [
        "67ec360d.cb3488"
      ]
    ]
  },
  {
    "id": "9a95b194.a8985",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1075.0620079040527,
    "y": 1108.8555704131722,
    "z": "cd9be5df.ce2908",
    "wires": [
      [
        "cd8d17ff.780028"
      ]
    ]
  },
  {
    "id": "67ec360d.cb3488",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating md-sal for connection-attachment-allotted-resource\" />\n",
    "comments": "",
    "x": 1241.0620079040527,
    "y": 1139.2484893798828,
    "z": "cd9be5df.ce2908",
    "wires": []
  },
  {
    "id": "cd8d17ff.780028",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1216.717975616455,
    "y": 1105.0477396026254,
    "z": "cd9be5df.ce2908",
    "wires": [
      []
    ]
  },
  {
    "id": "6d246a12.903cb4",
    "type": "comment",
    "name": "Put the parent allotted resource in mdsal",
    "info": "",
    "comments": "",
    "x": 701.0038070678711,
    "y": 1100.0000705718994,
    "z": "cd9be5df.ce2908",
    "wires": []
  },
  {
    "id": "96fd2d4.3efccd",
    "type": "set",
    "name": "set connection-attachment-ar-identifiers",
    "xml": "<set>\n<parameter name='connection-attachment-ar-identifiers.consuming-service-instance-id' value=\"`$connection-attachment-topology-operation-input.service-information.service-instance-id` \" />\n<parameter name='connection-attachment-ar-identifiers.parent-service-instance-id' value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.parent-service-instance-id` \" />\n<parameter name='connection-attachment-ar-identifiers.allotted-resource-type' value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.allotted-resource-type` \" />\n<parameter name='connection-attachment-ar-identifiers.allotted-resource-id' value=\"`$tmp.ar.allotted-resource-id` \" />\n\n",
    "comments": "",
    "x": 697.3609924316406,
    "y": 1302.571689605713,
    "z": "cd9be5df.ce2908",
    "wires": []
  },
  {
    "id": "465324d8.73e58c",
    "type": "set",
    "name": "set ar-data",
    "xml": "<set>\n<parameter name='connection-attachment-ar.allotted-resource-id' value=\"`$tmp.ar.allotted-resource-id` \" />\n<parameter name='connection-attachment-ar.allotted-resource-status.action' value=\"`$connection-attachment-topology-operation-input.request-information.request-action` \" />\n<parameter name='connection-attachment-ar.allotted-resource-status.rpc-name' value=\"connection-attachment-topology-operation\" />\n<parameter name='connection-attachment-ar.allotted-resource-status.rpc-action' value=\"`$connection-attachment-topology-operation-input.sdnc-request-header.svc-action` \" />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-operation-information.request-information.' value=\"`$connection-attachment-topology-operation-input.request-information.` \" />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-operation-information.sdnc-request-header.' value=\"`$connection-attachment-topology-operation-input.sdnc-request-header.` \" />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-operation-information.service-information.' value=\"`$connection-attachment-topology-operation-input.service-information.` \" />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-operation-information.allotted-resource-information.' value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.` \" />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-operation-information.connection-attachment-request-input.' value=\"`$connection-attachment-topology-operation-input.connection-attachment-request-input.` \" />",
    "comments": "",
    "x": 611.2177734375,
    "y": 1270.381046295166,
    "z": "cd9be5df.ce2908",
    "wires": []
  },
  {
    "id": "eaaea0ea.31b57",
    "type": "set",
    "name": "set identifiers in overall structure",
    "xml": "<set>\n<parameter name='connection-attachment-ar.allotted-resource-data.connection-attachment-topology.allotted-resource-identifiers.' \nvalue=\"`$connection-attachment-ar-identifiers.`\" />\n\n\n",
    "comments": "",
    "x": 676.1707916259766,
    "y": 1336.666874885559,
    "z": "cd9be5df.ce2908",
    "wires": []
  },
  {
    "id": "d974b696.f92d58",
    "type": "execute",
    "name": "execute getTime",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='setTime' >\n    <parameter name=\"outputPath\" value=\"tmp.current-time\" />\n\n",
    "comments": "",
    "outputs": 1,
    "x": 628.5036315917969,
    "y": 1410.0004024505615,
    "z": "cd9be5df.ce2908",
    "wires": [
      []
    ]
  },
  {
    "id": "c290a3d2.4b9bc",
    "type": "set",
    "name": "set allotted-resource-oper-status",
    "xml": "<set>\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.order-status' value='Created' />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.last-action' value='`$connection-attachment-topology-operation-input.request-information.request-action`' />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.last-rpc-action' value='`$connection-attachment-topology-operation-input.sdnc-request-header.svc-action`' />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.last-svc-request-id' value='`$connection-attachment-topology-operation-input.sdnc-request-header.svc-request-id`' />\n<parameter name='connection-attachment-ar.allotted-resource-data.allotted-resource-oper-status.create-timestamp' value='`$tmp.current-time`' />\n",
    "comments": "",
    "x": 679.4906692504883,
    "y": 1465.9516353607178,
    "z": "cd9be5df.ce2908",
    "wires": []
  },
  {
    "id": "604d94ec.b3a5ec",
    "type": "set",
    "name": "set model-data",
    "xml": "<set>\n<parameter name='connection-attachment-ar.allotted-resource-data.connection-attachment-topology.onap-model-information.' value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.onap-model-information.` \" />",
    "comments": "",
    "x": 624.0592880249023,
    "y": 1371.555760383606,
    "z": "cd9be5df.ce2908",
    "wires": []
  },
  {
    "id": "1de58d01.5dca13",
    "type": "comment",
    "name": "Prepare data for allotted-resource addition to MDSAL",
    "info": "This will add to allotted-resource which is present inside service.",
    "comments": "",
    "x": 741.3927764892578,
    "y": 1236.555606842041,
    "z": "cd9be5df.ce2908",
    "wires": []
  },
  {
    "id": "c3a30593.5755d8",
    "type": "execute",
    "name": "generate parent-ar url - replace allotted-resource-id",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"`$tmp.parent-ar-url`\"/>\n    <parameter name=\"outputPath\" value=\"tmp.parent-ar-url\"/>\n    <parameter name=\"target\" value=\"{allotted-resource-id}\"/>\n    <parameter name=\"replacement\" value=\"`$tmp.ar.allotted-resource-id`\"/>\n",
    "comments": "",
    "outputs": 1,
    "x": 736.5039215087891,
    "y": 1064.0000095367432,
    "z": "cd9be5df.ce2908",
    "wires": [
      []
    ]
  },
  {
    "id": "fa779466.451918",
    "type": "execute",
    "name": "generate parent-ar url - replace service-instance-id",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"`$prop.restapi.parent-provided-resource`\"/>\n    <parameter name=\"outputPath\" value=\"tmp.parent-ar-url\"/>\n    <parameter name=\"target\" value=\"{service-instance-id}\"/>\n    <parameter name=\"replacement\" value=\"`$tmp.ar.parent-service-instance-id`\"/>\n",
    "comments": "",
    "outputs": 1,
    "x": 732.5038452148438,
    "y": 1021.0001459121704,
    "z": "cd9be5df.ce2908",
    "wires": [
      []
    ]
  },
  {
    "id": "92e70778.8561b8",
    "type": "comment",
    "name": "Prepare Parent AR URL",
    "info": "Preparation to set provided-allotted-resource in parent service instance",
    "comments": "",
    "x": 650.5043029785156,
    "y": 950.0000991821289,
    "z": "cd9be5df.ce2908",
    "wires": []
  },
  {
    "id": "7955c841.e97a58",
    "type": "set",
    "name": "set tmp.ar.parent-service-instance-id",
    "xml": "<set>\n<parameter name='tmp.ar.parent-service-instance-id' value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.parent-service-instance-id` \" />\n\n",
    "comments": "",
    "x": 689.5040969848633,
    "y": 983.5000386238098,
    "z": "cd9be5df.ce2908",
    "wires": []
  },
  {
    "id": "4fac86d0.aaff48",
    "type": "comment",
    "name": "Required for filling template values",
    "info": "This is done because connection-attachment is generic resource and doesn't have specific parameters",
    "comments": "",
    "x": 684.0042724609375,
    "y": 1511.499885559082,
    "z": "cd9be5df.ce2908",
    "wires": []
  },
  {
    "id": "5f190cf1.6a6b14",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating md-sal for connection-attachment-allotted-resource as cosumed allotted resource already exists.\" />\n",
    "comments": "",
    "x": 2246.7608795166016,
    "y": 821.6458282470703,
    "z": "cd9be5df.ce2908",
    "wires": []
  },
  {
    "id": "4094a21b.818aac",
    "type": "set",
    "name": "set tmp.found-cidx",
    "xml": "<set>\n<parameter name='tmp.found-cidx' value=\"`false`\" />\n\n\n",
    "comments": "",
    "x": 1372.6500511169434,
    "y": 733.3125712871552,
    "z": "cd9be5df.ce2908",
    "wires": []
  },
  {
    "id": "fe6d24b6.f9f518",
    "type": "comment",
    "name": "Add to parent services provided-allotted-resources in mdsal",
    "info": "",
    "comments": "",
    "x": 761.2054138183594,
    "y": 917.9792556762695,
    "z": "cd9be5df.ce2908",
    "wires": []
  },
  {
    "id": "57e7c6ce.edad78",
    "type": "comment",
    "name": "Add to allotted-resources in mdsal",
    "info": "",
    "comments": "",
    "x": 681.9726028442383,
    "y": 1203.9689359664917,
    "z": "cd9be5df.ce2908",
    "wires": []
  },
  {
    "id": "5a7187fc.7cbe38",
    "type": "block",
    "name": "block: atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1355.003957748413,
    "y": 631.277759552002,
    "z": "cd9be5df.ce2908",
    "wires": [
      [
        "6904eac2.f66f64"
      ]
    ]
  },
  {
    "id": "6904eac2.f66f64",
    "type": "switchNode",
    "name": "switch cr length",
    "xml": "<switch test='`$mdsal-ar.connection-attachment-allotted-resource_length`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1542.8613376617432,
    "y": 631.8968949317932,
    "z": "cd9be5df.ce2908",
    "wires": [
      [
        "a104ce60.4608e"
      ]
    ]
  },
  {
    "id": "a104ce60.4608e",
    "type": "other",
    "name": "outcome 1",
    "xml": "<outcome value='1'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1742.1944599151611,
    "y": 631.8969736099243,
    "z": "cd9be5df.ce2908",
    "wires": [
      [
        "9b07dcd5.e21ac"
      ]
    ]
  },
  {
    "id": "cd515755.334938",
    "type": "execute",
    "name": "execute RestApiCallNode - get-resource connection-attachment-allotted-resource",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.ar-url`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='GET' />\n    <parameter name=\"responsePrefix\" value=\"mdsal-ar\" />\n\n",
    "comments": "",
    "outputs": 1,
    "x": 827.0039596557617,
    "y": 626.0000352859497,
    "z": "cd9be5df.ce2908",
    "wires": [
      [
        "23e2be4c.571a12",
        "947a36b0.307838"
      ]
    ]
  },
  {
    "id": "947a36b0.307838",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1195.0039901733398,
    "y": 596.0000333786011,
    "z": "cd9be5df.ce2908",
    "wires": [
      [
        "9d20b3b3.a2912"
      ]
    ]
  },
  {
    "id": "9d20b3b3.a2912",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1347.0039901733398,
    "y": 595.0000333786011,
    "z": "cd9be5df.ce2908",
    "wires": [
      []
    ]
  }
]
