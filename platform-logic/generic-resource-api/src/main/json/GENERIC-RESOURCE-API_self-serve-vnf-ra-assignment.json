[{"id":"63c6d4ad.9f7fdc","type":"dgstart","name":"DGSTART","outputs":1,"x":105,"y":60,"z":"9c9d6788.9ad478","wires":[["c9ec4200.9fbe"]]},{"id":"c9ec4200.9fbe","type":"service-logic","name":"GENERIC-RESOURCE-API ${project.version}","module":"GENERIC-RESOURCE-API","version":"${project.version}","comments":"","xml":"<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>","outputs":1,"x":381,"y":61,"z":"9c9d6788.9ad478","wires":[["9dfa437.8ea91c"]]},{"id":"9dfa437.8ea91c","type":"method","name":"self-serve-vnf-ra-assignment","xml":"<method rpc='self-serve-vnf-ra-assignment' mode='sync'>\n","comments":"","outputs":1,"x":224.07144165039062,"y":117.96428775787354,"z":"9c9d6788.9ad478","wires":[["2d7abfcd.2faa6"]]},{"id":"2d7abfcd.2faa6","type":"block","name":"block atomic","xml":"<block atomic=\"true\">\n","atomic":"false","comments":"","outputs":1,"x":218.4523468017578,"y":184.54761695861816,"z":"9c9d6788.9ad478","wires":[["4d21efd2.5e5ff","ab54238d.24ce5","8b575074.f108d","bc2286aa.e94c88","d4b38f52.e612d","a657e5a1.4f2038","2de3e1e7.11b9de","76f1b778.049d28","8217d55.d112b28","f43af4c9.1c8338","c77c96b3.9671d8","25ebf820.dd8c48","989ba1d5.b7504","3dd11a72.581e76"]]},{"id":"ab54238d.24ce5","type":"set","name":"set","xml":"<set>\n   <parameter name=\"cds\" value=\"execution-service_process.\"/>\n   <parameter name=\"`$cds + 'commonHeader.requestId'`\" value=\"`$tmp.return.generate.vnf-se-serv-uuid`\"/>\n   <parameter name=\"resource-type\" value=\"`$vnf-topology-operation-input.vnf-information.vnf-type`\" />  \n   <parameter name=\"`$cds + 'commonHeader.subRequestId'`\" value=\"`$vnf-topology-operation-input.vnf-information.vnf-id`\" />   \n   <parameter name=\"`$cds + 'actionIdentifiers.actionName'`\" value=\"resource-assignment\"/> \n   <parameter name=\"responsePrefix\" value=\"raAssign\" />\n   <parameter name=\"`$cds + 'isNonAppend'`\" value=\"true\"/>\n   <parameter name=\"`$cds + 'commonHeader.originatorId'`\" value=\"SDNC_DG\"/>\n   <parameter name=\"`$cds + 'actionIdentifiers.mode'`\" value=\"sync\"/>\n","comments":"","x":399.2023696899414,"y":253.0476131439209,"z":"9c9d6788.9ad478","wires":[]},{"id":"a14536c0.6d3618","type":"get-resource","name":"get-resource VF_MODEL","xml":"<get-resource plugin='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource' resource='SQL'\n  key='SELECT * from VF_MODEL WHERE customization_uuid = $vnf-topology-operation-input.vnf-information.onap-model-information.model-customization-uuid'\n  pfx='db1.vf-model'>\n  \n\n","comments":"","outputs":1,"x":957.8173675537109,"y":716.111005783081,"z":"9c9d6788.9ad478","wires":[["cfe4a3cc.64f95","e22771c4.b1ea3","bf4a0272.ac394"]]},{"id":"cfe4a3cc.64f95","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1202.8174667358398,"y":665.3967294692993,"z":"9c9d6788.9ad478","wires":[["f292357e.bbd1a8"]]},{"id":"f292357e.bbd1a8","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error reading VF_MODULE_MODEL table\" />\n","comments":"","x":1375.8174667358398,"y":665.3967294692993,"z":"9c9d6788.9ad478","wires":[]},{"id":"b5950127.c7e1c","type":"set","name":"set tmp.sdnc-model-name, tmp.sdnc-model-version, tmp.sdnc-artifact-name","xml":"<set>\n<parameter name='tmp.sdnc-model-name' value='`$db1.vf-model.sdnc-model-name`' />\n<parameter name='tmp.sdnc-model-version' value='`$db1.vf-model.sdnc-model-version`' />\n<parameter name='tmp.sdnc-artifact-name' value='`$db1.vf-model.sdnc-artifact-name`' />\n\n\n\n\n","comments":"","x":1601.2459678649902,"y":765.5395336151123,"z":"9c9d6788.9ad478","wires":[]},{"id":"11e64d9f.7666f2","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error reading VF_MODULE_MODEL table\" />\n","comments":"","x":1385.8174667358398,"y":714.3967294692993,"z":"9c9d6788.9ad478","wires":[]},{"id":"d4b38f52.e612d","type":"switchNode","name":"switch: model info == NULL","xml":"<switch test=\"`$tmp.sdnc-model-name == '' or $tmp.sdnc-model-version == '' or $tmp.sdnc-artifact-name == ''`\">\n","comments":"","outputs":1,"x":475.81736755371094,"y":717.111005783081,"z":"9c9d6788.9ad478","wires":[["50bfe883.896158"]]},{"id":"e22771c4.b1ea3","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":1208.8174667358398,"y":714.3967294692993,"z":"9c9d6788.9ad478","wires":[["11e64d9f.7666f2"]]},{"id":"50bfe883.896158","type":"outcome","name":"true","xml":"<outcome value='true'>","comments":"","outputs":1,"x":727.8173675537109,"y":717.111005783081,"z":"9c9d6788.9ad478","wires":[["a14536c0.6d3618"]]},{"id":"bc2286aa.e94c88","type":"for","name":"for vnf-topology-operation-input","xml":"<for silentFailure='true' index='i' start='0' end='`$vnf-topology-operation-input.vnf-request-input.vnf-input-parameters.param_length`' >","comments":"","outputs":1,"x":487.4523468017578,"y":502.79761695861816,"z":"9c9d6788.9ad478","wires":[["19d21bae.1c2954"]]},{"id":"19d21bae.1c2954","type":"block","name":"block atomic","xml":"<block atomic=\"true\">","atomic":"false","comments":"","outputs":1,"x":748.4523468017578,"y":502.79761695861816,"z":"9c9d6788.9ad478","wires":[["a444ea28.08f138"]]},{"id":"bf9fd0c8.a829d","type":"set","name":"set tmp.sdnc-model-name","xml":"<set>\n<parameter name='tmp.sdnc-model-name' value='`$vnf-topology-operation-input.vnf-request-input.vnf-input-parameters.param[$i].value`' />\n","comments":"","x":1397.4523468017578,"y":424.79761695861816,"z":"9c9d6788.9ad478","wires":[]},{"id":"94e35222.f28a4","type":"outcome","name":"sdnc_model_name","xml":"<outcome value='sdnc_model_name'>\n","comments":"","outputs":1,"x":1143.4523468017578,"y":424.79761695861816,"z":"9c9d6788.9ad478","wires":[["bf9fd0c8.a829d"]]},{"id":"a444ea28.08f138","type":"switchNode","name":"switch","xml":"<switch test='`$vnf-topology-operation-input.vnf-request-input.vnf-input-parameters.param[$i].name`'>\n\n","comments":"","outputs":1,"x":922.4523468017578,"y":502.79761695861816,"z":"9c9d6788.9ad478","wires":[["94e35222.f28a4","729b92d8.96607c","2b571743.3f9948","8a545dd3.88e11"]]},{"id":"729b92d8.96607c","type":"outcome","name":"sdnc_model_version","xml":"<outcome value='sdnc_model_version'>\n","comments":"","outputs":1,"x":1146.4523468017578,"y":470.79761695861816,"z":"9c9d6788.9ad478","wires":[["77facf86.b921f"]]},{"id":"2b571743.3f9948","type":"outcome","name":"sdnc_artifact_name","xml":"<outcome value='sdnc_artifact_name'>\n","comments":"","outputs":1,"x":1145.4523468017578,"y":519.7976169586182,"z":"9c9d6788.9ad478","wires":[["784205a5.281cac"]]},{"id":"77facf86.b921f","type":"set","name":"set tmp.sdnc-model-version","xml":"<set>\n<parameter name='tmp.sdnc-model-version' value='`$vnf-topology-operation-input.vnf-request-input.vnf-input-parameters.param[$i].value`' />\n\n","comments":"","x":1401.4523468017578,"y":470.79761695861816,"z":"9c9d6788.9ad478","wires":[]},{"id":"784205a5.281cac","type":"set","name":"set tmp.sdnc-artifact-name","xml":"<set>\n<parameter name='tmp.sdnc-artifact-name' value='`$vnf-topology-operation-input.vnf-request-input.vnf-input-parameters.param[$i].value`' />\n\n","comments":"","x":1397.4523468017578,"y":519.7976169586182,"z":"9c9d6788.9ad478","wires":[]},{"id":"f57a1ff1.c4263","type":"set","name":"set name-value other JsonString","xml":"<set>\n<parameter name=\"tmp.config-name-value-other-payload\" value=\"`$tmp.config-name-value-other-payload + '&quot;' + $vnf-topology-operation-input.vnf-request-input.vnf-input-parameters.param[$i].name + '&quot;:&quot;' + $vnf-topology-operation-input.vnf-request-input.vnf-input-parameters.param[$i].value + '&quot;,'`\"/>\n\n","comments":"","x":1413.4523468017578,"y":568.7976169586182,"z":"9c9d6788.9ad478","wires":[]},{"id":"8a545dd3.88e11","type":"outcome","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":1105.4523544311523,"y":569.3690376281738,"z":"9c9d6788.9ad478","wires":[["f57a1ff1.c4263"]]},{"id":"a657e5a1.4f2038","type":"set","name":"set configAssignment JsonString","xml":"<set>\n<parameter name=\"tmp.config-name-value-payload4\" value=\"`$tmp.config-name-value-other-payload + '&quot;service-instance-id&quot;:&quot;' + $vnf-topology-operation-input.service-information.service-instance-id   + '&quot;,'`\"/>\n<parameter name=\"tmp.config-name-value-payload5\" value=\"`$tmp.config-name-value-payload4 + '&quot;vnf-model-customization-uuid&quot;:&quot;' + $vnf-topology-operation-input.vnf-information.onap-model-information.model-customization-uuid + '&quot;,'`\"/>\n<parameter name=\"tmp.config-name-value-payload6\" value=\"`$tmp.config-name-value-payload5 + '&quot;vnf-id&quot;:&quot;' + $vnf-topology-operation-input.vnf-information.vnf-id + '&quot;,'`\"/>\n<parameter name=\"tmp.config-name-value-payload7\" value=\"`$tmp.config-name-value-payload6 + '&quot;aic-cloud-region&quot;:&quot;' + $vnf-topology-operation-input.vnf-request-input.aic-cloud-region + '&quot;'`\"/>\n","comments":"","x":489.0079040527344,"y":776.4920196533203,"z":"9c9d6788.9ad478","wires":[]},{"id":"2de3e1e7.11b9de","type":"execute","name":"execute BlueprintProcessingClient","xml":"<execute plugin='org.onap.ccsdk.sli.plugins.restconfapicall.RestconfApiCallNode' method='sendRequest' >\n    <parameter name='restapiUrl' value=\"`$prop.cds.url + '/api/v1/execution-service/process'`\" />\n    <parameter name='restapiUser' value='`$prop.cds.user`' />\n    <parameter name='restapiPassword' value='`$prop.cds.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='POST' />\n    <parameter name='dirPath' value=\"/opt/onap/sdnc/restconfapi/yang\" />\n    <parameter name=\"responsePrefix\" value=\"raAssign\" />","comments":"","outputs":1,"x":491.8968048095703,"y":996.9364633560181,"z":"9c9d6788.9ad478","wires":[["72272799.6f87e8","94ab143.1d302e8"]]},{"id":"72272799.6f87e8","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":731.8968048095703,"y":968.9364633560181,"z":"9c9d6788.9ad478","wires":[["d75bb620.442198"]]},{"id":"d75bb620.442198","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error from BlueprintProcessingClient\" />\n","comments":"","x":920.8968048095703,"y":989.9364633560181,"z":"9c9d6788.9ad478","wires":[]},{"id":"4d21efd2.5e5ff","type":"execute","name":"execute generateUUID","xml":" <execute plugin=\"org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils\" method=\"generateUUID\" > \n <parameter name=\"ctx-destination\" value=\"tmp.return.generate.vnf-se-serv-uuid\" /> \n ","comments":"","outputs":1,"x":455.9523468017578,"y":184.54761695861816,"z":"9c9d6788.9ad478","wires":[["4b9937da.942858"]]},{"id":"4b9937da.942858","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":667.9523468017578,"y":183.54761695861816,"z":"9c9d6788.9ad478","wires":[["a3737477.348b98"]]},{"id":"a3737477.348b98","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"generateUUID is failed\" />\n","comments":"","x":843.9523468017578,"y":183.54761695861816,"z":"9c9d6788.9ad478","wires":[]},{"id":"8b575074.f108d","type":"switchNode","name":"switch vnf-parameters-data.param_length","xml":"<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-parameters-data.param_length`'>\n","comments":"","outputs":1,"x":524.2023468017578,"y":331.29764461517334,"z":"9c9d6788.9ad478","wires":[["2de664b1.86a3cc","ce207255.cb9e6"]]},{"id":"2de664b1.86a3cc","type":"outcome","name":"null","xml":"<outcome value=''>","comments":"","outputs":1,"x":791.2023468017578,"y":299.29764461517334,"z":"9c9d6788.9ad478","wires":[["163e5ecc.ddef61"]]},{"id":"ce207255.cb9e6","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":790.2023468017578,"y":363.29764461517334,"z":"9c9d6788.9ad478","wires":[["aa3c70c4.b7cd6"]]},{"id":"163e5ecc.ddef61","type":"set","name":"set pre service param len as 0","xml":"<set>\n   <parameter name='highnum' value='0' />\n   <parameter name='prehighnum' value='0'/>\n","comments":"","x":1004.2023468017578,"y":299.29764461517334,"z":"9c9d6788.9ad478","wires":[]},{"id":"aa3c70c4.b7cd6","type":"set","name":"set pre service param len","xml":"<set>\n   <parameter name='highnum' value='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-parameters-data.param_length`' />\n   <parameter name='prehighnum' value='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-topology.vnf-parameters-data.param_length`' />","comments":"","x":989.2023468017578,"y":363.29764461517334,"z":"9c9d6788.9ad478","wires":[]},{"id":"94ab143.1d302e8","type":"failure","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":742.8968048095703,"y":1030.936463356018,"z":"9c9d6788.9ad478","wires":[["d75bb620.442198"]]},{"id":"bf4a0272.ac394","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":1204.9602699279785,"y":765.3967018127441,"z":"9c9d6788.9ad478","wires":[["b5950127.c7e1c"]]},{"id":"76f1b778.049d28","type":"record","name":"record","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"BEFORE BlueprintProcessingClient\"/>\n\n","comments":"","outputs":1,"x":395.67456436157227,"y":920.7143058776855,"z":"9c9d6788.9ad478","wires":[[]]},{"id":"8217d55.d112b28","type":"record","name":"record","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"AFTER BlueprintProcessingClient\"/>\n\n","comments":"","outputs":1,"x":397.8968200683594,"y":1104.6031112670898,"z":"9c9d6788.9ad478","wires":[[]]},{"id":"f43af4c9.1c8338","type":"set","name":"set updateJsonPayload","xml":"<set>\n<parameter name=\"tmp.json-payload\" value=\"`'{' + $tmp.config-name-value-payload7 + '}'`\" />\n<parameter name=\"`$cds + 'actionIdentifiers.blueprintName'`\" value='`$tmp.sdnc-model-name`' />\n<parameter name=\"`$cds + 'actionIdentifiers.blueprintVersion'`\" value='`$tmp.sdnc-model-version`' />\n<parameter name=\"`$cds + 'payload.resource-assignment-request.template-prefix[0]'`\" value='`$tmp.sdnc-artifact-name`' />\n<parameter name=\"`$cds + 'payload.resource-assignment-request.resource-assignment-properties'`\" value='`$tmp.json-payload`' />","comments":"","x":454.4523468017578,"y":848.7143030166626,"z":"9c9d6788.9ad478","wires":[]},{"id":"809d6195.590c7","type":"call","name":"Call self-serve-process-vnf-template-ra-response","xml":"<call module='GENERIC-RESOURCE-API' rpc='self-serve-process-vnf-template-ra-response' mode='sync' >\n","comments":"","outputs":1,"x":1641.1666946411133,"y":1324.0276069641113,"z":"9c9d6788.9ad478","wires":[[]]},{"id":"16e7a11.046735f","type":"call","name":"Call self-serve-process-vnf-mapping-ra-response","xml":"<call module='GENERIC-RESOURCE-API' rpc='self-serve-process-vnf-mapping-ra-response' mode='sync' >\n","comments":"","outputs":1,"x":1082.000015258789,"y":1177.8888149261475,"z":"9c9d6788.9ad478","wires":[[]]},{"id":"989ba1d5.b7504","type":"execute","name":"printContext","xml":"<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='printContext' >\n<parameter name='filename' value='`$pathname`' />\n","comments":"","outputs":1,"x":417.7500114440918,"y":1532.7500228881836,"z":"9c9d6788.9ad478","wires":[[]]},{"id":"25ebf820.dd8c48","type":"set","name":"set pathname","xml":"<set>\n<parameter name='pathname' \n\tvalue=\"`'/var/tmp/ss-vnf-ra-assignment-' + \n\t$service-data.vnfs.vnf[$vnf-index].vnf-data.vnf-information.vnf-id + '.log'`\" />\n","comments":"","x":423.0000114440918,"y":1480.250020980835,"z":"9c9d6788.9ad478","wires":[]},{"id":"c77c96b3.9671d8","type":"record","name":"record","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"DONE: self-serve-vnf-ra-assignment\"/>\n\n","comments":"","outputs":1,"x":398.50000762939453,"y":1430.000020980835,"z":"9c9d6788.9ad478","wires":[[]]},{"id":"3dd11a72.581e76","type":"execute","name":"execute jsonStringToCtx - resolved-data","xml":"<execute plugin=\"org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils\" method=\"jsonStringToCtx\">\n\t<parameter name=\"source\" value=\"`'raAssign.payload.resource-assignment-response.resolved-data.' + $tmp.sdnc-artifact-name`\" />\n\t<parameter name=\"outputPath\" value=\"jsonContextPrefix\" />\n\t<parameter name=\"isEscaped\" value=\"true\" />\n\n","comments":"","outputs":1,"x":510.2500915527344,"y":1232.7500190734863,"z":"9c9d6788.9ad478","wires":[["2788fff6.944b9","13b73d7.3420cc3"]]},{"id":"2788fff6.944b9","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":784.000072479248,"y":1177.7500190734863,"z":"9c9d6788.9ad478","wires":[["16e7a11.046735f"]]},{"id":"13b73d7.3420cc3","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":777.250072479248,"y":1286.250020980835,"z":"9c9d6788.9ad478","wires":[["4b9abfd.ef1ff4"]]},{"id":"4b9abfd.ef1ff4","type":"execute","name":"execute jsonStringToCtx - meshed-template","xml":"<execute plugin=\"org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils\" method=\"jsonStringToCtx\">\n\t<parameter name=\"source\" value=\"`'raAssign.payload.resource-assignment-response.meshed-template.' + $tmp.sdnc-artifact-name`\" />\n\t<parameter name=\"outputPath\" value=\"jsonContextPrefix\" />\n\t<parameter name=\"isEscaped\" value=\"true\" />\n\n","comments":"","outputs":1,"x":1056.5001335144043,"y":1286.5000200271606,"z":"9c9d6788.9ad478","wires":[["8cc2bc38.60658","672e4e41.d3303"]]},{"id":"672e4e41.d3303","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":1345.2501411437988,"y":1324.0000190734863,"z":"9c9d6788.9ad478","wires":[["809d6195.590c7"]]},{"id":"8cc2bc38.60658","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1338.5001373291016,"y":1247.750018119812,"z":"9c9d6788.9ad478","wires":[["ac6070e3.05c52"]]},{"id":"ac6070e3.05c52","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Failed to parse RA respose from mapping or meshed-template\" />\n","comments":"","x":1515.7500495910645,"y":1248,"z":"9c9d6788.9ad478","wires":[]}]