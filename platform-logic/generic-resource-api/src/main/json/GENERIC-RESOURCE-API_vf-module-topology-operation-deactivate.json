[
    {
        "id": "9308e75f.05f858",
        "type": "dgstart",
        "name": "DGSTART",
        "outputs": 1,
        "x": 103.33332824707031,
        "y": 78.33332824707031,
        "z": "66718f17.55d5b",
        "wires": [
            [
                "878f150c.2e48d8"
            ]
        ]
    },
    {
        "id": "878f150c.2e48d8",
        "type": "service-logic",
        "name": "GENERIC-RESOURCE-API ${project.version}",
        "module": "GENERIC-RESOURCE-API",
        "version": "${project.version}",
        "comments": "",
        "xml": "<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>",
        "outputs": 1,
        "x": 178.61903381347656,
        "y": 118.57143974304199,
        "z": "66718f17.55d5b",
        "wires": [
            [
                "a015909f.179d2"
            ]
        ]
    },
    {
        "id": "a015909f.179d2",
        "type": "method",
        "name": "method vf-module-topology-operation-deactivate",
        "xml": "<method rpc='vf-module-topology-operation-deactivate' mode='sync'>\n",
        "comments": "",
        "outputs": 1,
        "x": 228.42862701416016,
        "y": 158.33332443237305,
        "z": "66718f17.55d5b",
        "wires": [
            [
                "c7c25d58.df7b4"
            ]
        ]
    },
    {
        "id": "b22c04d8.425a68",
        "type": "comment",
        "name": "vf-module-topology-operation-deactivate",
        "info": "",
        "comments": "",
        "x": 497.67818450927734,
        "y": 25.9196720123291,
        "z": "66718f17.55d5b",
        "wires": []
    },
    {
        "id": "9077c4fc.db6fb8",
        "type": "switchNode",
        "name": "switch request-action",
        "xml": "<switch test='`$vf-module-topology-operation-input.request-information.request-action`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 506.85713958740234,
        "y": 257.190465927124,
        "z": "66718f17.55d5b",
        "wires": [
            [
                "36986752.8db598",
                "ae847a12.f2ba48"
            ]
        ]
    },
    {
        "id": "36986752.8db598",
        "type": "outcome",
        "name": "DeleteVfModuleInstance",
        "xml": "<outcome value='DeleteVfModuleInstance'>\n",
        "comments": "",
        "outputs": 1,
        "x": 768.9047546386719,
        "y": 234.33335208892822,
        "z": "66718f17.55d5b",
        "wires": [
            [
                "6bfdb413.6dba6c"
            ]
        ]
    },
    {
        "id": "ae847a12.f2ba48",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 712.5713996887207,
        "y": 279.71434116363525,
        "z": "66718f17.55d5b",
        "wires": [
            [
                "840b0e33.1be94"
            ]
        ]
    },
    {
        "id": "6bfdb413.6dba6c",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 958.7619190216064,
        "y": 234.33338356018066,
        "z": "66718f17.55d5b",
        "wires": [
            []
        ]
    },
    {
        "id": "840b0e33.1be94",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"If svc-action is 'deactivate' then request-action must be 'DeleteVfModuleInstance'\" />\n",
        "comments": "",
        "x": 977.5714073181152,
        "y": 280.04765367507935,
        "z": "66718f17.55d5b",
        "wires": []
    },
    {
        "id": "c7c25d58.df7b4",
        "type": "block",
        "name": "block : atomic",
        "xml": "<block atomic=\"true\">",
        "atomic": "true",
        "outputs": 1,
        "x": 126.66666412353516,
        "y": 541.666618347168,
        "z": "66718f17.55d5b",
        "wires": [
            [
                "9077c4fc.db6fb8",
                "bf2aa82.3dc7e58",
                "3439a9d8.ab9236",
                "8fb6cdcf.b16af",
                "cd383d34.c434c",
                "e644f473.82cda8",
                "2f8a8aae.f43eb6",
                "6a53a509.21c6fc",
                "a3c6b6a0.82de08",
                "fcd4522.e4775b",
                "b1395859.6a0108",
                "762c177b.08d768"
            ]
        ]
    },
    {
        "id": "3439a9d8.ab9236",
        "type": "switchNode",
        "name": "switch service-data.vnfs.vnf_length",
        "xml": "<switch test='`$service-data.vnfs.vnf_length`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 553.3333129882812,
        "y": 401.66664123535156,
        "z": "66718f17.55d5b",
        "wires": [
            [
                "6917fb8.2adad04",
                "9afc044d.1d85f8"
            ]
        ]
    },
    {
        "id": "6917fb8.2adad04",
        "type": "other",
        "name": "NULL",
        "xml": "<outcome value=''>\n",
        "comments": "",
        "outputs": 1,
        "x": 794.0475845336914,
        "y": 378.80938148498535,
        "z": "66718f17.55d5b",
        "wires": [
            [
                "683e93db.bf1b8c"
            ]
        ]
    },
    {
        "id": "9afc044d.1d85f8",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 793.8094253540039,
        "y": 419.7618999481201,
        "z": "66718f17.55d5b",
        "wires": [
            [
                "93864c89.1db7a"
            ]
        ]
    },
    {
        "id": "683e93db.bf1b8c",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"There are no VNFs defined in MD-SAL\" />\n",
        "comments": "",
        "x": 960.7141990661621,
        "y": 378.09513664245605,
        "z": "66718f17.55d5b",
        "wires": []
    },
    {
        "id": "93864c89.1db7a",
        "type": "for",
        "name": "for each vnf",
        "xml": "<for index='idx' start='0' end='`$service-data.vnfs.vnf_length`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 956.0475692749023,
        "y": 419.4285182952881,
        "z": "66718f17.55d5b",
        "wires": [
            [
                "816952d1.278e1"
            ]
        ]
    },
    {
        "id": "816952d1.278e1",
        "type": "switchNode",
        "name": "switch service data vnf == input vnf",
        "xml": "<switch test='`$service-data.vnfs.vnf[$idx].vnf-id == $vf-module-topology-operation-input.vnf-information.vnf-id`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1207.380786895752,
        "y": 419.09520530700684,
        "z": "66718f17.55d5b",
        "wires": [
            [
                "4dae753e.0c4bac"
            ]
        ]
    },
    {
        "id": "4dae753e.0c4bac",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1437.3808784484863,
        "y": 418.4285593032837,
        "z": "66718f17.55d5b",
        "wires": [
            [
                "3161b7a1.0cc078"
            ]
        ]
    },
    {
        "id": "bf2aa82.3dc7e58",
        "type": "set",
        "name": "set vnf-index to -1",
        "xml": "<set>\n<parameter name='vnf-index' value='-1' />\n",
        "comments": "",
        "x": 502.3809356689453,
        "y": 333.0951404571533,
        "z": "66718f17.55d5b",
        "wires": []
    },
    {
        "id": "78c0e49e.7d500c",
        "type": "set",
        "name": "set vnf-index to idx",
        "xml": "<set>\n<parameter name='vnf-index' value='`$idx`' />\n",
        "comments": "",
        "x": 1759.0475158691406,
        "y": 389.42851734161377,
        "z": "66718f17.55d5b",
        "wires": []
    },
    {
        "id": "8fb6cdcf.b16af",
        "type": "switchNode",
        "name": "switch vnf-index",
        "xml": "<switch test='`$vnf-index`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 492.38094329833984,
        "y": 469.76183700561523,
        "z": "66718f17.55d5b",
        "wires": [
            [
                "ee9f9bc9.c74618"
            ]
        ]
    },
    {
        "id": "ee9f9bc9.c74618",
        "type": "outcome",
        "name": "-1",
        "xml": "<outcome value='-1'>\n",
        "comments": "",
        "outputs": 1,
        "x": 670.7143287658691,
        "y": 469.09521293640137,
        "z": "66718f17.55d5b",
        "wires": [
            [
                "d0b968e1.02fc78"
            ]
        ]
    },
    {
        "id": "d0b968e1.02fc78",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unable to find VNF ID ' + $vf-module-topology-operation-input.vnf-information.vnf-id + ' in MD-SAL'`\" />\n",
        "comments": "",
        "x": 830.7142372131348,
        "y": 468.42851638793945,
        "z": "66718f17.55d5b",
        "wires": []
    },
    {
        "id": "3161b7a1.0cc078",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 1585.714340209961,
        "y": 417.34825801849365,
        "z": "66718f17.55d5b",
        "wires": [
            [
                "78c0e49e.7d500c",
                "d8a1c30a.67ec2"
            ]
        ]
    },
    {
        "id": "d8a1c30a.67ec2",
        "type": "break",
        "name": "break",
        "xml": "<break>\n",
        "comments": "",
        "x": 1720.7143058776855,
        "y": 439.01484394073486,
        "z": "66718f17.55d5b",
        "wires": []
    },
    {
        "id": "e644f473.82cda8",
        "type": "switchNode",
        "name": "switch service-data...vf-module_length",
        "xml": "<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 566.6666259765625,
        "y": 591.6666660308838,
        "z": "66718f17.55d5b",
        "wires": [
            [
                "dabca98f.b55858",
                "d754c5bd.ecf668"
            ]
        ]
    },
    {
        "id": "dabca98f.b55858",
        "type": "other",
        "name": "NULL",
        "xml": "<outcome value=''>\n",
        "comments": "",
        "outputs": 1,
        "x": 817.3809356689453,
        "y": 570.4760694503784,
        "z": "66718f17.55d5b",
        "wires": [
            [
                "13063c42.536de4"
            ]
        ]
    },
    {
        "id": "d754c5bd.ecf668",
        "type": "other",
        "name": "other",
        "xml": "<outcome value='Other'>\n",
        "comments": "",
        "outputs": 1,
        "x": 817.1427764892578,
        "y": 611.4285879135132,
        "z": "66718f17.55d5b",
        "wires": [
            [
                "601e343c.8c78cc"
            ]
        ]
    },
    {
        "id": "13063c42.536de4",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'There are no VF modules defined in MD-SAL for VNF ' + $vf-module-topology-operation-input.vnf-information.vnf-id`\" />\n",
        "comments": "",
        "x": 984.047550201416,
        "y": 569.7618246078491,
        "z": "66718f17.55d5b",
        "wires": []
    },
    {
        "id": "601e343c.8c78cc",
        "type": "for",
        "name": "for each vf-module",
        "xml": "<for index='idx' start='0' end='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module_length`' >\n",
        "comments": "",
        "outputs": 1,
        "x": 979.3809204101562,
        "y": 611.0952062606812,
        "z": "66718f17.55d5b",
        "wires": [
            [
                "8c46688e.150378"
            ]
        ]
    },
    {
        "id": "8c46688e.150378",
        "type": "switchNode",
        "name": "switch service data vf-module == input vf-module",
        "xml": "<switch test='`$service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$idx].vf-module-id == $vf-module-topology-operation-input.vf-module-information.vf-module-id`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1285.7140808105469,
        "y": 610.76194190979,
        "z": "66718f17.55d5b",
        "wires": [
            [
                "f337ae4d.c9823"
            ]
        ]
    },
    {
        "id": "f337ae4d.c9823",
        "type": "outcomeTrue",
        "name": "true",
        "xml": "<outcome value='true'>\n",
        "comments": "",
        "outputs": 1,
        "x": 1555.7141342163086,
        "y": 608.4285469055176,
        "z": "66718f17.55d5b",
        "wires": [
            [
                "4421d8b3.cc5a98"
            ]
        ]
    },
    {
        "id": "cd383d34.c434c",
        "type": "set",
        "name": "set vf-module-index to -1",
        "xml": "<set>\n<parameter name='vf-module-index' value='-1' />\n",
        "comments": "",
        "x": 522.3809204101562,
        "y": 526.428503036499,
        "z": "66718f17.55d5b",
        "wires": []
    },
    {
        "id": "26c56276.cbbaee",
        "type": "set",
        "name": "set vf-module-index to idx",
        "xml": "<set>\n<parameter name='vf-module-index' value='`$idx`' />\n",
        "comments": "",
        "x": 1885.714225769043,
        "y": 579.4285259246826,
        "z": "66718f17.55d5b",
        "wires": []
    },
    {
        "id": "2f8a8aae.f43eb6",
        "type": "switchNode",
        "name": "switch vf-module-index",
        "xml": "<switch test='`$vf-module-index`'>\n",
        "comments": "",
        "outputs": 1,
        "x": 514.0476036071777,
        "y": 663.0952157974243,
        "z": "66718f17.55d5b",
        "wires": [
            [
                "18ce1819.ff8848"
            ]
        ]
    },
    {
        "id": "18ce1819.ff8848",
        "type": "outcome",
        "name": "-1",
        "xml": "<outcome value='-1'>\n",
        "comments": "",
        "outputs": 1,
        "x": 692.380989074707,
        "y": 662.4285917282104,
        "z": "66718f17.55d5b",
        "wires": [
            [
                "966d8d53.6b6fa"
            ]
        ]
    },
    {
        "id": "966d8d53.6b6fa",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unable to find VF module ID ' + $vf-module-topology-operation-input.vf-module-information.vf-module-id + ' in MD-SAL'`\" />\n",
        "comments": "",
        "x": 852.3808975219727,
        "y": 661.7618951797485,
        "z": "66718f17.55d5b",
        "wires": []
    },
    {
        "id": "4421d8b3.cc5a98",
        "type": "block",
        "name": "block",
        "xml": "<block>\n",
        "atomic": "false",
        "comments": "",
        "outputs": 1,
        "x": 1689.0476760864258,
        "y": 607.3482866287231,
        "z": "66718f17.55d5b",
        "wires": [
            [
                "26c56276.cbbaee",
                "8db1d4c2.4e5f98"
            ]
        ]
    },
    {
        "id": "8db1d4c2.4e5f98",
        "type": "break",
        "name": "break",
        "xml": "<break>\n",
        "comments": "",
        "x": 1824.0476417541504,
        "y": 629.0148725509644,
        "z": "66718f17.55d5b",
        "wires": []
    },
    {
        "id": "6a53a509.21c6fc",
        "type": "set",
        "name": "set order-status to PendingDelete",
        "xml": "<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-level-oper-status.order-status'\n  value='PendingDelete' />\n",
        "comments": "",
        "x": 550.0000305175781,
        "y": 903.3332681655884,
        "z": "66718f17.55d5b",
        "wires": []
    },
    {
        "id": "a3c6b6a0.82de08",
        "type": "set",
        "name": "set vf-module-status to PendingDelete",
        "xml": "<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-topology.vf-module-assignments.vf-module-status' value='PendingDelete' />\n",
        "comments": "",
        "x": 561.3333435058594,
        "y": 725.0000095367432,
        "z": "66718f17.55d5b",
        "wires": []
    },
    {
        "id": "fcd4522.e4775b",
        "type": "save",
        "name": "update vf-module to PendingDelete",
        "xml": "<update plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\"\n   resource=\"vf-module\"\n   key=\"vf-module.vf-module-id = $service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-id\n      AND generic-vnf.vnf-id = $service-data.vnfs.vnf[$vnf-index].vnf-id\"\n   force=\"true\" pfx=\"tmp.AnAI-data\">\n<parameter name=\"orchestration-status\" value=\"PendingDelete\" />\n",
        "comments": "",
        "outputs": 1,
        "x": 551.6667175292969,
        "y": 786.666618347168,
        "z": "66718f17.55d5b",
        "wires": [
            [
                "1e182c2d.f61464",
                "7c1bc2f6.54919c"
            ]
        ]
    },
    {
        "id": "19ff43f6.90e7bc",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'No vf-module found in AAI for vf module ID ' + $service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-id`\" />\n",
        "comments": "",
        "x": 971.6667938232422,
        "y": 811.6666450500488,
        "z": "66718f17.55d5b",
        "wires": []
    },
    {
        "id": "1e182c2d.f61464",
        "type": "failure",
        "name": "failure",
        "xml": "<outcome value='failure'>\n",
        "comments": "",
        "outputs": 1,
        "x": 784.3573608398438,
        "y": 768.6191148757935,
        "z": "66718f17.55d5b",
        "wires": [
            [
                "b0f96d27.7ef2b"
            ]
        ]
    },
    {
        "id": "7c1bc2f6.54919c",
        "type": "not-found",
        "name": "not-found",
        "xml": "<outcome value='not-found'>\n",
        "comments": "",
        "outputs": 1,
        "x": 792.9287910461426,
        "y": 812.9048280715942,
        "z": "66718f17.55d5b",
        "wires": [
            [
                "19ff43f6.90e7bc"
            ]
        ]
    },
    {
        "id": "b0f96d27.7ef2b",
        "type": "returnFailure",
        "name": "return failure",
        "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating vf-module in AAI\" />\n",
        "comments": "",
        "x": 974.3573875427246,
        "y": 768.4288501739502,
        "z": "66718f17.55d5b",
        "wires": []
    },
    {
        "id": "b1395859.6a0108",
        "type": "set",
        "name": "copy input data",
        "xml": "<set>\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.sdnc-request-header.'\n   value='$vf-module-topology-operation-input.sdnc-request-header.' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.request-information.'\n   value='$vf-module-topology-operation-input.request-information.' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.service-information.'\n   value='$vf-module-topology-operation-input.service-information.' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vnf-information.'\n   value='$vf-module-topology-operation-input.vnf-information.' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-information.'\n   value='$vf-module-topology-operation-input.vf-module-information.' />\n<parameter name='service-data.vnfs.vnf[$vnf-index].vnf-data.vf-modules.vf-module[$vf-module-index].vf-module-data.vf-module-request-input.'\n   value='$vf-module-topology-operation-input.vf-module-request-input.' />\n\n",
        "comments": "",
        "x": 489.9999694824219,
        "y": 856.6666259765625,
        "z": "66718f17.55d5b",
        "wires": []
    },
    {
        "id": "762c177b.08d768",
        "type": "returnSuccess",
        "name": "return success",
        "xml": "<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n",
        "comments": "",
        "x": 488.33331298828125,
        "y": 953.3333129882812,
        "z": "66718f17.55d5b",
        "wires": []
    }
]
