[
  {
    "id": "6559b393.6f861c",
    "type": "dgstart",
    "name": "DGSTART",
    "outputs": 1,
    "x": 119.03125,
    "y": 56,
    "z": "5c765a65.b2ea34",
    "wires": [
      [
        "7c1b2fe9.45548"
      ]
    ]
  },
  {
    "id": "7c1b2fe9.45548",
    "type": "service-logic",
    "name": "GENERIC-RESOURCE-API ${project.version}",
    "module": "GENERIC-RESOURCE-API",
    "version": "${project.version}",
    "comments": "",
    "xml": "<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>",
    "outputs": 1,
    "x": 380.03125,
    "y": 127,
    "z": "5c765a65.b2ea34",
    "wires": [
      [
        "aa816cc6.1183d"
      ]
    ]
  },
  {
    "id": "aa816cc6.1183d",
    "type": "method",
    "name": "method dci-connects-network-topology-operation-deactivate",
    "xml": "<method rpc='dci-connects-network-topology-operation-deactivate' mode='sync'>\n",
    "comments": "",
    "outputs": 1,
    "x": 270.03125,
    "y": 212,
    "z": "5c765a65.b2ea34",
    "wires": [
      [
        "eac98b7a.9d5828"
      ]
    ]
  },
  {
    "id": "eac98b7a.9d5828",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 605.0312652587891,
    "y": 212.00000953674316,
    "z": "5c765a65.b2ea34",
    "wires": [
      [
        "477ac034.f205c",
        "f8509dc8.168a7",
        "8e2e032c.881de",
        "68a7916a.a5311",
        "6f360656.1dec58",
        "7aead92.5a32728"
      ]
    ]
  },
  {
    "id": "477ac034.f205c",
    "type": "call",
    "name": "call GENERIC-RESOURCE-API:validate-network-input-parameters",
    "xml": "<call module='GENERIC-RESOURCE-API' rpc='validate-network-input-parameters' mode='sync' >\n",
    "comments": "",
    "outputs": 1,
    "x": 930.0313568115234,
    "y": 52.00000190734863,
    "z": "5c765a65.b2ea34",
    "wires": [
      []
    ]
  },
  {
    "id": "f8509dc8.168a7",
    "type": "returnSuccess",
    "name": "return success",
    "xml": "<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n",
    "comments": "",
    "x": 814.03125,
    "y": 974,
    "z": "5c765a65.b2ea34",
    "wires": []
  },
  {
    "id": "c12d1dde.f4e3",
    "type": "block",
    "name": "block : sendRequest",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "comments": "",
    "outputs": 1,
    "x": 1001.5312805175781,
    "y": 555.5156650543213,
    "z": "5c765a65.b2ea34",
    "wires": [
      [
        "4ec4fd77.ad10f4",
        "aa980a06.38e9b8",
        "e11c9638.70d6a8",
        "376cb70c.ff4a7"
      ]
    ]
  },
  {
    "id": "5870b6d9.9c5e38",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1534.031177520752,
    "y": 352.51519107818604,
    "z": "5c765a65.b2ea34",
    "wires": [
      [
        "25c20f00.fa6cf"
      ]
    ]
  },
  {
    "id": "39a6df4a.252ba",
    "type": "not-found",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1541.031177520752,
    "y": 390.51519107818604,
    "z": "5c765a65.b2ea34",
    "wires": [
      [
        "3e95b312.6100ac"
      ]
    ]
  },
  {
    "id": "f0e345da.109628",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1533.031177520752,
    "y": 432.51519107818604,
    "z": "5c765a65.b2ea34",
    "wires": [
      [
        "3f665015.a6a47"
      ]
    ]
  },
  {
    "id": "3e95b312.6100ac",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
    "comments": "",
    "x": 1698.031177520752,
    "y": 394.51519107818604,
    "z": "5c765a65.b2ea34",
    "wires": []
  },
  {
    "id": "3f665015.a6a47",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
    "comments": "",
    "x": 1691.031177520752,
    "y": 441.51519107818604,
    "z": "5c765a65.b2ea34",
    "wires": []
  },
  {
    "id": "e11c9638.70d6a8",
    "type": "get-resource",
    "name": "get-resource esr-thirdparty-sdnc",
    "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"esr-thirdparty-sdnc\" \n\t\tkey=\"esr-thirdparty-sdnc.thirdparty-sdnc-id = $prop.dci-connects.id AND \n\t\t     depth = '1'\"\n        pfx='tmp.aai.esr-thirdparty-sdnc' local-only='false' >\n",
    "comments": "",
    "outputs": 1,
    "x": 1310.031265258789,
    "y": 399.51519799232483,
    "z": "5c765a65.b2ea34",
    "wires": [
      [
        "5870b6d9.9c5e38",
        "39a6df4a.252ba",
        "f0e345da.109628"
      ]
    ]
  },
  {
    "id": "25c20f00.fa6cf",
    "type": "set",
    "name": "set controller data",
    "xml": "<set>\n<parameter name='prop.sdncRestApi.thirdpartySdnc.url' value=\"`$tmp.aai.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].service-url`\" />\n<parameter name='prop.sdncRestApi.templateDir' value='/opt/onap/sdnc/data' />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.user' value=\"`$tmp.aai.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].user-name`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.password' value=\"`$tmp.aai.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].password`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.vendor' value=\"`$tmp.aai.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].vendor`\" />\n\n",
    "comments": "",
    "x": 1713.5311279296875,
    "y": 345.01513671875,
    "z": "5c765a65.b2ea34",
    "wires": []
  },
  {
    "id": "4ae70608.d9f108",
    "type": "execute",
    "name": "execute RestApiCallNode De-Activate Vxlan Tunnel",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/v2.0/l3-dci-connects/' + $prop.dci-connects.id`\"/>\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\"/>\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\"/>\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"delete\"/>\n<parameter name=\"responsePrefix\" value=\"restapi-result\"/>\n<parameter name='customHttpHeaders' value=\"`'X-ACCESS-TOKEN=' + $prop.sdncRestApi.token_id`\" />\n",
    "comments": "",
    "outputs": 1,
    "x": 2109.531539916992,
    "y": 549.5156259536743,
    "z": "5c765a65.b2ea34",
    "wires": [
      []
    ]
  },
  {
    "id": "cb70d9c8.c98578",
    "type": "switchNode",
    "name": "switch tunnelType",
    "xml": "<switch test=\"`$prop.dci-connects.tunnelType`\">\n",
    "comments": "",
    "outputs": 1,
    "x": 1572.5309982299805,
    "y": 574.01513671875,
    "z": "5c765a65.b2ea34",
    "wires": [
      [
        "cd693888.f47b98",
        "41c50c84.a9e5b4"
      ]
    ]
  },
  {
    "id": "cd693888.f47b98",
    "type": "outcomeTrue",
    "name": "L3-DCI",
    "xml": "<outcome value='L3-DCI'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1785.5311279296875,
    "y": 554.01513671875,
    "z": "5c765a65.b2ea34",
    "wires": [
      [
        "4ae70608.d9f108"
      ]
    ]
  },
  {
    "id": "41c50c84.a9e5b4",
    "type": "outcomeTrue",
    "name": "L2-DCI",
    "xml": "<outcome value='L2-DCI'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1783.530948638916,
    "y": 626.01513671875,
    "z": "5c765a65.b2ea34",
    "wires": [
      [
        "c9cdc266.ba884"
      ]
    ]
  },
  {
    "id": "c9cdc266.ba884",
    "type": "execute",
    "name": "execute RestApiCallNode De-Activate Vxlan Tunnel",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/v2.0/l2-dci-connects/' + $prop.dci-connects.id`\"/>\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\"/>\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\"/>\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"delete\"/>\n<parameter name=\"responsePrefix\" value=\"restapi-result\"/>\n<parameter name='customHttpHeaders' value=\"`'X-ACCESS-TOKEN=' + $prop.sdncRestApi.token_id`\" />",
    "comments": "",
    "outputs": 1,
    "x": 2103.531494140625,
    "y": 626.5155620574951,
    "z": "5c765a65.b2ea34",
    "wires": [
      []
    ]
  },
  {
    "id": "56ea174e.66fdc8",
    "type": "for",
    "name": "for each network-input-parameters",
    "xml": "<for index='idx' start='0' end='`$service-data.networks.network[$tmp.nidx].network-data.network-request-input.network-input-parameters.param_length`' >\n\n",
    "comments": "",
    "outputs": 1,
    "x": 1064.031234741211,
    "y": 156.51563167572021,
    "z": "5c765a65.b2ea34",
    "wires": [
      [
        "d467ada9.bc47a"
      ]
    ]
  },
  {
    "id": "4ec4fd77.ad10f4",
    "type": "record",
    "name": "record",
    "xml": "<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"dci-network-topology-operation-deactivate\"/>\n<parameter name=\"field3\" value=\"dci-connects.id\" />\n<parameter name=\"field4\" value=\"`$prop.dci-connects.id`\"/>\n<parameter name=\"field5\" value=\"dci-connects.tunnelType\" />\n<parameter name=\"field6\" value=\"`$prop.dci-connects.tunnelType`\"/>\n<parameter name=\"field7\" value=\"dci-connects.tunnelType\" />\n<parameter name=\"field8\" value=\"`$prop.dci-connects.tunnelType`\"/>\n<parameter name=\"field9\" value=\"sdncRestApi.thirdpartySdnc.url\"/>\n<parameter name=\"field10\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url`\"/>",
    "comments": "",
    "outputs": 1,
    "x": 1247.3646240234375,
    "y": 508,
    "z": "5c765a65.b2ea34",
    "wires": [
      []
    ]
  },
  {
    "id": "d467ada9.bc47a",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1297.3646774291992,
    "y": 156.00000762939453,
    "z": "5c765a65.b2ea34",
    "wires": [
      [
        "dfb8e94f.3061f8",
        "6ee22c97.f3fe94"
      ]
    ]
  },
  {
    "id": "dfb8e94f.3061f8",
    "type": "switchNode",
    "name": "switch site1_id",
    "xml": "<switch test=\"`$service-data.networks.network[$tmp.nidx].network-data.network-request-input.network-input-parameters.param[$idx].name == 'site1_id'`\">\n",
    "comments": "",
    "outputs": 1,
    "x": 1503.6978874206543,
    "y": 125.00000381469727,
    "z": "5c765a65.b2ea34",
    "wires": [
      [
        "424ca41d.d8b57c"
      ]
    ]
  },
  {
    "id": "424ca41d.d8b57c",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1704.697982788086,
    "y": 124.00000286102295,
    "z": "5c765a65.b2ea34",
    "wires": [
      [
        "3b8b7bc.f6de684"
      ]
    ]
  },
  {
    "id": "3b8b7bc.f6de684",
    "type": "set",
    "name": "set id",
    "xml": "<set>\n<parameter name='prop.dci-connects.id' value='`$service-data.networks.network[$tmp.nidx].network-data.network-request-input.network-input-parameters.param[$idx].value`' />\n",
    "comments": "",
    "x": 1878.3643341064453,
    "y": 123.66654777526855,
    "z": "5c765a65.b2ea34",
    "wires": []
  },
  {
    "id": "6ee22c97.f3fe94",
    "type": "switchNode",
    "name": "switch tunnelType",
    "xml": "<switch test=\"`$service-data.networks.network[$tmp.nidx].network-data.network-request-input.network-input-parameters.param[$idx].name == 'tunnelType'`\">\n",
    "comments": "",
    "outputs": 1,
    "x": 1513.6979675292969,
    "y": 178.00000977516174,
    "z": "5c765a65.b2ea34",
    "wires": [
      [
        "b8f51f64.5384d"
      ]
    ]
  },
  {
    "id": "b8f51f64.5384d",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1719.6979675292969,
    "y": 178.00000977516174,
    "z": "5c765a65.b2ea34",
    "wires": [
      [
        "a2c0d127.d5692"
      ]
    ]
  },
  {
    "id": "a2c0d127.d5692",
    "type": "set",
    "name": "set tunnelType",
    "xml": "<set>\n<parameter name='prop.dci-connects.tunnelType' value='`$service-data.networks.network[$tmp.nidx].network-data.network-request-input.network-input-parameters.param[$idx].value`' />\n",
    "comments": "",
    "x": 1888.6980667114258,
    "y": 178.0000250339508,
    "z": "5c765a65.b2ea34",
    "wires": []
  },
  {
    "id": "8e2e032c.881de",
    "type": "block",
    "name": "block : executeSite1",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "comments": "",
    "outputs": 1,
    "x": 793.3645858764648,
    "y": 157.66666412353516,
    "z": "5c765a65.b2ea34",
    "wires": [
      [
        "56ea174e.66fdc8",
        "c12d1dde.f4e3"
      ]
    ]
  },
  {
    "id": "c8ad7c0c.e274a",
    "type": "for",
    "name": "for each network-input-parameters",
    "xml": "<for index='idx' start='0' end='`$service-data.networks.network[$tmp.nidx].network-data.network-request-input.network-input-parameters.param_length`' >\n\n",
    "comments": "",
    "outputs": 1,
    "x": 1069.0313186645508,
    "y": 262.66663551330566,
    "z": "5c765a65.b2ea34",
    "wires": [
      [
        "323207f2.263c18"
      ]
    ]
  },
  {
    "id": "323207f2.263c18",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1297.3646850585938,
    "y": 265.15101146698,
    "z": "5c765a65.b2ea34",
    "wires": [
      [
        "3c001f99.e738d"
      ]
    ]
  },
  {
    "id": "3c001f99.e738d",
    "type": "switchNode",
    "name": "switch site2_id",
    "xml": "<switch test=\"`$service-data.networks.network[$tmp.nidx].network-data.network-request-input.network-input-parameters.param[$idx].name == 'site2_id'`\">\n",
    "comments": "",
    "outputs": 1,
    "x": 1498.3646354675293,
    "y": 265.15099716186523,
    "z": "5c765a65.b2ea34",
    "wires": [
      [
        "69a68f4d.5d472"
      ]
    ]
  },
  {
    "id": "69a68f4d.5d472",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1699.364730834961,
    "y": 264.1509962081909,
    "z": "5c765a65.b2ea34",
    "wires": [
      [
        "2194fc1d.e7f094"
      ]
    ]
  },
  {
    "id": "2194fc1d.e7f094",
    "type": "set",
    "name": "set id",
    "xml": "<set>\n<parameter name='prop.dci-connects.id' value='`$service-data.networks.network[$tmp.nidx].network-data.network-request-input.network-input-parameters.param[$idx].value`' />\n",
    "comments": "",
    "x": 1873.0310821533203,
    "y": 263.8175411224365,
    "z": "5c765a65.b2ea34",
    "wires": []
  },
  {
    "id": "68a7916a.a5311",
    "type": "block",
    "name": "block : executeSite1",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "comments": "",
    "outputs": 1,
    "x": 793.3645935058594,
    "y": 266.8176679611206,
    "z": "5c765a65.b2ea34",
    "wires": [
      [
        "c8ad7c0c.e274a",
        "c12d1dde.f4e3"
      ]
    ]
  },
  {
    "id": "c71a68d.91d3a98",
    "type": "set",
    "name": "set object-path",
    "xml": "<set>\n<parameter name='network-object-path' value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $network-topology-operation-input.service-information.service-instance-id\n + '/service-data/networks/network/'\n + $networkId\n + '/network-data/network-topology/'` \" />\n \n",
    "comments": "",
    "x": 1108.3685760498047,
    "y": 787.8607425689697,
    "z": "5c765a65.b2ea34",
    "wires": []
  },
  {
    "id": "8529d043.0aea5",
    "type": "set",
    "name": "set networkId",
    "xml": "<set>\n<parameter name='networkId' value='`$network-topology-operation-input.network-information.network-id`' />\n",
    "comments": "",
    "x": 1102.654209136963,
    "y": 750.7178506851196,
    "z": "5c765a65.b2ea34",
    "wires": []
  },
  {
    "id": "6f360656.1dec58",
    "type": "block",
    "name": "block : saveNetworkData",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "comments": "",
    "outputs": 1,
    "x": 845.3646469116211,
    "y": 726.6666917800903,
    "z": "5c765a65.b2ea34",
    "wires": [
      [
        "8529d043.0aea5",
        "c71a68d.91d3a98",
        "b1e695ce.6afdf8",
        "7c7891ee.131d7"
      ]
    ]
  },
  {
    "id": "3da3119d.a99f0e",
    "type": "comment",
    "name": "TODO",
    "info": "Currently deactivate does deletion too, later divide in two phases.",
    "comments": "",
    "x": 727.3645858764648,
    "y": 20,
    "z": "5c765a65.b2ea34",
    "wires": []
  },
  {
    "id": "b1e695ce.6afdf8",
    "type": "set",
    "name": "copy input to service-data",
    "xml": "<set>\n<parameter name='service-data.networks.network[$tmp.nidx].network-data.sdnc-request-header.' value='`$network-topology-operation-input.sdnc-request-header.`' />\n<parameter name='service-data.networks.network[$tmp.nidx].network-data.request-information.' value='`$network-topology-operation-input.request-information.`' />\n",
    "comments": "",
    "x": 1138.3646545410156,
    "y": 707.0000038146973,
    "z": "5c765a65.b2ea34",
    "wires": []
  },
  {
    "id": "7c7891ee.131d7",
    "type": "set",
    "name": "set network-level-oper-status",
    "xml": "<set>\n<parameter name='service-data.networks.network[$tmp.nidx].network-data.network-level-oper-status.order-status' value='Deleted' />\n<parameter name='service-data.networks.network[$tmp.nidx].network-data.network-level-oper-status.last-rpc-action' value='`$network-topology-operation-input.sdnc-request-header.svc-action`' />\n<parameter name='service-data.networks.network[$tmp.nidx].network-data.network-level-oper-status.last-action' value='`$network-topology-operation-input.request-information.request-action`' />\n",
    "comments": "",
    "x": 1152.3645858764648,
    "y": 834.9999618530273,
    "z": "5c765a65.b2ea34",
    "wires": []
  },
  {
    "id": "7aead92.5a32728",
    "type": "delete",
    "name": "delete underlay configuration in AAI",
    "xml": "<delete plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" resource='configuration' \n        key='configuration.configuration-id = $network-topology-operation-input.network-information.network-id'>\n",
    "comments": "",
    "outputs": 1,
    "x": 882.03125,
    "y": 894,
    "z": "5c765a65.b2ea34",
    "wires": [
      []
    ]
  },
  {
    "id": "aa980a06.38e9b8",
    "type": "execute",
    "name": "execute Properties",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.prop.PropertiesNode' method='readProperties' >\n    <parameter name='fileName' value='%SDNC_CONFIG_DIR%/generic-resource-api-dg.properties' />\n    <parameter name='contextPrefix' value='prop' />\n",
    "comments": "",
    "outputs": 1,
    "x": 1282.03125,
    "y": 456,
    "z": "5c765a65.b2ea34",
    "wires": [
      []
    ]
  },
  {
    "id": "376cb70c.ff4a7",
    "type": "switchNode",
    "name": "switch vendor",
    "xml": "<switch test=\"`$prop.sdncRestApi.thirdpartySdnc.vendor`\">\n",
    "comments": "",
    "outputs": 1,
    "x": 1239,
    "y": 576,
    "z": "5c765a65.b2ea34",
    "wires": [
      [
        "26c37886.1a934"
      ]
    ]
  },
  {
    "id": "26c37886.1a934",
    "type": "outcomeTrue",
    "name": "SPTN",
    "xml": "<outcome value='SPTN'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1393,
    "y": 578,
    "z": "5c765a65.b2ea34",
    "wires": [
      [
        "cb70d9c8.c98578"
      ]
    ]
  }
]
