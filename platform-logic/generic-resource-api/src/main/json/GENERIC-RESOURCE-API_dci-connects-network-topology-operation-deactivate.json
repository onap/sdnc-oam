[
  {
    "id": "e6595ced.cd07e",
    "type": "dgstart",
    "name": "DGSTART",
    "outputs": 1,
    "x": 93,
    "y": 105,
    "z": "88fdd57.10ebea8",
    "wires": [
      [
        "6a3b8941.159818"
      ]
    ]
  },
  {
    "id": "6a3b8941.159818",
    "type": "service-logic",
    "name": "GENERIC-RESOURCE-API ${project.version}",
    "module": "GENERIC-RESOURCE-API",
    "version": "${project.version}",
    "comments": "",
    "xml": "<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>",
    "outputs": 1,
    "x": 354,
    "y": 176,
    "z": "88fdd57.10ebea8",
    "wires": [
      [
        "3be859ad.2be5b6"
      ]
    ]
  },
  {
    "id": "3be859ad.2be5b6",
    "type": "method",
    "name": "method dci-connects-network-topology-operation-deactivate",
    "xml": "<method rpc='dci-connects-network-topology-operation-deactivate' mode='sync'>\n",
    "comments": "",
    "outputs": 1,
    "x": 244,
    "y": 261,
    "z": "88fdd57.10ebea8",
    "wires": [
      [
        "33572f89.f401b"
      ]
    ]
  },
  {
    "id": "33572f89.f401b",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 579.0000152587891,
    "y": 261.00000953674316,
    "z": "88fdd57.10ebea8",
    "wires": [
      [
        "d0a86103.e51848",
        "74647967.d19da8",
        "87f2c3a5.8dd168",
        "d8b9200b.bee808",
        "827daee9.fd9758",
        "1f2fa549.76dec3"
      ]
    ]
  },
  {
    "id": "d0a86103.e51848",
    "type": "call",
    "name": "call GENERIC-RESOURCE-API:validate-network-input-parameters",
    "xml": "<call module='GENERIC-RESOURCE-API' rpc='validate-network-input-parameters' mode='sync' >\n",
    "comments": "",
    "outputs": 1,
    "x": 914,
    "y": 130,
    "z": "88fdd57.10ebea8",
    "wires": [
      []
    ]
  },
  {
    "id": "74647967.d19da8",
    "type": "returnSuccess",
    "name": "return success",
    "xml": "<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n",
    "comments": "",
    "x": 788,
    "y": 1023,
    "z": "88fdd57.10ebea8",
    "wires": []
  },
  {
    "id": "38788fe5.0d87a",
    "type": "block",
    "name": "block : sendRequest",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "comments": "",
    "outputs": 1,
    "x": 975.5000305175781,
    "y": 604.5156650543213,
    "z": "88fdd57.10ebea8",
    "wires": [
      [
        "351a36d5.bb2aba",
        "a84bd383.c98848",
        "d1ee1ccb.6ac1e"
      ]
    ]
  },
  {
    "id": "fff41978.9f33",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1507.999927520752,
    "y": 401.51519107818604,
    "z": "88fdd57.10ebea8",
    "wires": [
      [
        "8722da7b.5697a8"
      ]
    ]
  },
  {
    "id": "d6d9b577.1d5bf8",
    "type": "not-found",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1514.999927520752,
    "y": 439.51519107818604,
    "z": "88fdd57.10ebea8",
    "wires": [
      [
        "cdd52bd7.c7dbb8"
      ]
    ]
  },
  {
    "id": "2bb0e607.cf37aa",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1506.999927520752,
    "y": 481.51519107818604,
    "z": "88fdd57.10ebea8",
    "wires": [
      [
        "db4903d.eb23f8"
      ]
    ]
  },
  {
    "id": "cdd52bd7.c7dbb8",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
    "comments": "",
    "x": 1671.999927520752,
    "y": 443.51519107818604,
    "z": "88fdd57.10ebea8",
    "wires": []
  },
  {
    "id": "db4903d.eb23f8",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n",
    "comments": "",
    "x": 1664.999927520752,
    "y": 490.51519107818604,
    "z": "88fdd57.10ebea8",
    "wires": []
  },
  {
    "id": "351a36d5.bb2aba",
    "type": "get-resource",
    "name": "get-resource esr-thirdparty-sdnc",
    "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"esr-thirdparty-sdnc\" \n\t\tkey=\"esr-thirdparty-sdnc.thirdparty-sdnc-id = $prop.dci-connects.id AND \n\t\t     depth = '1'\"\n        pfx='tmp.aai.esr-thirdparty-sdnc' local-only='false' >\n",
    "comments": "",
    "outputs": 1,
    "x": 1284.000015258789,
    "y": 448.51519799232483,
    "z": "88fdd57.10ebea8",
    "wires": [
      [
        "fff41978.9f33",
        "d6d9b577.1d5bf8",
        "2bb0e607.cf37aa"
      ]
    ]
  },
  {
    "id": "8722da7b.5697a8",
    "type": "set",
    "name": "set controller data",
    "xml": "<set>\n<parameter name='prop.sdncRestApi.thirdpartySdnc.url' value=\"`$tmp.aai.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].service-url`\" />\n<parameter name='prop.sdncRestApi.templateDir' value='/opt/onap/sdnc/data' />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.user' value=\"`$tmp.aai.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].user-name`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.password' value=\"`$tmp.aai.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].password`\" />\n\n",
    "comments": "",
    "x": 1687.4998779296875,
    "y": 394.01513671875,
    "z": "88fdd57.10ebea8",
    "wires": []
  },
  {
    "id": "ecb96ba3.5758d",
    "type": "execute",
    "name": "execute RestApiCallNode De-Activate Vxlan Tunnel",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/v2.0/l3-dci-connects/' + $prop.dci-connects.id`\"/>\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\"/>\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\"/>\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"delete\"/>\n<parameter name=\"responsePrefix\" value=\"restapi-result\"/>\n",
    "comments": "",
    "outputs": 1,
    "x": 1783.5003051757812,
    "y": 667.5156202316284,
    "z": "88fdd57.10ebea8",
    "wires": [
      []
    ]
  },
  {
    "id": "a84bd383.c98848",
    "type": "switchNode",
    "name": "switch tunnelType",
    "xml": "<switch test=\"`$prop.dci-connects.tunnelType`\">\n",
    "comments": "",
    "outputs": 1,
    "x": 1246.4997634887695,
    "y": 692.0151309967041,
    "z": "88fdd57.10ebea8",
    "wires": [
      [
        "1b404d3f.38e2eb",
        "dcb57b7d.8ec64"
      ]
    ]
  },
  {
    "id": "1b404d3f.38e2eb",
    "type": "outcomeTrue",
    "name": "L3-DCI",
    "xml": "<outcome value='L3-DCI'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1459.4998931884766,
    "y": 672.0151309967041,
    "z": "88fdd57.10ebea8",
    "wires": [
      [
        "ecb96ba3.5758d"
      ]
    ]
  },
  {
    "id": "dcb57b7d.8ec64",
    "type": "outcomeTrue",
    "name": "L2-DCI",
    "xml": "<outcome value='L2-DCI'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1457.499713897705,
    "y": 744.0151309967041,
    "z": "88fdd57.10ebea8",
    "wires": [
      [
        "62327707.f218a"
      ]
    ]
  },
  {
    "id": "62327707.f218a",
    "type": "execute",
    "name": "execute RestApiCallNode De-Activate Vxlan Tunnel",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/v2.0/l2-dci-connects/' + $prop.dci-connects.id`\"/>\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\"/>\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\"/>\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"delete\"/>\n<parameter name=\"responsePrefix\" value=\"restapi-result\"/>",
    "comments": "",
    "outputs": 1,
    "x": 1777.500259399414,
    "y": 744.5155563354492,
    "z": "88fdd57.10ebea8",
    "wires": [
      []
    ]
  },
  {
    "id": "4860ee5f.f2017",
    "type": "for",
    "name": "for each network-input-parameters",
    "xml": "<for index='idx' start='0' end='`$service-data.networks.network[$tmp.nidx].network-data.network-request-input.network-input-parameters.param_length`' >\n\n",
    "comments": "",
    "outputs": 1,
    "x": 1037.999984741211,
    "y": 205.51563167572021,
    "z": "88fdd57.10ebea8",
    "wires": [
      [
        "ba7fcf57.78acb"
      ]
    ]
  },
  {
    "id": "d1ee1ccb.6ac1e",
    "type": "record",
    "name": "record",
    "xml": "<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"field1\" value=\"__TIMESTAMP__\"/>\n<parameter name=\"field2\" value=\"dci-network-topology-operation-deactivate\"/>\n<parameter name=\"field3\" value=\"dci-connects.id\" />\n<parameter name=\"field4\" value=\"`$prop.dci-connects.id`\"/>\n<parameter name=\"field5\" value=\"dci-connects.tunnelType\" />\n<parameter name=\"field6\" value=\"`$prop.dci-connects.tunnelType`\"/>\n<parameter name=\"field7\" value=\"dci-connects.tunnelType\" />\n<parameter name=\"field8\" value=\"`$prop.dci-connects.tunnelType`\"/>\n<parameter name=\"field9\" value=\"sdncRestApi.thirdpartySdnc.url\"/>\n<parameter name=\"field10\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url`\"/>",
    "comments": "",
    "outputs": 1,
    "x": 1220.333366394043,
    "y": 624,
    "z": "88fdd57.10ebea8",
    "wires": [
      []
    ]
  },
  {
    "id": "ba7fcf57.78acb",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1271.3334274291992,
    "y": 205.00000762939453,
    "z": "88fdd57.10ebea8",
    "wires": [
      [
        "121de4fa.dd7713",
        "e7af85ba.d512e"
      ]
    ]
  },
  {
    "id": "121de4fa.dd7713",
    "type": "switchNode",
    "name": "switch site1_id",
    "xml": "<switch test=\"`$service-data.networks.network[$tmp.nidx].network-data.network-request-input.network-input-parameters.param[$idx].name == 'site1_id'`\">\n",
    "comments": "",
    "outputs": 1,
    "x": 1477.6666374206543,
    "y": 174.00000381469727,
    "z": "88fdd57.10ebea8",
    "wires": [
      [
        "b3100ed.49466f"
      ]
    ]
  },
  {
    "id": "b3100ed.49466f",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1678.666732788086,
    "y": 173.00000286102295,
    "z": "88fdd57.10ebea8",
    "wires": [
      [
        "7769aa51.22fb2c"
      ]
    ]
  },
  {
    "id": "7769aa51.22fb2c",
    "type": "set",
    "name": "set id",
    "xml": "<set>\n<parameter name='prop.dci-connects.id' value='`$service-data.networks.network[$tmp.nidx].network-data.network-request-input.network-input-parameters.param[$idx].value`' />\n",
    "comments": "",
    "x": 1852.3330841064453,
    "y": 172.66654777526855,
    "z": "88fdd57.10ebea8",
    "wires": []
  },
  {
    "id": "e7af85ba.d512e",
    "type": "switchNode",
    "name": "switch tunnelType",
    "xml": "<switch test=\"`$service-data.networks.network[$tmp.nidx].network-data.network-request-input.network-input-parameters.param[$idx].name == 'tunnelType'`\">\n",
    "comments": "",
    "outputs": 1,
    "x": 1487.6667175292969,
    "y": 227.00000977516174,
    "z": "88fdd57.10ebea8",
    "wires": [
      [
        "98ab781f.4131f8"
      ]
    ]
  },
  {
    "id": "98ab781f.4131f8",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1693.6667175292969,
    "y": 227.00000977516174,
    "z": "88fdd57.10ebea8",
    "wires": [
      [
        "ffcfe73.d016818"
      ]
    ]
  },
  {
    "id": "ffcfe73.d016818",
    "type": "set",
    "name": "set tunnelType",
    "xml": "<set>\n<parameter name='prop.dci-connects.tunnelType' value='`$service-data.networks.network[$tmp.nidx].network-data.network-request-input.network-input-parameters.param[$idx].value`' />\n",
    "comments": "",
    "x": 1862.6668167114258,
    "y": 227.0000250339508,
    "z": "88fdd57.10ebea8",
    "wires": []
  },
  {
    "id": "87f2c3a5.8dd168",
    "type": "block",
    "name": "block : executeSite1",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "comments": "",
    "outputs": 1,
    "x": 767.3333358764648,
    "y": 206.66666412353516,
    "z": "88fdd57.10ebea8",
    "wires": [
      [
        "4860ee5f.f2017",
        "38788fe5.0d87a"
      ]
    ]
  },
  {
    "id": "2ffdab13.6ed684",
    "type": "for",
    "name": "for each network-input-parameters",
    "xml": "<for index='idx' start='0' end='`$service-data.networks.network[$tmp.nidx].network-data.network-request-input.network-input-parameters.param_length`' >\n\n",
    "comments": "",
    "outputs": 1,
    "x": 1043.0000686645508,
    "y": 311.66663551330566,
    "z": "88fdd57.10ebea8",
    "wires": [
      [
        "b45df97f.e41dd"
      ]
    ]
  },
  {
    "id": "b45df97f.e41dd",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1271.3334350585938,
    "y": 314.15101146698,
    "z": "88fdd57.10ebea8",
    "wires": [
      [
        "4ec4a4e9.835374"
      ]
    ]
  },
  {
    "id": "4ec4a4e9.835374",
    "type": "switchNode",
    "name": "switch site2_id",
    "xml": "<switch test=\"`$service-data.networks.network[$tmp.nidx].network-data.network-request-input.network-input-parameters.param[$idx].name == 'site2_id'`\">\n",
    "comments": "",
    "outputs": 1,
    "x": 1472.3333854675293,
    "y": 314.15099716186523,
    "z": "88fdd57.10ebea8",
    "wires": [
      [
        "583f59bb.0661c"
      ]
    ]
  },
  {
    "id": "583f59bb.0661c",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1673.333480834961,
    "y": 313.1509962081909,
    "z": "88fdd57.10ebea8",
    "wires": [
      [
        "5598a85d.318a8"
      ]
    ]
  },
  {
    "id": "5598a85d.318a8",
    "type": "set",
    "name": "set id",
    "xml": "<set>\n<parameter name='prop.dci-connects.id' value='`$service-data.networks.network[$tmp.nidx].network-data.network-request-input.network-input-parameters.param[$idx].value`' />\n",
    "comments": "",
    "x": 1846.9998321533203,
    "y": 312.8175411224365,
    "z": "88fdd57.10ebea8",
    "wires": []
  },
  {
    "id": "d8b9200b.bee808",
    "type": "block",
    "name": "block : executeSite1",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "comments": "",
    "outputs": 1,
    "x": 767.3333435058594,
    "y": 315.8176679611206,
    "z": "88fdd57.10ebea8",
    "wires": [
      [
        "2ffdab13.6ed684",
        "38788fe5.0d87a"
      ]
    ]
  },
  {
    "id": "c84ccddc.555998",
    "type": "set",
    "name": "set object-path",
    "xml": "<set>\n<parameter name='network-object-path' value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $network-topology-operation-input.service-information.service-instance-id\n + '/service-data/networks/network/'\n + $networkId\n + '/network-data/network-topology/'` \" />\n \n",
    "comments": "",
    "x": 1082.3373260498047,
    "y": 836.8607425689697,
    "z": "88fdd57.10ebea8",
    "wires": []
  },
  {
    "id": "ef0a295c.2add48",
    "type": "set",
    "name": "set networkId",
    "xml": "<set>\n<parameter name='networkId' value='`$network-topology-operation-input.network-information.network-id`' />\n",
    "comments": "",
    "x": 1076.622959136963,
    "y": 799.7178506851196,
    "z": "88fdd57.10ebea8",
    "wires": []
  },
  {
    "id": "827daee9.fd9758",
    "type": "block",
    "name": "block : saveNetworkData",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "comments": "",
    "outputs": 1,
    "x": 819.3333969116211,
    "y": 775.6666917800903,
    "z": "88fdd57.10ebea8",
    "wires": [
      [
        "ef0a295c.2add48",
        "c84ccddc.555998",
        "11e0aee9.730f31",
        "6f6203a9.3e25c4"
      ]
    ]
  },
  {
    "id": "e74b5285.3bfcc8",
    "type": "comment",
    "name": "TODO",
    "info": "Currently deactivate does deletion too, later divide in two phases.",
    "comments": "",
    "x": 701.3333358764648,
    "y": 69,
    "z": "88fdd57.10ebea8",
    "wires": []
  },
  {
    "id": "11e0aee9.730f31",
    "type": "set",
    "name": "copy input to service-data",
    "xml": "<set>\n<parameter name='service-data.networks.network[$tmp.nidx].network-data.sdnc-request-header.' value='`$network-topology-operation-input.sdnc-request-header.`' />\n<parameter name='service-data.networks.network[$tmp.nidx].network-data.request-information.' value='`$network-topology-operation-input.request-information.`' />\n",
    "comments": "",
    "x": 1112.3334045410156,
    "y": 756.0000038146973,
    "z": "88fdd57.10ebea8",
    "wires": []
  },
  {
    "id": "6f6203a9.3e25c4",
    "type": "set",
    "name": "set network-level-oper-status",
    "xml": "<set>\n<parameter name='service-data.networks.network[$tmp.nidx].network-data.network-level-oper-status.order-status' value='Deleted' />\n<parameter name='service-data.networks.network[$tmp.nidx].network-data.network-level-oper-status.last-rpc-action' value='`$network-topology-operation-input.sdnc-request-header.svc-action`' />\n<parameter name='service-data.networks.network[$tmp.nidx].network-data.network-level-oper-status.last-action' value='`$network-topology-operation-input.request-information.request-action`' />\n",
    "comments": "",
    "x": 1126.3333358764648,
    "y": 883.9999618530273,
    "z": "88fdd57.10ebea8",
    "wires": []
  },
  {
    "id": "1f2fa549.76dec3",
    "type": "delete",
    "name": "delete underlay configuration in AAI",
    "xml": "<delete plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" resource='configuration' \n        key='configuration.configuration-id = $network-topology-operation-input.network-information.network-id'>\n",
    "comments": "",
    "outputs": 1,
    "x": 856,
    "y": 943,
    "z": "88fdd57.10ebea8",
    "wires": [
      []
    ]
  }
]
