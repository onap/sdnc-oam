[
  {
    "id": "4b30503e.867f2",
    "type": "dgstart",
    "name": "DGSTART",
    "outputs": 1,
    "x": 116.00390625,
    "y": 47.999999046325684,
    "z": "5c846185.ea888",
    "wires": [
      [
        "37e77520.ee3cba"
      ]
    ]
  },
  {
    "id": "37e77520.ee3cba",
    "type": "service-logic",
    "name": "GENERIC-RESOURCE-API ${project.version}",
    "module": "GENERIC-RESOURCE-API",
    "version": "${project.version}",
    "comments": "",
    "xml": "<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>",
    "outputs": 1,
    "x": 328.00391006469727,
    "y": 120.00001621246338,
    "z": "5c846185.ea888",
    "wires": [
      [
        "5677b71b.5fb328"
      ]
    ]
  },
  {
    "id": "5677b71b.5fb328",
    "type": "method",
    "name": "sotn-attachment-topology-operation-delete",
    "xml": "<method rpc='sotn-attachment-topology-operation-delete' mode='sync'>\n",
    "comments": "",
    "outputs": 1,
    "x": 316.0040283203125,
    "y": 207.99999904632568,
    "z": "5c846185.ea888",
    "wires": [
      [
        "9d2f20f7.d7e57"
      ]
    ]
  },
  {
    "id": "9d2f20f7.d7e57",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 332.0040283203125,
    "y": 763.0002436637878,
    "z": "5c846185.ea888",
    "wires": [
      [
        "ed51ef95.ae803",
        "88df7f3c.6dcf",
        "3f1b61e1.0ac49e",
        "e2fe8873.3a2848",
        "d8fe29bc.d00d68",
        "4903f6e1.1eeb68",
        "f2266740.3e9f68",
        "a2240e65.e6034",
        "1742ced6.939601",
        "8b97d92c.0d63e8",
        "4eb557ec.96c928",
        "608b88dd.e3a5a8",
        "12cd17c5.66c948",
        "9eb3dfae.f51c4",
        "cf61b833.d96918"
      ]
    ]
  },
  {
    "id": "ed51ef95.ae803",
    "type": "set",
    "name": "set tmp.ar.allotted-resource-id,etc",
    "xml": "<set>\n<parameter name='tmp.ar.allotted-resource-id' value='`$connection-attachment-topology-operation-input.allotted-resource-information.allotted-resource-id`' />\n<parameter name='tmp.ar.parent-service-instance-id' value='`$connection-attachment-topology-operation-input.allotted-resource-information.parent-service-instance-id`' />\n\n\n",
    "comments": "",
    "x": 728.9974670410156,
    "y": 161.9934859275818,
    "z": "5c846185.ea888",
    "wires": []
  },
  {
    "id": "d21298fe.289dd8",
    "type": "comment",
    "name": "set tmp ar-id to fetch resource from MDSAL",
    "info": "",
    "comments": "",
    "x": 757.9577789306641,
    "y": 126.02528190612793,
    "z": "5c846185.ea888",
    "wires": []
  },
  {
    "id": "88df7f3c.6dcf",
    "type": "set",
    "name": "set tmp.ar.self-link",
    "xml": "<set>\n<parameter name='tmp.ar.self-link' value=\"`'restconf/config/GENERIC-RESOURCE-API:connection-attachment-allotted-resources/connection-attachment-allotted-resource/'\n + $tmp.ar.allotted-resource-id\n + '/allotted-resource-data/connection-attachment-topology/'` \" />\n\n",
    "comments": "",
    "x": 682.9974060058594,
    "y": 254.99349117279053,
    "z": "5c846185.ea888",
    "wires": []
  },
  {
    "id": "d8fe29bc.d00d68",
    "type": "execute",
    "name": "execute Properties",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.prop.PropertiesNode' method='readProperties' >\n    <parameter name='fileName' value='%SDNC_CONFIG_DIR%/generic-resource-api-dg.properties' />\n    <parameter name='contextPrefix' value='prop' />\n",
    "comments": "",
    "outputs": 1,
    "x": 689.2592964172363,
    "y": 342.6602201461792,
    "z": "5c846185.ea888",
    "wires": [
      []
    ]
  },
  {
    "id": "3f1b61e1.0ac49e",
    "type": "execute",
    "name": "generate allotted-resource url",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"`$prop.restapi.connection-attachment-allottedresource`\"/>\n    <parameter name=\"outputPath\" value=\"tmp.ar-url\"/>\n    <parameter name=\"target\" value=\"{allotted-resource-id}\"/>\n    <parameter name=\"replacement\" value=\"`$tmp.ar.allotted-resource-id`\"/>\n",
    "comments": "",
    "outputs": 1,
    "x": 721.2593231201172,
    "y": 430.66020154953003,
    "z": "5c846185.ea888",
    "wires": [
      []
    ]
  },
  {
    "id": "c43edf3b.dcbac",
    "type": "comment",
    "name": "Used for setting output to API Handler",
    "info": "",
    "comments": "",
    "x": 736.9974365234375,
    "y": 221.9935007095337,
    "z": "5c846185.ea888",
    "wires": []
  },
  {
    "id": "10733905.283097",
    "type": "comment",
    "name": "Obtain different URL, template location etc",
    "info": "For saving resource information to MDSAL & for AAI",
    "comments": "",
    "x": 754.9974021911621,
    "y": 307.882381439209,
    "z": "5c846185.ea888",
    "wires": []
  },
  {
    "id": "62545852.867ec8",
    "type": "comment",
    "name": "Used to Get AR by id to MDSAL, same as self-link",
    "info": "",
    "comments": "",
    "x": 780.9974212646484,
    "y": 394.8823404312134,
    "z": "5c846185.ea888",
    "wires": []
  },
  {
    "id": "ed0a2645.640ef8",
    "type": "comment",
    "name": "GET parent-service-data from mdsal to check existence of other End point",
    "info": "",
    "comments": "",
    "x": 848.0042343139648,
    "y": 849.5316219329834,
    "z": "5c846185.ea888",
    "wires": []
  },
  {
    "id": "a950273c.9f66a8",
    "type": "for",
    "name": "for pidx..mdsal-psd.service-data.provided-allotted-resources.provided-allotted-resource[]",
    "xml": "<for index='pidx' start='0' end='`$mdsal-psd.service-data.provided-allotted-resources.provided-allotted-resource_length`' >\n",
    "comments": "",
    "outputs": 1,
    "x": 1676.1888427734375,
    "y": 1083.0042576789856,
    "z": "5c846185.ea888",
    "wires": [
      [
        "e88ff344.a2353"
      ]
    ]
  },
  {
    "id": "e2fe8873.3a2848",
    "type": "switchNode",
    "name": "switch mdsal-psd.service-data.provided-allotted-resources_length",
    "xml": "<switch test='`$mdsal-psd.service-data.provided-allotted-resources.provided-allotted-resource_length`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 827.1882019042969,
    "y": 1089.7180404663086,
    "z": "5c846185.ea888",
    "wires": [
      [
        "7dbb67ae.29f3f8",
        "dea01091.d8b15"
      ]
    ]
  },
  {
    "id": "2fdb27fa.f6ac38",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 1277.4583644866943,
    "y": 1129.7015261650085,
    "z": "5c846185.ea888",
    "wires": [
      [
        "a950273c.9f66a8",
        "19cf7741.613499"
      ]
    ]
  },
  {
    "id": "e88ff344.a2353",
    "type": "switchNode",
    "name": "switch allotted-resource-id",
    "xml": "<switch test=\"`$mdsal-psd.service-data.provided-allotted-resources.provided-allotted-resource[$pidx].allotted-resource-id == $tmp.ar.allotted-resource-id`\">\n\n",
    "comments": "",
    "outputs": 1,
    "x": 2126.300048828125,
    "y": 1081.0041155815125,
    "z": "5c846185.ea888",
    "wires": [
      [
        "c87ef19e.e93cf"
      ]
    ]
  },
  {
    "id": "4903f6e1.1eeb68",
    "type": "set",
    "name": "set tmp.ar.parent-service-instance-id",
    "xml": "<set>\n<parameter name='tmp.ar.parent-service-instance-id' value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.parent-service-instance-id` \" />\n\n",
    "comments": "",
    "x": 738.9726181030273,
    "y": 885.0000667572021,
    "z": "5c846185.ea888",
    "wires": []
  },
  {
    "id": "9023749d.2a65a8",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1118.972900390625,
    "y": 963.0001816749573,
    "z": "5c846185.ea888",
    "wires": [
      [
        "85ec274.d7380d8"
      ]
    ]
  },
  {
    "id": "13a32c23.faaff4",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1110.8247032165527,
    "y": 998.0662665367126,
    "z": "5c846185.ea888",
    "wires": [
      [
        "61460fc5.a222"
      ]
    ]
  },
  {
    "id": "61460fc5.a222",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"404\" />\n    <parameter name=\"error-message\" value=\"Error: SOTN resource not found\" />\n    \n",
    "comments": "",
    "x": 1285.973388671875,
    "y": 994.333616733551,
    "z": "5c846185.ea888",
    "wires": []
  },
  {
    "id": "85ec274.d7380d8",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1269.972900390625,
    "y": 961.0001816749573,
    "z": "5c846185.ea888",
    "wires": [
      []
    ]
  },
  {
    "id": "2a315011.b7952",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 972.7346687316895,
    "y": 1278.9528144598007,
    "z": "5c846185.ea888",
    "wires": [
      [
        "398739b4.01afc6"
      ]
    ]
  },
  {
    "id": "398739b4.01afc6",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"AAI failed\" />\n",
    "comments": "",
    "x": 1139.2585487365723,
    "y": 1290.5718854665756,
    "z": "5c846185.ea888",
    "wires": []
  },
  {
    "id": "2e78e3b1.a4cadc",
    "type": "failure",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 979.8299560546875,
    "y": 1311.7147821187973,
    "z": "5c846185.ea888",
    "wires": [
      [
        "398739b4.01afc6"
      ]
    ]
  },
  {
    "id": "3f6ffe96.e0bda2",
    "type": "comment",
    "name": "TODO: Rework after confirmation from AAI",
    "info": "",
    "comments": "",
    "x": 1104.1413345336914,
    "y": 1229.8732142448425,
    "z": "5c846185.ea888",
    "wires": []
  },
  {
    "id": "f2266740.3e9f68",
    "type": "set",
    "name": "set output to api handler",
    "xml": "<set>\n<parameter name='allotted-resource-id' value='`$tmp.ar.allotted-resource-id`' />\n<parameter name='connection-attachment-object-path' value=\"`$tmp.ar.self-link`\"/>\n<parameter name='service-object-path' value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $connection-attachment-topology-operation-input.service-information.service-instance-id\n + '/service-data/service-topology/'`\"/>\n \n",
    "comments": "",
    "x": 705.5500564575195,
    "y": 1242.8276815414429,
    "z": "5c846185.ea888",
    "wires": []
  },
  {
    "id": "a2240e65.e6034",
    "type": "returnSuccess",
    "name": "return success",
    "xml": "<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n",
    "comments": "",
    "x": 674.9631614685059,
    "y": 1343.4434361457825,
    "z": "5c846185.ea888",
    "wires": []
  },
  {
    "id": "1742ced6.939601",
    "type": "execute",
    "name": "execute RestApiCallNode - PUT AR by id",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.ar-url`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='Delete' />\n    <parameter name=\"responsePrefix\" value=\"mdsal-ar\" />\n\n",
    "comments": "",
    "outputs": 1,
    "x": 754.6705703735352,
    "y": 519.3333616256714,
    "z": "5c846185.ea888",
    "wires": [
      [
        "597f085a.f89fd8",
        "c3fb7b14.ff60a8",
        "e4c15d29.0e847"
      ]
    ]
  },
  {
    "id": "597f085a.f89fd8",
    "type": "not-found",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 994.3120727539062,
    "y": 559.6649098396301,
    "z": "5c846185.ea888",
    "wires": [
      [
        "67fdc38f.4e65cc"
      ]
    ]
  },
  {
    "id": "c3fb7b14.ff60a8",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 991.3120727539062,
    "y": 516.1649074554443,
    "z": "5c846185.ea888",
    "wires": [
      [
        "67fdc38f.4e65cc"
      ]
    ]
  },
  {
    "id": "e4c15d29.0e847",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 998.0621528625488,
    "y": 475.52200269699097,
    "z": "5c846185.ea888",
    "wires": [
      [
        "50ef93e6.56ad3c"
      ]
    ]
  },
  {
    "id": "67fdc38f.4e65cc",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating md-sal for connection-attachment-allotted-resource\" />\n",
    "comments": "",
    "x": 1150.062240600586,
    "y": 537.9149079322815,
    "z": "5c846185.ea888",
    "wires": []
  },
  {
    "id": "50ef93e6.56ad3c",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1135.7180843353271,
    "y": 475.7141823768616,
    "z": "5c846185.ea888",
    "wires": [
      []
    ]
  },
  {
    "id": "c4e5f3c2.475ed",
    "type": "comment",
    "name": "Delete Allotted Resource",
    "info": "",
    "comments": "",
    "x": 702.0039520263672,
    "y": 488.0000276565552,
    "z": "5c846185.ea888",
    "wires": []
  },
  {
    "id": "de43dad6.d53448",
    "type": "for",
    "name": "for cidx..service-data.consumed-allotted-resources.consumed-allotted-resource[]",
    "xml": "<for index='cidx' start='0' end='`$service-data.consumed-allotted-resources.consumed-allotted-resource_length`' >\n",
    "comments": "",
    "outputs": 1,
    "x": 1652.0078125,
    "y": 725.0039052963257,
    "z": "5c846185.ea888",
    "wires": [
      [
        "584a4c5d.3639a4"
      ]
    ]
  },
  {
    "id": "8b97d92c.0d63e8",
    "type": "switchNode",
    "name": "switch service-data.consumed-allotted-resources_length",
    "xml": "<switch test='`$service-data.consumed-allotted-resources.consumed-allotted-resource_length`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 805.0071983337402,
    "y": 685.7179067134857,
    "z": "5c846185.ea888",
    "wires": [
      [
        "3433f8dc.aa0358",
        "d35e52b4.a3e33"
      ]
    ]
  },
  {
    "id": "3433f8dc.aa0358",
    "type": "other",
    "name": "outcome Null",
    "xml": "<outcome value=''>\n",
    "comments": "",
    "outputs": 1,
    "x": 1129.1500625610352,
    "y": 668.5753412246704,
    "z": "5c846185.ea888",
    "wires": [
      [
        "e9cfa004.3e1db"
      ]
    ]
  },
  {
    "id": "d35e52b4.a3e33",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1115.1500854492188,
    "y": 731.5753300189972,
    "z": "5c846185.ea888",
    "wires": [
      [
        "27f778ec.7e6108"
      ]
    ]
  },
  {
    "id": "27f778ec.7e6108",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 1275.2771759033203,
    "y": 729.7013065814972,
    "z": "5c846185.ea888",
    "wires": [
      [
        "de43dad6.d53448",
        "c89d5c3.bdcfea"
      ]
    ]
  },
  {
    "id": "4eb557ec.96c928",
    "type": "set",
    "name": "set consumed allotted resources for deletion",
    "xml": "<set>\n<parameter name=\"service-data.consumed-allotted-resources.consumed-allotted-resource[$cidx].\" value=\"\" />\n<parameter name='service-data.consumed-allotted-resources.consumed-allotted-resource_length' value='`$service-data.consumed-allotted-resources.consumed-allotted-resource_length - 1`' />\n\n",
    "comments": "",
    "x": 761.8645324707031,
    "y": 756.2895498275757,
    "z": "5c846185.ea888",
    "wires": []
  },
  {
    "id": "584a4c5d.3639a4",
    "type": "switchNode",
    "name": "switch allotted-resource-id",
    "xml": "<switch test=\"`$service-data.consumed-allotted-resources.consumed-allotted-resource[$cidx].allotted-resource-id == $tmp.ar.allotted-resource-id`\">\n\n",
    "comments": "",
    "outputs": 1,
    "x": 2090.1194229125977,
    "y": 721.0040273666382,
    "z": "5c846185.ea888",
    "wires": [
      [
        "c6c0a37e.c2dab"
      ]
    ]
  },
  {
    "id": "c6c0a37e.c2dab",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2285.929244995117,
    "y": 720.4683518409729,
    "z": "5c846185.ea888",
    "wires": [
      [
        "980eb324.1f10c"
      ]
    ]
  },
  {
    "id": "b3956a96.0877a8",
    "type": "set",
    "name": "set tmp.cidx",
    "xml": "<set>\n<parameter name='tmp.cidx' value='`$cidx`' />\n",
    "comments": "",
    "x": 2601.2657775878906,
    "y": 721.2246098518372,
    "z": "5c846185.ea888",
    "wires": []
  },
  {
    "id": "f7015fdd.73e0f",
    "type": "comment",
    "name": "Delete consumed service consumed-allotted-resources in mdsal",
    "info": "",
    "comments": "",
    "x": 816.0084686279297,
    "y": 618.003871455905,
    "z": "5c846185.ea888",
    "wires": []
  },
  {
    "id": "1b9b1c3c.959814",
    "type": "comment",
    "name": "This set resource will be deleted in MDSAL by provider code",
    "info": "",
    "comments": "",
    "x": 806.341251373291,
    "y": 722.7819633483887,
    "z": "5c846185.ea888",
    "wires": []
  },
  {
    "id": "4ceb1c8.5e02ee4",
    "type": "comment",
    "name": "Obtain the index of conusumed AR",
    "info": "",
    "comments": "",
    "x": 728.7856597900391,
    "y": 649.8927316665649,
    "z": "5c846185.ea888",
    "wires": []
  },
  {
    "id": "e9cfa004.3e1db",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Resource to be deleted doesn't exist in MDSAL.\" />\n",
    "comments": "",
    "x": 1291.0078125,
    "y": 669.0039052963257,
    "z": "5c846185.ea888",
    "wires": []
  },
  {
    "id": "980eb324.1f10c",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 2435.007843017578,
    "y": 721.2539548873901,
    "z": "5c846185.ea888",
    "wires": [
      [
        "b3956a96.0877a8"
      ]
    ]
  },
  {
    "id": "157c6d55.8b7213",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"resource to be deleted is not available in mdsal\" />\n",
    "comments": "",
    "x": 1745.2578125,
    "y": 778.2539052963257,
    "z": "5c846185.ea888",
    "wires": []
  },
  {
    "id": "2c9e34da.91de0c",
    "type": "outcome",
    "name": "NULL",
    "xml": "<outcome value=''>\n",
    "comments": "",
    "outputs": 1,
    "x": 1607.7578125,
    "y": 778.2539052963257,
    "z": "5c846185.ea888",
    "wires": [
      [
        "157c6d55.8b7213"
      ]
    ]
  },
  {
    "id": "c89d5c3.bdcfea",
    "type": "switchNode",
    "name": "switch tmp.cidx ",
    "xml": "<switch test=\"`$tmp.cidx`\">\n\n",
    "comments": "",
    "outputs": 1,
    "x": 1453.7578125,
    "y": 778.2539052963257,
    "z": "5c846185.ea888",
    "wires": [
      [
        "2c9e34da.91de0c"
      ]
    ]
  },
  {
    "id": "c4252e31.dbb43",
    "type": "comment",
    "name": "Delete provided service provided-allotted-resources in mdsal",
    "info": "",
    "comments": "",
    "x": 802.5078277587891,
    "y": 814.0039052963257,
    "z": "5c846185.ea888",
    "wires": []
  },
  {
    "id": "dea01091.d8b15",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1130.5080833435059,
    "y": 1128.7540974617004,
    "z": "5c846185.ea888",
    "wires": [
      [
        "2fdb27fa.f6ac38"
      ]
    ]
  },
  {
    "id": "7dbb67ae.29f3f8",
    "type": "other",
    "name": "outcome Null",
    "xml": "<outcome value=''>\n",
    "comments": "",
    "outputs": 1,
    "x": 1147.5080032348633,
    "y": 1040.7539315223694,
    "z": "5c846185.ea888",
    "wires": [
      [
        "f54472a.345109"
      ]
    ]
  },
  {
    "id": "f54472a.345109",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Resource to be deleted doesn't exist in MDSAL.\" />\n",
    "comments": "",
    "x": 1311.3656005859375,
    "y": 1041.1824765205383,
    "z": "5c846185.ea888",
    "wires": []
  },
  {
    "id": "e1824da6.1f214",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"resource to be deleted is not available in mdsal\" />\n",
    "comments": "",
    "x": 1742.7578563690186,
    "y": 1158.7539353370667,
    "z": "5c846185.ea888",
    "wires": []
  },
  {
    "id": "8205df8d.8ddee",
    "type": "outcome",
    "name": "NULL",
    "xml": "<outcome value=''>\n",
    "comments": "",
    "outputs": 1,
    "x": 1605.2578563690186,
    "y": 1158.7539353370667,
    "z": "5c846185.ea888",
    "wires": [
      [
        "e1824da6.1f214"
      ]
    ]
  },
  {
    "id": "19cf7741.613499",
    "type": "switchNode",
    "name": "switch tmp.pidx ",
    "xml": "<switch test=\"`$tmp.pidx`\">\n\n",
    "comments": "",
    "outputs": 1,
    "x": 1451.2578563690186,
    "y": 1158.7539353370667,
    "z": "5c846185.ea888",
    "wires": [
      [
        "8205df8d.8ddee"
      ]
    ]
  },
  {
    "id": "c87ef19e.e93cf",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2315.508274078369,
    "y": 1078.7540936470032,
    "z": "5c846185.ea888",
    "wires": [
      [
        "27e8796d.045376"
      ]
    ]
  },
  {
    "id": "33e9010b.6c835e",
    "type": "set",
    "name": "set tmp.pidx",
    "xml": "<set>\n<parameter name='tmp.pidx' value='`$pidx`' />\n",
    "comments": "",
    "x": 2383.8443908691406,
    "y": 1213.510190486908,
    "z": "5c846185.ea888",
    "wires": []
  },
  {
    "id": "27e8796d.045376",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 2375.586727142334,
    "y": 1149.5395798683167,
    "z": "5c846185.ea888",
    "wires": [
      [
        "33e9010b.6c835e"
      ]
    ]
  },
  {
    "id": "608b88dd.e3a5a8",
    "type": "set",
    "name": "set provided allotted resources for deletion",
    "xml": "<set>\n<parameter name=\"service-data.provided-allotted-resources.consumed-allotted-resource[$pidx].\" value=\"\" />\n<parameter name=\"service-data.provided-allotted-resources.consumed-allotted-resource_length\" value='`$service-data.provided-allotted-resources.consumed-allotted-resource_length - 1`' />\n\n",
    "comments": "",
    "x": 761.0079040527344,
    "y": 1144.003975868225,
    "z": "5c846185.ea888",
    "wires": []
  },
  {
    "id": "12cd17c5.66c948",
    "type": "update",
    "name": "update AAI allotted-resource",
    "xml": "<delete plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" resource='allotted-resource'  \n\t\tkey=\"customer.global-customer-id = $connection-attachment-topology-operation-input.service-information.global-customer-id AND\n\t\t\tservice-subscription.service-type = $connection-attachment-topology-operation-input.service-information.subscription-service-type AND\n\t\t\tservice-instance.service-instance-id = $connection-attachment-topology-operation-input.allotted-resource-information.parent-service-instance-id AND\n\t\t\tallotted-resource.id = $tmp.ar.allotted-resource-id\">\n",
    "comments": "",
    "outputs": 1,
    "x": 718.2266616821289,
    "y": 1298.7543454170227,
    "z": "5c846185.ea888",
    "wires": [
      [
        "2a315011.b7952",
        "2e78e3b1.a4cadc"
      ]
    ]
  },
  {
    "id": "cf61b833.d96918",
    "type": "execute",
    "name": "execute RestApiCallNode - get-resource parent service data",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.ar-url-psd`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='GET' />\n    <parameter name=\"responsePrefix\" value=\"mdsal-psd\" />\n\n",
    "comments": "",
    "outputs": 1,
    "x": 808.3373260498047,
    "y": 984.3333654403687,
    "z": "5c846185.ea888",
    "wires": [
      [
        "9023749d.2a65a8",
        "13a32c23.faaff4"
      ]
    ]
  },
  {
    "id": "9eb3dfae.f51c4",
    "type": "execute",
    "name": "get parent-service-data tmp.ar-url-psd",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"/restconf/config/GENERIC-RESOURCE-API:services/service/{service-instance-id}/service-data\"/>\n    <parameter name=\"outputPath\" value=\"tmp.ar-url-psd\"/>\n    <parameter name=\"target\" value=\"{service-instance-id}\"/>\n    <parameter name=\"replacement\" value=\"`$tmp.ar.parent-service-instance-id`\"/>",
    "comments": "",
    "outputs": 1,
    "x": 742.3372650146484,
    "y": 942.3332047462463,
    "z": "5c846185.ea888",
    "wires": [
      []
    ]
  }
]