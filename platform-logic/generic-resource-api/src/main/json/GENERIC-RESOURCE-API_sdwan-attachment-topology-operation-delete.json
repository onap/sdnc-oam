[
  {
    "id": "9ff5a59d.ba1e08",
    "type": "dgstart",
    "name": "DGSTART",
    "outputs": 1,
    "x": 90.00390625,
    "y": 49.999999046325684,
    "z": "3cf3c3f6.8ecf4c",
    "wires": [
      [
        "2a13d7f0.0d4348"
      ]
    ]
  },
  {
    "id": "2a13d7f0.0d4348",
    "type": "service-logic",
    "name": "GENERIC-RESOURCE-API ${project.version}",
    "module": "GENERIC-RESOURCE-API",
    "version": "${project.version}",
    "comments": "",
    "xml": "<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>",
    "outputs": 1,
    "x": 302.00391006469727,
    "y": 122.00001621246338,
    "z": "3cf3c3f6.8ecf4c",
    "wires": [
      [
        "a747a1bc.5a7f6"
      ]
    ]
  },
  {
    "id": "a747a1bc.5a7f6",
    "type": "method",
    "name": "sdwan-attachment-topology-operation-delete",
    "xml": "<method rpc='sdwan-attachment-topology-operation-delete' mode='sync'>\n",
    "comments": "",
    "outputs": 1,
    "x": 290.0040283203125,
    "y": 209.99999904632568,
    "z": "3cf3c3f6.8ecf4c",
    "wires": [
      [
        "c8f19e0f.8c32c"
      ]
    ]
  },
  {
    "id": "c8f19e0f.8c32c",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 306.0040283203125,
    "y": 765.0002436637878,
    "z": "3cf3c3f6.8ecf4c",
    "wires": [
      [
        "ac139f07.afe46",
        "d564f17f.3cd7c",
        "b24304d4.852188",
        "81139b91.d72eb8",
        "da5a8374.7ecac",
        "72df0cf3.25ba74",
        "b5ddcb9b.3d0b08",
        "7e7d6803.801908",
        "97410a5a.3537b8",
        "d656e279.64fe3",
        "be0fff75.07c73",
        "38ea07fe.9ae708",
        "9639b1d0.6aa4d",
        "5ded2c1d.2cf294"
      ]
    ]
  },
  {
    "id": "ac139f07.afe46",
    "type": "set",
    "name": "set tmp.ar.allotted-resource-id,etc",
    "xml": "<set>\n<parameter name='tmp.ar.allotted-resource-id' value='`$connection-attachment-topology-operation-input.allotted-resource-information.allotted-resource-id`' />\n<parameter name='tmp.ar.parent-service-instance-id' value='`$connection-attachment-topology-operation-input.allotted-resource-information.parent-service-instance-id`' />\n\n\n",
    "comments": "",
    "x": 702.9974670410156,
    "y": 163.9934859275818,
    "z": "3cf3c3f6.8ecf4c",
    "wires": []
  },
  {
    "id": "c1a22f40.b7f8d",
    "type": "comment",
    "name": "set tmp ar-id to fetch resource from MDSAL",
    "info": "",
    "comments": "",
    "x": 731.9577789306641,
    "y": 128.02528190612793,
    "z": "3cf3c3f6.8ecf4c",
    "wires": []
  },
  {
    "id": "d564f17f.3cd7c",
    "type": "set",
    "name": "set tmp.ar.self-link",
    "xml": "<set>\n<parameter name='tmp.ar.self-link' value=\"`'restconf/config/GENERIC-RESOURCE-API:connection-attachment-allotted-resources/connection-attachment-allotted-resource/'\n + $tmp.ar.allotted-resource-id\n + '/allotted-resource-data/connection-attachment-topology/'` \" />\n\n",
    "comments": "",
    "x": 656.9974060058594,
    "y": 256.9934911727905,
    "z": "3cf3c3f6.8ecf4c",
    "wires": []
  },
  {
    "id": "da5a8374.7ecac",
    "type": "execute",
    "name": "execute Properties",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.prop.PropertiesNode' method='readProperties' >\n    <parameter name='fileName' value='%SDNC_CONFIG_DIR%/generic-resource-api-dg.properties' />\n    <parameter name='contextPrefix' value='prop' />\n",
    "comments": "",
    "outputs": 1,
    "x": 663.2592964172363,
    "y": 344.6602201461792,
    "z": "3cf3c3f6.8ecf4c",
    "wires": [
      []
    ]
  },
  {
    "id": "b24304d4.852188",
    "type": "execute",
    "name": "generate allotted-resource url",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"`$prop.restapi.connection-attachment-allottedresource`\"/>\n    <parameter name=\"outputPath\" value=\"tmp.ar-url\"/>\n    <parameter name=\"target\" value=\"{allotted-resource-id}\"/>\n    <parameter name=\"replacement\" value=\"`$tmp.ar.allotted-resource-id`\"/>\n",
    "comments": "",
    "outputs": 1,
    "x": 695.2593231201172,
    "y": 432.66020154953003,
    "z": "3cf3c3f6.8ecf4c",
    "wires": [
      []
    ]
  },
  {
    "id": "595e5ef1.fa051",
    "type": "comment",
    "name": "Used for setting output to API Handler",
    "info": "",
    "comments": "",
    "x": 710.9974365234375,
    "y": 223.9935007095337,
    "z": "3cf3c3f6.8ecf4c",
    "wires": []
  },
  {
    "id": "6c854173.f4bc7",
    "type": "comment",
    "name": "Obtain different URL, template location etc",
    "info": "For saving resource information to MDSAL & for AAI",
    "comments": "",
    "x": 728.9974021911621,
    "y": 309.882381439209,
    "z": "3cf3c3f6.8ecf4c",
    "wires": []
  },
  {
    "id": "e788822e.3722e",
    "type": "comment",
    "name": "Used to Get AR by id to MDSAL, same as self-link",
    "info": "",
    "comments": "",
    "x": 754.9974212646484,
    "y": 396.8823404312134,
    "z": "3cf3c3f6.8ecf4c",
    "wires": []
  },
  {
    "id": "dff7fd40.e0f0c",
    "type": "comment",
    "name": "GET parent-service-data from mdsal to check existence of other End point",
    "info": "",
    "comments": "",
    "x": 822.0042343139648,
    "y": 851.5316219329834,
    "z": "3cf3c3f6.8ecf4c",
    "wires": []
  },
  {
    "id": "5cba16bf.c97498",
    "type": "for",
    "name": "for pidx..mdsal-psd.service-data.provided-allotted-resources.provided-allotted-resource[]",
    "xml": "<for index='pidx' start='0' end='`$mdsal-psd.service-data.provided-allotted-resources.provided-allotted-resource_length`' >\n",
    "comments": "",
    "outputs": 1,
    "x": 1650.1888427734375,
    "y": 1085.0042576789856,
    "z": "3cf3c3f6.8ecf4c",
    "wires": [
      [
        "72856d05.385d64"
      ]
    ]
  },
  {
    "id": "81139b91.d72eb8",
    "type": "switchNode",
    "name": "switch mdsal-psd.service-data.provided-allotted-resources_length",
    "xml": "<switch test='`$mdsal-psd.service-data.provided-allotted-resources.provided-allotted-resource_length`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 801.1882019042969,
    "y": 1091.7180404663086,
    "z": "3cf3c3f6.8ecf4c",
    "wires": [
      [
        "e3d57198.c43ea",
        "2011daa6.6398e6"
      ]
    ]
  },
  {
    "id": "73a8d368.4b79bc",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 1251.4583644866943,
    "y": 1131.7015261650085,
    "z": "3cf3c3f6.8ecf4c",
    "wires": [
      [
        "5cba16bf.c97498",
        "4ca0ceba.893a2"
      ]
    ]
  },
  {
    "id": "72856d05.385d64",
    "type": "switchNode",
    "name": "switch allotted-resource-id",
    "xml": "<switch test=\"`$mdsal-psd.service-data.provided-allotted-resources.provided-allotted-resource[$pidx].allotted-resource-id == $tmp.ar.allotted-resource-id`\">\n\n",
    "comments": "",
    "outputs": 1,
    "x": 2100.300048828125,
    "y": 1083.0041155815125,
    "z": "3cf3c3f6.8ecf4c",
    "wires": [
      [
        "f2234386.9854c"
      ]
    ]
  },
  {
    "id": "72df0cf3.25ba74",
    "type": "set",
    "name": "set tmp.ar.parent-service-instance-id",
    "xml": "<set>\n<parameter name='tmp.ar.parent-service-instance-id' value=\"`$connection-attachment-topology-operation-input.allotted-resource-information.parent-service-instance-id` \" />\n\n",
    "comments": "",
    "x": 712.9726181030273,
    "y": 887.0000667572021,
    "z": "3cf3c3f6.8ecf4c",
    "wires": []
  },
  {
    "id": "32223174.f7450e",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1092.972900390625,
    "y": 965.0001816749573,
    "z": "3cf3c3f6.8ecf4c",
    "wires": [
      [
        "c45c28d6.ff3cc8"
      ]
    ]
  },
  {
    "id": "e0a303bb.2dc06",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1084.8247032165527,
    "y": 1000.0662665367126,
    "z": "3cf3c3f6.8ecf4c",
    "wires": [
      [
        "3e0bcadf.484fe6"
      ]
    ]
  },
  {
    "id": "3e0bcadf.484fe6",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"404\" />\n    <parameter name=\"error-message\" value=\"Error: SOTN resource not found\" />\n    \n",
    "comments": "",
    "x": 1259.973388671875,
    "y": 996.333616733551,
    "z": "3cf3c3f6.8ecf4c",
    "wires": []
  },
  {
    "id": "c45c28d6.ff3cc8",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1243.972900390625,
    "y": 963.0001816749573,
    "z": "3cf3c3f6.8ecf4c",
    "wires": [
      []
    ]
  },
  {
    "id": "ebfdd448.549cc8",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 946.7346687316895,
    "y": 1280.9528144598007,
    "z": "3cf3c3f6.8ecf4c",
    "wires": [
      [
        "65c46af.7320594"
      ]
    ]
  },
  {
    "id": "65c46af.7320594",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"AAI failed\" />\n",
    "comments": "",
    "x": 1113.2585487365723,
    "y": 1292.5718854665756,
    "z": "3cf3c3f6.8ecf4c",
    "wires": []
  },
  {
    "id": "4d049da0.ca99b4",
    "type": "failure",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 953.8299560546875,
    "y": 1313.7147821187973,
    "z": "3cf3c3f6.8ecf4c",
    "wires": [
      [
        "65c46af.7320594"
      ]
    ]
  },
  {
    "id": "36f9e028.ff6b9",
    "type": "comment",
    "name": "TODO: Rework after confirmation from AAI",
    "info": "",
    "comments": "",
    "x": 1078.1413345336914,
    "y": 1231.8732142448425,
    "z": "3cf3c3f6.8ecf4c",
    "wires": []
  },
  {
    "id": "b5ddcb9b.3d0b08",
    "type": "set",
    "name": "set output to api handler",
    "xml": "<set>\n<parameter name='allotted-resource-id' value='`$tmp.ar.allotted-resource-id`' />\n<parameter name='connection-attachment-object-path' value=\"`$tmp.ar.self-link`\"/>\n<parameter name='service-object-path' value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $connection-attachment-topology-operation-input.service-information.service-instance-id\n + '/service-data/service-topology/'`\"/>\n \n",
    "comments": "",
    "x": 679.5500564575195,
    "y": 1244.8276815414429,
    "z": "3cf3c3f6.8ecf4c",
    "wires": []
  },
  {
    "id": "7e7d6803.801908",
    "type": "returnSuccess",
    "name": "return success",
    "xml": "<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n",
    "comments": "",
    "x": 648.9631729125977,
    "y": 1351.443561553955,
    "z": "3cf3c3f6.8ecf4c",
    "wires": []
  },
  {
    "id": "97410a5a.3537b8",
    "type": "execute",
    "name": "execute RestApiCallNode - PUT AR by id",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.ar-url`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='Delete' />\n    <parameter name=\"responsePrefix\" value=\"mdsal-ar\" />\n\n",
    "comments": "",
    "outputs": 1,
    "x": 728.6705703735352,
    "y": 521.3333616256714,
    "z": "3cf3c3f6.8ecf4c",
    "wires": [
      [
        "1994f5fd.2a6f4a",
        "da3ffcab.ea62a",
        "e404bf43.f1066"
      ]
    ]
  },
  {
    "id": "1994f5fd.2a6f4a",
    "type": "not-found",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 968.3120727539062,
    "y": 561.6649098396301,
    "z": "3cf3c3f6.8ecf4c",
    "wires": [
      [
        "e45dc5dc.4ac748"
      ]
    ]
  },
  {
    "id": "da3ffcab.ea62a",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 965.3120727539062,
    "y": 518.1649074554443,
    "z": "3cf3c3f6.8ecf4c",
    "wires": [
      [
        "e45dc5dc.4ac748"
      ]
    ]
  },
  {
    "id": "e404bf43.f1066",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 972.0621528625488,
    "y": 477.52200269699097,
    "z": "3cf3c3f6.8ecf4c",
    "wires": [
      [
        "6706c73a.4ce818"
      ]
    ]
  },
  {
    "id": "e45dc5dc.4ac748",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating md-sal for connection-attachment-allotted-resource\" />\n",
    "comments": "",
    "x": 1124.062240600586,
    "y": 539.9149079322815,
    "z": "3cf3c3f6.8ecf4c",
    "wires": []
  },
  {
    "id": "6706c73a.4ce818",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1109.7180843353271,
    "y": 477.7141823768616,
    "z": "3cf3c3f6.8ecf4c",
    "wires": [
      []
    ]
  },
  {
    "id": "61ea2842.341858",
    "type": "comment",
    "name": "Delete Allotted Resource",
    "info": "",
    "comments": "",
    "x": 676.0039520263672,
    "y": 490.0000276565552,
    "z": "3cf3c3f6.8ecf4c",
    "wires": []
  },
  {
    "id": "6dbcd93.5772b28",
    "type": "for",
    "name": "for cidx..service-data.consumed-allotted-resources.consumed-allotted-resource[]",
    "xml": "<for index='cidx' start='0' end='`$service-data.consumed-allotted-resources.consumed-allotted-resource_length`' >\n",
    "comments": "",
    "outputs": 1,
    "x": 1626.0078125,
    "y": 727.0039052963257,
    "z": "3cf3c3f6.8ecf4c",
    "wires": [
      [
        "8604274a.795a98"
      ]
    ]
  },
  {
    "id": "d656e279.64fe3",
    "type": "switchNode",
    "name": "switch service-data.consumed-allotted-resources_length",
    "xml": "<switch test='`$service-data.consumed-allotted-resources.consumed-allotted-resource_length`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 779.0071983337402,
    "y": 687.7179067134857,
    "z": "3cf3c3f6.8ecf4c",
    "wires": [
      [
        "e4f37d32.adb08",
        "b232603b.f0d15"
      ]
    ]
  },
  {
    "id": "e4f37d32.adb08",
    "type": "other",
    "name": "outcome Null",
    "xml": "<outcome value=''>\n",
    "comments": "",
    "outputs": 1,
    "x": 1103.1500625610352,
    "y": 670.5753412246704,
    "z": "3cf3c3f6.8ecf4c",
    "wires": [
      [
        "157affe5.dc6c6"
      ]
    ]
  },
  {
    "id": "b232603b.f0d15",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1089.1500854492188,
    "y": 733.5753300189972,
    "z": "3cf3c3f6.8ecf4c",
    "wires": [
      [
        "a3ecd1d6.43a2e"
      ]
    ]
  },
  {
    "id": "a3ecd1d6.43a2e",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 1249.2771759033203,
    "y": 731.7013065814972,
    "z": "3cf3c3f6.8ecf4c",
    "wires": [
      [
        "6dbcd93.5772b28",
        "9971417.dd05cc"
      ]
    ]
  },
  {
    "id": "be0fff75.07c73",
    "type": "set",
    "name": "set consumed allotted resources for deletion",
    "xml": "<set>\n<parameter name=\"service-data.consumed-allotted-resources.consumed-allotted-resource[$cidx].\" value=\"\" />\n<parameter name='service-data.consumed-allotted-resources.consumed-allotted-resource_length' value='`$service-data.consumed-allotted-resources.consumed-allotted-resource_length - 1`' />\n\n",
    "comments": "",
    "x": 735.8645324707031,
    "y": 758.2895498275757,
    "z": "3cf3c3f6.8ecf4c",
    "wires": []
  },
  {
    "id": "8604274a.795a98",
    "type": "switchNode",
    "name": "switch allotted-resource-id",
    "xml": "<switch test=\"`$service-data.consumed-allotted-resources.consumed-allotted-resource[$cidx].allotted-resource-id == $tmp.ar.allotted-resource-id`\">\n\n",
    "comments": "",
    "outputs": 1,
    "x": 2064.1194229125977,
    "y": 723.0040273666382,
    "z": "3cf3c3f6.8ecf4c",
    "wires": [
      [
        "3ce4b91e.bc1ea6"
      ]
    ]
  },
  {
    "id": "3ce4b91e.bc1ea6",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2259.929244995117,
    "y": 722.4683518409729,
    "z": "3cf3c3f6.8ecf4c",
    "wires": [
      [
        "bfbb9b9d.413298"
      ]
    ]
  },
  {
    "id": "5d4138bb.2e6948",
    "type": "set",
    "name": "set tmp.cidx",
    "xml": "<set>\n<parameter name='tmp.cidx' value='`$cidx`' />\n",
    "comments": "",
    "x": 2575.2657775878906,
    "y": 723.2246098518372,
    "z": "3cf3c3f6.8ecf4c",
    "wires": []
  },
  {
    "id": "80fa82c1.032f3",
    "type": "comment",
    "name": "Delete consumed service consumed-allotted-resources in mdsal",
    "info": "",
    "comments": "",
    "x": 790.0084686279297,
    "y": 620.003871455905,
    "z": "3cf3c3f6.8ecf4c",
    "wires": []
  },
  {
    "id": "b69750ea.d13e7",
    "type": "comment",
    "name": "This set resource will be deleted in MDSAL by provider code",
    "info": "",
    "comments": "",
    "x": 780.341251373291,
    "y": 724.7819633483887,
    "z": "3cf3c3f6.8ecf4c",
    "wires": []
  },
  {
    "id": "24feb42b.2816cc",
    "type": "comment",
    "name": "Obtain the index of conusumed AR",
    "info": "",
    "comments": "",
    "x": 702.7856597900391,
    "y": 651.8927316665649,
    "z": "3cf3c3f6.8ecf4c",
    "wires": []
  },
  {
    "id": "157affe5.dc6c6",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Resource to be deleted doesn't exist in MDSAL.\" />\n",
    "comments": "",
    "x": 1265.0078125,
    "y": 671.0039052963257,
    "z": "3cf3c3f6.8ecf4c",
    "wires": []
  },
  {
    "id": "bfbb9b9d.413298",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 2409.007843017578,
    "y": 723.2539548873901,
    "z": "3cf3c3f6.8ecf4c",
    "wires": [
      [
        "5d4138bb.2e6948"
      ]
    ]
  },
  {
    "id": "f597fe60.1abe5",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"resource to be deleted is not available in mdsal\" />\n",
    "comments": "",
    "x": 1719.2578125,
    "y": 780.2539052963257,
    "z": "3cf3c3f6.8ecf4c",
    "wires": []
  },
  {
    "id": "15fa064d.455b2a",
    "type": "outcome",
    "name": "NULL",
    "xml": "<outcome value=''>\n",
    "comments": "",
    "outputs": 1,
    "x": 1581.7578125,
    "y": 780.2539052963257,
    "z": "3cf3c3f6.8ecf4c",
    "wires": [
      [
        "f597fe60.1abe5"
      ]
    ]
  },
  {
    "id": "9971417.dd05cc",
    "type": "switchNode",
    "name": "switch tmp.cidx ",
    "xml": "<switch test=\"`$tmp.cidx`\">\n\n",
    "comments": "",
    "outputs": 1,
    "x": 1427.7578125,
    "y": 780.2539052963257,
    "z": "3cf3c3f6.8ecf4c",
    "wires": [
      [
        "15fa064d.455b2a"
      ]
    ]
  },
  {
    "id": "78b32310.b31e1c",
    "type": "comment",
    "name": "Delete provided service provided-allotted-resources in mdsal",
    "info": "",
    "comments": "",
    "x": 776.5078277587891,
    "y": 816.0039052963257,
    "z": "3cf3c3f6.8ecf4c",
    "wires": []
  },
  {
    "id": "2011daa6.6398e6",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1104.5080833435059,
    "y": 1130.7540974617004,
    "z": "3cf3c3f6.8ecf4c",
    "wires": [
      [
        "73a8d368.4b79bc"
      ]
    ]
  },
  {
    "id": "e3d57198.c43ea",
    "type": "other",
    "name": "outcome Null",
    "xml": "<outcome value=''>\n",
    "comments": "",
    "outputs": 1,
    "x": 1121.5080032348633,
    "y": 1042.7539315223694,
    "z": "3cf3c3f6.8ecf4c",
    "wires": [
      [
        "e0cbd03d.fef77"
      ]
    ]
  },
  {
    "id": "e0cbd03d.fef77",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Resource to be deleted doesn't exist in MDSAL.\" />\n",
    "comments": "",
    "x": 1285.3656005859375,
    "y": 1043.1824765205383,
    "z": "3cf3c3f6.8ecf4c",
    "wires": []
  },
  {
    "id": "8152d4f5.017ee8",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"resource to be deleted is not available in mdsal\" />\n",
    "comments": "",
    "x": 1716.7578563690186,
    "y": 1160.7539353370667,
    "z": "3cf3c3f6.8ecf4c",
    "wires": []
  },
  {
    "id": "9af42612.9cc9e8",
    "type": "outcome",
    "name": "NULL",
    "xml": "<outcome value=''>\n",
    "comments": "",
    "outputs": 1,
    "x": 1579.2578563690186,
    "y": 1160.7539353370667,
    "z": "3cf3c3f6.8ecf4c",
    "wires": [
      [
        "8152d4f5.017ee8"
      ]
    ]
  },
  {
    "id": "4ca0ceba.893a2",
    "type": "switchNode",
    "name": "switch tmp.pidx ",
    "xml": "<switch test=\"`$tmp.pidx`\">\n\n",
    "comments": "",
    "outputs": 1,
    "x": 1425.2578563690186,
    "y": 1160.7539353370667,
    "z": "3cf3c3f6.8ecf4c",
    "wires": [
      [
        "9af42612.9cc9e8"
      ]
    ]
  },
  {
    "id": "f2234386.9854c",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2289.508274078369,
    "y": 1080.7540936470032,
    "z": "3cf3c3f6.8ecf4c",
    "wires": [
      [
        "8c3b4c6c.f6375"
      ]
    ]
  },
  {
    "id": "51d5026c.5bd4fc",
    "type": "set",
    "name": "set tmp.pidx",
    "xml": "<set>\n<parameter name='tmp.pidx' value='`$pidx`' />\n",
    "comments": "",
    "x": 2357.8443908691406,
    "y": 1215.510190486908,
    "z": "3cf3c3f6.8ecf4c",
    "wires": []
  },
  {
    "id": "8c3b4c6c.f6375",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 2349.586727142334,
    "y": 1151.5395798683167,
    "z": "3cf3c3f6.8ecf4c",
    "wires": [
      [
        "51d5026c.5bd4fc"
      ]
    ]
  },
  {
    "id": "38ea07fe.9ae708",
    "type": "set",
    "name": "set provided allotted resources for deletion",
    "xml": "<set>\n<parameter name=\"service-data.provided-allotted-resources.consumed-allotted-resource[$pidx].\" value=\"\" />\n<parameter name=\"service-data.provided-allotted-resources.consumed-allotted-resource_length\" value='`$service-data.provided-allotted-resources.consumed-allotted-resource_length - 1`' />\n\n",
    "comments": "",
    "x": 735.0079040527344,
    "y": 1146.003975868225,
    "z": "3cf3c3f6.8ecf4c",
    "wires": []
  },
  {
    "id": "a01da430.f51578",
    "type": "update",
    "name": "update AAI allotted-resource",
    "xml": "<delete plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" resource='allotted-resource'  \n\t\tkey=\"customer.global-customer-id = $connection-attachment-topology-operation-input.service-information.global-customer-id AND\n\t\t\tservice-subscription.service-type = $connection-attachment-topology-operation-input.service-information.subscription-service-type AND\n\t\t\tservice-instance.service-instance-id = $connection-attachment-topology-operation-input.allotted-resource-information.parent-service-instance-id AND\n\t\t\tallotted-resource.id = $tmp.ar.allotted-resource-id\">\n",
    "comments": "",
    "outputs": 1,
    "x": 692.2266616821289,
    "y": 1300.7543454170227,
    "z": "3cf3c3f6.8ecf4c",
    "wires": [
      [
        "ebfdd448.549cc8",
        "4d049da0.ca99b4"
      ]
    ]
  },
  {
    "id": "5ded2c1d.2cf294",
    "type": "execute",
    "name": "execute RestApiCallNode - get-resource parent service data",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.ar-url-psd`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='GET' />\n    <parameter name=\"responsePrefix\" value=\"mdsal-psd\" />\n\n",
    "comments": "",
    "outputs": 1,
    "x": 782.3373260498047,
    "y": 986.3333654403687,
    "z": "3cf3c3f6.8ecf4c",
    "wires": [
      [
        "32223174.f7450e",
        "e0a303bb.2dc06"
      ]
    ]
  },
  {
    "id": "9639b1d0.6aa4d",
    "type": "execute",
    "name": "get parent-service-data tmp.ar-url-psd",
    "xml": "<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"/restconf/config/GENERIC-RESOURCE-API:services/service/{service-instance-id}/service-data\"/>\n    <parameter name=\"outputPath\" value=\"tmp.ar-url-psd\"/>\n    <parameter name=\"target\" value=\"{service-instance-id}\"/>\n    <parameter name=\"replacement\" value=\"`$tmp.ar.parent-service-instance-id`\"/>",
    "comments": "",
    "outputs": 1,
    "x": 716.3372650146484,
    "y": 944.3332047462463,
    "z": "3cf3c3f6.8ecf4c",
    "wires": [
      []
    ]
  }
]
