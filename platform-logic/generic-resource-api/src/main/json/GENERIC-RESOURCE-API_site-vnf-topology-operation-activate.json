[
  {
    "id": "365b721f.7a253e",
    "type": "dgstart",
    "name": "DGSTART",
    "outputs": 1,
    "x": 142.00390625,
    "y": 164.01038789749146,
    "z": "d540a7b.861cb58",
    "wires": [
      [
        "4883cd2c.e8add4"
      ]
    ]
  },
  {
    "id": "4883cd2c.e8add4",
    "type": "service-logic",
    "name": "GENERIC-RESOURCE-API ${project.version}",
    "module": "GENERIC-RESOURCE-API",
    "version": "${project.version}",
    "comments": "",
    "xml": "<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>",
    "outputs": 1,
    "x": 217.28961181640625,
    "y": 204.24849939346313,
    "z": "d540a7b.861cb58",
    "wires": [
      [
        "3fd0f9a0.bfb166"
      ]
    ]
  },
  {
    "id": "3fd0f9a0.bfb166",
    "type": "method",
    "name": "method site-vnf-topology-operation-activate",
    "xml": "<method rpc='site-vnf-topology-operation-activate' mode='sync'>\n",
    "comments": "",
    "outputs": 1,
    "x": 238.43252563476562,
    "y": 294.01038789749146,
    "z": "d540a7b.861cb58",
    "wires": [
      [
        "a41ebaac.ea0658"
      ]
    ]
  },
  {
    "id": "a41ebaac.ea0658",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 226.67063903808594,
    "y": 483.6771664619446,
    "z": "d540a7b.861cb58",
    "wires": [
      [
        "d76422f.52b80e",
        "221a8fd1.b8b2f",
        "faa004c7.5a25c8",
        "5f14f4d2.549ccc",
        "3c340ff6.924a4",
        "3edd9e9f.d604f2",
        "dd9550a6.ba9af",
        "ead8f54d.0eecc8",
        "90854244.d2678",
        "78b0ee0f.0865f"
      ]
    ]
  },
  {
    "id": "d76422f.52b80e",
    "type": "switchNode",
    "name": "switch service-data.vnfs.vnf_length",
    "xml": "<switch test='`$service-data.vnfs.vnf_length`'>\n",
    "comments": "",
    "outputs": 1,
    "x": 665.9935684204102,
    "y": 112.9999828338623,
    "z": "d540a7b.861cb58",
    "wires": [
      [
        "3851ce61.8f91c2",
        "a2f9a6ea.ae2718",
        "c137a07.e2f1f6"
      ]
    ]
  },
  {
    "id": "3851ce61.8f91c2",
    "type": "other",
    "name": "Null",
    "xml": "<outcome value=''>\n",
    "comments": "",
    "outputs": 1,
    "x": 896.9935455322266,
    "y": 115.00004625320435,
    "z": "d540a7b.861cb58",
    "wires": [
      [
        "4f151038.9977"
      ]
    ]
  },
  {
    "id": "4f151038.9977",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"vnf-topology-operation-input.vnf-request-input.vnf-id not found in service-data\" />\n",
    "comments": "",
    "x": 1054.7710609436035,
    "y": 95.8889946937561,
    "z": "d540a7b.861cb58",
    "wires": []
  },
  {
    "id": "a2f9a6ea.ae2718",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 888.9939727783203,
    "y": 150.00006818771362,
    "z": "d540a7b.861cb58",
    "wires": [
      [
        "f0eea43d.80c008"
      ]
    ]
  },
  {
    "id": "f0eea43d.80c008",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 1055.263442993164,
    "y": 141.55460166931152,
    "z": "d540a7b.861cb58",
    "wires": [
      [
        "5514a22c.cabcac",
        "c241356.b2ab4c8",
        "18332af4.bcb575"
      ]
    ]
  },
  {
    "id": "5514a22c.cabcac",
    "type": "for",
    "name": "for vidx..service-data.vnfs.vnf_length[]",
    "xml": "<for index='vidx' start='0' end='`$service-data.vnfs.vnf_length`' >\n",
    "comments": "",
    "outputs": 1,
    "x": 1306.2795715332031,
    "y": 86.42860507965088,
    "z": "d540a7b.861cb58",
    "wires": [
      [
        "5665ac79.9c7064"
      ]
    ]
  },
  {
    "id": "c241356.b2ab4c8",
    "type": "switchNode",
    "name": "switch tmp.vidx ",
    "xml": "<switch test=\"`$tmp.vidx`\">\n\n",
    "comments": "",
    "outputs": 1,
    "x": 1261.5808868408203,
    "y": 136.41179132461548,
    "z": "d540a7b.861cb58",
    "wires": [
      [
        "19a218fc.ad6fe7"
      ]
    ]
  },
  {
    "id": "19a218fc.ad6fe7",
    "type": "outcome",
    "name": "NULL",
    "xml": "<outcome value=''>\n",
    "comments": "",
    "outputs": 1,
    "x": 1413.0096893310547,
    "y": 136.9832215309143,
    "z": "d540a7b.861cb58",
    "wires": [
      [
        "87ce1b6f.ea04b8"
      ]
    ]
  },
  {
    "id": "3d3bb0a2.e8367",
    "type": "switchNode",
    "name": "switch vnfid found",
    "xml": "<switch test=\"`$service-data.vnfs.vnf[$vidx].vnf-id == $vnf-topology-operation-input.vnf-information.vnf-id`\">\n\n",
    "comments": "",
    "outputs": 1,
    "x": 1722.7082748413086,
    "y": 45.67872476577759,
    "z": "d540a7b.861cb58",
    "wires": [
      [
        "90ad7f4f.37ad5"
      ]
    ]
  },
  {
    "id": "87ce1b6f.ea04b8",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"vnf-topology-operation-input.vnf-request-input.vnf-id not found in service-data\" />\n",
    "comments": "",
    "x": 1551.438087463379,
    "y": 138.1260437965393,
    "z": "d540a7b.861cb58",
    "wires": []
  },
  {
    "id": "90ad7f4f.37ad5",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1896.6607551574707,
    "y": 45.57144498825073,
    "z": "d540a7b.861cb58",
    "wires": [
      [
        "edd58360.fef7"
      ]
    ]
  },
  {
    "id": "c137a07.e2f1f6",
    "type": "outcome",
    "name": "0",
    "xml": "<outcome value='0'>\n",
    "comments": "",
    "outputs": 1,
    "x": 894.9623565673828,
    "y": 77.9687352180481,
    "z": "d540a7b.861cb58",
    "wires": [
      [
        "4f151038.9977"
      ]
    ]
  },
  {
    "id": "5f14f4d2.549ccc",
    "type": "returnSuccess",
    "name": "return success",
    "xml": "<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n",
    "comments": "",
    "x": 610.3376045227051,
    "y": 666.344172000885,
    "z": "d540a7b.861cb58",
    "wires": []
  },
  {
    "id": "ead8f54d.0eecc8",
    "type": "set",
    "name": "set vnf-level-oper-status to Active",
    "xml": "<set>\n<parameter name='service-data.vnfs.vnf[$tmp.vidx].vnf-data.vnf-level-oper-status.order-status' value='Active' />\n<parameter name='service-data.vnfs.vnf[$tmp.vidx].vnf-data.vnf-level-oper-status.last-rpc-action' value='`$vnf-topology-operation-input.sdnc-request-header.svc-action`' />\n<parameter name='service-data.vnfs.vnf[$tmp.vidx].vnf-data.vnf-level-oper-status.last-action' value='`$vnf-topology-operation-input.request-information.request-action`' />\n",
    "comments": "",
    "x": 672.8177947998047,
    "y": 500.68161153793335,
    "z": "d540a7b.861cb58",
    "wires": []
  },
  {
    "id": "dd9550a6.ba9af",
    "type": "set",
    "name": "set vnf-index and vnf-object-path",
    "xml": "<set>\n<parameter name='vnfId' value='`$service-data.vnfs.vnf[$tmp.vidx].vnf-id`' />\n<parameter name=\"vnf-object-path\" value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'  + $vnf-topology-operation-input.service-information.service-instance-id  + '/service-data/vnfs/vnf/'  + $vnf-topology-operation-input.vnf-information.vnf-id  + '/vnf-data/'` \" />",
    "comments": "",
    "x": 672.50439453125,
    "y": 457.34414625167847,
    "z": "d540a7b.861cb58",
    "wires": []
  },
  {
    "id": "1689d83b.0f3d48",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1530.504482269287,
    "y": 402.0003957748413,
    "z": "d540a7b.861cb58",
    "wires": [
      [
        "877e79a4.de6e08"
      ]
    ]
  },
  {
    "id": "877e79a4.de6e08",
    "type": "set",
    "name": "set controller data",
    "xml": "<set>\n<parameter name='prop.sdncRestApi.thirdpartySdnc.url' value=\"`$tmp.aai.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].service-url`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.user' value=\"`$tmp.aai.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].user-name`\" />\n<parameter name='prop.sdncRestApi.thirdpartySdnc.password' value=\"`$tmp.aai.esr-thirdparty-sdnc.esr-system-info-list.esr-system-info[0].password`\" />\n",
    "comments": "",
    "x": 1719.0045776367188,
    "y": 396.00040543079376,
    "z": "d540a7b.861cb58",
    "wires": []
  },
  {
    "id": "e9a64136.0f3a4",
    "type": "not-found",
    "name": "not-found",
    "xml": "<outcome value='not-found'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1533.995449066162,
    "y": 449.57443141937256,
    "z": "d540a7b.861cb58",
    "wires": [
      [
        "1ecf5c87.8a1883"
      ]
    ]
  },
  {
    "id": "1ecf5c87.8a1883",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'An error occurred while querying esr-thirdparty-sdnc from AnAI with thirdparty-sdnc-id = ' + $tmp.thirdparty-sdnc-id`\" />\n\n",
    "comments": "",
    "x": 1707.5668601989746,
    "y": 437.86016750335693,
    "z": "d540a7b.861cb58",
    "wires": []
  },
  {
    "id": "46f84de2.5c2c94",
    "type": "other",
    "name": "other",
    "xml": "<outcome value='Other'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1526.328456878662,
    "y": 490.9077444076538,
    "z": "d540a7b.861cb58",
    "wires": [
      [
        "87e2e13c.489f3"
      ]
    ]
  },
  {
    "id": "87e2e13c.489f3",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"`'Unexpected error occurred while querying esr-thirdparty-sdnc from AnAI with thirdparty-sdnc-id = ' + $tmp.thirdparty-sdnc-id`\" />\n\n",
    "comments": "",
    "x": 1714.1010131835938,
    "y": 486.34693717956543,
    "z": "d540a7b.861cb58",
    "wires": []
  },
  {
    "id": "e15f72bc.d37ff",
    "type": "get-resource",
    "name": "get-resource esr-thirdparty-sdnc",
    "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"esr-thirdparty-sdnc\" \n\t\tkey=\"esr-thirdparty-sdnc.thirdparty-sdnc-id = SDWANController AND \n\t\t     depth = '1'\"\n        pfx='tmp.aai.esr-thirdparty-sdnc' local-only='false' >\n\n",
    "comments": "",
    "outputs": 1,
    "x": 1263.50439453125,
    "y": 450.0004016160965,
    "z": "d540a7b.861cb58",
    "wires": [
      [
        "1689d83b.0f3d48",
        "e9a64136.0f3a4",
        "46f84de2.5c2c94"
      ]
    ]
  },
  {
    "id": "8c66a623.b3e238",
    "type": "execute",
    "name": "execute RestApiCallNode Create  SDWAN site",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/sdwan-site.json'`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/controller/campus/v1/sdwan/net/sites'`\" />\n<parameter name=\"restapiUser\" value=\"`$prop.sdncRestApi.thirdpartySdnc.user`\" />\n<parameter name=\"restapiPassword\" value=\"`$prop.sdncRestApi.thirdpartySdnc.password`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"post\"/>\n<parameter name=\"responsePrefix\" value=\"site-result\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.openecomp.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>\n<parameter name='customHttpHeaders' value=\"`'X-ACCESS-TOKEN=' + $prop.sdncRestApi.token_id`\" />",
    "comments": "",
    "outputs": 1,
    "x": 1286.004508972168,
    "y": 607.0003957748413,
    "z": "d540a7b.861cb58",
    "wires": [
      [
        "9cc77bf6.9a9d78",
        "2cdd5eb4.cdc7e2"
      ]
    ]
  },
  {
    "id": "45d1f2b.f3e000c",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "comments": "",
    "outputs": 1,
    "x": 1706.6710319519043,
    "y": 608.8892965316772,
    "z": "d540a7b.861cb58",
    "wires": [
      []
    ]
  },
  {
    "id": "7a151bff.37aaa4",
    "type": "returnFailure",
    "name": "return failure",
    "xml": "<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error executing Create vpn rest api\" />\n",
    "comments": "",
    "x": 1692.1156158447266,
    "y": 668.4446439743042,
    "z": "d540a7b.861cb58",
    "wires": []
  },
  {
    "id": "2cdd5eb4.cdc7e2",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1547.1156063079834,
    "y": 665.4446420669556,
    "z": "d540a7b.861cb58",
    "wires": [
      [
        "7a151bff.37aaa4"
      ]
    ]
  },
  {
    "id": "9cc77bf6.9a9d78",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1547.559944152832,
    "y": 609.1114501953125,
    "z": "d540a7b.861cb58",
    "wires": [
      [
        "45d1f2b.f3e000c"
      ]
    ]
  },
  {
    "id": "90854244.d2678",
    "type": "set",
    "name": "copy input data to service data",
    "xml": "<set>\n<!--parameter name='service-data.vnfs.vnf[$tmp.vidx].vnf-id' value='`$vnf-topology-operation-input.vnf-information.vnf-id`' /-->\n<parameter name='service-data.vnfs.vnf[$tmp.vidx].vnf-data.sdnc-request-header.' value='$vnf-topology-operation-input.sdnc-request-header.' />\n<parameter name='service-data.vnfs.vnf[$tmp.vidx].vnf-data.request-information.' value='$vnf-topology-operation-input.request-information.' />\n<parameter name='service-data.vnfs.vnf[$tmp.vidx].vnf-data.service-information.' value='$vnf-topology-operation-input.service-information.' />",
    "comments": "",
    "x": 664.0043487548828,
    "y": 544.0006427764893,
    "z": "d540a7b.861cb58",
    "wires": []
  },
  {
    "id": "dc8a36b0.c3b358",
    "type": "execute",
    "name": "execute RestApiCallNode Get token",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n<parameter name=\"templateFileName\" value=\"`$prop.restapi.templateDir + '/actokentemplate.json'`\" />\n<parameter name=\"restapiUrl\" value=\"`$prop.sdncRestApi.thirdpartySdnc.url + '/controller/v2/tokens'`\" />\n<parameter name=\"format\" value=\"json\"/>\n<parameter name=\"httpMethod\" value=\"post\"/>\n<parameter name=\"responsePrefix\" value=\"token-result\"/>\n<parameter name=\"trustStoreFileName\" value=\"/opt/onap/sdnc/data/stores/truststore.openecomp.client.jks\"/>\n<parameter name=\"trustStorePassword\" value=\"adminadmin\"/>\n<parameter name=\"keyStoreFileName\" value=\"/opt/onap/sdnc/data/stores/sdnc.p12\"/>\n<parameter name=\"keyStorePassword\" value=\"adminadmin\"/>",
    "comments": "",
    "outputs": 1,
    "x": 1264.7584915161133,
    "y": 543.0044623613358,
    "z": "d540a7b.861cb58",
    "wires": [
      [
        "b5fd26d4.434e58",
        "35ebfe16.180562"
      ]
    ]
  },
  {
    "id": "b5fd26d4.434e58",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1529.758373260498,
    "y": 528.004357457161,
    "z": "d540a7b.861cb58",
    "wires": [
      [
        "545e872c.836968"
      ]
    ]
  },
  {
    "id": "35ebfe16.180562",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1522.008373260498,
    "y": 569.6472407579422,
    "z": "d540a7b.861cb58",
    "wires": [
      [
        "ec823836.0a8798"
      ]
    ]
  },
  {
    "id": "ec823836.0a8798",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 1648.091869354248,
    "y": 569.893273472786,
    "z": "d540a7b.861cb58",
    "wires": [
      []
    ]
  },
  {
    "id": "545e872c.836968",
    "type": "set",
    "name": "set token-id",
    "xml": "<set>\n<parameter name='prop.sdncRestApi.token_id' value='`$token-result.data.token_id`' />\n",
    "comments": "",
    "x": 1666.758373260498,
    "y": 528.004357457161,
    "z": "d540a7b.861cb58",
    "wires": []
  },
  {
    "id": "48a7bd41.b0ef94",
    "type": "comment",
    "name": "tmp.thirdparty-sdnc-id is hardcoded value?",
    "info": "",
    "comments": "",
    "x": 1312.0082931518555,
    "y": 404.00437355041504,
    "z": "d540a7b.861cb58",
    "wires": []
  },
  {
    "id": "3edd9e9f.d604f2",
    "type": "set",
    "name": "set siteId to service data",
    "xml": "<set>\n<!--parameter name='service-data.vnfs.vnf[$tmp.vidx].vnf-id' value='`$service-data.vnfs.vnf[$tmp.vidx].vnf-id`' /-->\n<parameter name='service-data.vnfs.vnf[$tmp.vidx].vnf-data.vnf-request-input.vnf-input-parameters.param[$service-data.vnfs.vnf[$tmp.vidx].vnf-data.vnf-request-input.vnf-input-parameters.param_length].name' value='siteId' />\n<parameter name='service-data.vnfs.vnf[$tmp.vidx].vnf-data.vnf-request-input.vnf-input-parameters.param[$service-data.vnfs.vnf[$tmp.vidx].vnf-data.vnf-request-input.vnf-input-parameters.param_length].value' value='`$site-result.success[0].id`' />\n<parameter name='service-data.vnfs.vnf[$tmp.vidx].vnf-data.vnf-request-input.vnf-input-parameters.param_length' value='`$service-data.vnfs.vnf[$tmp.vidx].vnf-data.vnf-request-input.vnf-input-parameters.param_length + 1`' />\n",
    "comments": "",
    "x": 654.0081787109375,
    "y": 419.0042562484741,
    "z": "d540a7b.861cb58",
    "wires": []
  },
  {
    "id": "5c9c6749.a75a58",
    "type": "switchNode",
    "name": "switch ActivateSDWANDeviceInstance",
    "xml": "<switch test=\"`$service-data.vnfs.vnf[$vidx].vnf-data.request-information.request-action == 'ActivateSDWANDeviceInstance'`\">\n\n    \n    \n\n",
    "comments": "",
    "outputs": 1,
    "x": 1790.2582473754883,
    "y": 115.00390195846558,
    "z": "d540a7b.861cb58",
    "wires": [
      [
        "4e8a745e.fc595c"
      ]
    ]
  },
  {
    "id": "4e8a745e.fc595c",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2017.2581024169922,
    "y": 114.00390100479126,
    "z": "d540a7b.861cb58",
    "wires": [
      [
        "80899e02.b6a68"
      ]
    ]
  },
  {
    "id": "f39513a2.e7f31",
    "type": "comment",
    "name": "Get devices",
    "info": "",
    "comments": "",
    "x": 1824.0082626342773,
    "y": 135.75391721725464,
    "z": "d540a7b.861cb58",
    "wires": []
  },
  {
    "id": "221a8fd1.b8b2f",
    "type": "set",
    "name": "set prop.site.sdwan false",
    "xml": "<set>\n<parameter name='prop.site.sdwan' value=\"false\" />\n\n",
    "comments": "",
    "x": 645.0039215087891,
    "y": 54.00003242492676,
    "z": "d540a7b.861cb58",
    "wires": []
  },
  {
    "id": "3c340ff6.924a4",
    "type": "switchNode",
    "name": "switch prop.site.sdwan",
    "xml": "<switch test=\"`$prop.site.sdwan`\">\n",
    "comments": "",
    "outputs": 1,
    "x": 641.0040283203125,
    "y": 361.6666216850281,
    "z": "d540a7b.861cb58",
    "wires": [
      [
        "3529dc36.6091c4"
      ]
    ]
  },
  {
    "id": "3529dc36.6091c4",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 820.004077911377,
    "y": 358.6666216850281,
    "z": "d540a7b.861cb58",
    "wires": [
      [
        "b0a30d5b.6002c"
      ]
    ]
  },
  {
    "id": "b0a30d5b.6002c",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 976.0043029785156,
    "y": 355.66694355010986,
    "z": "d540a7b.861cb58",
    "wires": [
      [
        "8c7ebff5.e351e",
        "1aa5ae21.057332",
        "8c66a623.b3e238",
        "e15f72bc.d37ff",
        "dc8a36b0.c3b358"
      ]
    ]
  },
  {
    "id": "80899e02.b6a68",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 1972.6710166931152,
    "y": 176.00004196166992,
    "z": "d540a7b.861cb58",
    "wires": [
      [
        "744280bc.85fef"
      ]
    ]
  },
  {
    "id": "744280bc.85fef",
    "type": "for",
    "name": "for loop deviceidx - Get deviceId from servicedata",
    "xml": "<for index=\"deviceidx\" start=\"0\" end=\"`$service-data.vnfs.vnf[$vidx].vnf-data.vnf-request-input.vnf-input-parameters.param_length`\">",
    "comments": "",
    "outputs": 1,
    "x": 2254.0047702789307,
    "y": 186.00006246566772,
    "z": "d540a7b.861cb58",
    "wires": [
      [
        "e3f03864.75b5b8"
      ]
    ]
  },
  {
    "id": "e3f03864.75b5b8",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 2370.004554748535,
    "y": 237.00024795532227,
    "z": "d540a7b.861cb58",
    "wires": [
      [
        "271bfd98.e39bf2"
      ]
    ]
  },
  {
    "id": "271bfd98.e39bf2",
    "type": "switchNode",
    "name": "switch deviceId",
    "xml": "<switch test=\"`$service-data.vnfs.vnf[$vidx].vnf-data.vnf-request-input.vnf-input-parameters.param[$deviceidx].name == 'deviceId'`\">\n",
    "comments": "",
    "outputs": 1,
    "x": 2530.004810333252,
    "y": 239.00010108947754,
    "z": "d540a7b.861cb58",
    "wires": [
      [
        "d2e3890.db58f78"
      ]
    ]
  },
  {
    "id": "d2e3890.db58f78",
    "type": "outcomeTrue",
    "name": "true",
    "xml": "<outcome value='true'>\n",
    "comments": "",
    "outputs": 1,
    "x": 2682.004981994629,
    "y": 238.00010108947754,
    "z": "d540a7b.861cb58",
    "wires": [
      [
        "a5559674.8a50e8"
      ]
    ]
  },
  {
    "id": "a5559674.8a50e8",
    "type": "set",
    "name": "set deviceId",
    "xml": "<set>\n<parameter name='prop.site.deviceId[$prop.site.deviceId_length]' value='`$service-data.vnfs.vnf[$vidx].vnf-data.vnf-request-input.vnf-input-parameters.param[$deviceidx].value`' />\n<parameter name='prop.site.deviceId_length' value='`$prop.site.deviceId_length + 1`' />\n",
    "comments": "",
    "x": 2822.004985809326,
    "y": 237.60005569458008,
    "z": "d540a7b.861cb58",
    "wires": []
  },
  {
    "id": "18332af4.bcb575",
    "type": "set",
    "name": "set prop.site.deviceId_length",
    "xml": "<set>\n<parameter name='prop.site.deviceId_length' value='0' />\n",
    "comments": "",
    "x": 1298.003978729248,
    "y": 40.99999475479126,
    "z": "d540a7b.861cb58",
    "wires": []
  },
  {
    "id": "78b0ee0f.0865f",
    "type": "save",
    "name": "update siteInstance configuration in AAI",
    "xml": "<save plugin='org.onap.ccsdk.sli.adaptors.aai.AAIService' resource='site-resource' \n      key='site-resource.site-resource-id = $vnf-topology-operation-input.vnf-information.vnf-id' >\n<parameter name='site-resource-id' value='`$vnf-topology-operation-input.vnf-information.vnf-id`' />      \n<parameter name='generated-site-id' value='`$site-result.success[0].id`' /> \n<parameter name='operational-status' value='Active' />\n",
    "comments": "",
    "outputs": 1,
    "x": 694.0040740966797,
    "y": 605.0001573562622,
    "z": "d540a7b.861cb58",
    "wires": [
      []
    ]
  },
  {
    "id": "faa004c7.5a25c8",
    "type": "execute",
    "name": "execute Properties",
    "xml": "<execute plugin='org.onap.ccsdk.sli.plugins.prop.PropertiesNode' method='readProperties' >\n    <parameter name='fileName' value='%SDNC_CONFIG_DIR%/generic-resource-api-dg.properties' />\n    <parameter name='contextPrefix' value='prop' />\n",
    "comments": "",
    "outputs": 1,
    "x": 637.0039443969727,
    "y": 250.9999966621399,
    "z": "d540a7b.861cb58",
    "wires": [
      []
    ]
  },
  {
    "id": "8c7ebff5.e351e",
    "type": "set",
    "name": "set siteId",
    "xml": "<set>\n<parameter name='prop.site.siteId' value=\"\" />\n\n",
    "comments": "",
    "x": 1185.0042419433594,
    "y": 346.00010216236115,
    "z": "d540a7b.861cb58",
    "wires": []
  },
  {
    "id": "f5d9902.f200f7",
    "type": "comment",
    "name": "should be null in request",
    "info": "",
    "comments": "",
    "x": 1194.004165649414,
    "y": 317.00005638599396,
    "z": "d540a7b.861cb58",
    "wires": []
  },
  {
    "id": "edd58360.fef7",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 2067.004051208496,
    "y": 49.65758037567139,
    "z": "d540a7b.861cb58",
    "wires": [
      [
        "e434b261.8d553",
        "2f0be2c.5dcd11e",
        "eee333df.5a9b6"
      ]
    ]
  },
  {
    "id": "2f0be2c.5dcd11e",
    "type": "set",
    "name": "set vnf-request-input.",
    "xml": "<set>\n<parameter name='vnf-request-input.' value='`$ctx.vnf-data.vnf-data.vnf-request-input.`' />\n\n",
    "comments": "",
    "x": 2319.337059020996,
    "y": 66.65763568878174,
    "z": "d540a7b.861cb58",
    "wires": []
  },
  {
    "id": "e434b261.8d553",
    "type": "set",
    "name": "set tmp.vidx and ctx.vnf-data",
    "xml": "<set>\n<parameter name='tmp.vidx' value='`$vidx`' />\n<parameter name='ctx.vnf-data.' value='`$service-data.vnfs.vnf[$vidx].`' />\n",
    "comments": "",
    "x": 2346.890769958496,
    "y": 20,
    "z": "d540a7b.861cb58",
    "wires": []
  },
  {
    "id": "eee333df.5a9b6",
    "type": "call",
    "name": "call sdwan-get-site-param",
    "xml": "<call module='GENERIC-RESOURCE-API' rpc='sdwan-get-site-param' mode='sync' >\n",
    "comments": "",
    "outputs": 1,
    "x": 2317.977737426758,
    "y": 102.1071195602417,
    "z": "d540a7b.861cb58",
    "wires": [
      []
    ]
  },
  {
    "id": "1aa5ae21.057332",
    "type": "for",
    "name": "for cpidx..prop.site.controlpoints",
    "xml": "<for index='cpidx' start='0' end='`$prop.site.controlpoints_length`' >\n\t\t\t\t\t\t\t\t\t\n",
    "comments": "",
    "outputs": 1,
    "x": 1245.0045166015625,
    "y": 247.03131580352783,
    "z": "d540a7b.861cb58",
    "wires": [
      [
        "78afb961.5c44f8"
      ]
    ]
  },
  {
    "id": "78afb961.5c44f8",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 1488.0040283203125,
    "y": 245.03125476837158,
    "z": "d540a7b.861cb58",
    "wires": [
      [
        "6cfee007.a751c",
        "9f90e330.d491e"
      ]
    ]
  },
  {
    "id": "5665ac79.9c7064",
    "type": "block",
    "name": "block : atomic",
    "xml": "<block atomic=\"true\">",
    "atomic": "true",
    "outputs": 1,
    "x": 1545.2540493011475,
    "y": 86.00390911102295,
    "z": "d540a7b.861cb58",
    "wires": [
      [
        "3d3bb0a2.e8367",
        "5c9c6749.a75a58"
      ]
    ]
  },
  {
    "id": "6cfee007.a751c",
    "type": "get-resource",
    "name": "get-resource control pts for sideId",
    "xml": "<get-resource plugin=\"org.onap.ccsdk.sli.adaptors.aai.AAIService\" \n\t\tresource=\"site-resource\" \n\t\tkey=\"site-resource.site-resource-name = $prop.controlPtId AND \n\t\t     depth = '1'\"\n        pfx='tmp.aai.controlPoints' local-only='false' >\n\n",
    "comments": "",
    "outputs": 1,
    "x": 1711.333595275879,
    "y": 270.0000762939453,
    "z": "d540a7b.861cb58",
    "wires": [
      [
        "80cbc7ba.096f98",
        "e060fcc5.cef25"
      ]
    ]
  },
  {
    "id": "44fab179.6e6d3",
    "type": "set",
    "name": "set siteId in control point",
    "xml": "<set>\n<parameter name='prop.site.controlpoints[$cpidx]' value='`$tmp.aai.controlPoints.generated-site-id`' />\n\n",
    "comments": "",
    "x": 2108.666790008545,
    "y": 240.00019645690918,
    "z": "d540a7b.861cb58",
    "wires": []
  },
  {
    "id": "80cbc7ba.096f98",
    "type": "success",
    "name": "success",
    "xml": "<outcome value='success'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1930.0004386901855,
    "y": 239.00007438659668,
    "z": "d540a7b.861cb58",
    "wires": [
      [
        "44fab179.6e6d3"
      ]
    ]
  },
  {
    "id": "e060fcc5.cef25",
    "type": "failure",
    "name": "failure",
    "xml": "<outcome value='failure'>\n",
    "comments": "",
    "outputs": 1,
    "x": 1932.2502822875977,
    "y": 277.6429605484009,
    "z": "d540a7b.861cb58",
    "wires": [
      [
        "a065dfd4.9970f"
      ]
    ]
  },
  {
    "id": "a065dfd4.9970f",
    "type": "block",
    "name": "block",
    "xml": "<block>\n",
    "atomic": "false",
    "comments": "",
    "outputs": 1,
    "x": 2072.6666297912598,
    "y": 276.0000171661377,
    "z": "d540a7b.861cb58",
    "wires": [
      []
    ]
  },
  {
    "id": "9f90e330.d491e",
    "type": "set",
    "name": "set prop.controlPtId",
    "xml": "<set>\n<parameter name='prop.controlPtId' value='`$prop.site.controlpoints[$cpidx]`' />\n\n",
    "comments": "",
    "x": 1673.000099182129,
    "y": 210.0000114440918,
    "z": "d540a7b.861cb58",
    "wires": []
  }
]
