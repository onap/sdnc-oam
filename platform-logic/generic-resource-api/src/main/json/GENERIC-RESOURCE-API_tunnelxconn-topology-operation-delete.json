[{"id":"73e15983.54aaa","type":"dgstart","name":"DGSTART","outputs":1,"x":134,"y":114,"z":"83d5bebc.b2e04","wires":[["d289c8b5.38246"]]},{"id":"d289c8b5.38246","type":"service-logic","name":"GENERIC-RESOURCE-API ${project.version}","module":"GENERIC-RESOURCE-API","version":"${project.version}","comments":"","xml":"<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'>","outputs":1,"x":230.23807907104492,"y":174.95239067077637,"z":"83d5bebc.b2e04","wires":[["1e31bf7c.bf4681"]]},{"id":"1e31bf7c.bf4681","type":"method","name":"tunnelxconn-topology-operation-delete","xml":"<method rpc='tunnelxconn-topology-operation-delete' mode='sync'>\n","comments":"","outputs":1,"x":276.15485763549805,"y":210.19044589996338,"z":"83d5bebc.b2e04","wires":[["88507a82.3be6b"]]},{"id":"88507a82.3be6b","type":"block","name":"block : atomic","xml":"<block atomic=\"true\">","atomic":"true","comments":"","outputs":1,"x":184.47619247436523,"y":353.5237879753113,"z":"83d5bebc.b2e04","wires":[["708c9cdf.38800c","38980918.60101e","940119d2.97d148","e2436206.64fe28","aed70f88.b64e","4926e886.d118d8","d8423ad3.959b9","1cda58ea.ace997","a1df0643.52ee18","c5f2e7f7.67fa4","481ae8b1.0c6d8","abfc59fc.fb60e"]]},{"id":"38980918.60101e","type":"returnSuccess","name":"return success","xml":"<return status='success'>\n<parameter name=\"ack-final-indicator\" value=\"Y\" />\n<parameter name=\"error-code\" value=\"200\" />\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n","comments":"","x":451.0001106262207,"y":1023.2145080566406,"z":"83d5bebc.b2e04","wires":[]},{"id":"708c9cdf.38800c","type":"set","name":"set output to api handler","xml":"<set>\n<parameter name='allotted-resource-id' value='`$tmp.ar.allotted-resource-id`' />\n<parameter name='tunnelxconn-object-path' value=\"`$tmp.ar.self-link`\"/>\n<parameter name='service-object-path' value=\"`'restconf/config/GENERIC-RESOURCE-API:services/service/'\n + $tunnelxconn-topology-operation-input.service-information.service-instance-id\n + '/service-data/service-topology/'`\"/>\n \n","comments":"","x":479.75402450561523,"y":987.3370542526245,"z":"83d5bebc.b2e04","wires":[]},{"id":"a1df0643.52ee18","type":"set","name":"set allotted-resource-oper-status","xml":"<set>\n<parameter name='tx-ar.allotted-resource-data.allotted-resource-oper-status.order-status' value='PendingDelete' />\n<parameter name='tx-ar.allotted-resource-data.allotted-resource-oper-status.last-action' value='`$tunnelxconn-topology-operation-input.request-information.request-action`' />\n<parameter name='tx-ar.allotted-resource-data.allotted-resource-oper-status.last-rpc-action' value='`$tunnelxconn-topology-operation-input.sdnc-request-header.svc-action`' />\n<parameter name='tx-ar.allotted-resource-data.allotted-resource-oper-status.last-svc-request-id' value='`$tunnelxconn-topology-operation-input.sdnc-request-header.svc-request-id`' />\n<parameter name='tx-ar.allotted-resource-data.allotted-resource-oper-status.create-timestamp' value='`$tmp.current-time`' />\n","comments":"","x":490.7542190551758,"y":734.0514001846313,"z":"83d5bebc.b2e04","wires":[]},{"id":"e2436206.64fe28","type":"set","name":"set tmp.ar.self-link","xml":"<set>\n<parameter name='tmp.ar.self-link' value=\"`'restconf/config/GENERIC-RESOURCE-API:tunnelxconn-allotted-resources/tunnelxconn-allotted-resource/'\n + $tmp.ar.allotted-resource-id\n + '/allotted-resource-data/tunnelxconn-topology/'` \" />\n\n","comments":"","x":446.73806381225586,"y":327.33332538604736,"z":"83d5bebc.b2e04","wires":[]},{"id":"940119d2.97d148","type":"set","name":"set tmp.ar.allotted-resource-id,etc","xml":"<set>\n<parameter name='tmp.ar.allotted-resource-id' value='`$tunnelxconn-topology-operation-input.allotted-resource-information.allotted-resource-id`' />\n<parameter name='tmp.ar.parent-service-instance-id' value='`$tunnelxconn-topology-operation-input.allotted-resource-information.parent-service-instance-id`' />\n\n\n","comments":"","x":493.9973258972168,"y":293.59259128570557,"z":"83d5bebc.b2e04","wires":[]},{"id":"aed70f88.b64e","type":"execute","name":"execute Properties","xml":"<execute plugin='org.onap.ccsdk.sli.plugins.prop.PropertiesNode' method='readProperties' >\n    <parameter name='fileName' value='%SDNC_CONFIG_DIR%/generic-resource-api-dg.properties' />\n    <parameter name='contextPrefix' value='prop' />\n","comments":"","outputs":1,"x":452.9934196472168,"y":363.23152446746826,"z":"83d5bebc.b2e04","wires":[[]]},{"id":"d8423ad3.959b9","type":"execute","name":"execute RestApiCallNode - Get AR by id","xml":"<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.ar-url`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='GET' />\n    <parameter name=\"responsePrefix\" value=\"mdsal-ar\" />\n\n","comments":"","outputs":1,"x":515.5187530517578,"y":524.4594917297363,"z":"83d5bebc.b2e04","wires":[["f4db9cab.d2556","d2ef8432.b57"]]},{"id":"4926e886.d118d8","type":"execute","name":"generate allotted-resource url","xml":"<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliStringUtils' method='replace' >\n    <parameter name=\"source\" value=\"`$prop.restapi.sz-allottedresource`\"/>\n    <parameter name=\"outputPath\" value=\"tmp.ar-url\"/>\n    <parameter name=\"target\" value=\"{allotted-resource-id}\"/>\n    <parameter name=\"replacement\" value=\"`$tmp.ar.allotted-resource-id`\"/>\n","comments":"","outputs":1,"x":481.0648536682129,"y":423.0172290802002,"z":"83d5bebc.b2e04","wires":[[]]},{"id":"f4db9cab.d2556","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":772.8148918151855,"y":523.2672522068024,"z":"83d5bebc.b2e04","wires":[["3354ddf4.08c79a"]]},{"id":"ece1582d.455d9","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":793.837329864502,"y":930.432332418859,"z":"83d5bebc.b2e04","wires":[["cf83304d.d0ebb8"]]},{"id":"83c14202.0049f8","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":784.8373794555664,"y":898.9323581680655,"z":"83d5bebc.b2e04","wires":[["cf83304d.d0ebb8"]]},{"id":"9bc349d7.413588","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":788.5874176025391,"y":869.2894630432129,"z":"83d5bebc.b2e04","wires":[["6b98a797.ae324"]]},{"id":"cf83304d.d0ebb8","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n\t<parameter name='ack-final' value='Y'/>\n\t<parameter name=\"error-code\" value=\"500\" />\n    <parameter name=\"error-message\" value=\"Error updating md-sal for tunnelxconn-allotted-resource\" />\n","comments":"","x":954.5874176025391,"y":899.6823820099235,"z":"83d5bebc.b2e04","wires":[]},{"id":"3354ddf4.08c79a","type":"block","name":"block: atomic","xml":"<block atomic=\"true\">\n","atomic":"false","comments":"","outputs":1,"x":953.8148460388184,"y":523.7672016620636,"z":"83d5bebc.b2e04","wires":[["2b27c4d4.997524","ab03d1d0.e9037"]]},{"id":"2b27c4d4.997524","type":"switchNode","name":"switch tx length","xml":"<switch test='`$mdsal-ar.tunnelxconn-allotted-resource_length`'>\n","comments":"","outputs":1,"x":1199.6720924377441,"y":558.052964925766,"z":"83d5bebc.b2e04","wires":[["930a4219.057d78"]]},{"id":"930a4219.057d78","type":"other","name":"outcome 1","xml":"<outcome value='1'>\n","comments":"","outputs":1,"x":1390.6720962524414,"y":558.0529625415802,"z":"83d5bebc.b2e04","wires":[["4cf6e1d2.effed"]]},{"id":"f1ca49e7.6e5fc","type":"set","name":"set tx-ar from get","xml":"<set>\n<parameter name='tx-ar.' value='$mdsal-ar.tunnelxconn-allotted-resource[0].' />\n","comments":"","x":1790.5292320251465,"y":558.6243867874146,"z":"83d5bebc.b2e04","wires":[]},{"id":"4cf6e1d2.effed","type":"block","name":"block: atomic","xml":"<block atomic='true'>\n","atomic":"false","comments":"","outputs":1,"x":1561.5290794372559,"y":558.6244316101074,"z":"83d5bebc.b2e04","wires":[["f1ca49e7.6e5fc","485e3856.60d4a8","222bb1e9.0427b6"]]},{"id":"485e3856.60d4a8","type":"set","name":"set oper-status","xml":"<set>\n<parameter name='tx-ar.allotted-resource-data.allotted-resource-oper-status.last-action' value='`$tx-ar.allotted-resource-data.allotted-resource-operation-information.request-information.request-action`' />\n<parameter name='tx-ar.allotted-resource-data.allotted-resource-oper-status.last-rpc-action' value='`$tx-ar.allotted-resource-status.rpc-action`' />\n<parameter name='tx-ar.allotted-resource-data.allotted-resource-oper-status.last-svc-request-id' value='`$tx-ar.allotted-resource-data.allotted-resource-operation-information.sdnc-request-header.svc-request-id`' />\n\n","comments":"","x":1788.5294761657715,"y":626.0529508590698,"z":"83d5bebc.b2e04","wires":[]},{"id":"1b34868.09b18fa","type":"comment","name":"GET tunnelxconn-allotted-resource from mdsal","info":"","comments":"","x":540.8148155212402,"y":487.7671926021576,"z":"83d5bebc.b2e04","wires":[]},{"id":"222bb1e9.0427b6","type":"switchNode","name":"switch order-status","xml":"<switch test='`$tx-ar.allotted-resource-data.allotted-resource-oper-status.order-status`'>\n","comments":"","outputs":1,"x":1798.52925491333,"y":591.6243848800659,"z":"83d5bebc.b2e04","wires":[["d4024b9b.b96b68","5352c45c.7c8d2c"]]},{"id":"d4024b9b.b96b68","type":"outcome","name":"outcome Created","xml":"<outcome value='Created'>\n","comments":"","outputs":1,"x":2010.1292114257812,"y":552.6243848800659,"z":"83d5bebc.b2e04","wires":[["43e0fc0.7e21584"]]},{"id":"5352c45c.7c8d2c","type":"outcome","name":"outcome Other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":2035.8435859680176,"y":588.052975654602,"z":"83d5bebc.b2e04","wires":[["43e0fc0.7e21584"]]},{"id":"51ffa743.27a62","type":"comment","name":"Set allotted-resource-identifiers","info":"","comments":"","x":496.33863830566406,"y":578.3386459350586,"z":"83d5bebc.b2e04","wires":[]},{"id":"ab03d1d0.e9037","type":"set","name":"save backup copy of mdsal-ar for rollback","xml":"<set>\n<parameter name='bk-tx-ar' value='$mdsal-ar.' />\n","comments":"","x":1279.3864250183105,"y":523.7672936916351,"z":"83d5bebc.b2e04","wires":[]},{"id":"903a3cb1.1c223","type":"comment","name":"Create urls for restapi","info":"","comments":"","x":451.9576606750488,"y":392.6243562698364,"z":"83d5bebc.b2e04","wires":[]},{"id":"6b98a797.ae324","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":930.2433853149414,"y":865.481632232666,"z":"83d5bebc.b2e04","wires":[[]]},{"id":"32ab8eae.09664a","type":"comment","name":"TO DO: vnf/put parent","info":"","comments":"","x":464.2433776855469,"y":799.4815540313718,"z":"83d5bebc.b2e04","wires":[]},{"id":"1cda58ea.ace997","type":"execute","name":"execute getTime","xml":"<execute plugin='org.onap.ccsdk.sli.core.slipluginutils.SliPluginUtils' method='setTime' >\n    <parameter name=\"outputPath\" value=\"tmp.current-time\" />\n\n","comments":"","outputs":1,"x":438.24338150024414,"y":695.4815549850464,"z":"83d5bebc.b2e04","wires":[[]]},{"id":"d2ef8432.b57","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":772.5766868591309,"y":559.4814250469208,"z":"83d5bebc.b2e04","wires":[["2c450f2e.03316"]]},{"id":"2c450f2e.03316","type":"block","name":"block: atomic","xml":"<block atomic=\"true\">\n","atomic":"false","comments":"","outputs":1,"x":952.5766372680664,"y":560.1479756832123,"z":"83d5bebc.b2e04","wires":[[]]},{"id":"c5f2e7f7.67fa4","type":"set","name":"set id","xml":"<set>\n<parameter name='tx-ar.allotted-resource-id' value=\"`$tmp.ar.allotted-resource-id` \" />\n<parameter name='tx-ar.allotted-resource-status.action' value=\"`$tunnelxconn-topology-operation-input.request-information.request-action` \" />\n<parameter name='tx-ar.allotted-resource-status.rpc-name' value=\"tunnelxconn-topology-operation\" />\n<parameter name='tx-ar.allotted-resource-status.rpc-action' value=\"`$tunnelxconn-topology-operation-input.sdnc-request-header.svc-action` \" />\n<parameter name='tx-ar.allotted-resource-data.allotted-resource-operation-information.request-information.' value=\"`$tunnelxconn-topology-operation-input.request-information.` \" />\n<parameter name='tx-ar.allotted-resource-data.allotted-resource-operation-information.sdnc-request-header.' value=\"`$tunnelxconn-topology-operation-input.sdnc-request-header.` \" />\n<parameter name='tx-ar.allotted-resource-data.allotted-resource-operation-information.service-information.' value=\"`$tunnelxconn-topology-operation-input.service-information.` \" />\n<parameter name='tx-ar.allotted-resource-data.allotted-resource-operation-information.allotted-resource-information.' value=\"`$tunnelxconn-topology-operation-input.allotted-resource-information.` \" />\n<parameter name='tx-ar.allotted-resource-data.allotted-resource-operation-information.tunnelxconn-request-input.' value=\"`$tunnelxconn-topology-operation-input.tunnelxconn-request-input.` \" />","comments":"","x":421.24342346191406,"y":615.1481666564941,"z":"83d5bebc.b2e04","wires":[]},{"id":"43e0fc0.7e21584","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":2224.5997276306152,"y":554.0000190734863,"z":"83d5bebc.b2e04","wires":[[]]},{"id":"481ae8b1.0c6d8","type":"execute","name":"execute RestApiCallNode - PUT AR by id","xml":"<execute plugin='org.onap.ccsdk.sli.plugins.restapicall.RestapiCallNode' method='sendRequest' >\n    <parameter name='templateFileName' value=\"`$prop.restapi.templateDir + '/' + $prop.restapi.tx.templatefile`\" />\n    <parameter name='restapiUrl' value='`$prop.controller.url + $tmp.ar-url`' />\n    <parameter name='restapiUser' value='`$prop.controller.user`' />\n    <parameter name='restapiPassword' value='`$prop.controller.pwd`' />\n    <parameter name='format' value='json' />\n    <parameter name='httpMethod' value='PUT' />\n    <parameter name=\"responsePrefix\" value=\"mdsal-ar\" />\n\n","comments":"","outputs":1,"x":521.0000152587891,"y":880.0000247955322,"z":"83d5bebc.b2e04","wires":[["9bc349d7.413588","83c14202.0049f8","ece1582d.455d9"]]},{"id":"abfc59fc.fb60e","type":"set","name":"clear tx-ar-assignments","xml":"<set>\n<parameter name='tx-ar-assignments.' value=\"\" />\n\n\n\n","comments":"","x":465,"y":766,"z":"83d5bebc.b2e04","wires":[]}]