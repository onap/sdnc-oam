<!--Reserve/release VNI--><service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='GENERIC-RESOURCE-API' version='${project.version}'><method rpc='manage-vni-assignment' mode='sync'>
<block atomic='true'><set>
<parameter name='tmp.sql.plugin' value='org.onap.ccsdk.sli.adaptors.resource.sql.SqlResource' />
</set><switch test='$tmp.manage-vni.action'>
<outcome value='reserve'>
<block atomic='true'><get-resource plugin='`$tmp.sql.plugin`' resource='VNI' key="SELECT min(vlan_id) from VLAN_ID_POOL where purpose='VNI' and status='AVAILABLE'" pfx="tmp.manage-vni.results" >
<outcome value='success'>
<block>
<set>
<parameter name='tmp.manage-vni.vni' value='`$tmp.manage-vni.results.vlan-id`' />
</set><save plugin='`$tmp.sql.plugin`' resource='VNI' key="UPDATE VLAN_ID_POOL set status='RESERVED' where purpose='VNI' and vlan_id=$tmp.manage-vni.vni" force='false'>

</save></block></outcome></get-resource></block></outcome><outcome value='release'>
<save plugin='`$tmp.sql.plugin`' resource='VNI' key="UPDATE VLAN_ID_POOL set status='AVAILABLE' where purpose='VNI' and vlan_id=$tmp.manage-vni.vni" force='false'>

</save></outcome></switch></block></method></service-logic>